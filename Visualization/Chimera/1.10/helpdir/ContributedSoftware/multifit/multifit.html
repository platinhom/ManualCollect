<!--
--- UCSF Chimera Copyright ---
Copyright (c) 2011 Regents of the University of California.
All rights reserved.  This software provided pursuant to a
license agreement containing restrictions on its disclosure,
duplication and use.  This notice must be embedded in or
attached to all copies, including partial copies, of the
software or any revisions or derivations thereof.
--- UCSF Chimera Copyright ---
-->

<html>
<head>
<TITLE>MultiFit</TITLE>
</head>
<body>
<a name="top">
<h3>MultiFit <img src="multifiticon.png" alt="MultiFit icon"></h3>
</a>
<p>
<b>MultiFit</b> performs simultaneous rigid fitting of 
multiple atomic-resolution structures into
<a href="../../UsersGuide/filetypes.html#volume">density maps</a>
at resolutions as low as 25 &Aring;. 
Multiple copies of a structure can be fit 
<a href="#cyclic">assuming cyclic symmetry</a>,
or multiple different structures can be fit 
<a href="#nosym">without symmetry constraints</a>.
The method is described in:
<blockquote>
<a href="http://www.ncbi.nlm.nih.gov/pubmed/20827723" target="_blank">
Determining macromolecular assembly structures by molecular docking and 
fitting into an electron density map.</a>
Lasker K, Sali A, Wolfson HJ.
<i>Proteins.</i> 2010 Nov 15;78(15):3205-11.
<br><br>
<a href="http://www.ncbi.nlm.nih.gov/pubmed/19233204" target="_blank">
Inferential optimization for simultaneous fitting of multiple components 
into a CryoEM map of their assembly.</a>
Lasker K, Topf M, Sali A, Wolfson HJ.
<i>J Mol Biol.</i> 2009 Apr 24;388(1):180-94.
</blockquote>
The program
<a href="http://www.salilab.org/MultiFit/" target="_blank"><b>MultiFit</b></a>
optimizes a score based on the quality of fit of the structures
in the map, protrusions of the structures from the map envelope, 
and shape complementarity between pairs of structures.
Chimera provides a graphical interface to running this program
via a web service hosted by the
<a href="http://www.cgl.ucsf.edu/Overview/index.html" 
target="_blank">UCSF RBVI</a>.
<p></p>
See also: 
<a href="../volumeviewer/framevolumeviewer.html" target="_top"><b>Volume
Viewer</b></a>,
<a href="../fitmaps/fitmaps.html"><b>Fit in Map</b></a>,
<a href="../segger/fitsegments.html"><b>Fit to Segments</b></a>,
<a href="../../UsersGuide/midas/fitmap.html"><b>fitmap</b></a>,
<a href="../../UsersGuide/midas/measure.html#symmetry"><b>measure 
symmetry</b></a>
<p></p>
There are <a href="../../UsersGuide/extension.html">several ways to start</a>
<b>MultiFit</b>, a tool in the <b>Volume Data</b> category.
The atomic structure(s) and density map of interest should be open
in Chimera and designated as described below.
<ul>
<li>If using <a name="cyclic"><b>Cyclic symmetry</b></a>:
<p>
<b>Fit [<i>N</i>] copies of 
[<i>molecule-model</i> / selected atoms] in map [<i>map-model</i>]</b>
</p><p>
The stoichiometry is specified directly as <i>N</i> copies of the set
of input atoms, each copy to be treated as a single rigid body. 
For example, if <i>N</i> is 7 and the input set of atoms
has stoichiometry &alpha;<sub>2</sub>&beta;, the result will contain 
7 copies of the &alpha;<sub>2</sub>&beta module, without changes 
in the &alpha;-&alpha; or &alpha;-&beta; interactions within the module.
<br>
<li>If using <a name="nosym"><b>No symmetry</b></a>:
<p>
The <b>models to fit</b> should be chosen (highlighted) in the table
with the mouse.
A model should be opened multiple times if the assembly is 
thought to contain more than one copy of that structure.
A block of models can be chosen by dragging, or by
clicking on the first (or last) line in the desired block
and then <b>Shift</b>-clicking on its last (or first) line.
<b>Ctrl</b>-click toggles the state (chosen or not) of a single line.
The table includes:
</p>
  <ul>
  <li>model <b>ID</b> number
  <li>model <b>c</b>olor 
  (a <a href="../../UsersGuide/coloring.html#colorwell">color well</a>)
  <li>whether <b>A</b>ctive
  (<a href="../../UsersGuide/mouse.html#activedef">movable</a>)
  <li>whether <b>S</b>hown (display-enabled)
  <li><b>Fit globally</b> indicates whether to search
  translations all over the density map and all orientations instead 
  of only shifts of up to &plusmn;15 &Aring; in each direction and
  rotations of up to &plusmn;30&deg; from a model's current position.
  The translational (shift) search
  increment is the map voxel size, whereas the rotational increment
  is set in the <b>MultiFit</b> <a href="#options">options</a>.
  Global fitting may take significantly longer than local fitting.
  <li><b>Model</b> name
  </ul>
<p>
Clicking <b>Calculate anchor graph</b> performs an initial assessment 
(also via the web service) of which regions in the density map 
could accommodate models.  One sphere per chosen model is placed 
in the map to guide placement by the user prior to local fitting.
The anchor graph is created as a 
<a href="../volumepathtracer/volumepathtracer.html#markersets">marker model</a>.
The anchor graph will be replaced if the calculation is rerun.
<p>
</ul>
Results also depend on:
<ul>
<li>the contour level 
(<a href="../volumeviewer/volumeviewer.html#dispsurf">surface display threshold</a>) of the map in 
<a href="../volumeviewer/framevolumeviewer.html" target="_top"><b>Volume
Viewer</b></a>, which sets the size and shape of the map envelope
<li>certain <b>MultiFit</b> <a href="#options">options</a>
</ul>
Clicking <b>Fit</b> runs the calculation as a background task.  
Clicking the information icon <img src="../../UsersGuide/taskicon.png"> 
in the Chimera 
<a href="../../UsersGuide/chimerawindow.html#statusline">status line</a>
will bring up the <a href="../idle/task.html"><b>Task Panel</b></a>,
in which the job can be canceled if desired.
<b>Reset</b> deletes any existing results;
otherwise, new results will be appended to those already in the dialog 
(rather than replacing them automatically).
<b>Close</b> dismisses the dialog.
<b>Help</b> opens this manual page in a browser window.
</p><p>
<a name="options">Clicking the <b>Options</b></a> button reveals 
additional settings
(clicking the close button <img src ="../volumeviewer/x.png"</a> on the right
hides them again):
<ul>
<li><b>Number of output assemblies</b> (default <b>10</b>)
- how many solutions to the fitting problem to return to the user, 
after ranking by score
<li><b>Resolution of the density map (&Aring;)</b> (default <b>10.0</b>)
- should be set to the resolution of the chosen experimental map;
the same value is used to simulate density from the atomic coordinates, 
to evaluate their quality of fit to the experimental map
<li><b>Sampling angle (15 to 270&deg;)</b> (default <b>30</b>)
- rotational increment for sampling model orientations
<li><b>Output file location (optional)</b>
- local directory in which to place files used or produced by the calculation,
including the most recent set of results, stderr, and stdout files
</ul>
</p>

<a name="solutions">
<h3>MultiFit Results</h3></a>
<p>
When the calculation finishes, the results are listed in a table 
in the <b>MultiFit</b> dialog.
Each row in the table represents a solution to the fitting problem;
the top 101 solutions are returned.
A single solution consists of multiple models (the <b><i>N</i></b> copies 
of the input set of atoms) in their fitted positions.  
One or more rows can be chosen with the left mouse button to display the
corresponding solution(s) in the main Chimera window. 
<b>Ctrl</b>-click toggles the state (chosen or not) of a single row.
Columns in the table:
<ul>
<li><b>Index</b> - a numerical identifier, simply assigned
starting with zero for the best solution found
<li><b>c</b> - structure color
(a <a href="../../UsersGuide/coloring.html#colorwell">color well</a>, 
which also allows changing the color)
<li><b>Correlation</b> - cross-correlation value representing the 
quality of fit of the structures in the map
<li><b>Name</b> - auto-generated solution name; models within a solution are 
named by appending an underscore and additional integer to the solution name 
</ul>
The solution list can be sorted by the values in any displayed column by
clicking the column header.  Clicking the header once sorts the entries
in order of increasing value and places an up arrowhead (triangle)
in the header.	Clicking again sorts the entries in decreasing
order and places a down arrowhead (inverted triangle) in the header.
</p><p>
Currently, <b>MultiFit</b> results are not saved in 
<a href="../../UsersGuide/sessions.html">sessions</a>, other than
the models displayed at the time of saving. To save a solution:
<ol>
<li>click its row in the <b>MultiFit</b> dialog to display its models
<li>use 
<a href="../../UsersGuide/menu.html#menufile"><b>File... Save PDB</b></a>
in the Chimera menu to save the models as one or more PDB files
<b>relative to</b> the density map model
</ol>
<hr>
<address>UCSF Computer Graphics Laboratory / August 2011</address>
</body></html>
