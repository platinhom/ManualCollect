<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">

<!--Converted with LaTeX2HTML 2002-2-1 (1.71)
original version by:  Nikos Drakos, CBLU, University of Leeds
* revised and updated by:  Marcus Hennecke, Ross Moore, Herb Swan
* with significant contributions from:
  Jens Lippmann, Marek Rouchal, Martin Wilck and others -->
<HTML>
<HEAD>
<TITLE>Matrix routines</TITLE>
<META NAME="description" CONTENT="Matrix routines">
<META NAME="keywords" CONTENT="ug">
<META NAME="resource-type" CONTENT="document">
<META NAME="distribution" CONTENT="global">

<META NAME="Generator" CONTENT="LaTeX2HTML v2002-2-1">
<META HTTP-EQUIV="Content-Style-Type" CONTENT="text/css">

<LINK REL="STYLESHEET" HREF="ug.css">

<LINK REL="next" HREF="node195.html">
<LINK REL="previous" HREF="node193.html">
<LINK REL="up" HREF="node192.html">
<LINK REL="next" HREF="node195.html">
</HEAD>

<BODY BGCOLOR="WHITE">
<!--Navigation Panel-->
<A NAME="tex2html3774"
  HREF="node195.html">
<IMG WIDTH="37" HEIGHT="24" ALIGN="BOTTOM" BORDER="0" ALT="next" SRC="next.png"></A> 
<A NAME="tex2html3768"
  HREF="node192.html">
<IMG WIDTH="26" HEIGHT="24" ALIGN="BOTTOM" BORDER="0" ALT="up" SRC="up.png"></A> 
<A NAME="tex2html3762"
  HREF="node193.html">
<IMG WIDTH="63" HEIGHT="24" ALIGN="BOTTOM" BORDER="0" ALT="previous" SRC="prev.png"></A> 
<A NAME="tex2html3770"
  HREF="node1.html">
<IMG WIDTH="65" HEIGHT="24" ALIGN="BOTTOM" BORDER="0" ALT="contents" SRC="contents.png"></A> 
<A NAME="tex2html3772"
  HREF="node251.html">
<IMG WIDTH="43" HEIGHT="24" ALIGN="BOTTOM" BORDER="0" ALT="index" SRC="index.png"></A> 
<BR>
<B> Next:</B> <A NAME="tex2html3775"
  HREF="node195.html">Multiplying vectors and matrices</A>
<B> Up:</B> <A NAME="tex2html3769"
  HREF="node192.html">Vectors and Matrices</A>
<B> Previous:</B> <A NAME="tex2html3763"
  HREF="node193.html">Vectors</A>
 &nbsp; <B>  <A NAME="tex2html3771"
  HREF="node1.html">Contents</A></B> 
 &nbsp; <B>  <A NAME="tex2html3773"
  HREF="node251.html">Index</A></B> 
<BR>
<BR>
<!--End of Navigation Panel-->

<H1><A NAME="SECTION001420000000000000000"></A>
<A NAME="15266"></A>
<BR>
Matrix routines
</H1>

<P>
Because matrices are rather large when expressed in text form, the
following definitions are used for the examples.

<P>

<UL>
<LI><B>transidentity</B> -
Returns the identity matrix.
<A NAME="15269"></A>
<PRE>
Example:
vmd &gt; transidentity
{1.0 0.0 0.0 0.0} {0.0 1.0 0.0 0.0} {0.0 0.0 1.0 0.0} {0.0 0.0 0.0 1.0}
</PRE>

<P>
</LI>
<LI><B>transtranspose <I>m</I></B> -
Returns the matrix transpose of the given matrix
<A NAME="15273"></A>
<PRE>
Example:
vmd &gt; transtranspose {{0 1 2 3 4} {5 6 7 8} {9 10 11 12} {13 14 15 16}}
{0 5 9 13} {1 6 10 14} {2 7 11 15} {3 8 12 16}
</PRE>

<P>
</LI>
<LI>(C++) <B>transmult <I>m1 m2</I> [<I>m3 ... mn</I>]</B> -
Returns the matrix multiplication of the given matrices
<A NAME="15278"></A>
<PRE>
Examples:
vmd &gt; set mat1 {{1 2 3 4} {-2 3 -4 5} {3 -4 5 -6} {4 5 -6 -7}}
vmd &gt; set mat2 {{1 0 0 0} {0 0.7071 -0.7071 0} {0 0.7071 0.7071 0} {0 0 0 1}}
vmd &gt; set mat3 {{0.866025 0 0 0} {0 1 0 0} {-0.5 0 0.866025 0} {0 0 0 1}}
vmd &gt; transmult $mat1 [transidentity]
{1.0 2.0 3.0 4.0} {-2.0 3.0 -4.0 5.0} {3.0 -4.0 5.0 -6.0} 
   {4.0 5.0 -6.0 -7.0}
vmd &gt; transmult $mat1 $mat2 $mat3
{0.512475 3.5355 0.612366 4.0} {0.7428 -0.7071 -4.28656 5.0}
   {-0.58387 0.7071 5.5113 -6.0} {7.35315 -0.7071 -6.73603 -7.0}
</PRE>

<P>
</LI>
<LI><B>transaxis <IMG
 WIDTH="18" HEIGHT="30" ALIGN="MIDDLE" BORDER="0"
 SRC="img5.png"
 ALT="$ &lt;$">
x<code>|</code>y<code>|</code>z<IMG
 WIDTH="18" HEIGHT="30" ALIGN="MIDDLE" BORDER="0"
 SRC="img4.png"
 ALT="$ &gt;$">
 
<I>amount</I> [deg<code>|</code>rad<code>|</code>pi]</B> -
<A NAME="15282"></A>
Returns the transformation matrix needed to rotate around the
specified axis by a given amount.  By default, the amount is specified
in degrees, though it can also be given in radians or factors of pi.
<PRE>
Examples:
vmd &gt; transaxis x 90
{1.0 0.0 0.0 0.0} {0.0 -3.67321e-06 -1.0 0.0} {0.0 1.0 -3.67321e-06 0.0}
         {0.0 0.0 0.0 1.0}
vmd &gt; transaxis y 0.25 pi
{0.707107 0.0 0.707107 0.0} {0.0 1.0  0.0 0.0} 
         {-0.707107 0.0 0.707107 0.0} {0.0 0.0  0.0 1.0}
vmd &gt; transaxis z 3.1415927 rad
{-1.0 -2.65359e-06 0.0 0.0} {2.65359e-06 -1.0 0.0 0.0} {0.0 0.0 1.0 0.0}
         {0.0 0.0 0.0 1.0}
</PRE>

<P>
</LI>
<LI><B>transvec <I>v</I></B> -
<A NAME="15286"></A>
Returns the transformation matrix needed to bring the x axis along the
v vector.  This matrix is not unique, since a final rotation is
allowed around the vector.  The matrix is made from a rotation around
y, then one about z.
<PRE>
Examples:
vmd &gt; transvec {0 1 0}
{-3.67321e-06 -1.0 0.0 0.0} {1.0 -3.67321e-06 0.0 0.0} {0.0 0.0 1.0 0.0}
         {0.0 0.0 0.0 1.0}
vmd &gt; vectrans [transvec {0 0 2}] {1 0 0}
0.0 0.0 1.0
</PRE>

<P>
</LI>
<LI><B>transvecinv <I>v</I></B> -
<A NAME="15290"></A>
Returns the transformation needed to bring the vector v to the x axis.
This produces the inverse matrix to transvec, and is composed of a
rotation about z then one about y.
<PRE>
Examples:
vmd &gt; transvecinv {0 -1 0}
{-3.67321e-06 -1.0 0.0 0.0} {1.0 -3.67321e-06 0.0 0.0} {0.0 0.0 1.0 0.0}
    {0.0 0.0 0.0 1.0}
vmd &gt; vectrans [transvecinv {-3 4 -12}] {-3 4 -12}
13.0 -1.8e-05 5.8e-05
vmd &gt; transmult [transvec {6 -5 7}] [transvecinv {6 -5 7}]
{0.999999 2.29254e-07 -6.262e-09 0.0} {2.29254e-07 0.999999
    -4.52228e-07 0.0} {-6.262e-09 -4.52228e-07 1.0 0.0} {0.0 0.0 0.0 1.0}
</PRE>

<P>
</LI>
<LI>(C++) <B>transoffset <I>v</I></B> -
<A NAME="15294"></A>
Returns the transformation matrix needed to translate by the given offset
<PRE>
Examples:
vmd &gt; transoffset {1 0 0}
{1.0 0.0 0.0 1} {0.0 1.0 0.0 0} {0.0 0.0 1.0 0} {0.0 0.0 0.0 1.0}
vmd &gt; transoffset {-6 5 -4.3}
{1.0 0.0 0.0 -6} {0.0 1.0 0.0 5} {0.0 0.0 1.0 -4.3} {0.0 0.0 0.0 1.0}
</PRE>

<P>
</LI>
<LI><B>transabout <I>v amount</I> [deg<code>|</code>rad<code>|</code>pi]</B> -
Generates the transformation matrix needed to rotate by the given amount
counter-clockwise around axis which goes through the origin and along the
given vector.  As with transvec, the units of the amount of rotation
can be degrees, radians, or multiples of pi.
<A NAME="15298"></A>
<PRE>
Examples:
# this is a rotation about x by 180 degrees
vmd &gt; transabout {1 0 0} 180
{1.0 0.0 0.0 0.0} {0.0 -1.0 -2.65359e-06 0.0} {0.0 2.65359e-06
        -1.0 0.0} {0.0 0.0 0.0 1.0}
# a rotation about z by 90 degrees
# (compare this to "transaxis z 90"
vmd &gt; transabout {0 0 1} 1.5709 rad
{0.999624 -0.027414 0.0 0.0} {0.027414 0.999624 0.0 0.0} 
        {0.0 0.0 1.0 0.0} {0.0 0.0 0.0 1.0}
vmd &gt; transabout {1 1 1} 1 pi
{-0.333335 0.666665 0.666669 0.0} {0.666668 -0.333334 0.666666
        0.0} {0.666666 0.66667 -0.333332 0.0} {0.0 0.0 0.0 1.0}
</PRE>

<P>
</LI>
<LI><B>trans [center {<I>x y z</I>}] 
  [origin {<I>x y z</I>}] [offset {<I>x y z</I>}]
  [axis x <I>amount</I> [rad<code>|</code>deg<code>|</code>pi]]
  [axis y <I>amount</I> [rad<code>|</code>deg<code>|</code>pi]]
  [axis z <I>amount</I> [rad<code>|</code>deg<code>|</code>pi]]
  [x <I>amount</I> [rad<code>|</code>deg<code>|</code>pi]]
  [y <I>amount</I> [rad<code>|</code>deg<code>|</code>pi]]
  [z <I>amount</I> [rad<code>|</code>deg<code>|</code>pi]]
  [axis {<I>x y z</I>}  <I>amount</I> [rad<code>|</code>deg<code>|</code>pi]]
  [bond {<I>x1 y1 z1</I>} {<I>x2 y2 z2</I>} <I>amount</I> 
      [rad<code>|</code>deg<code>|</code>pi]]
  [angle {<I>x1 y1 z1</I>} {<I>x2 y2 z2</I>} {<I>x3 y3 z3</I>} 
      <I>amount</I> [rad<code>|</code>deg<code>|</code>pi]]</B> -
<A NAME="15319"></A>

<P>
This command can do almost everything the other ones can do, and then
some.  It is designed to be the main function used for generating
transformation matrices.
</LI>
</UL>

<P>
Using it correctly calls for understanding how it works internally.
There are three matrices: centering, rotation, and offset.  The
centering matrix determines where the center of rotation is located.
By default, this is the origin, but it can be changed to pivot about
any point.  The rotation matrix defines the rotation about that
centering point, and the offset matrix defines the final translation
after the rotation.  

<P>
For example, to rotate around a given point, the transformations
would be 1) the centering matrix to bring that point to the origin, 2)
the rotation about the center, and 3) the final offset to return the
origin back to its original location.

<P>
The different options for the <TT>trans</TT> command modify the
matrices in various ways.

<P>
 
<B>-</B>
<UL>
<LI><B>center {<I>x y z</I>}</B> -
	Sets the centering matrix so that point x y z is brought to the origin
</LI>
<LI><B>offset {<I>x y z</I>}</B> -
	Sets the offset matrix so that the origin is brought to x y z
</LI>
<LI><B>origin {<I>x y z</I>}</B> -
	Sets both the centering and offset matrices to x y z

<P>
</LI>
<LI><B>axis x <I>amount</I> [rad<code>|</code>deg<code>|</code>pi]</B>
-
	Adds a rotation about the x axis by the given amount to the
rotation matrix

<P>
</LI>
<LI><B>axis y <I>amount</I> [rad<code>|</code>deg<code>|</code>pi]</B>
-
	Adds a rotation about the y axis by the given amount to the
rotation matrix

<P>
</LI>
<LI><B>axis z <I>amount</I> [rad<code>|</code>deg<code>|</code>pi]</B>
- 
	Adds a rotation about the z axis by the given amount to the
rotation matrix

<P>
</LI>
<LI><B>axis {<I>x y z</I>} <I>amount</I> [rad<code>|</code>deg<code>|</code>pi]</B> -
	Adds a rotation of the given amount about the given vector to
the rotation matrix

<P>
</LI>
<LI><B>bond {<I>x1 y1 z1</I>} {<I>x2 y2 z2</I>} <I>amount</I> 
      [rad<code>|</code>deg<code>|</code>pi]</B> -
	Sets the center and offset transformations to the first point,
and defines a rotation about the bond axis by the given amount.

<P>
</LI>
<LI><B>angle {<I>x1 y1 z1</I>} {<I>x2 y2 z2</I>} {<I>x3 y3 z3</I>} 
    <I>amount</I> [rad<code>|</code>deg<code>|</code>pi]</B> -
	Sets the center and offset transformation to the second point,
and defines a rotation about the axis perpendicular to the plane made
by the three points (the vector is computed from the cross product of
the vector connecting the first two points with that connected the
last two).
</LI>
</UL>
<P>
<HR>
<!--Navigation Panel-->
<A NAME="tex2html3774"
  HREF="node195.html">
<IMG WIDTH="37" HEIGHT="24" ALIGN="BOTTOM" BORDER="0" ALT="next" SRC="next.png"></A> 
<A NAME="tex2html3768"
  HREF="node192.html">
<IMG WIDTH="26" HEIGHT="24" ALIGN="BOTTOM" BORDER="0" ALT="up" SRC="up.png"></A> 
<A NAME="tex2html3762"
  HREF="node193.html">
<IMG WIDTH="63" HEIGHT="24" ALIGN="BOTTOM" BORDER="0" ALT="previous" SRC="prev.png"></A> 
<A NAME="tex2html3770"
  HREF="node1.html">
<IMG WIDTH="65" HEIGHT="24" ALIGN="BOTTOM" BORDER="0" ALT="contents" SRC="contents.png"></A> 
<A NAME="tex2html3772"
  HREF="node251.html">
<IMG WIDTH="43" HEIGHT="24" ALIGN="BOTTOM" BORDER="0" ALT="index" SRC="index.png"></A> 
<BR>
<B> Next:</B> <A NAME="tex2html3775"
  HREF="node195.html">Multiplying vectors and matrices</A>
<B> Up:</B> <A NAME="tex2html3769"
  HREF="node192.html">Vectors and Matrices</A>
<B> Previous:</B> <A NAME="tex2html3763"
  HREF="node193.html">Vectors</A>
 &nbsp; <B>  <A NAME="tex2html3771"
  HREF="node1.html">Contents</A></B> 
 &nbsp; <B>  <A NAME="tex2html3773"
  HREF="node251.html">Index</A></B> 
<!--End of Navigation Panel-->
<ADDRESS>
vmd@ks.uiuc.edu
</ADDRESS>
</BODY>
</HTML>
