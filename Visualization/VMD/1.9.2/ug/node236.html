<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">

<!--Converted with LaTeX2HTML 2002-2-1 (1.71)
original version by:  Nikos Drakos, CBLU, University of Leeds
* revised and updated by:  Marcus Hennecke, Ross Moore, Herb Swan
* with significant contributions from:
  Jens Lippmann, Marek Rouchal, Martin Wilck and others -->
<HTML>
<HEAD>
<TITLE>Adaptive Linear Bias/Experiment Directed Simulation</TITLE>
<META NAME="description" CONTENT="Adaptive Linear Bias/Experiment Directed Simulation">
<META NAME="keywords" CONTENT="ug">
<META NAME="resource-type" CONTENT="document">
<META NAME="distribution" CONTENT="global">

<META NAME="Generator" CONTENT="LaTeX2HTML v2002-2-1">
<META HTTP-EQUIV="Content-Style-Type" CONTENT="text/css">

<LINK REL="STYLESHEET" HREF="ug.css">

<LINK REL="next" HREF="node237.html">
<LINK REL="previous" HREF="node235.html">
<LINK REL="up" HREF="node231.html">
<LINK REL="next" HREF="node237.html">
</HEAD>

<BODY BGCOLOR="WHITE">
<!--Navigation Panel-->
<A NAME="tex2html4556"
  HREF="node237.html">
<IMG WIDTH="37" HEIGHT="24" ALIGN="BOTTOM" BORDER="0" ALT="next" SRC="next.png"></A> 
<A NAME="tex2html4550"
  HREF="node231.html">
<IMG WIDTH="26" HEIGHT="24" ALIGN="BOTTOM" BORDER="0" ALT="up" SRC="up.png"></A> 
<A NAME="tex2html4544"
  HREF="node235.html">
<IMG WIDTH="63" HEIGHT="24" ALIGN="BOTTOM" BORDER="0" ALT="previous" SRC="prev.png"></A> 
<A NAME="tex2html4552"
  HREF="node1.html">
<IMG WIDTH="65" HEIGHT="24" ALIGN="BOTTOM" BORDER="0" ALT="contents" SRC="contents.png"></A> 
<A NAME="tex2html4554"
  HREF="node251.html">
<IMG WIDTH="43" HEIGHT="24" ALIGN="BOTTOM" BORDER="0" ALT="index" SRC="index.png"></A> 
<BR>
<B> Next:</B> <A NAME="tex2html4557"
  HREF="node237.html">Multidimensional histograms</A>
<B> Up:</B> <A NAME="tex2html4551"
  HREF="node231.html">Biasing and analysis methods</A>
<B> Previous:</B> <A NAME="tex2html4545"
  HREF="node235.html">Linear restraints</A>
 &nbsp; <B>  <A NAME="tex2html4553"
  HREF="node1.html">Contents</A></B> 
 &nbsp; <B>  <A NAME="tex2html4555"
  HREF="node251.html">Index</A></B> 
<BR>
<BR>
<!--End of Navigation Panel-->

<H2><A NAME="SECTION001655000000000000000"></A>
<A NAME="sec:colvarbias_alb"></A>
<BR>
Adaptive Linear Bias/Experiment Directed Simulation
</H2>

<P>
Experiment directed simulation applies a linear bias with a changing
force constant. Please cite White and Voth [<A
 HREF="node250.html#White2014">53</A>] when
using this feature. As opposed to that reference, the force constant here is scaled
by the <TT>width</TT> corresponding to the biased colvar. In White and
Voth, each force constant is scaled by the colvars set center. The
bias converges to a linear bias, after which it will be the minimal
possible bias. You may also stop the simulation, take the median of
the force constants (ForceConst) found in the colvars trajectory file,
and then apply a linear bias with that constant. All the notes about
units described in sections <A HREF="node235.html#sec:colvarbias_linear">13.5.4</A>
and <A HREF="node234.html#sec:colvarbias_harmonic">13.5.3</A> apply here as well. <B>This is not
a valid simulation of any particular statistical ensemble and is only
an optimization algorithm until the bias has converged</B>.

<P>

<UL>
<LI><A NAME="23258"></A>
  <B><FONT SIZE="+1"><TT>centers </TT></FONT></B> <B><IMG
 WIDTH="14" HEIGHT="34" ALIGN="MIDDLE" BORDER="0"
 SRC="img132.png"
 ALT="$ \langle\,$"></B>
Collective variable centers<B><IMG
 WIDTH="14" HEIGHT="34" ALIGN="MIDDLE" BORDER="0"
 SRC="img133.png"
 ALT="$ \,\rangle$"></B>
 
<BR><B>Context: </B> <TT>alb</TT> 
<BR><B>Acceptable values: </B> space-separated list of colvar values 
<BR><B>Description: </B> The desired center (equilibrium values) which will be sought during the 
      adaptive linear biasing.
    The number of values must be the number of requested colvars.
    Each value is a decimal number if the corresponding colvar returns
    a scalar, a ``<TT>(x, y, z)</TT>'' triplet if it returns a unit
    vector or a vector, and a ``<TT>q0, q1, q2, q3)</TT>'' quadruplet
    if it returns a rotational quaternion.  If a colvar has
    periodicities or symmetries, its closest image to the restraint
    center is considered when calculating the linear potential.
</LI>
<LI><A NAME="23275"></A>
  <B><FONT SIZE="+1"><TT>updateFrequency </TT></FONT></B> <B><IMG
 WIDTH="14" HEIGHT="34" ALIGN="MIDDLE" BORDER="0"
 SRC="img132.png"
 ALT="$ \langle\,$"></B>
The duration of updates<B><IMG
 WIDTH="14" HEIGHT="34" ALIGN="MIDDLE" BORDER="0"
 SRC="img133.png"
 ALT="$ \,\rangle$"></B>
 
<BR><B>Context: </B> <TT>alb</TT> 
<BR><B>Acceptable values: </B> An integer 
<BR><B>Description: </B> This is, <B><IMG
 WIDTH="20" HEIGHT="15" ALIGN="BOTTOM" BORDER="0"
 SRC="img41.png"
 ALT="$ N$"></B>
, the number of simulation steps to use for each update to the bias.
      This determines how long the system requires to equilibrate 
      after a change in force constant (<B><IMG
 WIDTH="36" HEIGHT="34" ALIGN="MIDDLE" BORDER="0"
 SRC="img314.png"
 ALT="$ N/2$"></B>
), how long statistics 
      are collected for an iteration (<B><IMG
 WIDTH="36" HEIGHT="34" ALIGN="MIDDLE" BORDER="0"
 SRC="img314.png"
 ALT="$ N/2$"></B>
), and how quickly energy is 
      added to the system (at most, <B><IMG
 WIDTH="51" HEIGHT="34" ALIGN="MIDDLE" BORDER="0"
 SRC="img315.png"
 ALT="$ A/2N$"></B>
, where <B><IMG
 WIDTH="17" HEIGHT="15" ALIGN="BOTTOM" BORDER="0"
 SRC="img31.png"
 ALT="$ A$"></B>
 is the <TT>forceRange</TT>). Until the force 
      constant has converged, the method as described is an 
      optimization procedure and not an integration of a particular 
      statistical ensemble. It is important that each step should be 
      uncorrelated from the last so that iterations are independent. 
      Therefore, <B><IMG
 WIDTH="20" HEIGHT="15" ALIGN="BOTTOM" BORDER="0"
 SRC="img41.png"
 ALT="$ N$"></B>
 should be at least twice the autocorrelation time 
      of the collective variable. The system should also be able to 
      dissipate energy as fast as <B><IMG
 WIDTH="36" HEIGHT="34" ALIGN="MIDDLE" BORDER="0"
 SRC="img314.png"
 ALT="$ N/2$"></B>
, which can be done by adjusting 
      thermostat parameters. Practically, <B><IMG
 WIDTH="20" HEIGHT="15" ALIGN="BOTTOM" BORDER="0"
 SRC="img41.png"
 ALT="$ N$"></B>
 has been tested successfully at 
      significantly shorter than the autocorrelation time of the 
      collective variables being biased and still converge correctly.

<P>
</LI>
<LI><A NAME="23292"></A>
  <B><FONT SIZE="+1"><TT>forceRange </TT></FONT></B> <B><IMG
 WIDTH="14" HEIGHT="34" ALIGN="MIDDLE" BORDER="0"
 SRC="img132.png"
 ALT="$ \langle\,$"></B>
The expected range of the force constant in units of energy<B><IMG
 WIDTH="14" HEIGHT="34" ALIGN="MIDDLE" BORDER="0"
 SRC="img133.png"
 ALT="$ \,\rangle$"></B>
 
<BR><B>Context: </B> <TT>alb</TT> 
<BR><B>Acceptable values: </B> A space-separated list of decimal numbers 
<BR><B>Default value: </B> 3 <B><IMG
 WIDTH="33" HEIGHT="32" ALIGN="MIDDLE" BORDER="0"
 SRC="img316.png"
 ALT="$ k_b T$"></B>
 
<BR><B>Description: </B> This is largest magnitude of the force constant which one expects. If this parameter is
      too low, the simulation will not converge. If it is too high the
      simulation will waste time exploring values that are too
      large. A value of 3 <B><IMG
 WIDTH="33" HEIGHT="32" ALIGN="MIDDLE" BORDER="0"
 SRC="img316.png"
 ALT="$ k_b T$"></B>
 has worked well in the systems presented
      as a first choice. This parameter is dynamically adjusted over
      the course of a simulation. The benefit is that a bad guess for
      the forceRange can be corrected. However, this can lead to
      large amounts of energy being added over time to the system. To
      prevent this dynamic update, add <TT>hardForceRange yes</TT>
      as a parameter
</LI>
<LI><A NAME="23309"></A>
  <B><FONT SIZE="+1"><TT>rateMax </TT></FONT></B> <B><IMG
 WIDTH="14" HEIGHT="34" ALIGN="MIDDLE" BORDER="0"
 SRC="img132.png"
 ALT="$ \langle\,$"></B>
The maximum rate of change of force constant<B><IMG
 WIDTH="14" HEIGHT="34" ALIGN="MIDDLE" BORDER="0"
 SRC="img133.png"
 ALT="$ \,\rangle$"></B>
 
<BR><B>Context: </B> <TT>alb</TT> 
<BR><B>Acceptable values: </B> A list of space-separated real numbers 
<BR><B>Description: </B> This optional parameter controls
      how much energy is added to the system from this bias.  Tuning
      this separately from the <TT>updateFrequency</TT>
      and <TT>forceRange</TT> can allow for large bias changes but
      with a low <TT>rateMax</TT> prevents large energy changes that
      can lead to instability in the simulation.

<P>
</LI>
</UL>

<P>
<HR>
<!--Navigation Panel-->
<A NAME="tex2html4556"
  HREF="node237.html">
<IMG WIDTH="37" HEIGHT="24" ALIGN="BOTTOM" BORDER="0" ALT="next" SRC="next.png"></A> 
<A NAME="tex2html4550"
  HREF="node231.html">
<IMG WIDTH="26" HEIGHT="24" ALIGN="BOTTOM" BORDER="0" ALT="up" SRC="up.png"></A> 
<A NAME="tex2html4544"
  HREF="node235.html">
<IMG WIDTH="63" HEIGHT="24" ALIGN="BOTTOM" BORDER="0" ALT="previous" SRC="prev.png"></A> 
<A NAME="tex2html4552"
  HREF="node1.html">
<IMG WIDTH="65" HEIGHT="24" ALIGN="BOTTOM" BORDER="0" ALT="contents" SRC="contents.png"></A> 
<A NAME="tex2html4554"
  HREF="node251.html">
<IMG WIDTH="43" HEIGHT="24" ALIGN="BOTTOM" BORDER="0" ALT="index" SRC="index.png"></A> 
<BR>
<B> Next:</B> <A NAME="tex2html4557"
  HREF="node237.html">Multidimensional histograms</A>
<B> Up:</B> <A NAME="tex2html4551"
  HREF="node231.html">Biasing and analysis methods</A>
<B> Previous:</B> <A NAME="tex2html4545"
  HREF="node235.html">Linear restraints</A>
 &nbsp; <B>  <A NAME="tex2html4553"
  HREF="node1.html">Contents</A></B> 
 &nbsp; <B>  <A NAME="tex2html4555"
  HREF="node251.html">Index</A></B> 
<!--End of Navigation Panel-->
<ADDRESS>
vmd@ks.uiuc.edu
</ADDRESS>
</BODY>
</HTML>
