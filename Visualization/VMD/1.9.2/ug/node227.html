<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">

<!--Converted with LaTeX2HTML 2002-2-1 (1.71)
original version by:  Nikos Drakos, CBLU, University of Leeds
* revised and updated by:  Marcus Hennecke, Ross Moore, Herb Swan
* with significant contributions from:
  Jens Lippmann, Marek Rouchal, Martin Wilck and others -->
<HTML>
<HEAD>
<TITLE>List of available colvar components</TITLE>
<META NAME="description" CONTENT="List of available colvar components">
<META NAME="keywords" CONTENT="ug">
<META NAME="resource-type" CONTENT="document">
<META NAME="distribution" CONTENT="global">

<META NAME="Generator" CONTENT="LaTeX2HTML v2002-2-1">
<META HTTP-EQUIV="Content-Style-Type" CONTENT="text/css">

<LINK REL="STYLESHEET" HREF="ug.css">

<LINK REL="next" HREF="node228.html">
<LINK REL="previous" HREF="node226.html">
<LINK REL="up" HREF="node226.html">
<LINK REL="next" HREF="node228.html">
</HEAD>

<BODY BGCOLOR="WHITE">
<!--Navigation Panel-->
<A NAME="tex2html4376"
  HREF="node228.html">
<IMG WIDTH="37" HEIGHT="24" ALIGN="BOTTOM" BORDER="0" ALT="next" SRC="next.png"></A> 
<A NAME="tex2html4370"
  HREF="node226.html">
<IMG WIDTH="26" HEIGHT="24" ALIGN="BOTTOM" BORDER="0" ALT="up" SRC="up.png"></A> 
<A NAME="tex2html4364"
  HREF="node226.html">
<IMG WIDTH="63" HEIGHT="24" ALIGN="BOTTOM" BORDER="0" ALT="previous" SRC="prev.png"></A> 
<A NAME="tex2html4372"
  HREF="node1.html">
<IMG WIDTH="65" HEIGHT="24" ALIGN="BOTTOM" BORDER="0" ALT="contents" SRC="contents.png"></A> 
<A NAME="tex2html4374"
  HREF="node251.html">
<IMG WIDTH="43" HEIGHT="24" ALIGN="BOTTOM" BORDER="0" ALT="index" SRC="index.png"></A> 
<BR>
<B> Next:</B> <A NAME="tex2html4377"
  HREF="node228.html">Advanced usage and special</A>
<B> Up:</B> <A NAME="tex2html4371"
  HREF="node226.html">Collective variable components (basis</A>
<B> Previous:</B> <A NAME="tex2html4365"
  HREF="node226.html">Collective variable components (basis</A>
 &nbsp; <B>  <A NAME="tex2html4373"
  HREF="node1.html">Contents</A></B> 
 &nbsp; <B>  <A NAME="tex2html4375"
  HREF="node251.html">Index</A></B> 
<BR>
<BR>
<!--End of Navigation Panel-->
<!--Table of Child-Links-->
<A NAME="CHILD_LINKS"><STRONG>Subsections</STRONG></A>

<UL>
<LI><A NAME="tex2html4378"
  HREF="node227.html#SECTION001641100000000000000"><TT>distance</TT>: center-of-mass distance between two groups.</A>
<LI><A NAME="tex2html4379"
  HREF="node227.html#SECTION001641200000000000000"><TT>distanceZ</TT>: projection of a distance vector on an axis.</A>
<LI><A NAME="tex2html4380"
  HREF="node227.html#SECTION001641300000000000000"><TT>distanceXY</TT>: modulus of the projection of a distance vector on a plane.</A>
<LI><A NAME="tex2html4381"
  HREF="node227.html#SECTION001641400000000000000"><TT>distanceVec</TT>: distance vector  between two groups.</A>
<LI><A NAME="tex2html4382"
  HREF="node227.html#SECTION001641500000000000000"><TT>distanceDir</TT>: distance unit vector between two groups.</A>
<LI><A NAME="tex2html4383"
  HREF="node227.html#SECTION001641600000000000000"><TT>distanceInv</TT>: mean distance between two groups of atoms.</A>
<LI><A NAME="tex2html4384"
  HREF="node227.html#SECTION001641700000000000000"><TT>angle</TT>: angle between three groups.</A>
<LI><A NAME="tex2html4385"
  HREF="node227.html#SECTION001641800000000000000"><TT>dihedral</TT>: torsional angle between four groups.</A>
<LI><A NAME="tex2html4386"
  HREF="node227.html#SECTION001641900000000000000"><TT>coordNum</TT>: coordination number between two groups.</A>
<LI><A NAME="tex2html4387"
  HREF="node227.html#SECTION0016411000000000000000"><TT>selfCoordNum</TT>: coordination number between atoms within a group.</A>
<UL>
<LI><A NAME="tex2html4388"
  HREF="node227.html#SECTION0016411010000000000000"><TT>hBond</TT>: hydrogen bond between two
  atoms.</A>
</UL>
<BR>
<LI><A NAME="tex2html4389"
  HREF="node227.html#SECTION0016411100000000000000"><TT>rmsd</TT>: root mean square displacement  (RMSD) from reference positions.</A>
<LI><A NAME="tex2html4390"
  HREF="node227.html#SECTION0016411200000000000000">Advanced usage of the <TT>rmsd</TT> component.</A>
<LI><A NAME="tex2html4391"
  HREF="node227.html#SECTION0016411300000000000000"><TT>eigenvector</TT>: projection of the atomic  coordinates on a vector.</A>
<LI><A NAME="tex2html4392"
  HREF="node227.html#SECTION0016411400000000000000"><TT>gyration</TT>: radius of gyration of a group  of atoms.</A>
<LI><A NAME="tex2html4393"
  HREF="node227.html#SECTION0016411500000000000000"><TT>inertia</TT>: total moment of inertia of a group  of atoms.</A>
<LI><A NAME="tex2html4394"
  HREF="node227.html#SECTION0016411600000000000000"><TT>inertiaZ</TT>: total moment of inertia of a group of atoms around a chosen axis.</A>
<LI><A NAME="tex2html4395"
  HREF="node227.html#SECTION0016411700000000000000"><TT>orientation</TT>: orientation from reference  coordinates.</A>
<LI><A NAME="tex2html4396"
  HREF="node227.html#SECTION0016411800000000000000"><TT>orientationAngle</TT>: angle of rotation from reference coordinates.</A>
<LI><A NAME="tex2html4397"
  HREF="node227.html#SECTION0016411900000000000000"><TT>orientationProj</TT>: cosine of the angle of rotation from reference coordinates.</A>
<LI><A NAME="tex2html4398"
  HREF="node227.html#SECTION0016412000000000000000"><TT>spinAngle</TT>: angle of rotation around a given axis.</A>
<LI><A NAME="tex2html4399"
  HREF="node227.html#SECTION0016412100000000000000"><TT>tilt</TT>: cosine of the rotation orthogonal to a given axis.</A>
<LI><A NAME="tex2html4400"
  HREF="node227.html#SECTION0016412200000000000000"><TT>alpha</TT>: <IMG
 WIDTH="16" HEIGHT="15" ALIGN="BOTTOM" BORDER="0"
 SRC="img44.png"
 ALT="$ \alpha$">
-helix content of a  protein segment.</A>
<LI><A NAME="tex2html4401"
  HREF="node227.html#SECTION0016412300000000000000"><TT>dihedralPC</TT>: protein dihedral pricipal component</A>
</UL>
<!--End of Table of Child-Links-->
<HR>

<H2><A NAME="SECTION001641000000000000000">
List of available colvar components</A>
</H2>

<P>

<H3><A NAME="SECTION001641100000000000000">
<TT>distance</TT>: center-of-mass distance between two groups.</A>
</H3>
The <TT>distance {...}</TT> block defines a distance component,
between two atom groups, <TT>group1</TT> and <TT>group2</TT>.

<UL>
<LI><A NAME="20856"></A>
  <B><FONT SIZE="+1"><TT>group1 </TT></FONT></B> <IMG
 WIDTH="14" HEIGHT="34" ALIGN="MIDDLE" BORDER="0"
 SRC="img132.png"
 ALT="$ \langle\,$">
First group of atoms<IMG
 WIDTH="14" HEIGHT="34" ALIGN="MIDDLE" BORDER="0"
 SRC="img133.png"
 ALT="$ \,\rangle$">
 
<BR><B>Context: </B> <TT>distance</TT> 
<BR><B>Acceptable values: </B> Block <TT>group1 {...}</TT> 
<BR><B>Description: </B> First group of atoms.
</LI>
<LI><A NAME="20872"></A>
  <B><FONT SIZE="+1"><TT>group2 </TT></FONT></B> <IMG
 WIDTH="14" HEIGHT="34" ALIGN="MIDDLE" BORDER="0"
 SRC="img132.png"
 ALT="$ \langle\,$">
Second group of atoms<IMG
 WIDTH="14" HEIGHT="34" ALIGN="MIDDLE" BORDER="0"
 SRC="img133.png"
 ALT="$ \,\rangle$">
 
<BR><B>Context: </B> <TT>distance</TT> 
<BR><B>Acceptable values: </B> Block <TT>group2 {...}</TT> 
<BR><B>Description: </B> Second group of atoms.
</LI>
<LI><A NAME="20889"></A>
  <B><FONT SIZE="+1"><TT>forceNoPBC </TT></FONT></B> <IMG
 WIDTH="14" HEIGHT="34" ALIGN="MIDDLE" BORDER="0"
 SRC="img132.png"
 ALT="$ \langle\,$">
Calculate absolute rather than minimum-image distance?<IMG
 WIDTH="14" HEIGHT="34" ALIGN="MIDDLE" BORDER="0"
 SRC="img133.png"
 ALT="$ \,\rangle$">
 
<BR><B>Context: </B> <TT>distance</TT> 
<BR><B>Acceptable values: </B> boolean 
<BR><B>Default value: </B> <TT>no</TT> 
<BR><B>Description: </B> By default, in calculations with periodic boundary conditions, the
    <TT>distance</TT> component returns the distance according to the
    minimum-image convention. If this parameter is set to <TT>yes</TT>,
    PBC will be ignored and the distance between the coordinates as maintained
    internally will be used. This is only useful in a limited number of
    special cases, e.g. to describe the distance between remote points
    of a single macromolecule, which cannot be split across periodic cell
    boundaries, and for which the minimum-image distance might give the
    wrong result because of a relatively small periodic cell.
</LI>
<LI><A NAME="20909"></A>
  <B><FONT SIZE="+1"><TT>oneSiteSystemForce </TT></FONT></B> <IMG
 WIDTH="14" HEIGHT="34" ALIGN="MIDDLE" BORDER="0"
 SRC="img132.png"
 ALT="$ \langle\,$">
Measure system force on group 1 only?<IMG
 WIDTH="14" HEIGHT="34" ALIGN="MIDDLE" BORDER="0"
 SRC="img133.png"
 ALT="$ \,\rangle$">
 
<BR><B>Context: </B> <TT>distance</TT> 
<BR><B>Acceptable values: </B> boolean 
<BR><B>Default value: </B> <TT>no</TT> 
<BR><B>Description: </B> If this is set to <TT>yes</TT>, the system force is measured along
    a vector field (see equation&nbsp;(<A HREF="node232.html#eq:gradient_vector">13.19</A>) in
    section&nbsp;<A HREF="node232.html#sec:colvarbias_abf">13.5.1</A>) that only involves atoms of
    <TT>group1</TT>.  This option is only useful for ABF, or custom
    biases that compute system forces.  See
    section&nbsp;<A HREF="node232.html#sec:colvarbias_abf">13.5.1</A> for details.
</LI>
</UL>

<P>
The value returned is a positive number (in &#197;), ranging from 0

to the largest possible interatomic distance within the chosen
boundary conditions (with PBCs, the minimum image convention is used
unless the <TT>forceNoPBC</TT> option is set).

<P>

<H3><A NAME="SECTION001641200000000000000">
<TT>distanceZ</TT>: projection of a distance vector on an axis.</A>
</H3> 
The <TT>distanceZ&nbsp;{...}</TT> block defines a distance projection
component, which can be seen as measuring the distance between two
groups projected onto an axis, or the position of a group along such
an axis.  The axis can be defined using either one reference group and
a constant vector, or dynamically based on two reference groups.

<UL>
<LI><A NAME="20934"></A>
  <B><FONT SIZE="+1"><TT>main </TT></FONT></B> <IMG
 WIDTH="14" HEIGHT="34" ALIGN="MIDDLE" BORDER="0"
 SRC="img132.png"
 ALT="$ \langle\,$">
Main group of atoms<IMG
 WIDTH="14" HEIGHT="34" ALIGN="MIDDLE" BORDER="0"
 SRC="img133.png"
 ALT="$ \,\rangle$">
 
<BR><B>Context: </B> <TT>distanceZ, <TT>distanceXY</TT></TT> 
<BR><B>Acceptable values: </B> Block <TT>main {...}</TT> 
<BR><B>Description: </B> Group of atoms whose position <!-- MATH
 ${\mbox{\boldmath {$r$}}}$
 -->
<IMG
 WIDTH="14" HEIGHT="15" ALIGN="BOTTOM" BORDER="0"
 SRC="img156.png"
 ALT="$ {\mbox{\boldmath {$r$}}}$">
 is measured.
</LI>
<LI><A NAME="20957"></A>
  <B><FONT SIZE="+1"><TT>ref </TT></FONT></B> <IMG
 WIDTH="14" HEIGHT="34" ALIGN="MIDDLE" BORDER="0"
 SRC="img132.png"
 ALT="$ \langle\,$">
Reference group of
    atoms<IMG
 WIDTH="14" HEIGHT="34" ALIGN="MIDDLE" BORDER="0"
 SRC="img133.png"
 ALT="$ \,\rangle$">
 
<BR><B>Context: </B> <TT>distanceZ, <TT>distanceXY</TT></TT> 
<BR><B>Acceptable values: </B> Block <TT>ref {...}</TT> 
<BR><B>Description: </B> Reference group of atoms.  The position of its center of mass is
    noted <!-- MATH
 ${\mbox{\boldmath {$r$}}}_1$
 -->
<IMG
 WIDTH="22" HEIGHT="30" ALIGN="MIDDLE" BORDER="0"
 SRC="img157.png"
 ALT="$ {\mbox{\boldmath {$r$}}}_1$">
 below.
</LI>
<LI><A NAME="20981"></A>
  <B><FONT SIZE="+1"><TT>ref2 </TT></FONT></B> <IMG
 WIDTH="14" HEIGHT="34" ALIGN="MIDDLE" BORDER="0"
 SRC="img132.png"
 ALT="$ \langle\,$">
Secondary reference
    group<IMG
 WIDTH="14" HEIGHT="34" ALIGN="MIDDLE" BORDER="0"
 SRC="img133.png"
 ALT="$ \,\rangle$">
 
<BR><B>Context: </B> <TT>distanceZ, <TT>distanceXY</TT></TT> 
<BR><B>Acceptable values: </B> Block <TT>ref2 {...}</TT> 
<BR><B>Default value: </B> none 
<BR><B>Description: </B> Optional group of reference atoms, whose position <!-- MATH
 ${\mbox{\boldmath {$r$}}}_2$
 -->
<IMG
 WIDTH="22" HEIGHT="30" ALIGN="MIDDLE" BORDER="0"
 SRC="img158.png"
 ALT="$ {\mbox{\boldmath {$r$}}}_2$">
 can
    be used to define a dynamic projection axis: <!-- MATH
 ${\mbox{\boldmath {$e$}}}=(\| {\mbox{\boldmath {$r$}}}_2
- {\mbox{\boldmath {$r$}}}_1\|)^{-1} \times ({\mbox{\boldmath {$r$}}}_2 - {\mbox{\boldmath {$r$}}}_1)$
 -->
<IMG
 WIDTH="233" HEIGHT="37" ALIGN="MIDDLE" BORDER="0"
 SRC="img159.png"
 ALT="$ {\mbox{\boldmath {$e$}}}=(\Vert {\mbox{\boldmath {$r$}}}_2
- {\mbox{\boldmath ...
...}_1\Vert)^{-1} \times ({\mbox{\boldmath {$r$}}}_2 - {\mbox{\boldmath {$r$}}}_1)$">
.  In this case,
    the origin is <!-- MATH
 ${\mbox{\boldmath {$r$}}}_m = 1/2 ({\mbox{\boldmath {$r$}}}_1+{\mbox{\boldmath {$r$}}}_2)$
 -->
<IMG
 WIDTH="146" HEIGHT="34" ALIGN="MIDDLE" BORDER="0"
 SRC="img160.png"
 ALT="$ {\mbox{\boldmath {$r$}}}_m = 1/2 ({\mbox{\boldmath {$r$}}}_1+{\mbox{\boldmath {$r$}}}_2)$">
, and the value
    of the component is <!-- MATH
 ${\mbox{\boldmath {$e$}}} \cdot ({\mbox{\boldmath {$r$}}}-{\mbox{\boldmath {$r$}}}_m)$
 -->
<IMG
 WIDTH="94" HEIGHT="34" ALIGN="MIDDLE" BORDER="0"
 SRC="img161.png"
 ALT="$ {\mbox{\boldmath {$e$}}} \cdot ({\mbox{\boldmath {$r$}}}-{\mbox{\boldmath {$r$}}}_m)$">
.
</LI>
<LI><A NAME="21051"></A>
  <B><FONT SIZE="+1"><TT>axis </TT></FONT></B> <IMG
 WIDTH="14" HEIGHT="34" ALIGN="MIDDLE" BORDER="0"
 SRC="img132.png"
 ALT="$ \langle\,$">
Projection axis (&#197;)<IMG
 WIDTH="14" HEIGHT="34" ALIGN="MIDDLE" BORDER="0"
 SRC="img133.png"
 ALT="$ \,\rangle$">
 
<BR><B>Context: </B> <TT>distanceZ</TT>, <TT>distanceXY</TT> 
<BR><B>Acceptable values: </B> <TT>(x, y, z)</TT> triplet 
<BR><B>Default value: </B> <TT>(0.0, 0.0, 1.0)</TT> 
<BR><B>Description: </B> The three components of this vector define (when normalized) a
    projection axis <!-- MATH
 ${\mbox{\boldmath {$e$}}}$
 -->
<IMG
 WIDTH="14" HEIGHT="15" ALIGN="BOTTOM" BORDER="0"
 SRC="img162.png"
 ALT="$ {\mbox{\boldmath {$e$}}}$">
 for the distance vector <!-- MATH
 ${\mbox{\boldmath {$r$}}} -
{\mbox{\boldmath {$r$}}}_1$
 -->
<IMG
 WIDTH="53" HEIGHT="30" ALIGN="MIDDLE" BORDER="0"
 SRC="img163.png"
 ALT="$ {\mbox{\boldmath {$r$}}} -
{\mbox{\boldmath {$r$}}}_1$">
 joining the centers of groups <TT>ref</TT> and
    <TT>main</TT>. The value of the component is then <!-- MATH
 ${\mbox{\boldmath {$e$}}} \cdot
({\mbox{\boldmath {$r$}}}-{\mbox{\boldmath {$r$}}}_1)$
 -->
<IMG
 WIDTH="89" HEIGHT="34" ALIGN="MIDDLE" BORDER="0"
 SRC="img164.png"
 ALT="$ {\mbox{\boldmath {$e$}}} \cdot
({\mbox{\boldmath {$r$}}}-{\mbox{\boldmath {$r$}}}_1)$">
.  The vector should be written as three
    components separated by commas and enclosed in parentheses.
</LI>
<LI><A NAME="21099"></A>
  <B><FONT SIZE="+1"><TT>forceNoPBC </TT></FONT></B> <IMG
 WIDTH="14" HEIGHT="34" ALIGN="MIDDLE" BORDER="0"
 SRC="img132.png"
 ALT="$ \langle\,$">
Calculate absolute rather than minimum-image distance?<IMG
 WIDTH="14" HEIGHT="34" ALIGN="MIDDLE" BORDER="0"
 SRC="img133.png"
 ALT="$ \,\rangle$">
 
<BR><B>Context: </B> <TT>distanceZ, distanceXY</TT> 
<BR><B>Acceptable values: </B> boolean 
<BR><B>Default value: </B> <TT>no</TT> 
<BR><B>Description: </B> This parameter has the same meaning as that described above for the <TT>distance</TT>
    component.
</LI>
<LI><A NAME="21118"></A>
  <B><FONT SIZE="+1"><TT>oneSiteSystemForce </TT></FONT></B> <IMG
 WIDTH="14" HEIGHT="34" ALIGN="MIDDLE" BORDER="0"
 SRC="img132.png"
 ALT="$ \langle\,$">
Measure system force on group <TT>main</TT> only?<IMG
 WIDTH="14" HEIGHT="34" ALIGN="MIDDLE" BORDER="0"
 SRC="img133.png"
 ALT="$ \,\rangle$">
 
<BR><B>Context: </B> <TT>distanceZ, distanceXY</TT> 
<BR><B>Acceptable values: </B> boolean 
<BR><B>Default value: </B> <TT>no</TT> 
<BR><B>Description: </B> If this is set to <TT>yes</TT>, the system force is measured along a
    vector field (see equation&nbsp;(<A HREF="node232.html#eq:gradient_vector">13.19</A>) in
    section&nbsp;<A HREF="node232.html#sec:colvarbias_abf">13.5.1</A>) that only involves atoms of <TT>main</TT>.
    This option is only useful for ABF, or custom biases that compute
    system forces.  See section&nbsp;<A HREF="node232.html#sec:colvarbias_abf">13.5.1</A> for details.
</LI>
</UL>
This component returns a number (in &#197;) whose range is determined
by the chosen boundary conditions.  For instance, if the <IMG
 WIDTH="13" HEIGHT="15" ALIGN="BOTTOM" BORDER="0"
 SRC="img28.png"
 ALT="$ z$">
 axis is
used in a simulation with periodic boundaries, the returned value ranges
between <IMG
 WIDTH="50" HEIGHT="34" ALIGN="MIDDLE" BORDER="0"
 SRC="img165.png"
 ALT="$ -b_{z}/2$">
 and <IMG
 WIDTH="37" HEIGHT="34" ALIGN="MIDDLE" BORDER="0"
 SRC="img166.png"
 ALT="$ b_{z}/2$">
, where <IMG
 WIDTH="20" HEIGHT="32" ALIGN="MIDDLE" BORDER="0"
 SRC="img167.png"
 ALT="$ b_{z}$">
 is the box length
along <IMG
 WIDTH="13" HEIGHT="15" ALIGN="BOTTOM" BORDER="0"
 SRC="img28.png"
 ALT="$ z$">
 (this behavior is disabled if <TT>forceNoPBC</TT> is set).

<P>

<H3><A NAME="SECTION001641300000000000000">
<TT>distanceXY</TT>: modulus of the projection of a distance vector on a plane.</A>
</H3>
The <TT>distanceXY&nbsp;{...}</TT> block defines a distance projected on
a plane, and accepts the same keywords as the component <TT>distanceZ</TT>, i.e.
<TT>main</TT>, <TT>ref</TT>, either <TT>ref2</TT> or <TT>axis</TT>,
and <TT>oneSiteSystemForce</TT>.  It returns the norm of the
projection of the distance vector between <TT>main</TT> and
<TT>ref</TT> onto the plane orthogonal to the axis.  The axis is
defined using the <TT>axis</TT> parameter or as the vector joining
<TT>ref</TT> and <TT>ref2</TT> (see <TT>distanceZ</TT> above).

<P>

<H3><A NAME="SECTION001641400000000000000">
<TT>distanceVec</TT>: distance vector  between two groups.</A>
</H3>
The <TT>distanceVec&nbsp;{...}</TT> block defines
a distance vector component, which accepts the same keywords as
the component <TT>distance</TT>: <TT>group1</TT>, <TT>group2</TT>, and
<TT>forceNoPBC</TT>. Its value is the 3-vector joining the centers
of mass of <TT>group1</TT> and <TT>group2</TT>.

<P>

<H3><A NAME="SECTION001641500000000000000">
<TT>distanceDir</TT>: distance unit vector between two groups.</A>
</H3>
The <TT>distanceDir&nbsp;{...}</TT> block defines
a distance unit vector component, which accepts the same keywords as
the component <TT>distance</TT>: <TT>group1</TT>, <TT>group2</TT>, and
<TT>forceNoPBC</TT>.  It returns a
3-dimensional unit vector <!-- MATH
 $\mathbf{d} = (d_{x}, d_{y}, d_{z})$
 -->
<IMG
 WIDTH="119" HEIGHT="34" ALIGN="MIDDLE" BORDER="0"
 SRC="img168.png"
 ALT="$ \mathbf{d} = (d_{x}, d_{y}, d_{z})$">
, with
<!-- MATH
 $|\mathbf{d}| = 1$
 -->
<IMG
 WIDTH="57" HEIGHT="34" ALIGN="MIDDLE" BORDER="0"
 SRC="img169.png"
 ALT="$ \vert\mathbf{d}\vert = 1$">
.

<P>

<H3><A NAME="SECTION001641600000000000000">
<TT>distanceInv</TT>: mean distance between two groups of atoms.</A>
</H3>
The <TT>distanceInv&nbsp;{...}</TT> block defines a generalized mean distance between two groups of atoms 1 and 2, weighted with exponent <IMG
 WIDTH="32" HEIGHT="34" ALIGN="MIDDLE" BORDER="0"
 SRC="img170.png"
 ALT="$ 1/n$">
:
<P></P>
<DIV ALIGN="CENTER"><A NAME="eq:distanceInv"></A><!-- MATH
 \begin{equation}
d_{\mathrm{1,2}}^{[n]} \; = \;   \left(\frac{1}{N_{\mathrm{1}}N_{\mathrm{2}}}\sum_{i,j} \left(\frac{1}{\Vert\mathbf{d}^{ij}\Vert}\right)^{n} \right)^{-1/n}
\end{equation}
 -->
<TABLE CELLPADDING="0" WIDTH="100%" ALIGN="CENTER">
<TR VALIGN="MIDDLE">
<TD NOWRAP ALIGN="CENTER"><IMG
 WIDTH="285" HEIGHT="88" ALIGN="MIDDLE" BORDER="0"
 SRC="img171.png"
 ALT="$\displaystyle d_{\mathrm{1,2}}^{[n]} \; = \; \left(\frac{1}{N_{\mathrm{1}}N_{\m...
...}\sum_{i,j} \left(\frac{1}{\Vert\mathbf{d}^{ij}\Vert}\right)^{n} \right)^{-1/n}$"></TD>
<TD NOWRAP WIDTH="10" ALIGN="RIGHT">
(13.2)</TD></TR>
</TABLE></DIV>
<BR CLEAR="ALL"><P></P>
where <!-- MATH
 $\Vert\mathbf{d}^{ij}\Vert$
 -->
<IMG
 WIDTH="45" HEIGHT="37" ALIGN="MIDDLE" BORDER="0"
 SRC="img172.png"
 ALT="$ \Vert\mathbf{d}^{ij}\Vert$">
 is the distance between atoms <IMG
 WIDTH="10" HEIGHT="16" ALIGN="BOTTOM" BORDER="0"
 SRC="img42.png"
 ALT="$ i$">
 and <IMG
 WIDTH="13" HEIGHT="31" ALIGN="MIDDLE" BORDER="0"
 SRC="img46.png"
 ALT="$ j$">
 in groups 1 and 2 respectively, and <IMG
 WIDTH="15" HEIGHT="15" ALIGN="BOTTOM" BORDER="0"
 SRC="img35.png"
 ALT="$ n$">
 is an even integer.
This component accepts the same keywords as the component <TT>distance</TT>: <TT>group1</TT>, <TT>group2</TT>, and <TT>forceNoPBC</TT>.  In addition, the following option may be provided:

<UL>
<LI><A NAME="21150"></A>
  <B><FONT SIZE="+1"><TT>exponent </TT></FONT></B> <IMG
 WIDTH="14" HEIGHT="34" ALIGN="MIDDLE" BORDER="0"
 SRC="img132.png"
 ALT="$ \langle\,$">
Exponent <IMG
 WIDTH="15" HEIGHT="15" ALIGN="BOTTOM" BORDER="0"
 SRC="img35.png"
 ALT="$ n$">
 in equation&nbsp;<A HREF="#eq:distanceInv">13.2</A><IMG
 WIDTH="14" HEIGHT="34" ALIGN="MIDDLE" BORDER="0"
 SRC="img133.png"
 ALT="$ \,\rangle$">
 
<BR><B>Context: </B> <TT>distanceInv</TT> 
<BR><B>Acceptable values: </B> positive even integer 
<BR><B>Default value: </B> 6 
<BR><B>Description: </B> Defines the exponent to which the individual distances are elevated before averaging.  The default value of 6 is useful for example to applying restraints based on NOE-measured distances.
</LI>
</UL>
This component returns a number in &#197;, ranging from 0
 to the largest possible distance within the chosen boundary conditions.

<P>

<H3><A NAME="SECTION001641700000000000000">
<TT>angle</TT>: angle between three groups.</A>
</H3>
The <TT>angle&nbsp;{...}</TT> block defines an angle, and contains the
three blocks <TT>group1</TT>, <TT>group2</TT> and <TT>group3</TT>, defining
the three groups.  It returns an angle (in degrees) within the
interval <IMG
 WIDTH="63" HEIGHT="34" ALIGN="MIDDLE" BORDER="0"
 SRC="img173.png"
 ALT="$ [0:180]$">
.

<P>

<H3><A NAME="SECTION001641800000000000000">
<TT>dihedral</TT>: torsional angle between four groups.</A>
</H3>
The <TT>dihedral&nbsp;{...}</TT> block defines a torsional angle, and
contains the blocks <TT>group1</TT>, <TT>group2</TT>, <TT>group3</TT>
and <TT>group4</TT>, defining the four groups.  It returns an angle
(in degrees) within the interval <!-- MATH
 $[-180:180]$
 -->
<IMG
 WIDTH="94" HEIGHT="34" ALIGN="MIDDLE" BORDER="0"
 SRC="img174.png"
 ALT="$ [-180:180]$">
.  The colvar module
calculates all the distances between two angles taking into account
periodicity.  For instance, reference values for restraints or range
boundaries can be defined by using any real number of choice.

<UL>
<LI><A NAME="21173"></A>
  <B><FONT SIZE="+1"><TT>oneSiteSystemForce </TT></FONT></B> <IMG
 WIDTH="14" HEIGHT="34" ALIGN="MIDDLE" BORDER="0"
 SRC="img132.png"
 ALT="$ \langle\,$">
Measure system force on group 1 only?<IMG
 WIDTH="14" HEIGHT="34" ALIGN="MIDDLE" BORDER="0"
 SRC="img133.png"
 ALT="$ \,\rangle$">
 
<BR><B>Context: </B> <TT>angle</TT>, <TT>dihedral</TT> 
<BR><B>Acceptable values: </B> boolean 
<BR><B>Default value: </B> <TT>no</TT> 
<BR><B>Description: </B> If this is set to <TT>yes</TT>, the system force is measured along
    a vector field (see equation&nbsp;(<A HREF="node232.html#eq:gradient_vector">13.19</A>) in
    section&nbsp;<A HREF="node232.html#sec:colvarbias_abf">13.5.1</A>) that only involves atoms of
    <TT>group1</TT>.  See section&nbsp;<A HREF="node232.html#sec:colvarbias_abf">13.5.1</A> for an
    example.
</LI>
</UL>

<P>

<H3><A NAME="SECTION001641900000000000000">
<TT>coordNum</TT>: coordination number between two groups.</A>
</H3>
The <TT>coordNum {...}</TT> block defines
a coordination number (or number of contacts), which calculates the
function <!-- MATH
 $(1-(d/d_0)^{n})/(1-(d/d_0)^{m})$
 -->
<IMG
 WIDTH="218" HEIGHT="34" ALIGN="MIDDLE" BORDER="0"
 SRC="img175.png"
 ALT="$ (1-(d/d_0)^{n})/(1-(d/d_0)^{m})$">
, where <IMG
 WIDTH="21" HEIGHT="32" ALIGN="MIDDLE" BORDER="0"
 SRC="img176.png"
 ALT="$ d_0$">
 is the
``cutoff'' distance, and <IMG
 WIDTH="15" HEIGHT="15" ALIGN="BOTTOM" BORDER="0"
 SRC="img35.png"
 ALT="$ n$">
 and <IMG
 WIDTH="20" HEIGHT="15" ALIGN="BOTTOM" BORDER="0"
 SRC="img177.png"
 ALT="$ m$">
 are exponents that can control
its long range behavior and stiffness [<A
 HREF="node250.html#Iannuzzi2003">33</A>].  This
function is summed over all pairs of atoms in <TT>group1</TT> and
<TT>group2</TT>:
<P></P>
<DIV ALIGN="CENTER"><A NAME="eq:cvc_coordNum"></A><!-- MATH
 \begin{equation}
C (\mathtt{group1}, \mathtt{group2}) \; = \;
  \sum_{i\in\mathtt{group1}}\sum_{j\in\mathtt{group2}} {
    \frac{1 - (|\mathbf{x}_{i}-\mathbf{x}_{j}|/d_{0})^{n}}{
      1 - (|\mathbf{x}_{i}-\mathbf{x}_{j}|/d_{0})^{m} }
  }
\end{equation}
 -->
<TABLE CELLPADDING="0" WIDTH="100%" ALIGN="CENTER">
<TR VALIGN="MIDDLE">
<TD NOWRAP ALIGN="CENTER"><IMG
 WIDTH="448" HEIGHT="59" ALIGN="MIDDLE" BORDER="0"
 SRC="img178.png"
 ALT="$\displaystyle C (\mathtt{group1}, \mathtt{group2}) \; = \; \sum_{i\in\mathtt{gr...
...}\vert/d_{0})^{n}}{ 1 - (\vert\mathbf{x}_{i}-\mathbf{x}_{j}\vert/d_{0})^{m} } }$"></TD>
<TD NOWRAP WIDTH="10" ALIGN="RIGHT">
(13.3)</TD></TR>
</TABLE></DIV>
<BR CLEAR="ALL"><P></P>
This colvar component accepts the same keywords as the component <TT>distance</TT>,
<TT>group1</TT> and <TT>group2</TT>.  In addition to them, it
recognizes the following keywords:

<P>

<UL>
<LI><A NAME="21200"></A>
  <B><FONT SIZE="+1"><TT>cutoff </TT></FONT></B> <IMG
 WIDTH="14" HEIGHT="34" ALIGN="MIDDLE" BORDER="0"
 SRC="img132.png"
 ALT="$ \langle\,$">
``Interaction'' distance (&#197;)<IMG
 WIDTH="14" HEIGHT="34" ALIGN="MIDDLE" BORDER="0"
 SRC="img133.png"
 ALT="$ \,\rangle$">
 
<BR><B>Context: </B> <TT>coordNum</TT> 
<BR><B>Acceptable values: </B> positive decimal 
<BR><B>Default value: </B> 4.0 
<BR><B>Description: </B> This number defines the switching distance to define an
    interatomic contact: for <IMG
 WIDTH="57" HEIGHT="32" ALIGN="MIDDLE" BORDER="0"
 SRC="img179.png"
 ALT="$ d \ll d_0$">
, the switching function
    <!-- MATH
 $(1-(d/d_0)^{n})/(1-(d/d_0)^{m})$
 -->
<IMG
 WIDTH="218" HEIGHT="34" ALIGN="MIDDLE" BORDER="0"
 SRC="img175.png"
 ALT="$ (1-(d/d_0)^{n})/(1-(d/d_0)^{m})$">
 is close to 1, at <IMG
 WIDTH="53" HEIGHT="32" ALIGN="MIDDLE" BORDER="0"
 SRC="img180.png"
 ALT="$ d = d_0$">
 it
    has a value of <IMG
 WIDTH="39" HEIGHT="34" ALIGN="MIDDLE" BORDER="0"
 SRC="img181.png"
 ALT="$ n/m$">
 (<IMG
 WIDTH="31" HEIGHT="34" ALIGN="MIDDLE" BORDER="0"
 SRC="img182.png"
 ALT="$ 1/2$">
 with the default <IMG
 WIDTH="15" HEIGHT="15" ALIGN="BOTTOM" BORDER="0"
 SRC="img35.png"
 ALT="$ n$">
 and <IMG
 WIDTH="20" HEIGHT="15" ALIGN="BOTTOM" BORDER="0"
 SRC="img177.png"
 ALT="$ m$">
), and at
    <IMG
 WIDTH="57" HEIGHT="32" ALIGN="MIDDLE" BORDER="0"
 SRC="img183.png"
 ALT="$ d \gg d_0$">
 it goes to zero approximately like <IMG
 WIDTH="45" HEIGHT="17" ALIGN="BOTTOM" BORDER="0"
 SRC="img184.png"
 ALT="$ d^{m-n}$">
.  Hence,
    for a proper behavior, <IMG
 WIDTH="20" HEIGHT="15" ALIGN="BOTTOM" BORDER="0"
 SRC="img177.png"
 ALT="$ m$">
 must be larger than <IMG
 WIDTH="15" HEIGHT="15" ALIGN="BOTTOM" BORDER="0"
 SRC="img35.png"
 ALT="$ n$">
.

<P>
</LI>
<LI><A NAME="21220"></A>
  <B><FONT SIZE="+1"><TT>cutoff3 </TT></FONT></B> <IMG
 WIDTH="14" HEIGHT="34" ALIGN="MIDDLE" BORDER="0"
 SRC="img132.png"
 ALT="$ \langle\,$">
Reference distance vector (&#197;)<IMG
 WIDTH="14" HEIGHT="34" ALIGN="MIDDLE" BORDER="0"
 SRC="img133.png"
 ALT="$ \,\rangle$">
 
<BR><B>Context: </B> <TT>coordNum</TT> 
<BR><B>Acceptable values: </B> ``<TT>(x, y, z)</TT>'' triplet of positive decimals 
<BR><B>Default value: </B> <TT>(4.0, 4.0, 4.0)</TT> 
<BR><B>Description: </B> The three components of this vector define three different cutoffs
    <IMG
 WIDTH="21" HEIGHT="32" ALIGN="MIDDLE" BORDER="0"
 SRC="img185.png"
 ALT="$ d_{0}$">
 for each direction.  This option is mutually exclusive with
    <TT>cutoff</TT>.

<P>
</LI>
<LI><A NAME="21241"></A>
  <B><FONT SIZE="+1"><TT>expNumer </TT></FONT></B> <IMG
 WIDTH="14" HEIGHT="34" ALIGN="MIDDLE" BORDER="0"
 SRC="img132.png"
 ALT="$ \langle\,$">
Numerator exponent<IMG
 WIDTH="14" HEIGHT="34" ALIGN="MIDDLE" BORDER="0"
 SRC="img133.png"
 ALT="$ \,\rangle$">
 
<BR><B>Context: </B> <TT>coordNum</TT> 
<BR><B>Acceptable values: </B> positive even integer 
<BR><B>Default value: </B> 6 
<BR><B>Description: </B> This number defines the <IMG
 WIDTH="15" HEIGHT="15" ALIGN="BOTTOM" BORDER="0"
 SRC="img35.png"
 ALT="$ n$">
 exponent for the switching function.

<P>
</LI>
<LI><A NAME="21258"></A>
  <B><FONT SIZE="+1"><TT>expDenom </TT></FONT></B> <IMG
 WIDTH="14" HEIGHT="34" ALIGN="MIDDLE" BORDER="0"
 SRC="img132.png"
 ALT="$ \langle\,$">
Denominator exponent<IMG
 WIDTH="14" HEIGHT="34" ALIGN="MIDDLE" BORDER="0"
 SRC="img133.png"
 ALT="$ \,\rangle$">
 
<BR><B>Context: </B> <TT>coordNum</TT> 
<BR><B>Acceptable values: </B> positive even integer 
<BR><B>Default value: </B> 12 
<BR><B>Description: </B> This number defines the <IMG
 WIDTH="20" HEIGHT="15" ALIGN="BOTTOM" BORDER="0"
 SRC="img177.png"
 ALT="$ m$">
 exponent for the switching function.

<P>
</LI>
<LI><A NAME="21275"></A>
  <B><FONT SIZE="+1"><TT>group2CenterOnly </TT></FONT></B> <IMG
 WIDTH="14" HEIGHT="34" ALIGN="MIDDLE" BORDER="0"
 SRC="img132.png"
 ALT="$ \langle\,$">
Use only <TT>group2</TT>'s center of
    mass<IMG
 WIDTH="14" HEIGHT="34" ALIGN="MIDDLE" BORDER="0"
 SRC="img133.png"
 ALT="$ \,\rangle$">
 
<BR><B>Context: </B> <TT>coordNum</TT> 
<BR><B>Acceptable values: </B> boolean 
<BR><B>Default value: </B> <TT>off</TT> 
<BR><B>Description: </B> If this option is <TT>on</TT>, only contacts between each atoms in <TT>group1</TT> and the center of mass of     <TT>group2</TT> are calculated (by default, the sum extends over all pairs of atoms in <TT>group1</TT> and <TT>group2</TT>).
If <TT>group2</TT> is a <TT>dummyAtom</TT>, this option is set to <TT>yes</TT> by default.

<P>
</LI>
</UL>

<P>
This component returns a dimensionless number, which ranges from
approximately 0 (all interatomic distances are much larger than the
cutoff) to <!-- MATH
 $N_{\mathtt{group1}} \times N_{\mathtt{group2}}$
 -->
<IMG
 WIDTH="136" HEIGHT="31" ALIGN="MIDDLE" BORDER="0"
 SRC="img186.png"
 ALT="$ N_{\mathtt{group1}} \times N_{\mathtt{group2}}$">
 (all distances
are less than the cutoff), or <!-- MATH
 $N_{\mathtt{group1}}$
 -->
<IMG
 WIDTH="60" HEIGHT="31" ALIGN="MIDDLE" BORDER="0"
 SRC="img187.png"
 ALT="$ N_{\mathtt{group1}}$">
 if
<TT>group2CenterOnly</TT> is used.  For performance reasons, at least
one of <TT>group1</TT> and <TT>group2</TT> should be of limited size or <TT>group2CenterOnly</TT> should be used: the cost of the loop over all pairs grows as <!-- MATH
 $N_{\mathtt{group1}} \times N_{\mathtt{group2}}$
 -->
<IMG
 WIDTH="136" HEIGHT="31" ALIGN="MIDDLE" BORDER="0"
 SRC="img186.png"
 ALT="$ N_{\mathtt{group1}} \times N_{\mathtt{group2}}$">
.

<P>

<H3><A NAME="SECTION0016411000000000000000">
<TT>selfCoordNum</TT>: coordination number between atoms within a group.</A>
</H3>
The <TT>selfCoordNum {...}</TT> block defines
a coordination number similarly to the component <TT>coordNum</TT>,
but the function is summed over atom pairs within <TT>group1</TT>:
<P></P>
<DIV ALIGN="CENTER"><A NAME="eq:cvc_selfCoordNum"></A><!-- MATH
 \begin{equation}
C (\mathtt{group1}) \; = \;
  \sum_{i\in\mathtt{group1}}\sum_{j > i} {
    \frac{1 - (|\mathbf{x}_{i}-\mathbf{x}_{j}|/d_{0})^{n}}{
      1 - (|\mathbf{x}_{i}-\mathbf{x}_{j}|/d_{0})^{m} }
  }
\end{equation}
 -->
<TABLE CELLPADDING="0" WIDTH="100%" ALIGN="CENTER">
<TR VALIGN="MIDDLE">
<TD NOWRAP ALIGN="CENTER"><IMG
 WIDTH="355" HEIGHT="59" ALIGN="MIDDLE" BORDER="0"
 SRC="img188.png"
 ALT="$\displaystyle C (\mathtt{group1}) \; = \; \sum_{i\in\mathtt{group1}}\sum_{j &gt; i...
...}\vert/d_{0})^{n}}{ 1 - (\vert\mathbf{x}_{i}-\mathbf{x}_{j}\vert/d_{0})^{m} } }$"></TD>
<TD NOWRAP WIDTH="10" ALIGN="RIGHT">
(13.4)</TD></TR>
</TABLE></DIV>
<BR CLEAR="ALL"><P></P>
The keywords accepted by <TT>selfCoordNum</TT> are a subset of
those accepted by <TT>coordNum</TT>, namely <TT>group1</TT>
(here defining <I>all</I> of the atoms to be considered),
<TT>cutoff</TT>, <TT>expNumer</TT>, and <TT>expDenom</TT>.

<P>
This component returns a dimensionless number, which ranges from
approximately 0 (all interatomic distances much larger than the
cutoff) to <!-- MATH
 $N_{\mathtt{group1}} \times (N_{\mathtt{group1}} - 1) / 2$
 -->
<IMG
 WIDTH="197" HEIGHT="34" ALIGN="MIDDLE" BORDER="0"
 SRC="img189.png"
 ALT="$ N_{\mathtt{group1}} \times (N_{\mathtt{group1}} - 1) / 2$">
 (all
distances within the cutoff).  For performance reasons,
<TT>group1</TT> should be of limited size, because the cost of the
loop over all pairs grows as <!-- MATH
 $N_{\mathtt{group1}}^2$
 -->
<IMG
 WIDTH="60" HEIGHT="37" ALIGN="MIDDLE" BORDER="0"
 SRC="img190.png"
 ALT="$ N_{\mathtt{group1}}^2$">
.

<P>

<H4><A NAME="SECTION0016411010000000000000">
<TT>hBond</TT>: hydrogen bond between two
  atoms.</A>
</H4>  The <TT>hBond {...}</TT> block defines a hydrogen
bond, implemented as a coordination number (eq.&nbsp;<A HREF="#eq:cvc_coordNum">13.3</A>)
between the donor and the acceptor atoms.  Therefore, it accepts the
same options <TT>cutoff</TT> (with a different default value of
3.3&nbsp;&#197;), <TT>expNumer</TT> (with a default value of 6) and
<TT>expDenom</TT> (with a default value of 8).  Unlike
<TT>coordNum</TT>, it requires two atom numbers, <TT>acceptor</TT> and
<TT>donor</TT>, to be defined.  It returns an adimensional number,
with values between 0 (acceptor and donor far outside the cutoff
distance) and 1 (acceptor and donor much closer than the cutoff).

<P>

<H3><A NAME="SECTION0016411100000000000000">
<TT>rmsd</TT>: root mean square displacement  (RMSD) from reference positions.</A>
</H3>
The block <TT>rmsd&nbsp;{...}</TT> defines the root mean square replacement
(RMSD) of a group of atoms with respect to a reference structure.  For
each set of coordinates <!-- MATH
 $\{ \mathbf{x}_1(t), \mathbf{x}_2(t), \ldots
\mathbf{x}_N(t) \}$
 -->
<IMG
 WIDTH="180" HEIGHT="34" ALIGN="MIDDLE" BORDER="0"
 SRC="img191.png"
 ALT="$ \{ \mathbf{x}_1(t), \mathbf{x}_2(t), \ldots
\mathbf{x}_N(t) \}$">
, the colvar component <TT>rmsd</TT> calculates the
optimal rotation
<!-- MATH
 $U^{\{\mathbf{x}_{i}(t)\}\rightarrow\{\mathbf{x}_{i}^{\mathrm{(ref)}}\}}$
 -->
<IMG
 WIDTH="121" HEIGHT="24" ALIGN="BOTTOM" BORDER="0"
 SRC="img192.png"
 ALT="$ U^{\{\mathbf{x}_{i}(t)\}\rightarrow\{\mathbf{x}_{i}^{\mathrm{(ref)}}\}}$">

that best superimposes the coordinates <!-- MATH
 $\{\mathbf{x}_{i}(t)\}$
 -->
<IMG
 WIDTH="58" HEIGHT="34" ALIGN="MIDDLE" BORDER="0"
 SRC="img193.png"
 ALT="$ \{\mathbf{x}_{i}(t)\}$">
 onto a
set of reference coordinates <!-- MATH
 $\{\mathbf{x}_{i}^{\mathrm{(ref)}}\}$
 -->
<IMG
 WIDTH="60" HEIGHT="45" ALIGN="MIDDLE" BORDER="0"
 SRC="img194.png"
 ALT="$ \{\mathbf{x}_{i}^{\mathrm{(ref)}}\}$">
.
Both the current and the reference coordinates are centered on their
centers of geometry, <!-- MATH
 $\mathbf{x}_{\mathrm{cog}}(t)$
 -->
<IMG
 WIDTH="55" HEIGHT="34" ALIGN="MIDDLE" BORDER="0"
 SRC="img195.png"
 ALT="$ \mathbf{x}_{\mathrm{cog}}(t)$">
 and
<!-- MATH
 $\mathbf{x}_{\mathrm{cog}}^{\mathrm{(ref)}}$
 -->
<IMG
 WIDTH="43" HEIGHT="45" ALIGN="MIDDLE" BORDER="0"
 SRC="img196.png"
 ALT="$ \mathbf{x}_{\mathrm{cog}}^{\mathrm{(ref)}}$">
.  The root mean square
displacement is then defined as:
<P></P>
<DIV ALIGN="CENTER"><A NAME="eq:cvc_rmsd"></A><!-- MATH
 \begin{equation}
{ \mathrm{RMSD}(\{\mathbf{x}_{i}(t)\},
    \{\mathbf{x}_{i}^{\mathrm{(ref)}}\}) } \; = \; \sqrt{
    \frac{1}{N} \sum_{i=1}^{N} \left|
      U
      \left(\mathbf{x}_{i}(t) - \mathbf{x}_{\mathrm{cog}}(t)\right) -
      \left(\mathbf{x}_{i}^{\mathrm{(ref)}} -
        \mathbf{x}_{\mathrm{cog}}^{\mathrm{(ref)}} \right) \right|^{2} }
\end{equation}
 -->
<TABLE CELLPADDING="0" WIDTH="100%" ALIGN="CENTER">
<TR VALIGN="MIDDLE">
<TD NOWRAP ALIGN="CENTER"><IMG
 WIDTH="585" HEIGHT="85" ALIGN="MIDDLE" BORDER="0"
 SRC="img197.png"
 ALT="$\displaystyle { \mathrm{RMSD}(\{\mathbf{x}_{i}(t)\}, \{\mathbf{x}_{i}^{\mathrm{...
...{(ref)}} - \mathbf{x}_{\mathrm{cog}}^{\mathrm{(ref)}} \right) \right\vert^{2} }$"></TD>
<TD NOWRAP WIDTH="10" ALIGN="RIGHT">
(13.5)</TD></TR>
</TABLE></DIV>
<BR CLEAR="ALL"><P></P>
The optimal rotation
<!-- MATH
 $U^{\{\mathbf{x}_{i}(t)\}\rightarrow\{\mathbf{x}_{i}^{\mathrm{(ref)}}\}}$
 -->
<IMG
 WIDTH="121" HEIGHT="24" ALIGN="BOTTOM" BORDER="0"
 SRC="img192.png"
 ALT="$ U^{\{\mathbf{x}_{i}(t)\}\rightarrow\{\mathbf{x}_{i}^{\mathrm{(ref)}}\}}$">

is calculated within the formalism developed in
reference&nbsp;[<A
 HREF="node250.html#Coutsias2004">34</A>], which guarantees a continuous
dependence of
<!-- MATH
 $U^{\{\mathbf{x}_{i}(t)\}\rightarrow\{\mathbf{x}_{i}^{\mathrm{(ref)}}\}}$
 -->
<IMG
 WIDTH="121" HEIGHT="24" ALIGN="BOTTOM" BORDER="0"
 SRC="img192.png"
 ALT="$ U^{\{\mathbf{x}_{i}(t)\}\rightarrow\{\mathbf{x}_{i}^{\mathrm{(ref)}}\}}$">

with respect to <!-- MATH
 $\{\mathbf{x}_{i}(t)\}$
 -->
<IMG
 WIDTH="58" HEIGHT="34" ALIGN="MIDDLE" BORDER="0"
 SRC="img193.png"
 ALT="$ \{\mathbf{x}_{i}(t)\}$">
.  The options for <TT>rmsd</TT>
are:

<UL>
<LI><A NAME="21305"></A>
  <B><FONT SIZE="+1"><TT>atoms </TT></FONT></B> <IMG
 WIDTH="14" HEIGHT="34" ALIGN="MIDDLE" BORDER="0"
 SRC="img132.png"
 ALT="$ \langle\,$">
Atom group<IMG
 WIDTH="14" HEIGHT="34" ALIGN="MIDDLE" BORDER="0"
 SRC="img133.png"
 ALT="$ \,\rangle$">
 
<BR><B>Context: </B> <TT>rmsd</TT> 
<BR><B>Acceptable values: </B> <TT>atoms&nbsp;{...}</TT> block 
<BR><B>Description: </B> Defines the group of atoms of which the RMSD should be calculated.
    Optimal fit options (such as <TT>refPositions</TT> and
    <TT>rotateReference</TT>) should typically NOT be set within this
    block. Exceptions to this rule are the special cases discussed in
    the <I>Advanced usage</I> paragraph below.

<P>
</LI>
<LI><A NAME="21324"></A>
  <B><FONT SIZE="+1"><TT>refPositions </TT></FONT></B> <IMG
 WIDTH="14" HEIGHT="34" ALIGN="MIDDLE" BORDER="0"
 SRC="img132.png"
 ALT="$ \langle\,$">
Reference coordinates<IMG
 WIDTH="14" HEIGHT="34" ALIGN="MIDDLE" BORDER="0"
 SRC="img133.png"
 ALT="$ \,\rangle$">
 
<BR><B>Context: </B> <TT>rmsd</TT> 
<BR><B>Acceptable values: </B> space-separated list of <TT>(x, y, z)</TT> triplets 
<BR><B>Description: </B> This option (mutually exclusive with <TT>refPositionsFile</TT>)
    sets the reference coordinates.  If only <TT>centerReference</TT> is <TT>on</TT>, the list can be a single (x, y, z) triplet; if also <TT>rotateReference</TT> is <TT>on</TT>, the list should be as long as the atom group.  This option 
    is independent from that with the same keyword within the
    <TT>atoms&nbsp;{...}</TT> block (see <A HREF="node221.html#sec:colvar_atom_groups">13.3</A>).  The latter (and related fitting
    options for the atom group) are normally not needed,
    and should be omitted altogether except for advanced usage cases.

<P>

</LI>
<LI><A NAME="21378"></A>
  <B><FONT SIZE="+1"><TT>refPositionsFile </TT></FONT></B> <IMG
 WIDTH="14" HEIGHT="34" ALIGN="MIDDLE" BORDER="0"
 SRC="img132.png"
 ALT="$ \langle\,$">
Reference coordinates file<IMG
 WIDTH="14" HEIGHT="34" ALIGN="MIDDLE" BORDER="0"
 SRC="img133.png"
 ALT="$ \,\rangle$">
 
<BR><B>Context: </B> <TT>rmsd</TT> 
<BR><B>Acceptable values: </B> UNIX filename 
<BR><B>Description: </B> This option (mutually exclusive with <TT>refPositions</TT>) sets
    the PDB file name for the reference coordinates to be compared
    with.  The format is the same as that provided by
    <TT>refPositionsFile</TT> within an atom group definition.

<P>
</LI>
<LI><A NAME="21395"></A>
  <B><FONT SIZE="+1"><TT>refPositionsCol </TT></FONT></B> <IMG
 WIDTH="14" HEIGHT="34" ALIGN="MIDDLE" BORDER="0"
 SRC="img132.png"
 ALT="$ \langle\,$">
PDB column containing atom flags<IMG
 WIDTH="14" HEIGHT="34" ALIGN="MIDDLE" BORDER="0"
 SRC="img133.png"
 ALT="$ \,\rangle$">
 
<BR><B>Context: </B> <TT>rmsd</TT> 
<BR><B>Acceptable values: </B> <TT>O</TT>, <TT>B</TT>, <TT>X</TT>, <TT>Y</TT>, or <TT>Z</TT> 
<BR><B>Description: </B> If <TT>refPositionsFile</TT> is defined, and the file contains
    all the atoms in the topology, this option may be povided to
    set which PDB field is
    used to flag the reference coordinates for <TT>atoms</TT>.

<P>
</LI>
<LI><A NAME="21417"></A>
  <B><FONT SIZE="+1"><TT>refPositionsColValue </TT></FONT></B> <IMG
 WIDTH="14" HEIGHT="34" ALIGN="MIDDLE" BORDER="0"
 SRC="img132.png"
 ALT="$ \langle\,$">
Atom selection flag in the PDB column<IMG
 WIDTH="14" HEIGHT="34" ALIGN="MIDDLE" BORDER="0"
 SRC="img133.png"
 ALT="$ \,\rangle$">
 
<BR><B>Context: </B> <TT>rmsd</TT> 
<BR><B>Acceptable values: </B> positive decimal 
<BR><B>Description: </B> If defined, this value identifies in the PDB column
    <TT>refPositionsCol</TT> of the file <TT>refPositionsFile</TT>
    which atom positions are to be read.  Otherwise, all positions
    with a non-zero value are read.

<P>
</LI>
</UL>
This component returns a positive real number (in &#197;).

<P>

<H3><A NAME="SECTION0016411200000000000000">
Advanced usage of the <TT>rmsd</TT> component.</A>
</H3> 
In the standard usage as described above, the <TT>rmsd</TT> component
calculates a minimum RMSD, that is, current coordinates are optimally
fitted onto the same reference coordinates that are used to 
compute the RMSD value. The fit itself is handled by the atom group
object, whose parameters are automatically set by the <TT>rmsd</TT>
component.
For very specific applications, however, it may be
useful to control the fitting process separately from the definition
of the reference coordinates, to evaluate various types of
non-minimal RMSD values. This can be achieved by setting the
related options (<TT>refPositions</TT>, etc.) explicitly in the
atom group block. This allows for the following non-standard cases:

<P>

<OL>
<LI>applying the optimal translation, but no rotation
(<TT>rotateReference off</TT>), to bias or restrain the shape and
orientation, but not the position of the atom group;
</LI>
<LI>applying the optimal rotation, but no translation
(<TT>translateReference off</TT>), to bias or restrain the shape and
position, but not the orientation of the atom group;
</LI>
<LI>disabling the application of optimal roto-translations, which
lets the RMSD component decribe the deviation of atoms
from fixed positions in the laboratory frame: this allows for custom
positional restraints within the colvars module;
</LI>
<LI>fitting the atomic positions to different reference coordinates
than those used in the RMSD calculation itself;
</LI>
<LI>applying the optimal rotation and/or translation from a separate
atom group, defined through <TT>refPositionsGroup</TT>: the RMSD then
reflects the deviation from reference coordinates in a separate, moving
reference frame.
</LI>
</OL>

<P>

<H3><A NAME="SECTION0016411300000000000000">
<TT>eigenvector</TT>: projection of the atomic  coordinates on a vector.</A>
</H3>
The block <TT>eigenvector&nbsp;{...}</TT> defines the projection of the coordinates
of a group of atoms (or more precisely, their deviations from the
reference coordinates) onto a vector in <!-- MATH
 $\mathbb{R}^{3n}$
 -->
<IMG
 WIDTH="33" HEIGHT="18" ALIGN="BOTTOM" BORDER="0"
 SRC="img198.png"
 ALT="$ \mathbb{R}^{3n}$">
, where <IMG
 WIDTH="15" HEIGHT="15" ALIGN="BOTTOM" BORDER="0"
 SRC="img35.png"
 ALT="$ n$">
 is the
number of atoms in the group. The computed quantity is the
total projection:
<P></P>
<DIV ALIGN="CENTER"><A NAME="eq:cvc_eigenvector"></A><!-- MATH
 \begin{equation}
{ p(\{\mathbf{x}_{i}(t)\},
    \{\mathbf{x}_{i}^{\mathrm{(ref)}}\}) } \; = \; {
    \sum_{i=1}^{n}  \mathbf{v}_{i} \cdot
    \left(U(\mathbf{x}_{i}(t) - \mathbf{x}_{\mathrm{cog}}(t)) -
      (\mathbf{x}_{i}^{\mathrm{(ref)}} -
      \mathbf{x}_{\mathrm{cog}}^{\mathrm{(ref)}}) \right)\mathrm{,} }
\end{equation}
 -->
<TABLE CELLPADDING="0" WIDTH="100%" ALIGN="CENTER">
<TR VALIGN="MIDDLE">
<TD NOWRAP ALIGN="CENTER"><IMG
 WIDTH="530" HEIGHT="66" ALIGN="MIDDLE" BORDER="0"
 SRC="img199.png"
 ALT="$\displaystyle { p(\{\mathbf{x}_{i}(t)\}, \{\mathbf{x}_{i}^{\mathrm{(ref)}}\}) }...
...athrm{(ref)}} - \mathbf{x}_{\mathrm{cog}}^{\mathrm{(ref)}}) \right)\mathrm{,} }$"></TD>
<TD NOWRAP WIDTH="10" ALIGN="RIGHT">
(13.6)</TD></TR>
</TABLE></DIV>
<BR CLEAR="ALL"><P></P>
where, as in the <TT>rmsd</TT> component, <IMG
 WIDTH="18" HEIGHT="15" ALIGN="BOTTOM" BORDER="0"
 SRC="img200.png"
 ALT="$ U$">
 is the optimal rotation
matrix, <!-- MATH
 $\mathbf{x}_{\mathrm{cog}}(t)$
 -->
<IMG
 WIDTH="55" HEIGHT="34" ALIGN="MIDDLE" BORDER="0"
 SRC="img195.png"
 ALT="$ \mathbf{x}_{\mathrm{cog}}(t)$">
 and
<!-- MATH
 $\mathbf{x}_{\mathrm{cog}}^{\mathrm{(ref)}}$
 -->
<IMG
 WIDTH="43" HEIGHT="45" ALIGN="MIDDLE" BORDER="0"
 SRC="img196.png"
 ALT="$ \mathbf{x}_{\mathrm{cog}}^{\mathrm{(ref)}}$">
 are the centers of
geometry of the current and reference positions respectively, and
<!-- MATH
 $\mathbf{v}_{i}$
 -->
<IMG
 WIDTH="20" HEIGHT="30" ALIGN="MIDDLE" BORDER="0"
 SRC="img201.png"
 ALT="$ \mathbf{v}_{i}$">
 are the components of the vector for each atom.
Example choices for <!-- MATH
 $(\mathbf{v}_{i})$
 -->
<IMG
 WIDTH="34" HEIGHT="34" ALIGN="MIDDLE" BORDER="0"
 SRC="img202.png"
 ALT="$ (\mathbf{v}_{i})$">
 are an eigenvector
of the covariance matrix (essential mode), or a normal
mode of the system.  It is assumed that <!-- MATH
 $\sum_{i}\mathbf{v}_{i} = 0$
 -->
<IMG
 WIDTH="79" HEIGHT="34" ALIGN="MIDDLE" BORDER="0"
 SRC="img203.png"
 ALT="$ \sum_{i}\mathbf{v}_{i} = 0$">
:
otherwise, the colvars module centers the <!-- MATH
 $\mathbf{v}_{i}$
 -->
<IMG
 WIDTH="20" HEIGHT="30" ALIGN="MIDDLE" BORDER="0"
 SRC="img201.png"
 ALT="$ \mathbf{v}_{i}$">

automatically when reading them from the configuration.

<P>
As for the component <TT>rmsd</TT>, the available options are <TT>atoms</TT>, <TT>refPositionsFile</TT>, <TT>refPositionsCol</TT> and <TT>refPositionsColValue</TT>,  and <TT>refPositions</TT>.
In addition, the following are recognized:

<UL>
<LI><A NAME="21441"></A>
  <B><FONT SIZE="+1"><TT>vector </TT></FONT></B> <IMG
 WIDTH="14" HEIGHT="34" ALIGN="MIDDLE" BORDER="0"
 SRC="img132.png"
 ALT="$ \langle\,$">
Vector components<IMG
 WIDTH="14" HEIGHT="34" ALIGN="MIDDLE" BORDER="0"
 SRC="img133.png"
 ALT="$ \,\rangle$">
 
<BR><B>Context: </B> <TT>eigenvector</TT> 
<BR><B>Acceptable values: </B> space-separated list of <TT>(x, y, z)</TT> triplets 
<BR><B>Description: </B> This option (mutually exclusive with <TT>vectorFile</TT>) sets the values of the vector components.

<P>

</LI>
<LI><A NAME="21487"></A>
  <B><FONT SIZE="+1"><TT>vectorFile </TT></FONT></B> <IMG
 WIDTH="14" HEIGHT="34" ALIGN="MIDDLE" BORDER="0"
 SRC="img132.png"
 ALT="$ \langle\,$">
PDB file containing vector components<IMG
 WIDTH="14" HEIGHT="34" ALIGN="MIDDLE" BORDER="0"
 SRC="img133.png"
 ALT="$ \,\rangle$">
 
<BR><B>Context: </B> <TT>eigenvector</TT> 
<BR><B>Acceptable values: </B> UNIX filename 
<BR><B>Description: </B> This option (mutually exclusive with <TT>vector</TT>) sets the
    name of a PDB file where the vector components will be read from the
    X, Y, and Z fields.
    <B>Note:</B> <I>The PDB file has limited precision and fixed
      point numbers: in some cases, the vector may not be
      accurately represented, and </I><TT>vector</TT><I> should be
      used instead.</I>

<P>
</LI>
<LI><A NAME="21507"></A>
  <B><FONT SIZE="+1"><TT>vectorCol </TT></FONT></B> <IMG
 WIDTH="14" HEIGHT="34" ALIGN="MIDDLE" BORDER="0"
 SRC="img132.png"
 ALT="$ \langle\,$">
PDB column used to flag participating atoms<IMG
 WIDTH="14" HEIGHT="34" ALIGN="MIDDLE" BORDER="0"
 SRC="img133.png"
 ALT="$ \,\rangle$">
 
<BR><B>Context: </B> <TT>eigenvector</TT> 
<BR><B>Acceptable values: </B> <TT>O</TT> or <TT>B</TT> 
<BR><B>Description: </B> Analogous to <TT>atomsCol</TT>.

<P>
</LI>
<LI><A NAME="21525"></A>
  <B><FONT SIZE="+1"><TT>vectorColValue </TT></FONT></B> <IMG
 WIDTH="14" HEIGHT="34" ALIGN="MIDDLE" BORDER="0"
 SRC="img132.png"
 ALT="$ \langle\,$">
Value used to flag participating atoms in the PDB file<IMG
 WIDTH="14" HEIGHT="34" ALIGN="MIDDLE" BORDER="0"
 SRC="img133.png"
 ALT="$ \,\rangle$">
 
<BR><B>Context: </B> <TT>eigenvector</TT> 
<BR><B>Acceptable values: </B> positive decimal 
<BR><B>Description: </B> Analogous to <TT>atomsColValue</TT>.

<P>
</LI>
<LI><A NAME="21542"></A>
  <B><FONT SIZE="+1"><TT>differenceVector </TT></FONT></B> <IMG
 WIDTH="14" HEIGHT="34" ALIGN="MIDDLE" BORDER="0"
 SRC="img132.png"
 ALT="$ \langle\,$">
The <IMG
 WIDTH="24" HEIGHT="15" ALIGN="BOTTOM" BORDER="0"
 SRC="img204.png"
 ALT="$ 3n$">
-dimensional vector is the difference between <TT>vector</TT> and <TT>refPositions</TT><IMG
 WIDTH="14" HEIGHT="34" ALIGN="MIDDLE" BORDER="0"
 SRC="img133.png"
 ALT="$ \,\rangle$">
 
<BR><B>Context: </B> <TT>eigenvector</TT> 
<BR><B>Acceptable values: </B> boolean 
<BR><B>Default value: </B> <TT>off</TT> 
<BR><B>Description: </B> If this option is <TT>on</TT>, the numbers provided by <TT>vector</TT> or <TT>vectorFile</TT> are interpreted as another set of positions, <!-- MATH
 $\mathbf{x}_{i}'$
 -->
<IMG
 WIDTH="20" HEIGHT="34" ALIGN="MIDDLE" BORDER="0"
 SRC="img205.png"
 ALT="$ \mathbf{x}_{i}'$">
: the vector <!-- MATH
 $\mathbf{v}_{i}$
 -->
<IMG
 WIDTH="20" HEIGHT="30" ALIGN="MIDDLE" BORDER="0"
 SRC="img201.png"
 ALT="$ \mathbf{v}_{i}$">
 is then defined as <!-- MATH
 $\mathbf{v}_{i} = \left(\mathbf{x}_{i}' - \mathbf{x}_{i}^{\mathrm{(ref)}}\right)$
 -->
<IMG
 WIDTH="140" HEIGHT="48" ALIGN="MIDDLE" BORDER="0"
 SRC="img206.png"
 ALT="$ \mathbf{v}_{i} = \left(\mathbf{x}_{i}' - \mathbf{x}_{i}^{\mathrm{(ref)}}\right)$">
.
This allows to conveniently define a colvar <IMG
 WIDTH="13" HEIGHT="32" ALIGN="MIDDLE" BORDER="0"
 SRC="img148.png"
 ALT="$ \xi$">
 as a projection on the linear transformation between two sets of positions, ``A'' and ``B''.
For convenience, the vector is also normalized so that <IMG
 WIDTH="45" HEIGHT="32" ALIGN="MIDDLE" BORDER="0"
 SRC="img207.png"
 ALT="$ \xi = 0$">
 when the atoms are at the set of positions ``A'' and <IMG
 WIDTH="45" HEIGHT="32" ALIGN="MIDDLE" BORDER="0"
 SRC="img208.png"
 ALT="$ \xi = 1$">
 at the set of positions ``B''.

<P>
</LI>
</UL>
This component returns a number (in &#197;), whose value ranges between
the smallest and largest absolute positions in the unit cell during
the simulations (see also <TT>distanceZ</TT>).  Due to the
normalization in eq.&nbsp;<A HREF="#eq:cvc_eigenvector">13.6</A>, this range does not
depend on the number of atoms involved.

<P>

<H3><A NAME="SECTION0016411400000000000000">
<TT>gyration</TT>: radius of gyration of a group  of atoms.</A>
</H3>
The block <TT>gyration&nbsp;{...}</TT> defines the
parameters for calculating the radius of gyration of a group of atomic
positions <!-- MATH
 $\{ \mathbf{x}_1(t), \mathbf{x}_2(t), \ldots \mathbf{x}_N(t)
\}$
 -->
<IMG
 WIDTH="180" HEIGHT="34" ALIGN="MIDDLE" BORDER="0"
 SRC="img191.png"
 ALT="$ \{ \mathbf{x}_1(t), \mathbf{x}_2(t), \ldots
\mathbf{x}_N(t) \}$">
 with respect to their center of geometry,
<!-- MATH
 $\mathbf{x}_{\mathrm{cog}}(t)$
 -->
<IMG
 WIDTH="55" HEIGHT="34" ALIGN="MIDDLE" BORDER="0"
 SRC="img195.png"
 ALT="$ \mathbf{x}_{\mathrm{cog}}(t)$">
:
<P></P>
<DIV ALIGN="CENTER"><A NAME="eq:colvar_gyration"></A><!-- MATH
 \begin{equation}
R_{\mathrm{gyr}} \; = \; \sqrt{ \frac{1}{N}
    \sum_{i=1}^{N} \left|\mathbf{x}_{i}(t) -
      \mathbf{x}_{\mathrm{cog}}(t)\right|^{2} }
\end{equation}
 -->
<TABLE CELLPADDING="0" WIDTH="100%" ALIGN="CENTER">
<TR VALIGN="MIDDLE">
<TD NOWRAP ALIGN="CENTER"><IMG
 WIDTH="265" HEIGHT="85" ALIGN="MIDDLE" BORDER="0"
 SRC="img209.png"
 ALT="$\displaystyle R_{\mathrm{gyr}} \; = \; \sqrt{ \frac{1}{N} \sum_{i=1}^{N} \left\vert\mathbf{x}_{i}(t) - \mathbf{x}_{\mathrm{cog}}(t)\right\vert^{2} }$"></TD>
<TD NOWRAP WIDTH="10" ALIGN="RIGHT">
(13.7)</TD></TR>
</TABLE></DIV>
<BR CLEAR="ALL"><P></P>
This component must contain one <TT>atoms&nbsp;{...}</TT> block to
define the atom group, and returns a positive number, expressed in
&#197;.

<P>

<H3><A NAME="SECTION0016411500000000000000">
<TT>inertia</TT>: total moment of inertia of a group  of atoms.</A>
</H3>
The block <TT>inertia&nbsp;{...}</TT> defines the
parameters for calculating the total moment of inertia of a group of atomic
positions <!-- MATH
 $\{ \mathbf{x}_1(t), \mathbf{x}_2(t), \ldots \mathbf{x}_N(t)
\}$
 -->
<IMG
 WIDTH="180" HEIGHT="34" ALIGN="MIDDLE" BORDER="0"
 SRC="img191.png"
 ALT="$ \{ \mathbf{x}_1(t), \mathbf{x}_2(t), \ldots
\mathbf{x}_N(t) \}$">
 with respect to their center of geometry,
<!-- MATH
 $\mathbf{x}_{\mathrm{cog}}(t)$
 -->
<IMG
 WIDTH="55" HEIGHT="34" ALIGN="MIDDLE" BORDER="0"
 SRC="img195.png"
 ALT="$ \mathbf{x}_{\mathrm{cog}}(t)$">
:
<P></P>
<DIV ALIGN="CENTER"><A NAME="eq:colvar_inertia"></A><!-- MATH
 \begin{equation}
I \; = \; \sum_{i=1}^{N} \left|\mathbf{x}_{i}(t) -
      \mathbf{x}_{\mathrm{cog}}(t)\right|^{2}
\end{equation}
 -->
<TABLE CELLPADDING="0" WIDTH="100%" ALIGN="CENTER">
<TR VALIGN="MIDDLE">
<TD NOWRAP ALIGN="CENTER"><IMG
 WIDTH="200" HEIGHT="72" ALIGN="MIDDLE" BORDER="0"
 SRC="img210.png"
 ALT="$\displaystyle I \; = \; \sum_{i=1}^{N} \left\vert\mathbf{x}_{i}(t) - \mathbf{x}_{\mathrm{cog}}(t)\right\vert^{2}$"></TD>
<TD NOWRAP WIDTH="10" ALIGN="RIGHT">
(13.8)</TD></TR>
</TABLE></DIV>
<BR CLEAR="ALL"><P></P>
<I>Note that all atomic masses are set to 1 for simplicity.</I>
This component must contain one <TT>atoms&nbsp;{...}</TT> block to
define the atom group, and returns a positive number, expressed in
&#197;<IMG
 WIDTH="12" HEIGHT="19" ALIGN="BOTTOM" BORDER="0"
 SRC="img211.png"
 ALT="$ ^{2}$">
.

<P>

<H3><A NAME="SECTION0016411600000000000000">
<TT>inertiaZ</TT>: total moment of inertia of a group of atoms around a chosen axis.</A>
</H3>
The block <TT>inertiaZ&nbsp;{...}</TT> defines the
parameters for calculating the component along the axis <!-- MATH
 $\mathbf{e}$
 -->
<IMG
 WIDTH="14" HEIGHT="15" ALIGN="BOTTOM" BORDER="0"
 SRC="img212.png"
 ALT="$ \mathbf{e}$">
 of the moment of inertia of a group of atomic
positions <!-- MATH
 $\{ \mathbf{x}_1(t), \mathbf{x}_2(t), \ldots \mathbf{x}_N(t)
\}$
 -->
<IMG
 WIDTH="180" HEIGHT="34" ALIGN="MIDDLE" BORDER="0"
 SRC="img191.png"
 ALT="$ \{ \mathbf{x}_1(t), \mathbf{x}_2(t), \ldots
\mathbf{x}_N(t) \}$">
 with respect to their center of geometry,
<!-- MATH
 $\mathbf{x}_{\mathrm{cog}}(t)$
 -->
<IMG
 WIDTH="55" HEIGHT="34" ALIGN="MIDDLE" BORDER="0"
 SRC="img195.png"
 ALT="$ \mathbf{x}_{\mathrm{cog}}(t)$">
:
<P></P>
<DIV ALIGN="CENTER"><A NAME="eq:colvar_inertia_z"></A><!-- MATH
 \begin{equation}
I_{\mathbf{e}} \; = \; \sum_{i=1}^{N} \left(\left(\mathbf{x}_{i}(t) -
      \mathbf{x}_{\mathrm{cog}}(t)\right)\cdot\mathbf{e}\right)^{2}
\end{equation}
 -->
<TABLE CELLPADDING="0" WIDTH="100%" ALIGN="CENTER">
<TR VALIGN="MIDDLE">
<TD NOWRAP ALIGN="CENTER"><IMG
 WIDTH="245" HEIGHT="72" ALIGN="MIDDLE" BORDER="0"
 SRC="img213.png"
 ALT="$\displaystyle I_{\mathbf{e}} \; = \; \sum_{i=1}^{N} \left(\left(\mathbf{x}_{i}(t) - \mathbf{x}_{\mathrm{cog}}(t)\right)\cdot\mathbf{e}\right)^{2}$"></TD>
<TD NOWRAP WIDTH="10" ALIGN="RIGHT">
(13.9)</TD></TR>
</TABLE></DIV>
<BR CLEAR="ALL"><P></P>
<I>Note that all atomic masses are set to 1 for simplicity.</I>
This component must contain one <TT>atoms&nbsp;{...}</TT> block to
define the atom group, and returns a positive number, expressed in
&#197;<IMG
 WIDTH="12" HEIGHT="19" ALIGN="BOTTOM" BORDER="0"
 SRC="img211.png"
 ALT="$ ^{2}$">
.  The following option may also be provided:

<UL>
<LI><A NAME="21585"></A>
  <B><FONT SIZE="+1"><TT>axis </TT></FONT></B> <IMG
 WIDTH="14" HEIGHT="34" ALIGN="MIDDLE" BORDER="0"
 SRC="img132.png"
 ALT="$ \langle\,$">
Projection axis (&#197;)<IMG
 WIDTH="14" HEIGHT="34" ALIGN="MIDDLE" BORDER="0"
 SRC="img133.png"
 ALT="$ \,\rangle$">
 
<BR><B>Context: </B> <TT>inertiaZ</TT> 
<BR><B>Acceptable values: </B> <TT>(x, y, z)</TT> triplet 
<BR><B>Default value: </B> <TT>(0.0, 0.0, 1.0)</TT> 
<BR><B>Description: </B> The three components of this vector define (when normalized) the
    projection axis <!-- MATH
 $\mathbf{e}$
 -->
<IMG
 WIDTH="14" HEIGHT="15" ALIGN="BOTTOM" BORDER="0"
 SRC="img212.png"
 ALT="$ \mathbf{e}$">
.
</LI>
</UL>

<P>

<H3><A NAME="SECTION0016411700000000000000">
<TT>orientation</TT>: orientation from reference  coordinates.</A>
</H3>
The block <TT>orientation&nbsp;{...}</TT> returns the
same optimal rotation used in the <TT>rmsd</TT> component to
superimpose the coordinates <!-- MATH
 $\{\mathbf{x}_{i}(t)\}$
 -->
<IMG
 WIDTH="58" HEIGHT="34" ALIGN="MIDDLE" BORDER="0"
 SRC="img193.png"
 ALT="$ \{\mathbf{x}_{i}(t)\}$">
 onto a set of
reference coordinates <!-- MATH
 $\{\mathbf{x}_{i}^{\mathrm{(ref)}}\}$
 -->
<IMG
 WIDTH="60" HEIGHT="45" ALIGN="MIDDLE" BORDER="0"
 SRC="img194.png"
 ALT="$ \{\mathbf{x}_{i}^{\mathrm{(ref)}}\}$">
.  Such
component returns a four dimensional vector <!-- MATH
 $\mathsf{q} = (q_0, q_1,
q_2, q_3)$
 -->
<IMG
 WIDTH="135" HEIGHT="34" ALIGN="MIDDLE" BORDER="0"
 SRC="img214.png"
 ALT="$ \mathsf{q} = (q_0, q_1,
q_2, q_3)$">
, with <!-- MATH
 $\sum_{i} q_{i}^{2} = 1$
 -->
<IMG
 WIDTH="79" HEIGHT="37" ALIGN="MIDDLE" BORDER="0"
 SRC="img215.png"
 ALT="$ \sum_{i} q_{i}^{2} = 1$">
; this <I>quaternion</I>
expresses the optimal rotation <!-- MATH
 $\{\mathbf{x}_{i}(t)\} \rightarrow
\{\mathbf{x}_{i}^{\mathrm{(ref)}}\}$
 -->
<IMG
 WIDTH="141" HEIGHT="45" ALIGN="MIDDLE" BORDER="0"
 SRC="img216.png"
 ALT="$ \{\mathbf{x}_{i}(t)\} \rightarrow
\{\mathbf{x}_{i}^{\mathrm{(ref)}}\}$">
 according to the formalism in
reference&nbsp;[<A
 HREF="node250.html#Coutsias2004">34</A>].  The quaternion <!-- MATH
 $(q_0, q_1, q_2, q_3)$
 -->
<IMG
 WIDTH="103" HEIGHT="34" ALIGN="MIDDLE" BORDER="0"
 SRC="img217.png"
 ALT="$ (q_0, q_1, q_2, q_3)$">

can also be written as <!-- MATH
 $\left(\cos(\theta/2), \,
\sin(\theta/2)\mathbf{u}\right)$
 -->
<IMG
 WIDTH="164" HEIGHT="34" ALIGN="MIDDLE" BORDER="0"
 SRC="img218.png"
 ALT="$ \left(\cos(\theta/2), \,
\sin(\theta/2)\mathbf{u}\right)$">
, where <IMG
 WIDTH="13" HEIGHT="15" ALIGN="BOTTOM" BORDER="0"
 SRC="img219.png"
 ALT="$ \theta$">
 is the angle and
<!-- MATH
 $\mathbf{u}$
 -->
<IMG
 WIDTH="16" HEIGHT="15" ALIGN="BOTTOM" BORDER="0"
 SRC="img220.png"
 ALT="$ \mathbf{u}$">
 the normalized axis of rotation; for example, a rotation
of 90<IMG
 WIDTH="12" HEIGHT="16" ALIGN="BOTTOM" BORDER="0"
 SRC="img221.png"
 ALT="$ ^{\circ}$">
 around the <IMG
 WIDTH="13" HEIGHT="15" ALIGN="BOTTOM" BORDER="0"
 SRC="img28.png"
 ALT="$ z$">
 axis is expressed as
``<TT>(0.707, 0.0, 0.0, 0.707)</TT>''.  The script
<TT>quaternion2rmatrix.tcl</TT> provides Tcl functions for converting
to and from a <!-- MATH
 $4\times{}4$
 -->
<IMG
 WIDTH="43" HEIGHT="30" ALIGN="MIDDLE" BORDER="0"
 SRC="img222.png"
 ALT="$ 4\times{}4$">
 rotation matrix in a format suitable for
usage in VMD.

<P>
As for the component <TT>rmsd</TT>, the available options are <TT>atoms</TT>, <TT>refPositionsFile</TT>, <TT>refPositionsCol</TT> and <TT>refPositionsColValue</TT>,  and <TT>refPositions</TT>.

<P>
<B>Note:</B> <TT>refPositions</TT> and <TT>refPositionsFile</TT> define the set of positions <I>from which</I> the optimal rotation is calculated, but this rotation is not applied to the coordinates of the atoms involved: it is used instead to define the variable itself.

<P>

<UL>
<LI><A NAME="21612"></A>
  <B><FONT SIZE="+1"><TT>closestToQuaternion </TT></FONT></B> <IMG
 WIDTH="14" HEIGHT="34" ALIGN="MIDDLE" BORDER="0"
 SRC="img132.png"
 ALT="$ \langle\,$">
Reference rotation<IMG
 WIDTH="14" HEIGHT="34" ALIGN="MIDDLE" BORDER="0"
 SRC="img133.png"
 ALT="$ \,\rangle$">
 
<BR><B>Context: </B> <TT>orientation</TT> 
<BR><B>Acceptable values: </B> ``<TT>(q0, q1, q2, q3)</TT>'' quadruplet 
<BR><B>Default value: </B> <TT>(1.0, 0.0, 0.0, 0.0)</TT> (``null'' rotation) 
<BR><B>Description: </B> Between the two equivalent quaternions <!-- MATH
 $(q_0, q_1, q_2, q_3)$
 -->
<IMG
 WIDTH="103" HEIGHT="34" ALIGN="MIDDLE" BORDER="0"
 SRC="img217.png"
 ALT="$ (q_0, q_1, q_2, q_3)$">
 and
    <!-- MATH
 $(-q_0, -q_1, -q_2, -q_3)$
 -->
<IMG
 WIDTH="157" HEIGHT="34" ALIGN="MIDDLE" BORDER="0"
 SRC="img223.png"
 ALT="$ (-q_0, -q_1, -q_2, -q_3)$">
, the closer to <TT>(1.0, 0.0, 0.0,
      0.0)</TT> is chosen.  This simplifies the visualization of the
    colvar trajectory when samples values are a smaller subset of all
    possible rotations.  <B>Note:</B> <I>this only affects the
      output, never the dynamics</I>.

<P>
</LI>
</UL>

<P>
<B>Hint: stopping the rotation of a protein.</B>  To stop the
rotation of an elongated macromolecule in solution (and use an
anisotropic box to save water molecules), it is possible to define a
colvar with an <TT>orientation</TT> component, and restrain it throuh
the <TT>harmonic</TT> bias around the identity rotation, <TT>(1.0,
  0.0, 0.0, 0.0)</TT>.  Only the overall orientation of the macromolecule
is affected, and <I>not</I> its internal degrees of freedom.  The user
should also take care that the macromolecule is composed by a single
chain, or disable <TT>wrapAll</TT> otherwise.

<P>

<H3><A NAME="SECTION0016411800000000000000">
<TT>orientationAngle</TT>: angle of rotation from reference coordinates.</A>
</H3>  
The block <TT>orientationAngle&nbsp;{...}</TT> accepts the same base options as
the component <TT>orientation</TT>: <TT>atoms</TT> and <TT>refPositions</TT>, or <TT>refPositionsFile</TT>, <TT>refPositionsCol</TT> and <TT>refPositionsColValue</TT>.
The returned value is the angle of rotation <IMG
 WIDTH="13" HEIGHT="15" ALIGN="BOTTOM" BORDER="0"
 SRC="img219.png"
 ALT="$ \theta$">
 between the current and the reference positions.
This angle is expressed in degrees within the range [0<IMG
 WIDTH="12" HEIGHT="16" ALIGN="BOTTOM" BORDER="0"
 SRC="img221.png"
 ALT="$ ^{\circ}$">
:180<IMG
 WIDTH="12" HEIGHT="16" ALIGN="BOTTOM" BORDER="0"
 SRC="img221.png"
 ALT="$ ^{\circ}$">
].

<P>

<H3><A NAME="SECTION0016411900000000000000">
<TT>orientationProj</TT>: cosine of the angle of rotation from reference coordinates.</A>
</H3>  
The block <TT>orientationProj&nbsp;{...}</TT> accepts the same base options as
the component <TT>orientation</TT>: <TT>atoms</TT> and <TT>refPositions</TT>, or <TT>refPositionsFile</TT>, <TT>refPositionsCol</TT> and <TT>refPositionsColValue</TT>.
The returned value is the cosine of the angle of rotation <IMG
 WIDTH="13" HEIGHT="15" ALIGN="BOTTOM" BORDER="0"
 SRC="img219.png"
 ALT="$ \theta$">
 between the current and the reference positions.
The range of values is [-1:1].

<P>

<H3><A NAME="SECTION0016412000000000000000">
<TT>spinAngle</TT>: angle of rotation around a given axis.</A>
</H3>
The complete rotation described by <TT>orientation</TT> can optionally be decomposed into two sub-rotations: one is a ``<I>spin</I>'' rotation around <B>e</B>, and the other a ``<I>tilt</I>'' rotation around an axis orthogonal to <B>e</B>.
The component <TT>spinAngle</TT> measures the angle of the ``spin'' sub-rotation around <B>e</B>.
This can be defined using the same options as the component <TT>orientation</TT>: <TT>atoms</TT> and <TT>refPositions</TT>, or <TT>refPositionsFile</TT>, <TT>refPositionsCol</TT> and <TT>refPositionsColValue</TT>.
In addition, <TT>spinAngle</TT> accepts the <TT>axis</TT> option:

<UL>
<LI><A NAME="21649"></A>
  <B><FONT SIZE="+1"><TT>axis </TT></FONT></B> <IMG
 WIDTH="14" HEIGHT="34" ALIGN="MIDDLE" BORDER="0"
 SRC="img132.png"
 ALT="$ \langle\,$">
Special rotation axis (&#197;)<IMG
 WIDTH="14" HEIGHT="34" ALIGN="MIDDLE" BORDER="0"
 SRC="img133.png"
 ALT="$ \,\rangle$">
 
<BR><B>Context: </B> <TT>tilt, spinAngle</TT> 
<BR><B>Acceptable values: </B> <TT>(x, y, z)</TT> triplet 
<BR><B>Default value: </B> <TT>(0.0, 0.0, 1.0)</TT> 
<BR><B>Description: </B> The three components of this vector define (when normalized) the special rotation axis used to calculate the <TT>tilt</TT> and <TT>spinAngle</TT> components.
</LI>
</UL>
The component <TT>spinAngle</TT> returns an angle (in degrees) within the periodic interval <!-- MATH
 $[-180:180]$
 -->
<IMG
 WIDTH="94" HEIGHT="34" ALIGN="MIDDLE" BORDER="0"
 SRC="img174.png"
 ALT="$ [-180:180]$">
.  

<P>
<B>Note:</B> the value of <TT>spinAngle</TT> is a continuous function almost everywhere, with the exception of configurations with the corresponding ``tilt'' angle equal to 180<IMG
 WIDTH="12" HEIGHT="16" ALIGN="BOTTOM" BORDER="0"
 SRC="img224.png"
 ALT="$ ^\circ$">
 (i.e.&nbsp;the <TT>tilt</TT> component is equal to <IMG
 WIDTH="27" HEIGHT="30" ALIGN="MIDDLE" BORDER="0"
 SRC="img225.png"
 ALT="$ -1$">
): in those cases, <TT>spinAngle</TT> is undefined.  If such configurations are expected, consider defining a <TT>tilt</TT> colvar using the same axis <B>e</B>, and restraining it with a lower wall away from <IMG
 WIDTH="27" HEIGHT="30" ALIGN="MIDDLE" BORDER="0"
 SRC="img225.png"
 ALT="$ -1$">
.

<P>

<H3><A NAME="SECTION0016412100000000000000">
<TT>tilt</TT>: cosine of the rotation orthogonal to a given axis.</A>
</H3>
The component <TT>tilt</TT> measures the cosine of the angle of the ``tilt'' sub-rotation, which combined with the ``spin'' sub-rotation provides the complete rotation of a group of atoms.
The cosine of the tilt angle rather than the tilt angle itself is implemented, because the latter is unevenly distributed even for an isotropic system: consider as an analogy the angle <IMG
 WIDTH="13" HEIGHT="15" ALIGN="BOTTOM" BORDER="0"
 SRC="img219.png"
 ALT="$ \theta$">
 in the spherical coordinate system.
The component <TT>tilt</TT> relies on the same options as <TT>spinAngle</TT>, including the definition of the axis <B>e</B>.
The values of <TT>tilt</TT> are real numbers in the interval <IMG
 WIDTH="60" HEIGHT="34" ALIGN="MIDDLE" BORDER="0"
 SRC="img226.png"
 ALT="$ [-1:1]$">
: the value <IMG
 WIDTH="13" HEIGHT="15" ALIGN="BOTTOM" BORDER="0"
 SRC="img64.png"
 ALT="$ 1$">
 represents an orientation fully parallel to <B>e</B> (tilt angle = 0<IMG
 WIDTH="12" HEIGHT="16" ALIGN="BOTTOM" BORDER="0"
 SRC="img224.png"
 ALT="$ ^\circ$">
), and the value <IMG
 WIDTH="27" HEIGHT="30" ALIGN="MIDDLE" BORDER="0"
 SRC="img225.png"
 ALT="$ -1$">
 represents an anti-parallel orientation.

<P>

<P>

<H3><A NAME="SECTION0016412200000000000000">
<TT>alpha</TT>: <IMG
 WIDTH="16" HEIGHT="15" ALIGN="BOTTOM" BORDER="0"
 SRC="img44.png"
 ALT="$ \alpha$">
-helix content of a  protein segment.</A>
</H3>
The block <TT>alpha&nbsp;{...}</TT> defines the
parameters to calculate the helical content of a segment of protein
residues.  The <IMG
 WIDTH="16" HEIGHT="15" ALIGN="BOTTOM" BORDER="0"
 SRC="img44.png"
 ALT="$ \alpha$">
-helical content across the <IMG
 WIDTH="50" HEIGHT="31" ALIGN="MIDDLE" BORDER="0"
 SRC="img227.png"
 ALT="$ N+1$">
 residues
<IMG
 WIDTH="26" HEIGHT="31" ALIGN="MIDDLE" BORDER="0"
 SRC="img228.png"
 ALT="$ N_{0}$">
 to <IMG
 WIDTH="63" HEIGHT="31" ALIGN="MIDDLE" BORDER="0"
 SRC="img229.png"
 ALT="$ N_{0}+N$">
 is calculated by the formula:
<BR>
<DIV ALIGN="CENTER"><A NAME="eq:colvars_alpha"></A><!-- MATH
 \begin{eqnarray}
{
    \alpha\left(
      \mathrm{C}_{\alpha}^{(N_{0})},
      \mathrm{O}^{(N_{0})},
      \mathrm{C}_{\alpha}^{(N_{0}+1)},
      \mathrm{O}^{(N_{0}+1)},
      \ldots
      \mathrm{N}^{(N_{0}+5)},
      \mathrm{C}_{\alpha}^{(N_{0}+5)},
      \mathrm{O}^{(N_{0}+5)},
      \ldots
      \mathrm{N}^{(N_{0}+N)},
      \mathrm{C}_{\alpha}^{(N_{0}+N)}
    \right)
  } \; = \; \; \; \; \\\; \; \; \; {
    \nonumber
    \frac{1}{2(N-2)} 
    \sum_{n=N_{0}}^{N_{0}+N-2}
    \mathrm{angf}\left(
        \mathrm{C}_{\alpha}^{(n)},
        \mathrm{C}_{\alpha}^{(n+1)},
        \mathrm{C}_{\alpha}^{(n+2)}\right)
  } \; + \; {
    \frac{1}{2(N-4)} 
    \sum_{n=N_{0}}^{N_{0}+N-4}
    \mathrm{hbf}\left(
      \mathrm{O}^{(n)},
      \mathrm{N}^{(n+4)}\right) \mathrm{,}
  } \\
\end{eqnarray}
 -->
<TABLE CELLPADDING="0" ALIGN="CENTER" WIDTH="100%">
<TR VALIGN="MIDDLE"><TD NOWRAP ALIGN="RIGHT"><IMG
 WIDTH="676" HEIGHT="48" ALIGN="MIDDLE" BORDER="0"
 SRC="img230.png"
 ALT="$\displaystyle {
\alpha\left(
\mathrm{C}_{\alpha}^{(N_{0})},
\mathrm{O}^{(N_{0})...
...thrm{N}^{(N_{0}+N)},
\mathrm{C}_{\alpha}^{(N_{0}+N)}
\right)
} \; = \; \; \; \;$"></TD>
<TD>&nbsp;</TD>
<TD>&nbsp;</TD>
<TD WIDTH=10 ALIGN="RIGHT">
(13.10)</TD></TR>
<TR VALIGN="MIDDLE"><TD NOWRAP ALIGN="RIGHT"><IMG
 WIDTH="674" HEIGHT="73" ALIGN="MIDDLE" BORDER="0"
 SRC="img231.png"
 ALT="$\displaystyle \; \; \; \; {
\frac{1}{2(N-2)}
\sum_{n=N_{0}}^{N_{0}+N-2}
\mathrm...
...-4}
\mathrm{hbf}\left(
\mathrm{O}^{(n)},
\mathrm{N}^{(n+4)}\right) \mathrm{,}
}$"></TD>
<TD>&nbsp;</TD>
<TD>&nbsp;</TD>
<TD WIDTH=10 ALIGN="RIGHT">
&nbsp;</TD></TR>
</TABLE></DIV>
<BR CLEAR="ALL">

where the score function for the <!-- MATH
 $\mathrm{C}_{\alpha} -
\mathrm{C}_{\alpha} - \mathrm{C}_{\alpha}$
 -->
<IMG
 WIDTH="113" HEIGHT="31" ALIGN="MIDDLE" BORDER="0"
 SRC="img232.png"
 ALT="$ \mathrm{C}_{\alpha} -
\mathrm{C}_{\alpha} - \mathrm{C}_{\alpha}$">
 angle is defined as: 
<P></P>
<DIV ALIGN="CENTER"><A NAME="eq:colvars_alpha_Calpha"></A><!-- MATH
 \begin{equation}
{
    \mathrm{angf}\left(
      \mathrm{C}_{\alpha}^{(n)},
      \mathrm{C}_{\alpha}^{(n+1)},
      \mathrm{C}_{\alpha}^{(n+2)}\right)
  } \; = \; {
    \frac{1 - \left(\theta(
        \mathrm{C}_{\alpha}^{(n)},
        \mathrm{C}_{\alpha}^{(n+1)},
        \mathrm{C}_{\alpha}^{(n+2)}) -
        \theta_{0}\right)^{2} /
      \left(\Delta\theta_{\mathrm{tol}}\right)^{2}}{
      1 - \left(\theta(
        \mathrm{C}_{\alpha}^{(n)},
        \mathrm{C}_{\alpha}^{(n+1)},
        \mathrm{C}_{\alpha}^{(n+2)}) -
        \theta_{0}\right)^{4} /
      \left(\Delta\theta_{\mathrm{tol}}\right)^{4}} \mathrm{,}
  }
\end{equation}
 -->
<TABLE CELLPADDING="0" WIDTH="100%" ALIGN="CENTER">
<TR VALIGN="MIDDLE">
<TD NOWRAP ALIGN="CENTER"><IMG
 WIDTH="586" HEIGHT="91" ALIGN="MIDDLE" BORDER="0"
 SRC="img233.png"
 ALT="$\displaystyle { \mathrm{angf}\left( \mathrm{C}_{\alpha}^{(n)}, \mathrm{C}_{\alp...
...eta_{0}\right)^{4} / \left(\Delta\theta_{\mathrm{tol}}\right)^{4}} \mathrm{,} }$"></TD>
<TD NOWRAP WIDTH="10" ALIGN="RIGHT">
(13.11)</TD></TR>
</TABLE></DIV>
<BR CLEAR="ALL"><P></P>
and the score function for the <!-- MATH
 $\mathrm{O}^{(n)} \leftrightarrow
\mathrm{N}^{(n+4)}$
 -->
<IMG
 WIDTH="114" HEIGHT="19" ALIGN="BOTTOM" BORDER="0"
 SRC="img234.png"
 ALT="$ \mathrm{O}^{(n)} \leftrightarrow
\mathrm{N}^{(n+4)}$">
 hydrogen bond is defined through a <TT>hBond</TT>
colvar component on the same atoms.  The options recognized within the
<TT>alpha&nbsp;{...}</TT> block are:

<UL>
<LI><A NAME="21922"></A>
  <B><FONT SIZE="+1"><TT>residueRange </TT></FONT></B> <IMG
 WIDTH="14" HEIGHT="34" ALIGN="MIDDLE" BORDER="0"
 SRC="img132.png"
 ALT="$ \langle\,$">
Potential <IMG
 WIDTH="16" HEIGHT="15" ALIGN="BOTTOM" BORDER="0"
 SRC="img44.png"
 ALT="$ \alpha$">
-helical residues<IMG
 WIDTH="14" HEIGHT="34" ALIGN="MIDDLE" BORDER="0"
 SRC="img133.png"
 ALT="$ \,\rangle$">
 
<BR><B>Context: </B> <TT>alpha</TT> 
<BR><B>Acceptable values: </B> ``<IMG
 WIDTH="18" HEIGHT="30" ALIGN="MIDDLE" BORDER="0"
 SRC="img5.png"
 ALT="$ &lt;$">
Initial residue number<IMG
 WIDTH="18" HEIGHT="30" ALIGN="MIDDLE" BORDER="0"
 SRC="img4.png"
 ALT="$ &gt;$">
-<IMG
 WIDTH="18" HEIGHT="30" ALIGN="MIDDLE" BORDER="0"
 SRC="img5.png"
 ALT="$ &lt;$">
Final residue number<IMG
 WIDTH="18" HEIGHT="30" ALIGN="MIDDLE" BORDER="0"
 SRC="img4.png"
 ALT="$ &gt;$">
'' 
<BR><B>Description: </B> This option specifies the range of residues on which this
    component should be defined.  The colvar module looks for the
    atoms within these residues named ``<TT>CA</TT>'', ``<TT>N</TT>''
    and ``<TT>O</TT>'', and raises an error if any of those atoms is
    not found.

<P>
</LI>
<LI><A NAME="21940"></A>
  <B><FONT SIZE="+1"><TT>psfSegID </TT></FONT></B> <IMG
 WIDTH="14" HEIGHT="34" ALIGN="MIDDLE" BORDER="0"
 SRC="img132.png"
 ALT="$ \langle\,$">
PSF segment identifier<IMG
 WIDTH="14" HEIGHT="34" ALIGN="MIDDLE" BORDER="0"
 SRC="img133.png"
 ALT="$ \,\rangle$">
 
<BR><B>Context: </B> <TT>alpha</TT> 
<BR><B>Acceptable values: </B> string (max 4 characters) 
<BR><B>Description: </B> This option sets the PSF segment identifier for the residues
    specified in <TT>residueRange</TT>.  This option is only required
    when PSF topologies are used.

<P>
</LI>
<LI><A NAME="21957"></A>
  <B><FONT SIZE="+1"><TT>hBondCoeff </TT></FONT></B> <IMG
 WIDTH="14" HEIGHT="34" ALIGN="MIDDLE" BORDER="0"
 SRC="img132.png"
 ALT="$ \langle\,$">
Coefficient for the hydrogen bond term<IMG
 WIDTH="14" HEIGHT="34" ALIGN="MIDDLE" BORDER="0"
 SRC="img133.png"
 ALT="$ \,\rangle$">
 
<BR><B>Context: </B> <TT>alpha</TT> 
<BR><B>Acceptable values: </B> positive between 0 and 1 
<BR><B>Default value: </B> 0.5 
<BR><B>Description: </B> This number specifies the contribution to the total value from the
    hydrogen bond terms.  0 disables the hydrogen bond terms, 1
    disables the angle terms.

<P>
</LI>
<LI><A NAME="21974"></A>
  <B><FONT SIZE="+1"><TT>angleRef </TT></FONT></B> <IMG
 WIDTH="14" HEIGHT="34" ALIGN="MIDDLE" BORDER="0"
 SRC="img132.png"
 ALT="$ \langle\,$">
Reference <!-- MATH
 $\mathrm{C}_{\alpha} -
\mathrm{C}_{\alpha} - \mathrm{C}_{\alpha}$
 -->
<IMG
 WIDTH="113" HEIGHT="31" ALIGN="MIDDLE" BORDER="0"
 SRC="img232.png"
 ALT="$ \mathrm{C}_{\alpha} -
\mathrm{C}_{\alpha} - \mathrm{C}_{\alpha}$">
 angle<IMG
 WIDTH="14" HEIGHT="34" ALIGN="MIDDLE" BORDER="0"
 SRC="img133.png"
 ALT="$ \,\rangle$">
 
<BR><B>Context: </B> <TT>alpha</TT> 
<BR><B>Acceptable values: </B> positive decimal 
<BR><B>Default value: </B> 88<IMG
 WIDTH="12" HEIGHT="16" ALIGN="BOTTOM" BORDER="0"
 SRC="img221.png"
 ALT="$ ^{\circ}$">
 
<BR><B>Description: </B> This option sets the reference angle used in the score function
    (<A HREF="#eq:colvars_alpha_Calpha">13.12</A>).

<P>
</LI>
<LI><A NAME="21999"></A>
  <B><FONT SIZE="+1"><TT>angleTol </TT></FONT></B> <IMG
 WIDTH="14" HEIGHT="34" ALIGN="MIDDLE" BORDER="0"
 SRC="img132.png"
 ALT="$ \langle\,$">
Tolerance in the <!-- MATH
 $\mathrm{C}_{\alpha} -
\mathrm{C}_{\alpha} - \mathrm{C}_{\alpha}$
 -->
<IMG
 WIDTH="113" HEIGHT="31" ALIGN="MIDDLE" BORDER="0"
 SRC="img232.png"
 ALT="$ \mathrm{C}_{\alpha} -
\mathrm{C}_{\alpha} - \mathrm{C}_{\alpha}$">
 angle<IMG
 WIDTH="14" HEIGHT="34" ALIGN="MIDDLE" BORDER="0"
 SRC="img133.png"
 ALT="$ \,\rangle$">
 
<BR><B>Context: </B> <TT>alpha</TT> 
<BR><B>Acceptable values: </B> positive decimal 
<BR><B>Default value: </B> 15<IMG
 WIDTH="12" HEIGHT="16" ALIGN="BOTTOM" BORDER="0"
 SRC="img221.png"
 ALT="$ ^{\circ}$">
 
<BR><B>Description: </B> This option sets the angle tolerance used in the score function
    (<A HREF="#eq:colvars_alpha_Calpha">13.12</A>).

<P>
</LI>
<LI><A NAME="22024"></A>
  <B><FONT SIZE="+1"><TT>hBondCutoff </TT></FONT></B> <IMG
 WIDTH="14" HEIGHT="34" ALIGN="MIDDLE" BORDER="0"
 SRC="img132.png"
 ALT="$ \langle\,$">
Hydrogen bond cutoff<IMG
 WIDTH="14" HEIGHT="34" ALIGN="MIDDLE" BORDER="0"
 SRC="img133.png"
 ALT="$ \,\rangle$">
 
<BR><B>Context: </B> <TT>alpha</TT> 
<BR><B>Acceptable values: </B> positive decimal 
<BR><B>Default value: </B> 3.3&nbsp;&#197; 
<BR><B>Description: </B> Equivalent to the <TT>cutoff</TT> option in the <TT>hBond</TT>
    component.

<P>
</LI>
<LI><A NAME="22044"></A>
  <B><FONT SIZE="+1"><TT>hBondExpNumer </TT></FONT></B> <IMG
 WIDTH="14" HEIGHT="34" ALIGN="MIDDLE" BORDER="0"
 SRC="img132.png"
 ALT="$ \langle\,$">
Hydrogen bond numerator exponent<IMG
 WIDTH="14" HEIGHT="34" ALIGN="MIDDLE" BORDER="0"
 SRC="img133.png"
 ALT="$ \,\rangle$">
 
<BR><B>Context: </B> <TT>alpha</TT> 
<BR><B>Acceptable values: </B> positive integer 
<BR><B>Default value: </B> 6 
<BR><B>Description: </B> Equivalent to the <TT>expNumer</TT> option in the <TT>hBond</TT>
    component.

<P>
</LI>
<LI><A NAME="22063"></A>
  <B><FONT SIZE="+1"><TT>hBondExpDenom </TT></FONT></B> <IMG
 WIDTH="14" HEIGHT="34" ALIGN="MIDDLE" BORDER="0"
 SRC="img132.png"
 ALT="$ \langle\,$">
Hydrogen bond denominator exponent<IMG
 WIDTH="14" HEIGHT="34" ALIGN="MIDDLE" BORDER="0"
 SRC="img133.png"
 ALT="$ \,\rangle$">
 
<BR><B>Context: </B> <TT>alpha</TT> 
<BR><B>Acceptable values: </B> positive integer 
<BR><B>Default value: </B> 8 
<BR><B>Description: </B> Equivalent to the <TT>expDenom</TT> option in the <TT>hBond</TT>
    component.

<P>
</LI>
</UL>

<P>
This component returns positive values, always comprised between 0
(lowest <IMG
 WIDTH="16" HEIGHT="15" ALIGN="BOTTOM" BORDER="0"
 SRC="img44.png"
 ALT="$ \alpha$">
-helical score) and 1 (highest <IMG
 WIDTH="16" HEIGHT="15" ALIGN="BOTTOM" BORDER="0"
 SRC="img44.png"
 ALT="$ \alpha$">
-helical
score).

<P>

<H3><A NAME="SECTION0016412300000000000000">
<TT>dihedralPC</TT>: protein dihedral pricipal component</A>
</H3>
The block <TT>dihedralPC&nbsp;{...}</TT> defines the
parameters to calculate the projection of backbone dihedral angles within
a protein segment onto a <I>dihedral principal component</I>, following
the formalism of dihedral principal component analysis (dPCA) proposed by
Mu et al.[<A
 HREF="node250.html#Mu2005">35</A>] and documented in detail by Altis et
al.[<A
 HREF="node250.html#Altis2007">36</A>].
Given a peptide or protein segment of <IMG
 WIDTH="20" HEIGHT="15" ALIGN="BOTTOM" BORDER="0"
 SRC="img41.png"
 ALT="$ N$">
 residues, each with Ramachandran
angles <IMG
 WIDTH="20" HEIGHT="32" ALIGN="MIDDLE" BORDER="0"
 SRC="img235.png"
 ALT="$ \phi_i$">
 and <IMG
 WIDTH="21" HEIGHT="32" ALIGN="MIDDLE" BORDER="0"
 SRC="img236.png"
 ALT="$ \psi_i$">
, dPCA rests on a variance/covariance analysis
of the <IMG
 WIDTH="73" HEIGHT="34" ALIGN="MIDDLE" BORDER="0"
 SRC="img237.png"
 ALT="$ 4(N-1)$">
 variables <!-- MATH
 $\cos(\psi_1), \sin(\psi_1), \cos(\phi_2), \sin(\phi_2)
\cdots \cos(\phi_N), \sin(\phi_N)$
 -->
<IMG
 WIDTH="397" HEIGHT="34" ALIGN="MIDDLE" BORDER="0"
 SRC="img238.png"
 ALT="$ \cos(\psi_1), \sin(\psi_1), \cos(\phi_2), \sin(\phi_2)
\cdots \cos(\phi_N), \sin(\phi_N)$">
. Note that angles <IMG
 WIDTH="22" HEIGHT="32" ALIGN="MIDDLE" BORDER="0"
 SRC="img239.png"
 ALT="$ \phi_1$">
 and <IMG
 WIDTH="29" HEIGHT="32" ALIGN="MIDDLE" BORDER="0"
 SRC="img240.png"
 ALT="$ \psi_N$">

have little impact on chain conformation, and are therefore discarded,
following the implementation of dPCA in the analysis software Carma.[<A
 HREF="node250.html#Glykos2006">37</A>]

<P>
For a given principal component (eigenvector) of coefficients
<!-- MATH
 $(k_i)_{1 \leq i \leq 4(N-1)}$
 -->
<IMG
 WIDTH="112" HEIGHT="34" ALIGN="MIDDLE" BORDER="0"
 SRC="img241.png"
 ALT="$ (k_i)_{1 \leq i \leq 4(N-1)}$">
,
the projection of the current backbone conformation is:
<P></P>
<DIV ALIGN="CENTER"><!-- MATH
 \begin{equation}
\xi = \sum_{n=1}^{N-1} k_{4n-3} \cos(\psi_n) + k_{4n-2} \sin (\psi_n)
+ k_{4n-1} \cos (\phi_{n+1}) + k_{4n} \sin(\phi_{n+1})
\end{equation}
 -->
<TABLE CELLPADDING="0" WIDTH="100%" ALIGN="CENTER">
<TR VALIGN="MIDDLE">
<TD NOWRAP ALIGN="CENTER"><IMG
 WIDTH="553" HEIGHT="72" ALIGN="MIDDLE" BORDER="0"
 SRC="img242.png"
 ALT="$\displaystyle \xi = \sum_{n=1}^{N-1} k_{4n-3} \cos(\psi_n) + k_{4n-2} \sin (\psi_n) + k_{4n-1} \cos (\phi_{n+1}) + k_{4n} \sin(\phi_{n+1})$"></TD>
<TD NOWRAP WIDTH="10" ALIGN="RIGHT">
(13.12)</TD></TR>
</TABLE></DIV>
<BR CLEAR="ALL"><P></P>

<P>
<TT>dihedralPC</TT> expects the same parameters as the <TT>alpha</TT>
component for defining the relevant residues (<TT>residueRange</TT>
and <TT>psfSegID</TT>) in addition to the following:

<P>

<UL>
<LI><A NAME="22083"></A>
  <B><FONT SIZE="+1"><TT>vectorFile </TT></FONT></B> <IMG
 WIDTH="14" HEIGHT="34" ALIGN="MIDDLE" BORDER="0"
 SRC="img132.png"
 ALT="$ \langle\,$">
File containing dihedral PCA eigenvector(s)<IMG
 WIDTH="14" HEIGHT="34" ALIGN="MIDDLE" BORDER="0"
 SRC="img133.png"
 ALT="$ \,\rangle$">
 
<BR><B>Context: </B> <TT>dihedralPC</TT> 
<BR><B>Acceptable values: </B> file name 
<BR><B>Description: </B> A text file containing the coefficients of dihedral PCA eigenvectors on the
    cosine and sine coordinates. The vectors should be arranged in columns,
    as in the files output by Carma.[<A
 HREF="node250.html#Glykos2006">37</A>]

<P>
</LI>
<LI><A NAME="22099"></A>
  <B><FONT SIZE="+1"><TT>vectorNumber </TT></FONT></B> <IMG
 WIDTH="14" HEIGHT="34" ALIGN="MIDDLE" BORDER="0"
 SRC="img132.png"
 ALT="$ \langle\,$">
File containing dihedralPCA eigenvector(s)<IMG
 WIDTH="14" HEIGHT="34" ALIGN="MIDDLE" BORDER="0"
 SRC="img133.png"
 ALT="$ \,\rangle$">
 
<BR><B>Context: </B> <TT>dihedralPC</TT> 
<BR><B>Acceptable values: </B> positive integer 
<BR><B>Description: </B> Number of the eigenvector to be used for this component.
</LI>
</UL>

<P>
 
<P>
<HR>
<!--Navigation Panel-->
<A NAME="tex2html4376"
  HREF="node228.html">
<IMG WIDTH="37" HEIGHT="24" ALIGN="BOTTOM" BORDER="0" ALT="next" SRC="next.png"></A> 
<A NAME="tex2html4370"
  HREF="node226.html">
<IMG WIDTH="26" HEIGHT="24" ALIGN="BOTTOM" BORDER="0" ALT="up" SRC="up.png"></A> 
<A NAME="tex2html4364"
  HREF="node226.html">
<IMG WIDTH="63" HEIGHT="24" ALIGN="BOTTOM" BORDER="0" ALT="previous" SRC="prev.png"></A> 
<A NAME="tex2html4372"
  HREF="node1.html">
<IMG WIDTH="65" HEIGHT="24" ALIGN="BOTTOM" BORDER="0" ALT="contents" SRC="contents.png"></A> 
<A NAME="tex2html4374"
  HREF="node251.html">
<IMG WIDTH="43" HEIGHT="24" ALIGN="BOTTOM" BORDER="0" ALT="index" SRC="index.png"></A> 
<BR>
<B> Next:</B> <A NAME="tex2html4377"
  HREF="node228.html">Advanced usage and special</A>
<B> Up:</B> <A NAME="tex2html4371"
  HREF="node226.html">Collective variable components (basis</A>
<B> Previous:</B> <A NAME="tex2html4365"
  HREF="node226.html">Collective variable components (basis</A>
 &nbsp; <B>  <A NAME="tex2html4373"
  HREF="node1.html">Contents</A></B> 
 &nbsp; <B>  <A NAME="tex2html4375"
  HREF="node251.html">Index</A></B> 
<!--End of Navigation Panel-->
<ADDRESS>
vmd@ks.uiuc.edu
</ADDRESS>
</BODY>
</HTML>
