<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">

<!--Converted with LaTeX2HTML 2002-2-1 (1.71)
original version by:  Nikos Drakos, CBLU, University of Leeds
* revised and updated by:  Marcus Hennecke, Ross Moore, Herb Swan
* with significant contributions from:
  Jens Lippmann, Marek Rouchal, Martin Wilck and others -->
<HTML>
<HEAD>
<TITLE>Trajectories, Macros and Labels</TITLE>
<META NAME="description" CONTENT="Trajectories, Macros and Labels">
<META NAME="keywords" CONTENT="vmd-tutorial">
<META NAME="resource-type" CONTENT="document">
<META NAME="distribution" CONTENT="global">

<META NAME="Generator" CONTENT="LaTeX2HTML v2002-2-1">
<META HTTP-EQUIV="Content-Style-Type" CONTENT="text/css">

<LINK REL="STYLESHEET" HREF="vmd-tutorial.css">

<LINK REL="previous" HREF="node3.html">
<LINK REL="up" HREF="vmd-tutorial.html">
</HEAD>

<BODY >
<!--Navigation Panel-->
<IMG WIDTH="81" HEIGHT="24" ALIGN="BOTTOM" BORDER="0" ALT="next_inactive" SRC="nx_grp_g.gif"> 
<A NAME="tex2html100"
  HREF="vmd-tutorial.html">
<IMG WIDTH="26" HEIGHT="24" ALIGN="BOTTOM" BORDER="0" ALT="up" SRC="up.gif"></A> 
<A NAME="tex2html98"
  HREF="node3.html">
<IMG WIDTH="63" HEIGHT="24" ALIGN="BOTTOM" BORDER="0" ALT="previous" SRC="prev.gif"></A>   
<BR>
<B> Up:</B> <A NAME="tex2html101"
  HREF="vmd-tutorial.html">VMD Tutorial</A>
<B> Previous:</B> <A NAME="tex2html99"
  HREF="node3.html">Multiple Molecules and Scripting</A>
<BR>
<BR>
<!--End of Navigation Panel-->
<!--Table of Child-Links-->
<A NAME="CHILD_LINKS"><STRONG>Subsections</STRONG></A>

<UL>
<LI><A NAME="tex2html102"
  HREF="node4.html#SECTION00041000000000000000">Loading trajectories</A>
<LI><A NAME="tex2html103"
  HREF="node4.html#SECTION00042000000000000000">Macros</A>
<LI><A NAME="tex2html104"
  HREF="node4.html#SECTION00043000000000000000">Main Menu Animation Tools</A>
<LI><A NAME="tex2html105"
  HREF="node4.html#SECTION00044000000000000000">Labels</A>
<LI><A NAME="tex2html106"
  HREF="node4.html#SECTION00045000000000000000">An Example Tcl Script: Calculating the RMSD of a trajectory</A>
</UL>
<!--End of Table of Child-Links-->
<HR>

<H1><A NAME="SECTION00040000000000000000"></A>
<A NAME="unit3"></A>
<BR>
Trajectories, Macros and Labels
</H1> 

<P>
<I> In this unit, you will learn how to load trajectories, create
macros, place labels on atoms and bonds, and calculate the RMSD of a
trajectory using a simple tcl scripts.  At the end, you should determine if
the ubiquitin system is equilibrated by looking at RMSD plots.</I>

<P>

<H2><A NAME="SECTION00041000000000000000"></A>
<A NAME="load_traj"></A>
<BR>
Loading trajectories
</H2>

<P>
You will now learn to load the time evolving coordinates of a
system, called <I>trajectories</I>. You will be able to see a movie of your
system. <BR> 

<P>
Trajectory files are normally binary files that contain several
sets of coordinates for the system. Each set of coordinates corresponds to
one <I>frame</I> in time. An example of trajectory files are DCD files. The
trajectory files do not contain the information of the system contained in
the protein structure (PSF) file, so we need to load first the parameter
file, and then add the trajectory data to this file, as explained in Unit 2.  <BR> 

<P>

<DL COMPACT>
<DT><B>1</B>
<DD>Start a new VMD session. 
</DD>
</DL>

<P>

<DL COMPACT>
<DT><B>2</B>
<DD>Load the PSF file of the system <TT>ubiquitin.psf</TT>, as done in
Unit 2. 
</DD>
</DL>

<P>

<DL COMPACT>
<DT><B>3</B>
<DD>In the Molecule File Browser window, click on
the <I>Browse</I> button, making sure that <TT>ubiquitin.psf</TT> is
selected on the menu. Browse for <TT>pulling.dcd</TT>, click <I>OK</I>  and click on the <I>Load</I> button again. You will be able to see the frames as they are
loaded into the molecule. 
</DD>
</DL>

<P>

<DL COMPACT>
<DT><B>4</B>
<DD>After the trajectory finishes loading, you will be will be looking at the last frame of your trajectory. To go to the
beginning of the trajectory, you will use one of the Animation Tools, that
will be explained extensively later in the tutorial. In the <I>Main</I>
menu, click on the <IMG
  WIDTH="10" HEIGHT="10" ALIGN="BOTTOM" BORDER="0"
 SRC="./tut_start.gif"
 ALT="Image tut_start"> button in the lower left. 
</DD>
</DL>

<P>

<DL COMPACT>
<DT><B>5</B>
<DD>Choose <I>Graphics&nbsp;<IMG
 WIDTH="19" HEIGHT="15" ALIGN="BOTTOM" BORDER="0"
 SRC="img4.gif"
 ALT="$\rightarrow$">&nbsp;Representations</I> menu item. In the <I>Drawing Method</I> pulldown menu, select Tube, and in the <I>Selected Atoms</I>
window, type <TT>protein</TT>. 
</DD>
</DL>

<P>

<DL COMPACT>
<DT><B>6</B>
<DD>In the same menu item, create another representation by clicking on
the <I>Create Rep</I> button. In the <I>Drawing Method</I> pulldown menu, pick
<I>Lines</I>, and in the <I>Selected Atoms</I> window, type <TT>water</TT>. For now, turn
off this representation by double-clicking on it.  
</DD>
</DL>

<P>

  <DIV ALIGN="CENTER">
<!-- MATH
 $\fbox{
    \begin{minipage}{.2\textwidth}
      \includegraphics[width=2.3 cm, height=2.3 cm]{pictures/tut0_science}
    \end{minipage}
    \begin{minipage}[r]{.75\textwidth}
      \noindent\small\textsf{\textbf{Elastic properties of ubiquitin.} Ubiquitin has many functions in the cell. It is currently believed that some of these functions depend on the elastic properties of
ubiquitin. \\\\Only certain proteins are known to show elastic
properties. Examples of these molecules are titin, which acts like a
``spring'' in the muscle. The elastic properties of these molecules are due
to hydrogen bonding between residues in $\beta$~strands of this molecules,
like the ones in ubiquitin.\\\\The trajectory you just loaded is a
simulation of an AFM (Atomic Force Microscopy) experiment pulling on a
single ubiquitin molecule. We will look at the behavior of the protein as
it unfolds while being pulled form one end.\\\\In Molecular Dynamics,
before starting a simulation like the one shown for the AFM experiment, one
first needs to perform the equilibration of the protein. You will have a
chance to look at such an equilibration trajectory later in this tutorial.  }
    \end{minipage}
  }$
 -->
<IMG
 WIDTH="557" HEIGHT="355" ALIGN="MIDDLE" BORDER="0"
 SRC="img39.gif"
 ALT="\fbox{
\begin{minipage}{.2\textwidth}
\includegraphics[width=2.3 cm, height=2....
... at such an equilibration trajectory later in this tutorial. }
\end{minipage} }">
</DIV>

<P>
In the next section, you will learn how to create representations
with a useful feature called <I>macros</I>. Once you create some
representations relevant to this trajectory, the following section will
teach you how to use the Animation Tools to look at trajectories. <BR> 

<P>

<H2><A NAME="SECTION00042000000000000000"></A>
<A NAME="macros"></A>
<BR>
Macros
</H2>

<P>
You will now create similar representations to the ones you learned
in Unit 1.  While creating these representations, you will learn
macros. A macro is text that represents a selection. It is useful to create
macros when you use certain selections often. Macros are created with the
<TT>atomselect</TT> command you learned in unit 2. <BR> 

<P>

  <DIV ALIGN="CENTER">
<!-- MATH
 $\framebox[0.9\textwidth]{
    
  \par
\begin{tabular}{ll}
      
       {\tt atomselect macro } {\it name} {\it selection} & - -
creates a macro for {\it selection} 
    
  \end{tabular}
  }$
 -->
<IMG
 WIDTH="501" HEIGHT="30" ALIGN="BOTTOM" BORDER="0"
 SRC="img40.gif"
 ALT="\framebox[0.9\textwidth]{
\par
\begin{tabular}{ll}
{\tt atomselect macro }...
...e} {\it selection} &amp; --
creates a macro for {\it selection}
\end{tabular}
}">
</DIV>

<P>
Ubiquitin has a mixed <IMG
 WIDTH="13" HEIGHT="30" ALIGN="MIDDLE" BORDER="0"
 SRC="img13.gif"
 ALT="$\beta$">&nbsp;sheet with five strands.  The <IMG
 WIDTH="13" HEIGHT="30" ALIGN="MIDDLE" BORDER="0"
 SRC="img13.gif"
 ALT="$\beta$">&nbsp;sheet play a major role in the
unfolding of the protein. To create a macro for these strands: <BR> 

<P>

<DL COMPACT>
<DT><B>1</B>
<DD>Open the Tk Console window by choosing the <I>Main <IMG
 WIDTH="19" HEIGHT="15" ALIGN="BOTTOM" BORDER="0"
 SRC="img4.gif"
 ALT="$\rightarrow$"> Extensions <IMG
 WIDTH="19" HEIGHT="15" ALIGN="BOTTOM" BORDER="0"
 SRC="img4.gif"
 ALT="$\rightarrow$"> Tk Console.</I> 
</DD>
</DL>

<P>

<DL COMPACT>
<DT><B>2</B>
<DD>In the Tk Console window, type:

<P>
<TABLE CELLPADDING=3>
<TR><TD ALIGN="LEFT"><TT>atomselect macro bstrand1 {protein and resid 2 to 6 }</TT></TD>
<TD ALIGN="LEFT">&nbsp;</TD>
</TR>
</TABLE>
</DD>
</DL>

<P>
This will create a macro for the first <IMG
 WIDTH="13" HEIGHT="30" ALIGN="MIDDLE" BORDER="0"
 SRC="img13.gif"
 ALT="$\beta$">&nbsp;strand, which includes
  residues 2 to 6. <BR> 

<P>
For the other strands, you will find out which residues belong to
them by using the sequence viewer introduced in Unit 1, and then
create similar macros: <BR> 

<P>

<DL COMPACT>
<DT><B>3</B>
<DD>Make sure you are in the first frame of the trajectory, as STRIDE (the program that calculates secondary structure in VMD) will determine the structure on that frame. 
</DD>
</DL>

<P>

<DL COMPACT>
<DT><B>4</B>
<DD>Choose the <I>Extensions&nbsp;<IMG
 WIDTH="19" HEIGHT="15" ALIGN="BOTTOM" BORDER="0"
 SRC="img4.gif"
 ALT="$\rightarrow$">&nbsp;Sequence&nbsp;<IMG
 WIDTH="19" HEIGHT="15" ALIGN="BOTTOM" BORDER="0"
 SRC="img4.gif"
 ALT="$\rightarrow$">&nbsp;Sequence Viewer</I> menu item. 
</DD>
</DL>

<P>
As you learned in Unit 1, the second color column corresponds to
structural features of the protein. The sections in yellow correspond to the
<IMG
 WIDTH="13" HEIGHT="30" ALIGN="MIDDLE" BORDER="0"
 SRC="img13.gif"
 ALT="$\beta$">&nbsp;strands.  <BR> 

<P>

<DL COMPACT>
<DT><B>5</B>
<DD>With the mouse, click and drag to highlight the second
<IMG
 WIDTH="13" HEIGHT="30" ALIGN="MIDDLE" BORDER="0"
 SRC="img13.gif"
 ALT="$\beta$">&nbsp;strand. This action will create a representation in the <I>Graphics&nbsp;<IMG
 WIDTH="19" HEIGHT="15" ALIGN="BOTTOM" BORDER="0"
 SRC="img4.gif"
 ALT="$\rightarrow$">&nbsp;Representations</I> window. 
</DD>
</DL>

<P>

<DL COMPACT>
<DT><B>6</B>
<DD>In the <I>Graphics&nbsp;<IMG
 WIDTH="19" HEIGHT="15" ALIGN="BOTTOM" BORDER="0"
 SRC="img4.gif"
 ALT="$\rightarrow$">&nbsp;Representations</I> window, click
on the new representation. The text corresponding to the selection is
displayed on the <I>Selected Atoms</I> window. You should have <TT>(
chain U and resid 12 13 14 15 16 )</TT>. 
</DD>
</DL>

<P>

<DL COMPACT>
<DT><B>7</B>
<DD>Use this text to create a new macro by typing in the Tk Console:

<P>
<TABLE CELLPADDING=3>
<TR><TD ALIGN="LEFT"><TT>atomselect macro bstrand2 { chain U and resid 12 13 14 15 16 }</TT></TD>
<TD ALIGN="LEFT">&nbsp;</TD>
</TR>
</TABLE>
</DD>
</DL>

<P>
This will create a macro called <TT>bstrand2 </TT> that will contain residues
  12 to 16 of <TT>chain U</TT>, which corresponds to the protein. <BR> 

<P>

<DL COMPACT>
<DT><B>8</B>
<DD>Note that the sequence viewer extension locates five <IMG
 WIDTH="13" HEIGHT="30" ALIGN="MIDDLE" BORDER="0"
 SRC="img13.gif"
 ALT="$\beta$"> strands. You have created macros for the first two; create similar macros for the other three <IMG
 WIDTH="13" HEIGHT="30" ALIGN="MIDDLE" BORDER="0"
 SRC="img13.gif"
 ALT="$\beta$">&nbsp;strands
using the sequence extension as done for <TT>bstrand2</TT>. 
</DD>
</DL>

<P>
Once a macro is created, you can refer to it both in the Tk Console, and
in the <I>Representations</I> selections. <BR> 

<P>
Macros you have created and other macros that come with VMD can be
  seen in the <I>Selections </I> tab of the <I>Graphical
    Representations</I> window. The macros are listed in the <I>    Singlewords </I> window. Clicking on a macro will show its definition in
  the Macro Definition  window. Double-clicking on it will select
  it and put its definition on the <I>Selected Atoms</I> form.  <BR> 

<P>

<DL COMPACT>
<DT><B>9</B>
<DD>Delete the representation created by the sequence viewer. 
</DD>
</DL>

<P>
You will now create a representation with the third and fifth <IMG
 WIDTH="13" HEIGHT="30" ALIGN="MIDDLE" BORDER="0"
 SRC="img13.gif"
 ALT="$\beta$">&nbsp;strands: <BR>

<P>

<DL COMPACT>
<DT><B>10</B>
<DD>In the <I>Graphics&nbsp;<IMG
 WIDTH="19" HEIGHT="15" ALIGN="BOTTOM" BORDER="0"
 SRC="img4.gif"
 ALT="$\rightarrow$">&nbsp;Representations</I> menu item, click on the <I>Create Rep</I> button.  
</DD>
</DL>

<P>

<DL COMPACT>
<DT><B>11</B>
<DD>In the <I>Selected Atoms</I> window, erase the text that appears there. 
</DD>
</DL>

<P>

<DL COMPACT>
<DT><B>12</B>
<DD>Click in the <I>Selections </I> tab. Browse in the <I>Singlewords </I> form until you find your newly created macros.  
</DD>
</DL>

<P>

<DL COMPACT>
<DT><B>13</B>
<DD>Double-click on <TT>bstrand3</TT>, click the button <I>or</I> and then double-click on <TT>bstrand5</TT> (Fig.&nbsp;<A HREF="#fig:tut_macros_gui">16</A>).  Then, click on the
    <I>Apply </I> button.  
</DD>
</DL>

<P>

<DL COMPACT>
<DT><B>14</B>
<DD>In the <I>Draw Style </I> tab, choose a Cartoon representation
    for this selection and color it yellow.  You should now see the
    <IMG
 WIDTH="13" HEIGHT="30" ALIGN="MIDDLE" BORDER="0"
 SRC="img13.gif"
 ALT="$\beta$">&nbsp;sheet.  
</DD>
</DL>

<P>

<DL COMPACT>
<DT><B>15</B>
<DD>Now, create a similar representation with the other three
    <IMG
 WIDTH="13" HEIGHT="30" ALIGN="MIDDLE" BORDER="0"
 SRC="img13.gif"
 ALT="$\beta$">&nbsp;strands. Do this by clicking on the <I>Create Rep</I> button.
  Now, in the <I>Selected Atoms </I> form, type:
<BR>  <TT>bstrand1 or bstrand2 or bstrand4</TT>
<BR>
Typing them directly works too! 
</DD>
</DL>

<P>

<DIV ALIGN="CENTER"><A NAME="fig:tut_macros_gui"></A><A NAME="4338"></A>
<TABLE>
<CAPTION ALIGN="BOTTOM"><STRONG>Figure 16:</STRONG>
Macros are listed in the Selections tab of the
  Graphical Representations Menu.</CAPTION>
<TR><TD><IMG
 WIDTH="323" HEIGHT="615" BORDER="0"
 SRC="img41.gif"
 ALT="\begin{figure}\begin{center}
\includegraphics[scale=0.5]{pictures/tut_macros_gui}
\end{center}
\end{figure}"></TD></TR>
</TABLE>
</DIV>

<P>
Noticed something strange? You only see two <IMG
 WIDTH="13" HEIGHT="30" ALIGN="MIDDLE" BORDER="0"
 SRC="img13.gif"
 ALT="$\beta$">&nbsp;strands! This is because VMD does not draw <IMG
 WIDTH="13" HEIGHT="30" ALIGN="MIDDLE" BORDER="0"
 SRC="img13.gif"
 ALT="$\beta$">&nbsp;strands that are only two residues long. <TT>bstrand4</TT> contains only two residues. In other configurations of the molecule, the calculated <IMG
 WIDTH="13" HEIGHT="30" ALIGN="MIDDLE" BORDER="0"
 SRC="img13.gif"
 ALT="$\beta$">&nbsp;strand might include another residue, and then the <IMG
 WIDTH="13" HEIGHT="30" ALIGN="MIDDLE" BORDER="0"
 SRC="img13.gif"
 ALT="$\beta$">&nbsp;strand would be drawn.  <BR> 

<P>

<DL COMPACT>
<DT><B>16</B>
<DD>In the <I>Graphical Representations </I> window, choose the
representation for <TT>protein</TT>. In the <I>Atom Selections </I> window,
substitute the text <TT>protein</TT> for 
<BR><TT>protein and not betasheet.</TT> 
</DD>
</DL>
  
 As you can see, macros can be very useful. When saving your work in
a saved state, macros are included in the saved state file. <BR> 

<P>

  <DIV ALIGN="CENTER">
<!-- MATH
 $\framebox[\textwidth]{
    \begin{minipage}{.2\textwidth}
      \includegraphics[width=2.5 cm, height=1.6 cm]{pictures/tut0_infobox}
   \end{minipage}
    \begin{minipage}[r]{.75\textwidth}
      \noindent\small\textsf{\textbf{Macros.} You can create several macros and store them in a VMD preferences
file {\tt .vmdrc} in your home directory (Windows uses the file {\tt 
vmd.rc}). VMD will look for this file upon startup and will recognize all
your macros. For more information of the VMD startup files, refer to the
VMD user's guide.}
    \end{minipage}
  }$
 -->
<IMG
 WIDTH="556" HEIGHT="94" ALIGN="BOTTOM" BORDER="0"
 SRC="img42.gif"
 ALT="\framebox[\textwidth]{
\begin{minipage}{.2\textwidth}
\includegraphics[width=2...
...tion of the VMD startup files, refer to the
VMD user's guide.}
\end{minipage} }">
</DIV>

<P>
To finish this section, you will create a very interesting
representation, that shows a key feature of the trajectory we are looking
at. This is an H-bonds representation.  <BR> 

<P>

  <DIV ALIGN="CENTER">
<!-- MATH
 $\fbox{
    \begin{minipage}{.2\textwidth}
      \includegraphics[width=2.3 cm, height=2.3 cm]{pictures/tut0_science}
    \end{minipage}
    \begin{minipage}[r]{.75\textwidth}
      \noindent\small\textsf{\textbf{Hydrogen Bonds.} The H-bonds give stability to proteins in several ways. The H-bonds
between $\beta$~sheet backbone atoms are a trademark of elastic proteins;
they give these proteins stability and their formation and rupture under
mechanical stress confers them their elastic properties. }
    \end{minipage}
  }$
 -->
<IMG
 WIDTH="557" HEIGHT="131" ALIGN="MIDDLE" BORDER="0"
 SRC="img43.gif"
 ALT="\fbox{
\begin{minipage}{.2\textwidth}
\includegraphics[width=2.3 cm, height=2....
...der
mechanical stress confers them their elastic properties. }
\end{minipage} }">
</DIV>

<P>

<DL COMPACT>
<DT><B>17</B>
<DD>Create a representation with the selection <TT>betasheet and
backbone</TT>, choose the Hbonds drawing method, and color it red using the <TT>Color ID</TT> Drawing Method. In the options, set Distance Cutoff to 3.2, Angle Cutoff to 30 and Line Thickness
to 5. 
</DD>
</DL>

<P>
You can now appreciate the most important features of ubiquitin for
this unfolding trajectory. Your protein should now look similar to the one
in Fig.&nbsp;<A HREF="#fig:tut_traj_nice">17</A>. <BR> 

<P>

<DL COMPACT>
<DT><B>18</B>
<DD>Save a VMD state of this session, so if you want to come back and
keep on working in this tutorial, you don't have to work through those
representations again. Do this with the <I>File&nbsp;<IMG
 WIDTH="19" HEIGHT="15" ALIGN="BOTTOM" BORDER="0"
 SRC="img4.gif"
 ALT="$\rightarrow$">&nbsp;Save
State... </I> menu item, as done in Unit 1. 
</DD>
</DL>

<P>

  <DIV ALIGN="CENTER">
<!-- MATH
 $\framebox[\textwidth]{
    \begin{minipage}{.2\textwidth}
      \includegraphics[width=2.5 cm, height=1.6 cm]{pictures/tut0_infobox}
   \end{minipage}
    \begin{minipage}[r]{.75\textwidth}
      \noindent\small\textsf{\textbf{Reusing saved states.} When you have a saved state for a system, you can use it later
for viewing different coordinates (PDB or a different trajectory), if these
have the same PSF file. You can do this by following these steps:\\
\begin{itemize}
\item Load your saved state file: {\sf File~$\rightarrow$~Load State...}
\item Select the file you saved before (i.e. {\tt nice-ubiquitin.vmd})
\item Go to {\sf Molecule~$\rightarrow$~Delete Frames...}. You need to
delete all frames currently loaded.The default options will do that. Click
on the {\sf Delete} button.
\item Load your new file {\tt yournewtrajectory.dcd} into the PSF in {\sf 
File~$\rightarrow$~Load Data Into Molecule}.
\end{itemize}
  }
    \end{minipage}
  }$
 -->
<IMG
 WIDTH="556" HEIGHT="239" ALIGN="BOTTOM" BORDER="0"
 SRC="img44.gif"
 ALT="\framebox[\textwidth]{
\begin{minipage}{.2\textwidth}
\includegraphics[width=2...
...
File~$\rightarrow$~Load Data Into Molecule}.
\end{itemize} }
\end{minipage} }">
</DIV>

<P>

<DIV ALIGN="CENTER"><A NAME="fig:tut_traj_nice"></A><A NAME="4506"></A>
<TABLE>
<CAPTION ALIGN="BOTTOM"><STRONG>Figure 17:</STRONG>
Ubiquitin with key secondary structure features
highlighted</CAPTION>
<TR><TD><IMG
 WIDTH="441" HEIGHT="334" BORDER="0"
 SRC="img45.gif"
 ALT="\begin{figure}\begin{center}
\par
\par
\latex{
\includegraphics[scale=0.5]{pictures/tut_traj_nice}
}
\end{center}
\end{figure}"></TD></TR>
</TABLE>
</DIV>

<P>

<H2><A NAME="SECTION00043000000000000000"></A>
<A NAME="animation"></A>
<BR>
Main Menu Animation Tools
</H2>

<P>
Now that you have nice representations, you will be able to observe
features of your trajectory. The Animation Tools help you do that. The
Main Menu includes all the Animation Tools you need for navigating
through your trajectories. They are located at the bottom of the Menu
(Fig.&nbsp; <A HREF="#fig:tut_animate">18</A>).  <BR> 

<P>

<DL COMPACT>
<DT><B>1</B>
<DD>Try using the <IMG
  WIDTH="10" HEIGHT="10" ALIGN="BOTTOM" BORDER="0"
 SRC="./tut_end.gif"
 ALT="Image tut_end"> button to jump to the end of the
trajectory and go back to the beginning with the <IMG
  WIDTH="10" HEIGHT="10" ALIGN="BOTTOM" BORDER="0"
 SRC="./tut_start.gif"
 ALT="Image tut_start">
button. You can see the final and initial states of the trajectory, that
correspond to the unfolded and folded states of the protein. 
</DD>
</DL>

<P>

<DIV ALIGN="CENTER"><A NAME="fig:tut_animate"></A><A NAME="4534"></A>
<TABLE>
<CAPTION ALIGN="BOTTOM"><STRONG>Figure 18:</STRONG>
Animation Tools</CAPTION>
<TR><TD><IMG
 WIDTH="462" HEIGHT="55" BORDER="0"
 SRC="img46.gif"
 ALT="\begin{figure}\begin{center}
\par
\par
\latex{
\includegraphics[scale=0.5]{pictures/tut_animate}
}
\end{center}
\end{figure}"></TD></TR>
</TABLE>
</DIV>

<P>

<DL COMPACT>
<DT><B>2</B>
<DD>Turn on again the water representation. Go to the VMD Main window and choose 
<I>Graphics&nbsp;<IMG
 WIDTH="19" HEIGHT="15" ALIGN="BOTTOM" BORDER="0"
 SRC="img4.gif"
 ALT="$\rightarrow$">&nbsp;Representations</I> menu item.
  Double-clicking on the representation with the text <TT>water</TT> will turn
  it on. 
</DD>
</DL>

<P>
You can click on the <I>slider</I> <IMG
  WIDTH="61" HEIGHT="10" ALIGN="BOTTOM" BORDER="0"
 SRC="./tut_slider.gif"
 ALT="Image tut_slider"> and drag it
    back and forth to navigate through your trajectory. You can stop at
    anytime you want, or go at the speed you need. This is helpful when you
    are looking at a trajectory and want to spot the time when something
    interesting happens. <BR> 

<P>

<DL COMPACT>
<DT><B>3</B>
<DD>Using the slider, observe the behavior of the water around the
protein at the beginning of the trajectory. 
</DD>
</DL>

<P>

  <DIV ALIGN="CENTER">
<!-- MATH
 $\fbox{
    \begin{minipage}{.2\textwidth}
      \includegraphics[width=2.3 cm, height=2.3 cm]{pictures/tut0_science}
    \end{minipage}
    \begin{minipage}[r]{.75\textwidth}
      \noindent\small\textsf{\textbf{Minimizing free energy.}  Note how the shape of the water box changes from a cube to a
sphere. To minimize free energy, the water adopts the configuration that
exposes less surface to the vacm, that is, a sphere! Check how fast the
water comes to this configuration (Each frame step corresponds to 10 ps. )}
    \end{minipage}
  }$
 -->
<IMG
 WIDTH="557" HEIGHT="131" ALIGN="MIDDLE" BORDER="0"
 SRC="img47.gif"
 ALT="\fbox{
\begin{minipage}{.2\textwidth}
\includegraphics[width=2.3 cm, height=2....
...o this configuration (Each frame step corresponds to 10 ps. )}
\end{minipage} }">
</DIV>

<P>

<DL COMPACT>
<DT><B>4</B>
<DD>Now, remove the Water Representation from the 
Representations form by double clicking on it to be able to give the
protein a closer look. Slide through the trajectory to look at the protein
unfold. Do you notice any features?  
</DD>
</DL>

<P>

  <DIV ALIGN="CENTER">
<!-- MATH
 $\fbox{
    \begin{minipage}{.2\textwidth}
      \includegraphics[width=2.3 cm, height=2.3 cm]{pictures/tut0_science}
    \end{minipage}
    \begin{minipage}[r]{.75\textwidth}
      \noindent\small\textsf{\textbf{Breaking H-Bonds.} Look at the two yellow $\beta$~strands in the middle. They are
connected to each other with H-bonds.  Note how they are the first
$\beta$~strands to separate, this means their H-bonds are the first to
break. We will talk some more about the relevance of this phenomenon
later.}
    \end{minipage}
  }$
 -->
<IMG
 WIDTH="557" HEIGHT="131" ALIGN="MIDDLE" BORDER="0"
 SRC="img48.gif"
 ALT="\fbox{
\begin{minipage}{.2\textwidth}
\includegraphics[width=2.3 cm, height=2....
... talk some more about the relevance of this phenomenon
later.}
\end{minipage} }">
</DIV>

<P>
On the lower part of the Animation tools, you will find all
the tools necessary to play an animation without using the slider. This is
done with the <I>Play</I> buttons, that go forward and backward.  <BR> 

<P>

<DL COMPACT>
<DT><B>5</B>
<DD>Play the trajectory backwards. Do you think this is the way the
protein would fold in nature?  
</DD>
</DL>

<P>
There are two ways to change the speed of your animation. You can
adjust the speed of the play using the <I>Speed Slider</I>. You can also
adjust the step size. This is done using the <I>Step Window</I>. If this
step is set to 3, the animation will show every 3rd frame, so it will make
it faster. <BR> 

<P>

<DL COMPACT>
<DT><B>6</B>
<DD>Set the step to 5, and play the trajectory. Note that it plays
faster, but it also looks less smooth than before. However, this can come
handy if you are looking at long trajectories. 
</DD>
</DL>

<P>

  <DIV ALIGN="CENTER">
<!-- MATH
 $\framebox[\textwidth]{
    \begin{minipage}{.2\textwidth}
      \includegraphics[width=2.5 cm, height=1.6 cm]{pictures/tut0_infobox}
   \end{minipage}
    \begin{minipage}[r]{.75\textwidth}
      \noindent\small\textsf{\textbf{Looping styles.} When playing animations, you can choose between 3 looping styles
in the {Style Chooser}. These are ``Once'', ``Loop'' and ``Rock''.  A
nice trick:\\
  \begin{itemize}
    \item Go to the beggining of the trajectory (frame 0).
    \item Set the step number to the total number of frames in your
    trajectory (100).
    \item Set the style to ``Rock''.
    \item Set the speed to lowest.
    \item Play.
    \end{itemize}
    You can see now a comparison between the first and the last frame of
    your trajectory. This trick is better than clicking on the {\sf 
    Start} and {\sf End} buttons.}
    \end{minipage}
  }$
 -->
<IMG
 WIDTH="556" HEIGHT="269" ALIGN="BOTTOM" BORDER="0"
 SRC="img49.gif"
 ALT="\framebox[\textwidth]{
\begin{minipage}{.2\textwidth}
\includegraphics[width=2...
...ter than clicking on the {\sf
Start} and {\sf End} buttons.}
\end{minipage} }">
</DIV>

<P>
You can also jump to a frame in your trajectory, by entering the frame number in the window at the left of the Animation Tools. <BR> 

<P>

  <DIV ALIGN="CENTER">
<!-- MATH
 $\framebox[\textwidth]{
    \begin{minipage}{.2\textwidth}
      \includegraphics[width=2.5 cm, height=1.6 cm]{pictures/tut0_infobox}
   \end{minipage}
    \begin{minipage}[r]{.75\textwidth}
      \noindent\small\textsf{\textbf{Recalculate secondary structure.} You can ask VMD to recalculate the secondary structure for a new frame using STRIDE. This was done for Fig.~\ref{fig:tut_traj_nice}, by typing the command {\tt mol ssrecalc top} in the Tk Console, while in frame 28.}
    \end{minipage}
  }$
 -->
<IMG
 WIDTH="556" HEIGHT="83" ALIGN="BOTTOM" BORDER="0"
 SRC="img50.gif"
 ALT="% latex2html id marker 5576
\framebox[\textwidth]{
\begin{minipage}{.2\textwid...
... {\tt mol ssrecalc top} in the Tk Console, while in frame 28.}
\end{minipage} }">
</DIV>

<P>
NOTE: The Animation Tools you learned cycle through the frames of
the Top molecule, but apply to all Active molecules. <BR> 

<P>

<H2><A NAME="SECTION00044000000000000000"></A>
<A NAME="labels"></A>
<BR>
Labels
</H2>

<P>
In VMD, you can place labels to get information on a particular
selection. We will now make use of those labels for fun and profit. Labels
are selected with the mouse. In this example, we will cover labels that can
be placed on atoms and bonds, although angle and dihedral labeling are also
possible.  <BR> 

<P>

<DL COMPACT>
<DT><B>1</B>
<DD>Choose the <I>Mouse&nbsp;<IMG
 WIDTH="19" HEIGHT="15" ALIGN="BOTTOM" BORDER="0"
 SRC="img4.gif"
 ALT="$\rightarrow$">&nbsp;Labels&nbsp;<IMG
 WIDTH="19" HEIGHT="15" ALIGN="BOTTOM" BORDER="0"
 SRC="img4.gif"
 ALT="$\rightarrow$">&nbsp;Atoms </I>
menu item.
  The mouse is now set to ``Display Label for Atom'' mode.  You can now
  click on any atom on your molecule and a label will be placed into this
  atom. Clicking again on it will erase the label. 
</DD>
</DL>

<P>
We will now try the same for bonds.  <BR> 

<P>

<DL COMPACT>
<DT><B>2</B>
<DD>Choose the <I>Mouse&nbsp;<IMG
 WIDTH="19" HEIGHT="15" ALIGN="BOTTOM" BORDER="0"
 SRC="img4.gif"
 ALT="$\rightarrow$">&nbsp;Label&nbsp;<IMG
 WIDTH="19" HEIGHT="15" ALIGN="BOTTOM" BORDER="0"
 SRC="img4.gif"
 ALT="$\rightarrow$">&nbsp;Bonds </I>
menu item. This selects the ``Display Label for Bond'' mode. 
</DD>
</DL>

<P>
You will make a VDW Representation for the <IMG
 WIDTH="13" HEIGHT="13" ALIGN="BOTTOM" BORDER="0"
 SRC="img17.gif"
 ALT="$\alpha$">&nbsp;carbon of Lysine 48 and of the C terminus. In the pulling simulation, the former is kept fixed, and
  the latter is pulled at constant force of 500 pN.  <BR> 

<P>

  <DIV ALIGN="CENTER">
<!-- MATH
 $\fbox{
    \begin{minipage}{.2\textwidth}
      \includegraphics[width=2.3 cm, height=2.3 cm]{pictures/tut0_science}
    \end{minipage}
    \begin{minipage}[r]{.75\textwidth}
      \noindent\small\textsf{\textbf{Residue K48.} As you learned in Unit 1, polyubiquitin chains can be linked by a connection between the C terminus of one ubiquitin molecule and residue K48 of the next. The simulation then mimic the effect of pulling on the C terminus with this kind of linkage.}
    \end{minipage}
  }$
 -->
<IMG
 WIDTH="557" HEIGHT="131" ALIGN="MIDDLE" BORDER="0"
 SRC="img51.gif"
 ALT="\fbox{
\begin{minipage}{.2\textwidth}
\includegraphics[width=2.3 cm, height=2....
...ffect of pulling on the C terminus with this kind of linkage.}
\end{minipage} }">
</DIV>

<P>
To find out the index of these atoms: <BR> 

<P>

<DL COMPACT>
<DT><B>3</B>
<DD>Make a selection including these two atoms, by typing in the Tk Console:
<BR><TT>set sel [atomselect top "resid 48 76 and name CA"]</TT> 
</DD>
</DL>

<P>

<DL COMPACT>
<DT><B>4</B>
<DD>Get the indices:
<BR><TT>$sel get index</TT> 
</DD>
</DL>

<P>
This command should give the indices <TT>770 1242</TT>. <BR> 

<P>

  <DIV ALIGN="CENTER">
<!-- MATH
 $\framebox[\textwidth]{
    \begin{minipage}{.2\textwidth}
      \includegraphics[width=2.5 cm, height=1.6 cm]{pictures/tut0_infobox}
   \end{minipage}
    \begin{minipage}[r]{.75\textwidth}
      \noindent\small\textsf{\textbf{PDB and VMD atom numbering.} Note that the atom number of these atoms in the pdb file is 771
and 1243. VMD starts counting the {\tt index} from zero, so the text in the
Representation should be the numbers that VMD understands. This is only the
case for index, since VMD does not read them from the PDB file. Other
keywords, such as residue, are consistent with the PDB file.}
    \end{minipage}
  }$
 -->
<IMG
 WIDTH="556" HEIGHT="110" ALIGN="BOTTOM" BORDER="0"
 SRC="img52.gif"
 ALT="\framebox[\textwidth]{
\begin{minipage}{.2\textwidth}
\includegraphics[width=2...
...
keywords, such as residue, are consistent with the PDB file.}
\end{minipage} }">
</DIV>

<P>

<DL COMPACT>
<DT><B>5</B>
<DD>Create a VDW Representation with selection <TT>index 770 1242</TT>. 
</DD>
</DL>

<P>

<DL COMPACT>
<DT><B>6</B>
<DD>Now that you can see them, click on both atoms (one after the
other). You should get a line connecting the two atoms. The number
appearing next to the line is the distance between the two atoms in
angstroms (Fig.&nbsp; <A HREF="#fig:tut_bond_dist">19</A>).  
</DD>
</DL>

<P>

<DIV ALIGN="CENTER"><A NAME="fig:tut_bond_dist"></A><A NAME="4741"></A>
<TABLE>
<CAPTION ALIGN="BOTTOM"><STRONG>Figure 19:</STRONG>
Bond selection of fixed and pulled atom in
simulation. Both atoms selected display labels in black. The bond is shown
in blue, with the value of the distance between the atoms in angstroms
displayed.</CAPTION>
<TR><TD><IMG
 WIDTH="732" HEIGHT="480" BORDER="0"
 SRC="img53.gif"
 ALT="\begin{figure}\begin{center}
\par
\par
\latex{
\includegraphics[scale=0.5]{pictures/tut_bond_dist}
}
\end{center}
\end{figure}"></TD></TR>
</TABLE>
</DIV>

<P>
The value of the distance corresponds to the current frame. <BR> 

<P>

  <DIV ALIGN="CENTER">
<!-- MATH
 $\framebox[\textwidth]{
    \begin{minipage}{.2\textwidth}
      \includegraphics[width=2.5 cm, height=1.6 cm]{pictures/tut0_infobox}
   \end{minipage}
    \begin{minipage}[r]{.75\textwidth}
      \noindent\small\textsf{\textbf{Labels.} The shortcut keys for labels are {\tt 1}: Atoms and {\tt 2}:
  Bonds. You can use these instead of the {\sf Mouse} menu. Be sure the Open GL display window is active when using these shortcuts. }
    \end{minipage}
  }$
 -->
<IMG
 WIDTH="556" HEIGHT="83" ALIGN="BOTTOM" BORDER="0"
 SRC="img54.gif"
 ALT="\framebox[\textwidth]{
\begin{minipage}{.2\textwidth}
\includegraphics[width=2...
...Open GL display window is active when using these shortcuts. }
\end{minipage} }">
</DIV>

<P>

<DL COMPACT>
<DT><B>7</B>
<DD>There are more things you can do with labels, in the <I>Graphics&nbsp;<IMG
 WIDTH="19" HEIGHT="15" ALIGN="BOTTOM" BORDER="0"
 SRC="img4.gif"
 ALT="$\rightarrow$">&nbsp;Labels</I> menu item. In the left side of the window (Fig.&nbsp;<A HREF="#fig:tut_label_window">20</A>),
there is a pull-down menu where you can choose the type of label (Atoms,
Bonds, Angles, Dihedrals). For now, keep it in <I>Atoms</I>. You can see the list
of atoms for which you made a label.  
</DD>
</DL>

<P>

<DIV ALIGN="CENTER"><A NAME="fig:tut_label_window"></A><A NAME="4777"></A>
<TABLE>
<CAPTION ALIGN="BOTTOM"><STRONG>Figure 20:</STRONG>
Label window.</CAPTION>
<TR><TD><IMG
 WIDTH="370" HEIGHT="359" BORDER="0"
 SRC="img55.gif"
 ALT="\begin{figure}\begin{center}
\par
\par
\latex{
\includegraphics[scale=0.5]{pictures/tut_label_window}
}
\end{center}
\end{figure}"></TD></TR>
</TABLE>
</DIV>

<P>

<DL COMPACT>
<DT><B>8</B>
<DD>Click on one of the atoms. You can see all the information of the
  atom displayed. You can delete, hide, or
  show the label by clicking on these buttons.  
</DD>
</DL>

<P>
Note that this information is useful to make selections. The
information about the atom corresponds to the current frame, and is updated
as the frame is changed. <BR> 

<P>

<DL COMPACT>
<DT><B>9</B>
<DD>Now, in the Label window, choose the label type <I>Bonds</I>, and select the bond you labeled.  Note
that the information given corresponds to only the first atom in the bond,
but the number in the <I>Value</I> field corresponds to the length of the
bond in angstroms. Click on the <I>Graph</I> tab. Select the bond you labeled between atoms
770 and 1242. Click on the <I>Graph </I> button. This will create the
plot of the distance between these two atoms over time. You can also save
this data to a file by clicking on the <I>Save</I> button.  
</DD>
</DL>

<P>

  <DIV ALIGN="CENTER">
<!-- MATH
 $\framebox[\textwidth]{
    \begin{minipage}{.2\textwidth}
      \includegraphics[width=2.5 cm, height=1.6 cm]{pictures/tut0_infobox}
   \end{minipage}
    \begin{minipage}[r]{.75\textwidth}
      \noindent\small\textsf{\textbf{xmgrace.} VMD uses the 2-D plotting program xmgrace. This program is
  available from  http://plasma-gate.weizmann.ac.il/Grace/. In Mac OSX, xmgrace
  runs in the X11 environment. Make sure X11 is running in order for xmgrace to
  start. }
    \end{minipage}
  }$
 -->
<IMG
 WIDTH="556" HEIGHT="83" ALIGN="BOTTOM" BORDER="0"
 SRC="img56.gif"
 ALT="\framebox[\textwidth]{
\begin{minipage}{.2\textwidth}
\includegraphics[width=2...
...nt. Make sure X11 is running in order for xmgrace to
start. }
\end{minipage} }">
</DIV>

<P>

<DL COMPACT>
<DT><B>10</B>
<DD>You can now close <TT>xmgrace</TT>. 
</DD>
</DL>

<P>

<DIV ALIGN="CENTER"><A NAME="fig:tut_bond_plot"></A><A NAME="4830"></A>
<TABLE>
<CAPTION ALIGN="BOTTOM"><STRONG>Figure 21:</STRONG>
Label window Plot of selected bond over time
created with the Graph button. </CAPTION>
<TR><TD><IMG
 WIDTH="720" HEIGHT="720" BORDER="0"
 SRC="img57.gif"
 ALT="\begin{figure}\begin{center}
\par
\par
\latex{
\includegraphics[scale=0.5]{pictures/tut_bond_plot}
}
\end{center}
\end{figure}"></TD></TR>
</TABLE>
</DIV>

<P>

  <DIV ALIGN="CENTER">
<!-- MATH
 $\fbox{
    \begin{minipage}{.2\textwidth}
      \includegraphics[width=2.3 cm, height=2.3 cm]{pictures/tut0_science}
    \end{minipage}
    \begin{minipage}[r]{.75\textwidth}
      \noindent\small\textsf{\textbf{Ubiquitin unfolding.} The plot displayed shows the length of the bond over time. You can think of it as a plot of the ``length'' of the molecule, as it is
pulled at constant force.\\Note that at the beginning of the curve,  the curve is flattening, like if the pulling did not affect the structure of the molecule, and suddenly, the distance increases a lot. Take a look
at the time this occurs: when the two yellow $\beta$~strands separated! This
means that, those H-bonds that keep the $\beta$~strands together provide an
initial resistance to the unfolding of the protein, and once they are
broken, the protein unfolds in a more regular way. Try identifying what happens in the second jump. You will have identified key features of ubiquitin unfolding!}
    \end{minipage}
  }$
 -->
<IMG
 WIDTH="557" HEIGHT="232" ALIGN="MIDDLE" BORDER="0"
 SRC="img58.gif"
 ALT="\fbox{
\begin{minipage}{.2\textwidth}
\includegraphics[width=2.3 cm, height=2....
...You will have identified key features of ubiquitin unfolding!}
\end{minipage} }">
</DIV>

<P>

<H2><A NAME="SECTION00045000000000000000"></A>
<A NAME="rmsd"></A>
<BR>
An Example Tcl Script: Calculating the RMSD of a trajectory
</H2>

<P>
VMD is a powerful tool for MD analysis. In this section you will
use tcl scripts to perform analysis of trajectories. You will load a new
trajectory, the equilibration of the ubiquitin system. You will use a short
script to calculate the RMSD of the protein during the MD run, and
determine if the system is equilibrated and ready to simulate. <BR> 

<P>

  <DIV ALIGN="CENTER">
<!-- MATH
 $\fbox{
    \begin{minipage}{.2\textwidth}
      \includegraphics[width=2.3 cm, height=2.3 cm]{pictures/tut0_science}
    \end{minipage}
    \begin{minipage}[r]{.75\textwidth}
      \noindent\small\textsf{\textbf{Root Mean Square Deviation.} The Root Mean Squared Deviation (RMSD) is a numerical measure of the difference between two structures.  It is defined as : \\
  \begin{equation}
    RMSD = \sqrt{\frac{\sum_{i=1}^{N_{atoms}}{(r_{i}(t_{1})-r_{i}(t_{2}))^2}}{N_{atoms}}}
  \end{equation}\\
where $N_{atoms}$\  is the number of atoms whose positions are being compared, and $r_{i}(t)$\  is the position of atom $i$\  at time $t$\  (or, if you are comparing two molecules, like in Unit 2, $t$\  labels the molecules).}
    \end{minipage}
  }$
 -->
<IMG
 WIDTH="557" HEIGHT="204" ALIGN="MIDDLE" BORDER="0"
 SRC="img59.gif"
 ALT="\fbox{
\begin{minipage}{.2\textwidth}
\includegraphics[width=2.3 cm, height=2....
...ng two molecules, like in Unit 2, $t$\ labels the molecules).}
\end{minipage} }">
</DIV>

<P>

<DL COMPACT>
<DT><B>1</B>
<DD>Delete the current trajectory. Select the only molecule by clicking it on the <I>Main</I> window. Go to <I>Molecule&nbsp; <IMG
 WIDTH="19" HEIGHT="15" ALIGN="BOTTOM" BORDER="0"
 SRC="img4.gif"
 ALT="$\rightarrow$">&nbsp;Delete Frames...</I>. The default values on this window
will delete the whole trajectory. Click on the <I>Delete</I> button. 
</DD>
</DL>

<P>

<DL COMPACT>
<DT><B>2</B>
<DD>Load the equilibration trajectory into the psf file by going to the
<I>File&nbsp;<IMG
 WIDTH="19" HEIGHT="15" ALIGN="BOTTOM" BORDER="0"
 SRC="img4.gif"
 ALT="$\rightarrow$">&nbsp;Load Data Into Molecule</I>. The file is <TT>equilibration.dcd</TT>. 
</DD>
</DL>

<P>

<DL COMPACT>
<DT><B>3</B>
<DD>Turn on the water representation and take a look at the trajectory with the
Animation tools that you learned before.  
</DD>
</DL>

<P>

  <DIV ALIGN="CENTER">
<!-- MATH
 $\fbox{
    \begin{minipage}{.2\textwidth}
      \includegraphics[width=2.3 cm, height=2.3 cm]{pictures/tut0_science}
    \end{minipage}
    \begin{minipage}[r]{.75\textwidth}
      \noindent\small\textsf{\textbf{Equilibration.} The trajectory you loaded is the equilibration of the ubiquitin
and water system. In reality, this trajectory was simulated before the
pulling trajectory you saw before. In MD, a system must be equilibrated
first to have the stability necessary to observe other features related to
the system and not to changes in the environment. \\\\Is there anything
you can say about this trajectory? Everything seems to be moving around
randomly. Note how the water comes closer to the protein filling in the
gaps, and the size of the water box decreases to obtain the right water
density. }
    \end{minipage}
  }$
 -->
<IMG
 WIDTH="557" HEIGHT="197" ALIGN="MIDDLE" BORDER="0"
 SRC="img60.gif"
 ALT="\fbox{
\begin{minipage}{.2\textwidth}
\includegraphics[width=2.3 cm, height=2....
...f the water box decreases to obtain the right water
density. }
\end{minipage} }">
</DIV>

<P>
Now you will find out how to determine if the protein is
equilibrated. One important factor to determine this is looking at the RMSD
of a protein in a trajectory. <BR> 

<P>

<DL COMPACT>
<DT><B>4</B>
<DD>The script we are going to use is called <TT>rmsd.tcl</TT>. This is
the script content:
<BR>
<P>

<P>
<TABLE CELLPADDING=3>
<TR><TD ALIGN="LEFT"><TT>set outfile [open rmsd.dat w]</TT></TD>
<TD ALIGN="LEFT">&nbsp;</TD>
</TR>
<TR><TD ALIGN="LEFT"><TT>set nf
[molinfo top get numframes]</TT></TD>
<TD ALIGN="LEFT">&nbsp;</TD>
</TR>
<TR><TD ALIGN="LEFT"><TT>set frame0 [atomselect top "protein
and backbone and noh" frame 0]</TT></TD>
<TD ALIGN="LEFT">&nbsp;</TD>
</TR>
<TR><TD ALIGN="LEFT"><TT># rmsd calculation loop</TT></TD>
<TD ALIGN="LEFT">&nbsp;</TD>
</TR>
<TR><TD ALIGN="LEFT"><TT>for
{ set i 1 } { $i <IMG
 WIDTH="15" HEIGHT="29" ALIGN="MIDDLE" BORDER="0"
 SRC="img61.gif"
 ALT="$\leq$"> $nf } { incr i } { </TT></TD>
<TD ALIGN="LEFT">&nbsp;</TD>
</TR>
<TR><TD ALIGN="LEFT"><TABLE CELLPADDING=3>
<TR><TD ALIGN="LEFT"><TT>set sel [atomselect top "protein and backbone and noh" frame $i] </TT></TD>
<TD ALIGN="LEFT">&nbsp;</TD>
</TR>
<TR><TD ALIGN="LEFT"><TT>set all [atomselect top all frame $i]</TT></TD>
<TD ALIGN="LEFT">&nbsp;</TD>
</TR>
<TR><TD ALIGN="LEFT"><TT>$all move [measure fit $sel $frame0]</TT></TD>
<TD ALIGN="LEFT">&nbsp;</TD>
</TR>
<TR><TD ALIGN="LEFT"><TT>puts
     $outfile "[measure rmsd $sel $frame0]"</TT></TD>
<TD ALIGN="LEFT">&nbsp;</TD>
</TR>
</TABLE></TD>
<TD ALIGN="LEFT">&nbsp;</TD>
</TR>
<TR><TD ALIGN="LEFT"><TT><IMG
 WIDTH="11" HEIGHT="32" ALIGN="MIDDLE" BORDER="0"
 SRC="img62.gif"
 ALT="$\}$"> </TT></TD>
<TD ALIGN="LEFT">&nbsp;</TD>
</TR>
<TR><TD ALIGN="LEFT"><TT>close $outfile</TT></TD>
<TD ALIGN="LEFT">&nbsp;</TD>
</TR>
</TABLE>
</DD>
</DL>

<P>

<DL COMPACT>
<DT><B>5</B>
<DD>The script does the following:

<P>

<UL>
<LI>Open file <TT>rmsd.dat</TT> for writing

<P>

<P>
<TABLE CELLPADDING=3>
<TR><TD ALIGN="LEFT"><TT>set outfile [open rmsd.dat w]</TT></TD>
<TD ALIGN="LEFT">&nbsp;</TD>
</TR>
</TABLE>

<BR>
<P>
</LI>
<LI>Get the number of frames in the trajectory and assign this value to
  the variable <TT>nf</TT> 
  
<P>
<TABLE CELLPADDING=3>
<TR><TD ALIGN="LEFT"><TT>set nf [molinfo top get numframes]</TT></TD>
<TD ALIGN="LEFT">&nbsp;</TD>
</TR>
</TABLE>
 
<BR>
<P>
</LI>
<LI>Select the first frame of the molecule to be the one other frames
  will compare to. The selection contains the atoms in the backbone of
  the protein, excluding hydrogens:

<P>

<P>
<TABLE CELLPADDING=3>
<TR><TD ALIGN="LEFT"><TT>set frame0 [atomselect top "protein and
      backbone and noh" frame 0]</TT></TD>
<TD ALIGN="LEFT">&nbsp;</TD>
</TR>
</TABLE>

<BR>
<P>
</LI>
<LI>Text after <TT>#</TT> denotes comment.

<P>

<P>
<TABLE CELLPADDING=3>
<TR><TD ALIGN="LEFT"><TT># rmsd calculation loop</TT></TD>
<TD ALIGN="LEFT">&nbsp;</TD>
</TR>
</TABLE>

<BR>
<P>
</LI>
<LI>Loop over all frames in the trajectory:

<P>

<P>
<TABLE CELLPADDING=3>
<TR><TD ALIGN="LEFT"><TT>for { set i 1 } { $i <IMG
 WIDTH="15" HEIGHT="29" ALIGN="MIDDLE" BORDER="0"
 SRC="img61.gif"
 ALT="$\leq$"> $nf } { incr
      i } { </TT></TD>
<TD ALIGN="LEFT">&nbsp;</TD>
</TR>
</TABLE>

<BR>
<P>
</LI>
<LI>Make the same selection as before for the current frame (the
  frame to be compared).

<P>

<P>
<TABLE CELLPADDING=3>
<TR><TD ALIGN="LEFT"><TT>set sel [atomselect top "protein and backbone
      and noh" frame $i] </TT></TD>
<TD ALIGN="LEFT">&nbsp;</TD>
</TR>
</TABLE>

<BR>
<P>
</LI>
<LI>Make a selection with all atoms

<P>

<P>
<TABLE CELLPADDING=3>
<TR><TD ALIGN="LEFT"><TT>set all [atomselect top all frame $i]</TT></TD>
<TD ALIGN="LEFT">&nbsp;</TD>
</TR>
</TABLE>
 
<BR>
<P>
</LI>
<LI>Calculate the matrix that will fit both selections. Apply this
    matrix to the second selection to align the molecules:

<P>

<P>
<TABLE CELLPADDING=3>
<TR><TD ALIGN="LEFT"><TT>$all move [measure fit $sel $frame0]</TT></TD>
<TD ALIGN="LEFT">&nbsp;</TD>
</TR>
</TABLE>

<BR>
<P>
</LI>
<LI>Calculate the RMSD value between these two selections, and write
    it to file: 
  
<P>
<TABLE CELLPADDING=3>
<TR><TD ALIGN="LEFT"><TT>puts $outfile "[measure rmsd $sel
        $frame0]"</TT></TD>
<TD ALIGN="LEFT">&nbsp;</TD>
</TR>
</TABLE>

<BR>
<P>
</LI>
</UL>
</DD>
</DL>

<P>
You can use the script for the system to test for equilibration.  <BR> 

<P>

<DL COMPACT>
<DT><B>6</B>
<DD>Type <TT>source rmsd.tcl</TT> in the Tk Console. This will perform
  all the commands in the script. The script will write a file <TT>    rmsd.dat</TT> that will contain the value of the RMSD of the protein
  backbone against time.  
</DD>
</DL>

<P>
Outside of VMD, you can use some plotting program to see this data.
  Examples of these are gnuplot, xmgrace, excel, Mathematica. <BR> 

<P>

<DL COMPACT>
<DT><B>7</B>
<DD>Use one of the above programs to plot the file <TT>rmsd.dat</TT> (For
  example, in Unix, you can type <TT>xmgrace rmsd.dat</TT> in a terminal). Can
  you see the RMSD curve flattening? This means your system is
  equilibrated! 
</DD>
</DL>

<P>

  <DIV ALIGN="CENTER">
<!-- MATH
 $\framebox[\textwidth]{
    \begin{minipage}{.2\textwidth}
      \includegraphics[width=2.5 cm, height=1.6 cm]{pictures/tut0_infobox}
   \end{minipage}
    \begin{minipage}[r]{.75\textwidth}
      \noindent\small\textsf{\textbf{More RMSD.} You can try sourcing another script called {\tt 
    rmsd-fullthrottle.tcl} Take a look at this script to learn simple
  procedures in tcl, as well as calculating the RMSD of each residue over
  time and coloring residues according to their RMSD similarly that in Unit
  \ref{unit2}.}
    \end{minipage}
  }$
 -->
<IMG
 WIDTH="556" HEIGHT="91" ALIGN="BOTTOM" BORDER="0"
 SRC="img63.gif"
 ALT="% latex2html id marker 5914
\framebox[\textwidth]{
\begin{minipage}{.2\textwid...
... according to their RMSD similarly that in Unit
\ref{unit2}.}
\end{minipage} }">
</DIV>

<P>
This ends the VMD tutorial. We hope that you learned a lot with
  it, and that you will make a great use of all the capabilities VMD has to
  offer.  <BR> 
<BR>
<P>

<P>
<HR>
<!--Navigation Panel-->
<IMG WIDTH="81" HEIGHT="24" ALIGN="BOTTOM" BORDER="0" ALT="next_inactive" SRC="nx_grp_g.gif"> 
<A NAME="tex2html100"
  HREF="vmd-tutorial.html">
<IMG WIDTH="26" HEIGHT="24" ALIGN="BOTTOM" BORDER="0" ALT="up" SRC="up.gif"></A> 
<A NAME="tex2html98"
  HREF="node3.html">
<IMG WIDTH="63" HEIGHT="24" ALIGN="BOTTOM" BORDER="0" ALT="previous" SRC="prev.gif"></A>   
<BR>
<B> Up:</B> <A NAME="tex2html101"
  HREF="vmd-tutorial.html">VMD Tutorial</A>
<B> Previous:</B> <A NAME="tex2html99"
  HREF="node3.html">Multiple Molecules and Scripting</A>
<!--End of Navigation Panel-->
<ADDRESS>
vmd@ks.uiuc.edu
</ADDRESS>
</BODY>
</HTML>
