<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">

<!--Converted with LaTeX2HTML 2002-2-1 (1.71)
original version by:  Nikos Drakos, CBLU, University of Leeds
* revised and updated by:  Marcus Hennecke, Ross Moore, Herb Swan
* with significant contributions from:
  Jens Lippmann, Marek Rouchal, Martin Wilck and others -->
<HTML>
<HEAD>
<TITLE>Multiple Molecules and Scripting</TITLE>
<META NAME="description" CONTENT="Multiple Molecules and Scripting">
<META NAME="keywords" CONTENT="vmd-tutorial">
<META NAME="resource-type" CONTENT="document">
<META NAME="distribution" CONTENT="global">

<META NAME="Generator" CONTENT="LaTeX2HTML v2002-2-1">
<META HTTP-EQUIV="Content-Style-Type" CONTENT="text/css">

<LINK REL="STYLESHEET" HREF="vmd-tutorial.css">

<LINK REL="next" HREF="node4.html">
<LINK REL="previous" HREF="node2.html">
<LINK REL="up" HREF="vmd-tutorial.html">
<LINK REL="next" HREF="node4.html">
</HEAD>

<BODY >
<!--Navigation Panel-->
<A NAME="tex2html88"
  HREF="node4.html">
<IMG WIDTH="37" HEIGHT="24" ALIGN="BOTTOM" BORDER="0" ALT="next" SRC="next.gif"></A> 
<A NAME="tex2html86"
  HREF="vmd-tutorial.html">
<IMG WIDTH="26" HEIGHT="24" ALIGN="BOTTOM" BORDER="0" ALT="up" SRC="up.gif"></A> 
<A NAME="tex2html80"
  HREF="node2.html">
<IMG WIDTH="63" HEIGHT="24" ALIGN="BOTTOM" BORDER="0" ALT="previous" SRC="prev.gif"></A>   
<BR>
<B> Next:</B> <A NAME="tex2html89"
  HREF="node4.html">Trajectories, Macros and Labels</A>
<B> Up:</B> <A NAME="tex2html87"
  HREF="vmd-tutorial.html">VMD Tutorial</A>
<B> Previous:</B> <A NAME="tex2html81"
  HREF="node2.html">Basics of VMD</A>
<BR>
<BR>
<!--End of Navigation Panel-->
<!--Table of Child-Links-->
<A NAME="CHILD_LINKS"><STRONG>Subsections</STRONG></A>

<UL>
<LI><A NAME="tex2html90"
  HREF="node3.html#SECTION00031000000000000000">Loading Multiple Molecules</A>
<LI><A NAME="tex2html91"
  HREF="node3.html#SECTION00032000000000000000">Using the Main Window</A>
<LI><A NAME="tex2html92"
  HREF="node3.html#SECTION00033000000000000000">Tcl Scripting Basics and Tk Console</A>
<LI><A NAME="tex2html93"
  HREF="node3.html#SECTION00034000000000000000">The <TT>atomselect</TT> Command</A>
<LI><A NAME="tex2html94"
  HREF="node3.html#SECTION00035000000000000000">Aligning Two Molecules</A>
<LI><A NAME="tex2html95"
  HREF="node3.html#SECTION00036000000000000000">Using Color to Display the Deviation</A>
</UL>
<!--End of Table of Child-Links-->
<HR>

<H1><A NAME="SECTION00030000000000000000"></A>
<A NAME="unit2"></A>
<BR>
Multiple Molecules and Scripting
</H1>

<P>
<I>In this unit, you will learn to deal with multiple molecules simultaneously. You will also cover the basics of Tcl scripting and use it to edit atomic data, align two molecules together and color a molecule according to calculated properties.</I>

<P>

<DL COMPACT>
<DT><B>1</B>
<DD>Start with a new VMD session. If you have just completed unit 1, you should quit VMD and then launch it again. 
</DD>
</DL>

<P>

<H2><A NAME="SECTION00031000000000000000">
Loading Multiple Molecules</A>
</H2>

<P>
First, you will load the molecules that you will need. <BR> 

<P>

<DL COMPACT>
<DT><B>1</B>
<DD>Open the Molecule File Browser from the <I>File&nbsp;<IMG
 WIDTH="19" HEIGHT="15" ALIGN="BOTTOM" BORDER="0"
 SRC="img4.gif"
 ALT="$\rightarrow$"> New&nbsp;Molecule...</I> menu item. 
</DD>
</DL>

<P>
You need to load the X-ray crystal structure of ubiquitin. You can do
  this in the same way you did in Unit 1, or directly in the command line: <BR> 

<P>

<DL COMPACT>
<DT><B>2</B>
<DD>In the VMD terminal, type <TT>mol new 1UBQ.pdb</TT>. 
</DD>
</DL>

<P>
An equilibration simulation for ubiquitin solvated in a water box has
  been performed previously for a duration of 1&nbsp;ns. Your files contain the
  coordinates of the last frame of this equilibration. You will now compare the conformation of ubiquitin at the end of this simulation with the initial crystal structure. <BR> 

<P>

  <DIV ALIGN="CENTER">
<!-- MATH
 $\framebox[\textwidth]{
    \begin{minipage}{.2\textwidth}
      \includegraphics[width=2.5 cm, height=1.6 cm]{pictures/tut0_infobox}
   \end{minipage}
    \begin{minipage}[r]{.75\textwidth}
      \noindent\small\textsf{\textbf{Coordinate files and structure files.} To save space, simulation output files usually contain only the atom coordinates and do not store unchanging information such as the atom types, atom charge, segment names and bonds. The latter information is stored in a separate ``structure" file (\emph{e.g.}, a PSF file). To visualize the results of a simulation, you need to merge both a structure and a coordinate file into the same molecule.}
    \end{minipage}
  }$
 -->
<IMG
 WIDTH="556" HEIGHT="126" ALIGN="BOTTOM" BORDER="0"
 SRC="img21.gif"
 ALT="\framebox[\textwidth]{
\begin{minipage}{.2\textwidth}
\includegraphics[width=2...
...oth a structure and a coordinate file into the same molecule.}
\end{minipage} }">
</DIV>

<P>

<DL COMPACT>
<DT><B>3</B>
<DD>Now, start loading the simulation results into a second molecule. Staying in the Molecule File Browser, select <I>New Molecule</I> from the menu at the top of the form. Browse for the file <TT>ubiquitin.psf</TT>,  then click on the <I>Load</I> button. You have just created a new molecule with a structure but no coordinates. 
</DD>
</DL>

<P>

<DL COMPACT>
<DT><B>4</B>
<DD>Notice that the menu at the top of the window now says <I>1:&nbsp;ubiquitin.psf</I>. This ensures that the next file that you load will be added to that molecule (molecule ID 1). Now, browse for the file <TT>ubiquitin-equilibrated.coor</TT> and click on <I>Load</I> again. This will load the coordinates and merge them with the previously loaded structure information. 
</DD>
</DL>

<P>
You should now see two superimposed and unaligned molecules. One is the original crystal ubiquitin. The other one is surrounded by a cube full of water molecules. <BR> 

<P>

<H2><A NAME="SECTION00032000000000000000">
Using the Main Window</A>
</H2>

<P>
You will now give names to your molecules so that you can identify them later. <BR> 

<P>

<DL COMPACT>
<DT><B>1</B>
<DD>Double-click on the first molecule in the Main window molecule listing. The Rename Molecule dialog box should pop up. Type in <TT>crystal</TT>. Do the same thing for the second molecule, and call it <TT>simulation</TT>. 
</DD>
</DL>

<P>
At this point, your Main window should look like Fig.&nbsp;<A HREF="#fig:tut_main_form_2mols">9</A>. In front of the molecule name, there are four letters that you can use to manipulate your molecules. <BR> 

<P>

<DIV ALIGN="CENTER"><A NAME="fig:tut_main_form_2mols"></A><A NAME="2475"></A>
<TABLE>
<CAPTION ALIGN="BOTTOM"><STRONG>Figure 9:</STRONG>
Main window with initial and final coordinates loaded into two separate molecules.</CAPTION>
<TR><TD><IMG
 WIDTH="462" HEIGHT="217" BORDER="0"
 SRC="img22.gif"
 ALT="\begin{figure}\begin{center}
\par
\par
\latex{
\includegraphics[scale=0.5]{pictures/tut2_main_2mols}
}
\end{center}
\end{figure}"></TD></TR>
</TABLE>
</DIV>

<P>
 <I>F</I> stands for ``Fixed," meaning that that molecule won't move when you move the scene around. When the <I>F</I> is black, the molecule is fixed; when it is grayed out, the molecule is mobile. <BR> 

<P>

<DL COMPACT>
<DT><B>2</B>
<DD>Double-click on the <I>F</I> to the left of a molecule description in the Main form. Then, try translating the scene with the mouse while one molecule is fixed. Do it again with both molecules fixed. 
</DD>
</DL>

<P>

<DL COMPACT>
<DT><B>3</B>
<DD>When you are done, <B>unfix both molecules</B> and select the <I>Display&nbsp;<IMG
 WIDTH="19" HEIGHT="15" ALIGN="BOTTOM" BORDER="0"
 SRC="img4.gif"
 ALT="$\rightarrow$"> Reset&nbsp;View</I> menu item to correctly reposition the two molecules relative to each other. 
</DD>
</DL>

<P>

<DL COMPACT>
<DT><B>4</B>
<DD>Next, double-click on the <I>D</I> of one molecule. The <I>D</I> stands for ``Displayed" and when the <I>D</I> is grayed out it means that the molecule is hidden. You can control the visibility of all your molecules by double-clicking here. 
</DD>
</DL>

<P>

<DL COMPACT>
<DT><B>5</B>
<DD>When you are done, make sure that only the <TT>crystal</TT> molecule is ``Displayed" and that none of the molecules are ``Fixed." 
</DD>
</DL>

<P>

<DL COMPACT>
<DT><B>6</B>
<DD>Finally, double-click under the <I>T</I> column to the left of the <TT>crystal</TT> molecule. The letter <I>T</I> should now appear in front of it. This makes it the unique ``top" molecule. Making a molecule top makes it a target for scripting commands. 
</DD>
</DL>

<P>

<H2><A NAME="SECTION00033000000000000000">
Tcl Scripting Basics and Tk Console</A>
</H2>

<P>
VMD includes support for the Tcl/Tk scripting language. This section will attempt to 
provide the minimal amount of scripting that you need to know to use very useful features. <BR> 

<P>

  <DIV ALIGN="CENTER">
<!-- MATH
 $\framebox[\textwidth]{
    \begin{minipage}{.2\textwidth}
      \includegraphics[width=2.5 cm, height=1.6 cm]{pictures/tut0_infobox}
   \end{minipage}
    \begin{minipage}[r]{.75\textwidth}
      \noindent\small\textsf{\textbf{The Tcl/Tk scripting language.} Tcl is a rich language that contains many other features and commands than those seen above, in addition to the typical conditional and looping expressions. Tk is an extension to Tcl that permits the writing of user interfaces with windows and buttons, \emph{etc}. More information and docs about the Tcl/Tk language can be found at \htmladdnormallink{http://www.tcl.tk/doc}{http://www.tcl.tk/doc/}. }
    \end{minipage}
  }$
 -->
<IMG
 WIDTH="556" HEIGHT="113" ALIGN="BOTTOM" BORDER="0"
 SRC="img23.gif"
 ALT="\framebox[\textwidth]{
\begin{minipage}{.2\textwidth}
\includegraphics[width=2...
...ddnormallink{http://www.tcl.tk/doc}{http://www.tcl.tk/doc/}. }
\end{minipage} }">
</DIV>

<P>
To execute Tcl commands, you will be using a convenient text console called <I>Tk Console</I>. <BR> 

<P>

<DL COMPACT>
<DT><B>1</B>
<DD>Select the <I>Extensions&nbsp;<IMG
 WIDTH="19" HEIGHT="15" ALIGN="BOTTOM" BORDER="0"
 SRC="img4.gif"
 ALT="$\rightarrow$"> Tk Console</I> menu item. A console window should appear with a prompt (Fig.&nbsp;<A HREF="#fig:tut_tkcon">10</A>). You can now start entering Tcl/Tk commands in it. 
</DD>
</DL>

<P>

<DIV ALIGN="CENTER"><A NAME="fig:tut_tkcon"></A><A NAME="2567"></A>
<TABLE>
<CAPTION ALIGN="BOTTOM"><STRONG>Figure 10:</STRONG>
The Tk Console console.</CAPTION>
<TR><TD><IMG
 WIDTH="501" HEIGHT="237" BORDER="0"
 SRC="img24.gif"
 ALT="\begin{figure}\begin{center}
\par
\par
\latex{
\includegraphics[scale=0.5]{pictures/tut2_tkcon}
}
\end{center}
\end{figure}"></TD></TR>
</TABLE>
</DIV>

<P>
You will initially focus on the very basic of Tcl/Tk. Here are Tcl's <TT>set</TT> and <TT>get</TT> commands: <BR> 

<P>

  <DIV ALIGN="CENTER">
<!-- MATH
 $\framebox[0.9\textwidth]{
    
  \par
\begin{tabular}{ll}
      
      
    {\tt set} {\it variable} {\it value} & - - sets the value of {\it variable}  \\
    {\tt puts} {\tt \$}{\it variable} & - - prints out the value of {\it variable}
    
  \end{tabular}

  }$
 -->
<IMG
 WIDTH="501" HEIGHT="49" ALIGN="BOTTOM" BORDER="0"
 SRC="img25.gif"
 ALT="\framebox[0.9\textwidth]{
\par
\begin{tabular}{ll}
{\tt set} {\it variab...
...}{\it variable} &amp; -- prints out the value of {\it variable}
\end{tabular}
}">
</DIV>

<P>

<DL COMPACT>
<DT><B>2</B>
<DD>Try the following commands:

<P>
<TABLE CELLPADDING=3>
<TR><TD ALIGN="LEFT"><TT>set x 10</TT></TD>
<TD ALIGN="LEFT">&nbsp;</TD>
</TR>
<TR><TD ALIGN="LEFT"><TT>puts "the value of x is: $x" </TT></TD>
<TD ALIGN="LEFT">&nbsp;</TD>
</TR>
<TR><TD ALIGN="LEFT"><TT>set text "some text"</TT></TD>
<TD ALIGN="LEFT">&nbsp;</TD>
</TR>
<TR><TD ALIGN="LEFT"><TT>puts "the value of text is: $text."</TT></TD>
<TD ALIGN="LEFT">&nbsp;</TD>
</TR>
</TABLE>
</DD>
</DL>

<P>
As you can see, <TT>$</TT><I>variable</I> refers to the value of <I>variable</I>. <BR> 

<P>
Here is a command that performs mathematical operations: <BR> 

<P>

  <DIV ALIGN="CENTER">
<!-- MATH
 $\framebox[0.9\textwidth]{
    
  \par
\begin{tabular}{ll}
      
      
    {\tt expr} {\it expression} & - - evaluates a mathematical expression 
    
  \end{tabular}

  }$
 -->
<IMG
 WIDTH="501" HEIGHT="30" ALIGN="BOTTOM" BORDER="0"
 SRC="img26.gif"
 ALT="\framebox[0.9\textwidth]{
\par
\begin{tabular}{ll}
{\tt expr} {\it expression} &amp; -- evaluates a mathematical expression
\end{tabular}
}">
</DIV>

<P>

<DL COMPACT>
<DT><B>3</B>
<DD>Try experimenting with the <TT>expr</TT> command:

<P>
<TABLE CELLPADDING=3>
<TR><TD ALIGN="LEFT"><TT>expr 3 - 8</TT></TD>
<TD ALIGN="LEFT">&nbsp;</TD>
</TR>
<TR><TD ALIGN="LEFT"><TT>set x 10</TT></TD>
<TD ALIGN="LEFT">&nbsp;</TD>
</TR>
<TR><TD ALIGN="LEFT"><TT>expr - 3 * $x</TT></TD>
<TD ALIGN="LEFT">&nbsp;</TD>
</TR>
</TABLE>
</DD>
</DL>

<P>
One of the most important aspects of Tcl is that you can embed Tcl commands into others by using brackets. A bracketed expression will automatically be substituted by the return value of the expression inside the brackets: <BR> 

<P>

  <DIV ALIGN="CENTER">
<!-- MATH
 $\framebox[0.9\textwidth]{
    
  \par
\begin{tabular}{ll}
      
      
    {\tt [{\rm \it expr.}]} & - - represents the result of the expression inside the brackets 
    
  \end{tabular}

  }$
 -->
<IMG
 WIDTH="501" HEIGHT="30" ALIGN="BOTTOM" BORDER="0"
 SRC="img27.gif"
 ALT="\framebox[0.9\textwidth]{
\par
\begin{tabular}{ll}
{\tt [{\rm \it expr.}...
...epresents the result of the expression inside the brackets
\end{tabular}
}">
</DIV>

<P>

<DL COMPACT>
<DT><B>4</B>
<DD>Create some commands using brackets and test them. Here is an example:

<P>
<TABLE CELLPADDING=3>
<TR><TD ALIGN="LEFT"><TT>set result [ expr -3 * $x ]</TT></TD>
<TD ALIGN="LEFT">&nbsp;</TD>
</TR>
<TR><TD ALIGN="LEFT"><TT>puts $result</TT></TD>
<TD ALIGN="LEFT">&nbsp;</TD>
</TR>
</TABLE>
</DD>
</DL>

<P>

<H2><A NAME="SECTION00034000000000000000">
The <TT>atomselect</TT> Command</A>
</H2>

<P>
You can edit atomic properties using VMD's <TT>atomselect</TT> command. The following examples will show you how. <BR> 

<P>

<DL COMPACT>
<DT><B>1</B>
<DD>After making sure that the <TT>crystal</TT> molecule is the top molecule (if not, double-click on <I>T</I>). Open the Representations window using the <I>Graphics&nbsp;<IMG
 WIDTH="19" HEIGHT="15" ALIGN="BOTTOM" BORDER="0"
 SRC="img4.gif"
 ALT="$\rightarrow$"> Representations...</I> menu item. 
</DD>
</DL>

<P>

  <DIV ALIGN="CENTER">
<!-- MATH
 $\framebox[\textwidth]{
    \begin{minipage}{.2\textwidth}
      \includegraphics[width=2.5 cm, height=1.6 cm]{pictures/tut0_infobox}
   \end{minipage}
    \begin{minipage}[r]{.75\textwidth}
      \noindent\small\textsf{\textbf{The PDB B-factor field.} The ``B" field of a PDB file typically stores the ``temperature factor" for a crystal structure and is read into VMD's ``Beta" field. Since we are not currently interested in this information, we can recycle this field to store our own numerical values. VMD has a ``Beta" coloring mode, which you will soon use, and which colors atoms according to their B-factors. Thus, by replacing the Beta values for various atoms, you can control the color in which they are drawn. This is very useful when you want to show a property of the system that you have computed and which is not supported out-of-the-box by VMD.}
    \end{minipage}
  }$
 -->
<IMG
 WIDTH="556" HEIGHT="181" ALIGN="BOTTOM" BORDER="0"
 SRC="img28.gif"
 ALT="\framebox[\textwidth]{
\begin{minipage}{.2\textwidth}
\includegraphics[width=2...
...ve computed and which is not supported out-of-the-box by VMD.}
\end{minipage} }">
</DIV>

<P>

<DL COMPACT>
<DT><B>2</B>
<DD>Select the molecule called ``crystal" in the <I>Selected Molecule</I> pop-up menu at the top of the form. Type in <TT>protein</TT> as the atom selection, change its coloring method to <I>Beta</I> and its drawing method to <I>VDW</I>. Your molecule should now appear as a mostly red and green assembly of spheres. 
</DD>
</DL>

<P>
You will now learn a very important Tcl command in VMD: <BR> 

<P>

  <DIV ALIGN="CENTER">
<!-- MATH
 $\framebox[0.9\textwidth]{
    
  \par
\begin{tabular}{ll}
      
      
    {\tt atomselect} {\it molid} {\it selection} & - - creates a new atom selection
    
  \end{tabular}

  }$
 -->
<IMG
 WIDTH="501" HEIGHT="30" ALIGN="BOTTOM" BORDER="0"
 SRC="img29.gif"
 ALT="\framebox[0.9\textwidth]{
\par
\begin{tabular}{ll}
{\tt atomselect} {\it molid} {\it selection} &amp; -- creates a new atom selection
\end{tabular}
}">
</DIV>

<P>
The first argument to <TT>atomselect</TT> is the molecule ID (shown to the very left of the Main form), the second argument is a textual atom selection like what you have been using to describe graphical reps in unit 1. The selection returned by <TT>atomselect</TT> is itself a command which you will learn to use. <BR>  

<P>

<DL COMPACT>
<DT><B>3</B>
<DD>Type <TT>set crystal [atomselect top "all"]</TT> in the Tk Console window. This creates a selection containing all the atoms in the molecule and assigns it to the variable <TT>crystal</TT>. Instead of a molecule ID (which is a number), we have used the shortcut ``<TT>top</TT>" to refer to the top molecule. 
</DD>
</DL>

<P>
The result of <TT>atomselect</TT> is a function. Thus, <TT>$crystal</TT> is now a function that performs actions on the contents of the ``all" selection. <BR> 

<P>

<DL COMPACT>
<DT><B>4</B>
<DD>Type <TT>$crystal num</TT>. Passing <TT>num</TT> to an atom selection returns the number of atoms in that selection. Check that this number matches the number of atoms for that molecule (as read from the Main form). 
</DD>
</DL>

<P>

<DL COMPACT>
<DT><B>5</B>
<DD>Type <TT>$crystal set beta 0</TT>. This resets the ``beta" field (which is being displayed) to be zero for all atoms. As you do this, you should observe that the atoms on your screen will suddenly change to a uniform color (since they all have the same beta values). 
</DD>
</DL>

<P>
Atom selections are just references to the atoms in the original molecule. When you change a property (<I>e.g.</I> beta value) of some atoms through a selection, that change is reflected in all the other selections that contain those atoms. <BR> 

<P>

<DL COMPACT>
<DT><B>6</B>
<DD>Now, type <TT>set sel [atomselect top "hydrophobic"]</TT>. This creates a selection containing all the hydrophobic residues. 
</DD>
</DL>

<P>

<DL COMPACT>
<DT><B>7</B>
<DD>Let's label all hydrophobic atoms by setting their beta values to  1. You should know how to do this now: <TT>$sel set beta 1</TT>. If the colors in the OpenGL Display do not get updated, click on the <I>Apply</I> button at the bottom of the Representations form. 
</DD>
</DL>

<P>

  <DIV ALIGN="CENTER">
<!-- MATH
 $\framebox[\textwidth]{
    \begin{minipage}{.2\textwidth}
      \includegraphics[width=2.5 cm, height=1.6 cm]{pictures/tut0_infobox}
   \end{minipage}
    \begin{minipage}[r]{.75\textwidth}
      \noindent\small\textsf{\textbf{Examples of atomic properties.} You can get and set many atomic properties using atom selections, including segment, residue and atom names, position (x, y and z), charge, mass, occupancy and radius, just to name a few.}
    \end{minipage}
  }$
 -->
<IMG
 WIDTH="556" HEIGHT="83" ALIGN="BOTTOM" BORDER="0"
 SRC="img30.gif"
 ALT="\framebox[\textwidth]{
\begin{minipage}{.2\textwidth}
\includegraphics[width=2...
...d z), charge, mass, occupancy and radius, just to name a few.}
\end{minipage} }">
</DIV>

<P>

<DL COMPACT>
<DT><B>8</B>
<DD>You will now change a physical property of the atoms to further illustrate the distribution of hydrophobic residues. Type <TT>$crystal set radius 1.0</TT> to make all the atoms smaller and easier to see through, and then <TT>$sel set radius 1.5</TT> to make the hydrophobic residues larger. The radius field affects the way that some representations (<I>e.g.,</I> VDW, CPK) are drawn. 
</DD>
</DL>

<P>
You have now created a visual state that clearly distinguishes which parts of the protein are hydrophobic and which are hydrophilic. If you have followed the instructions correctly, your protein should resemble Fig.&nbsp;<A HREF="#fig:tut2_hydrophobicity">11</A>. <BR> 

<P>

<DIV ALIGN="CENTER"><A NAME="fig:tut2_hydrophobicity"></A><A NAME="2805"></A>
<TABLE>
<CAPTION ALIGN="BOTTOM"><STRONG>Figure 11:</STRONG>
Ubiquitin in the VDW representation, colored according to the hydrophobicity of its residues.</CAPTION>
<TR><TD><IMG
 WIDTH="467" HEIGHT="318" BORDER="0"
 SRC="img31.gif"
 ALT="\begin{figure}\begin{center}
\par
\par
\latex{
\includegraphics[scale=0.5]{pictures/tut2_hydrophobicity}
}
\end{center}
\end{figure}"></TD></TR>
</TABLE>
</DIV>

<P>

  <DIV ALIGN="CENTER">
<!-- MATH
 $\fbox{
    \begin{minipage}{.2\textwidth}
      \includegraphics[width=2.3 cm, height=2.3 cm]{pictures/tut0_science}
    \end{minipage}
    \begin{minipage}[r]{.75\textwidth}
      \noindent\small\textsf{\textbf{Hydrophobic residues.} As you probably noticed in your rendering of ubiquitin, the hydrophobic residues are almost exclusively contained in the inner core of the protein. This is typical for small water-soluble proteins. As the protein folds, the hydrophylic residues will have a tendency to stay at the water interface, while the hydrophobic residues are pushed together and play a structural role. This helps the protein achieve proper folding and increases it's stability.}
    \end{minipage}
  }$
 -->
<IMG
 WIDTH="557" HEIGHT="145" ALIGN="MIDDLE" BORDER="0"
 SRC="img32.gif"
 ALT="\fbox{
\begin{minipage}{.2\textwidth}
\includegraphics[width=2.3 cm, height=2....
... protein achieve proper folding and increases it's stability.}
\end{minipage} }">
</DIV>

<P>
Atom selections are useful not only for setting atomic data, but also for getting information. Let's say that you wish to communicate which residues are hydrophobic, all you need to do is to create a hydrophobic selection and use <TT>get</TT> instead of <TT>set</TT>. <BR> 

<P>

<DL COMPACT>
<DT><B>9</B>
<DD>Use <TT>get</TT> with your hydrophobic <TT>sel</TT> atom selection:

<P>
<TABLE CELLPADDING=3>
<TR><TD ALIGN="LEFT"><TT>$sel get resname</TT></TD>
<TD ALIGN="LEFT">&nbsp;</TD>
</TR>
</TABLE>
</DD>
</DL>

<P>
But there is a problem! Each residue contain many atoms, resulting in multiple repeated entries. Can you think of a way to circumvent this? We know that each amino-acid residue have the same backbone atoms. If you pick only one of these atoms per residue, each residue will be present only once in your selection. <BR> 

<P>

<DL COMPACT>
<DT><B>10</B>
<DD>Let's try this solution. Each residue has one and only one <IMG
 WIDTH="13" HEIGHT="13" ALIGN="BOTTOM" BORDER="0"
 SRC="img17.gif"
 ALT="$\alpha$">-carbon (<TT>name&nbsp;CA</TT> = <TT>alpha</TT>):

<P>
<TABLE CELLPADDING=3>
<TR><TD ALIGN="LEFT"><TT>set sel [atomselect top "hydrophobic and alpha"]</TT></TD>
<TD ALIGN="LEFT">&nbsp;</TD>
</TR>
<TR><TD ALIGN="LEFT"><TT>$sel get resname</TT></TD>
<TD ALIGN="LEFT">&nbsp;</TD>
</TR>
</TABLE>
</DD>
</DL>

<P>
Aha! It worked. <BR> 

<P>

<DL COMPACT>
<DT><B>11</B>
<DD>You can also get multiple properties simultaneously. Try the following:

<P>
<TABLE CELLPADDING=3>
<TR><TD ALIGN="LEFT"><TT>$sel get resid</TT></TD>
<TD ALIGN="LEFT">&nbsp;</TD>
</TR>
<TR><TD ALIGN="LEFT"><TT>$sel get {resname resid}</TT></TD>
<TD ALIGN="LEFT">&nbsp;</TD>
</TR>
<TR><TD ALIGN="LEFT"><TT>$sel get {x y z}</TT></TD>
<TD ALIGN="LEFT">&nbsp;</TD>
</TR>
</TABLE>
</DD>
</DL>

<P>

<H2><A NAME="SECTION00035000000000000000">
Aligning Two Molecules</A>
</H2>

<P>
To properly visualize how ubiquitin has evolved during the simulation, you must first make sure to spatially superimpose your two molecules as best as you can. VMD offers some convenient commands to do this. You will now color the two molecules differently to visually distinguish them. <BR> 

<P>

<DL COMPACT>
<DT><B>1</B>
<DD>Make sure that both molecules are ``Displayed" (by double-clicking on <I>D</I> in the Main form). 
</DD>
</DL>

<P>

<DL COMPACT>
<DT><B>2</B>
<DD>In the Graphical Representations window, change the representation for the <TT>crystal</TT> molecule (remember to select it from the menu at the top of the window). Set its coloring method to <I>ColorID</I>, its color to <I>0&nbsp;blue</I> and its drawing method to <I>Tube</I>. 
</DD>
</DL>

<P>

<DL COMPACT>
<DT><B>3</B>
<DD>You can apply changes to different molecules in the Graphical Representations window by selecting the target molecule from the <I>Selected Molecule</I> menu at the very top of the window. Choose the same representation for the molecule called <TT>simulation</TT> (<I>ColorID</I> and <I>Tube</I>), but set its color to <I>1&nbsp;red</I> instead. 
</DD>
</DL>

<P>

<DL COMPACT>
<DT><B>4</B>
<DD>Create two atom selections containing the protein backbone <IMG
 WIDTH="13" HEIGHT="13" ALIGN="BOTTOM" BORDER="0"
 SRC="img17.gif"
 ALT="$\alpha$">-carbons (using the <TT>alpha</TT> atom selection macro) for each molecule by typing in the Tk Console window:

<P>
<TABLE CELLPADDING=3>
<TR><TD ALIGN="LEFT"><TT>set alpha1 [atomselect 0 "alpha"]</TT></TD>
<TD ALIGN="LEFT">&nbsp;</TD>
</TR>
<TR><TD ALIGN="LEFT"><TT>set alpha2 [atomselect 1 "alpha"]</TT></TD>
<TD ALIGN="LEFT">&nbsp;</TD>
</TR>
</TABLE>
</DD>
</DL>

<P>
Here we have selected the <IMG
 WIDTH="13" HEIGHT="13" ALIGN="BOTTOM" BORDER="0"
 SRC="img17.gif"
 ALT="$\alpha$">-carbons because they are more stable than the protein's floppy side-chains and give a good indication of the protein's spatial conformation. <BR> 

<P>
Even though the two molecules are very different (the crystal structure has no hydrogens), the selections that you created both contain the exact same atoms. VMD provides a command - <TT>measure fit</TT> - for finding the best fit between two selections corresponding to the same atoms: <BR> 

<P>

  <DIV ALIGN="CENTER">
<!-- MATH
 $\framebox[0.9\textwidth]{
    
  \par
\begin{tabular}{ll}
      
      
    {\tt measure fit} {\it atomsel1} {\it atomsel2} & - - calculates the best fit matrix 
    
  \end{tabular}

  }$
 -->
<IMG
 WIDTH="501" HEIGHT="30" ALIGN="BOTTOM" BORDER="0"
 SRC="img33.gif"
 ALT="\framebox[0.9\textwidth]{
\par
\begin{tabular}{ll}
{\tt measure fit} {\i...
...omsel1} {\it atomsel2} &amp; -- calculates the best fit matrix
\end{tabular}
}">
</DIV>

<P>

<DL COMPACT>
<DT><B>5</B>
<DD>Find the transformation matrix <TT>M</TT> that will best map the first selection onto the second by typing:

<P>
<TABLE CELLPADDING=3>
<TR><TD ALIGN="LEFT"><TT>set M [measure fit $alpha1 $alpha2]</TT></TD>
<TD ALIGN="LEFT">&nbsp;</TD>
</TR>
</TABLE>
</DD>
</DL>

<P>

<DL COMPACT>
<DT><B>6</B>
<DD>Apply the matrix you just found to the entire initial molecule (you had previously defined an atom selection called <TT>crystal</TT> for this), by typing:

<P>
<TABLE CELLPADDING=3>
<TR><TD ALIGN="LEFT"><TT>$crystal move $M</TT></TD>
<TD ALIGN="LEFT">&nbsp;</TD>
</TR>
</TABLE>
</DD>
</DL>

<P>
In the OpenGL window, the two molecules should now be aligned based on
  the positions of their <IMG
 WIDTH="13" HEIGHT="13" ALIGN="BOTTOM" BORDER="0"
 SRC="img17.gif"
 ALT="$\alpha$">-carbons. It is to be noticed that some parts
  of the molecule are well-aligned, whereas other dangling ends and loops seem
  more floppy (they have moved more during the equilibration). You can realign
  the molecules by repeating the alignment process using the <IMG
 WIDTH="13" HEIGHT="13" ALIGN="BOTTOM" BORDER="0"
 SRC="img17.gif"
 ALT="$\alpha$">-carbons for
  the the rigid residues only (in this case, the <IMG
 WIDTH="13" HEIGHT="30" ALIGN="MIDDLE" BORDER="0"
 SRC="img13.gif"
 ALT="$\beta$">&nbsp;strands and the <IMG
 WIDTH="13" HEIGHT="13" ALIGN="BOTTOM" BORDER="0"
 SRC="img17.gif"
 ALT="$\alpha$">&nbsp;helix). The final result would resemble Fig.&nbsp;<A HREF="#fig:tut_ubiquitin_aligned">12</A>. <BR> 

<P>

<DIV ALIGN="CENTER"><A NAME="fig:tut_ubiquitin_aligned"></A><A NAME="2982"></A>
<TABLE>
<CAPTION ALIGN="BOTTOM"><STRONG>Figure 12:</STRONG>
Initial and final states of ubiquitin after spatial alignment.</CAPTION>
<TR><TD><IMG
 WIDTH="480" HEIGHT="306" BORDER="0"
 SRC="img34.gif"
 ALT="\begin{figure}\begin{center}
\par
\par
\latex{
\includegraphics[scale=0.5]{pictures/tut2_ubiquitin_aligned}
}
\end{center}
\end{figure}"></TD></TR>
</TABLE>
</DIV>

<P>

<H2><A NAME="SECTION00036000000000000000">
Using Color to Display the Deviation</A>
</H2>

<P>
Once the two molecules are aligned, you can compare their atoms' positions. To do this, you will use a pre-written script (since it is slightly complex). Feel free to have a look at the script if you feel adventurous; as you become experienced, writing such scripts will become trivial. To run a script from a file, you can use Tcl's <TT>source</TT> command: <BR> 

<P>

  <DIV ALIGN="CENTER">
<!-- MATH
 $\framebox[0.9\textwidth]{
    
  \par
\begin{tabular}{ll}
      
      
  {\tt source} {\it file} & - - runs a script from a text file 
    
  \end{tabular}

  }$
 -->
<IMG
 WIDTH="501" HEIGHT="30" ALIGN="BOTTOM" BORDER="0"
 SRC="img35.gif"
 ALT="\framebox[0.9\textwidth]{
\par
\begin{tabular}{ll}
{\tt source} {\it file} &amp; -- runs a script from a text file
\end{tabular}
}">
</DIV>

<P>

<DL COMPACT>
<DT><B>1</B>
<DD>The script is in the <TT>coloring.tcl</TT> file. It will change the <TT>crystal</TT> molecule's beta values to reflect the displacement (in &#197;) of each atom of the molecule after equilibration. Let's run the script by typing:

<P>
<TABLE CELLPADDING=3>
<TR><TD ALIGN="LEFT"><TT>source coloring.tcl</TT></TD>
<TD ALIGN="LEFT">&nbsp;</TD>
</TR>
</TABLE>
</DD>
</DL>

<P>

<DL COMPACT>
<DT><B>2</B>
<DD>To see the new beta values, you need to set the <I>Coloring Style</I> of the <TT>crystal</TT> molecule to <I>Beta</I>, and hide the <TT>simulation</TT> molecule (by double-clicking on <I>D</I>).
 
</DD>
</DL>

<P>
The <TT>crystal</TT> molecule should now be colored according to the total displacement that occurred during the simulation. To have a better idea of what went on, we would like to adjust the color scale in a useful way. <BR> 

<P>

<DL COMPACT>
<DT><B>3</B>
<DD>In the Graphical Representations window, choose the <I>Trajectory</I> tab. Under the <I>Color Scale Range</I> label, you can set the minimum and maximum values used for the beta values color scale. Make sure that the right representation (of the <TT>crystal</TT> molecule) is selected, then enter <TT>0</TT> and <TT>5</TT> and click on <I>Set</I>. This sets the color range to scale between 0 and 5&nbsp;&#197;. 
</DD>
</DL>

<P>

<DIV ALIGN="CENTER"><A NAME="fig:tut_colorscale"></A><A NAME="3047"></A>
<TABLE>
<CAPTION ALIGN="BOTTOM"><STRONG>Figure 13:</STRONG>
The Color Range controls in the Representations window.</CAPTION>
<TR><TD><IMG
 WIDTH="313" HEIGHT="75" BORDER="0"
 SRC="img36.gif"
 ALT="\begin{figure}\begin{center}
\par
\par
\latex{
\includegraphics[scale=0.5]{pictures/tut2_colorrange}
}
\end{center}
\end{figure}"></TD></TR>
</TABLE>
</DIV>

<P>

<DL COMPACT>
<DT><B>4</B>
<DD>Now, bring up the Color Controls window (Fig. <A HREF="#fig:tut_colorscale">14</A>) by choosing the <I>Graphics&nbsp;<IMG
 WIDTH="19" HEIGHT="15" ALIGN="BOTTOM" BORDER="0"
 SRC="img4.gif"
 ALT="$\rightarrow$"> Colors...</I> menu item from the VMD Main window. Then select the <I>Color Scale</I> tab. 
</DD>
</DL>

<P>

<DIV ALIGN="CENTER"><A NAME="fig:tut_colorscale"></A><A NAME="3070"></A>
<TABLE>
<CAPTION ALIGN="BOTTOM"><STRONG>Figure 14:</STRONG>
The Color Controls window showing the <I>Color Scale</I> tab.</CAPTION>
<TR><TD><IMG
 WIDTH="370" HEIGHT="330" BORDER="0"
 SRC="img37.gif"
 ALT="\begin{figure}\begin{center}
\par
\par
\latex{
\includegraphics[scale=0.5]{pictures/tut2_colorscale}
}
\end{center}
\end{figure}"></TD></TR>
</TABLE>
</DIV>

<P>

<DL COMPACT>
<DT><B>5</B>
<DD>In the color scale <I>Method</I> menu, select the <I>BWR</I> color scheme. This will show residues with a low displacement (0&nbsp;&#197;) in blue, those with a high displacement (5&nbsp;&#197;) in red, and those in between as white. 
</DD>
</DL>

<P>

<DL COMPACT>
<DT><B>6</B>
<DD>You can now also adjust the color scale <I>Midpoint</I> to shift the level of atomic displacement that will be assigned to white. Try assigning a midpoint of <TT>0.1</TT>. 
</DD>
</DL>

<P>
You have now seen how to manipulate continuous color scales on custom data. Look at your molecule (it should resemble Fig.&nbsp;<A HREF="#fig:tut2_ubiquitin_dispcolor">15</A>). You should now be able to determine which parts of ubiquitin are stable (blue) and which are floppy (red). In general, the dangling ends and loops are flexible, whereas the helices and <IMG
 WIDTH="13" HEIGHT="30" ALIGN="MIDDLE" BORDER="0"
 SRC="img13.gif"
 ALT="$\beta$">&nbsp;strands are much more rigid. <BR> 

<P>

<DIV ALIGN="CENTER"><A NAME="fig:tut2_ubiquitin_dispcolor"></A><A NAME="3103"></A>
<TABLE>
<CAPTION ALIGN="BOTTOM"><STRONG>Figure 15:</STRONG>
Ubiquitin colored according to displacement after a 1&nbsp;ns equilibration.</CAPTION>
<TR><TD><IMG
 WIDTH="482" HEIGHT="328" BORDER="0"
 SRC="img38.gif"
 ALT="\begin{figure}\begin{center}
\par
\par
\latex{
\includegraphics[scale=0.5]{pictures/tut2_ubiquitin_colordisp}
}
\end{center}
\end{figure}"></TD></TR>
</TABLE>
</DIV>

<P>

<P>
 
<P>
<HR>
<!--Navigation Panel-->
<A NAME="tex2html88"
  HREF="node4.html">
<IMG WIDTH="37" HEIGHT="24" ALIGN="BOTTOM" BORDER="0" ALT="next" SRC="next.gif"></A> 
<A NAME="tex2html86"
  HREF="vmd-tutorial.html">
<IMG WIDTH="26" HEIGHT="24" ALIGN="BOTTOM" BORDER="0" ALT="up" SRC="up.gif"></A> 
<A NAME="tex2html80"
  HREF="node2.html">
<IMG WIDTH="63" HEIGHT="24" ALIGN="BOTTOM" BORDER="0" ALT="previous" SRC="prev.gif"></A>   
<BR>
<B> Next:</B> <A NAME="tex2html89"
  HREF="node4.html">Trajectories, Macros and Labels</A>
<B> Up:</B> <A NAME="tex2html87"
  HREF="vmd-tutorial.html">VMD Tutorial</A>
<B> Previous:</B> <A NAME="tex2html81"
  HREF="node2.html">Basics of VMD</A>
<!--End of Navigation Panel-->
<ADDRESS>
vmd@ks.uiuc.edu
</ADDRESS>
</BODY>
</HTML>
