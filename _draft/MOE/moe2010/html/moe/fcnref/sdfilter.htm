<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
"http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">

<!--
!!    MOE 2010.10 On-Line Manuals
!!    COPYRIGHT (C) 2010
!!        CHEMICAL COMPUTING GROUP INC.  ALL RIGHTS RESERVED.
!!-->

<!--
!!    	sdfilter.htm
!!
!!	28-oct-2009 (pl) add note on don,acc different from descriptors
!!    	18-jul-2008 (pl) added -svl, -desc, -numfield
!!    	28-aug-2007 (ac) minor revisions
!!    	21-may-2005 (pl) created
!!-->
 
<head>
<link rel="stylesheet" type="text/css"
href="../../manstyle.css" />


<title>sdfilter</title>
<meta functions sdfilter>
</head>

<body bgcolor="#ffffff">
<a href="../../index.htm"><img src="../../images/logo.gif"
alt="CCG Logo" align="right" width="174" height="55" border="0" /></a>
<h4>MOE 2010.10</h4>
<h2>sdfilter</h2>
<hr noshade="noshade" />

<h2>Syntax</h2>
<blockquote>
    <tt>$MOE/bin/sdfilter</tt>
    <b>{</b> <i>option</i> | <i>inputfilename</i> | @<i>filename</i> <b>}*</b>
    <br />
    <tt>$MOE/bin/moebatch -run $MOE/bin/sdfilter</tt>
    <b>{</b> <i>option</i> | <i>inputfilename</i> | @<i>filename</i> <b>}*</b>
    <br />
    <br />
    <tt>%MOE%\sdfilter</tt>
    <b>{</b> <i>option</i> | <i>inputfilename</i> | @<i>filename</i> <b>}*</b>
    <br />
    <tt>%MOE%\bin-i4w9\moebatch -run $MOE\bin\sdfilter</tt>
    <b>{</b> <i>option</i> | <i>inputfilename</i> | @<i>filename</i> <b>}*</b>
    <p>

<table>
    <tr>
    <td valign="baseline"><i>option</i>
    <td valign="baseline">&nbsp;:&nbsp;
	  <td valign="baseline"><tt>-o</tt> <i>outputfilename</i>
	      | <tt>-f</tt> <i>filterfilename</i>

    <tr><td valign="baseline">&nbsp;<td valign="baseline">&nbsp;:&nbsp;<td valign="baseline"><tt>-help
    
    <tr><td valign="baseline">&nbsp;<td valign="baseline">&nbsp;:&nbsp;<td valign="baseline"><tt>-verbose</tt> | <tt>-quiet</tt>
    
    <tr><td valign="baseline">&nbsp;<td valign="baseline">&nbsp;:&nbsp;<td valign="baseline"><tt>-annotate</tt>

    <tr><td valign="baseline">&nbsp;<td valign="baseline">&nbsp;:&nbsp;<td valign="baseline"><tt>-stripdata</tt>

    <tr><td valign="baseline">&nbsp;<td valign="baseline">&nbsp;:&nbsp;<td valign="baseline"><tt>-V2000</tt>

    <tr><td valign="baseline">&nbsp;<td valign="baseline">&nbsp;:&nbsp;<td valign="baseline"><tt>-records</tt> <i>range</i>

    <tr><td valign="baseline">&nbsp;<td valign="baseline">&nbsp;:&nbsp;<td valign="baseline"><tt>-druglike</tt>

    <tr><td valign="baseline">&nbsp;<td valign="baseline">&nbsp;:&nbsp;<td valign="baseline"><tt>-leadlike</tt>

    <tr><td valign="baseline">&nbsp;<td valign="baseline">&nbsp;:&nbsp;<td valign="baseline"><tt>-nonreactive</tt>

    <tr><td valign="baseline">&nbsp;<td valign="baseline">&nbsp;:&nbsp;<td valign="baseline"><tt>-smallring</tt>

    <tr><td valign="baseline">&nbsp;<td valign="baseline">&nbsp;:&nbsp;<td valign="baseline"><tt>-acc</tt> <i>range</i>

    <tr><td valign="baseline">&nbsp;<td valign="baseline">&nbsp;:&nbsp;<td valign="baseline"><tt>-don</tt> <i>range</i>

    <tr><td valign="baseline">&nbsp;<td valign="baseline">&nbsp;:&nbsp;<td valign="baseline"><tt>-donacc</tt> <i>range</i>

    <tr><td valign="baseline">&nbsp;<td valign="baseline">&nbsp;:&nbsp;<td valign="baseline"><tt>-chiral</tt> <i>range</i>

    <tr><td valign="baseline">&nbsp;<td valign="baseline">&nbsp;:&nbsp;<td valign="baseline"><tt>-racemic</tt> <i>range</i>

    <tr><td valign="baseline">&nbsp;<td valign="baseline">&nbsp;:&nbsp;<td valign="baseline"><tt>-rotatable</tt> <i>range</i>

    <tr><td valign="baseline">&nbsp;<td valign="baseline">&nbsp;:&nbsp;<td valign="baseline"><tt>-logp</tt> <i>range</i>

    <tr><td valign="baseline">&nbsp;<td valign="baseline">&nbsp;:&nbsp;<td valign="baseline"><tt>-logs</tt> <i>range</i>

    <tr><td valign="baseline">&nbsp;<td valign="baseline">&nbsp;:&nbsp;<td valign="baseline"><tt>-mr</tt> <i>range</i>

    <tr><td valign="baseline">&nbsp;<td valign="baseline">&nbsp;:&nbsp;<td valign="baseline"><tt>-mw</tt> <i>range</i>

    <tr><td valign="baseline">&nbsp;<td valign="baseline">&nbsp;:&nbsp;<td valign="baseline"><tt>-tpsa</tt> <i>range</i>

    <tr>
	<td valign="baseline">&nbsp;<td valign="baseline">&nbsp;:&nbsp;<td valign="baseline"><tt>-elements</tt>
		    <i>element_list</i>
    <tr>
	<td valign="baseline">&nbsp;<td valign="baseline">&nbsp;:&nbsp;<td valign="baseline"><tt>-smarts</tt>
		    <i>smartspattern</i> <i>range</i>
    <tr>
	<td valign="baseline">&nbsp;<td valign="baseline">&nbsp;:&nbsp;<td valign="baseline"><tt>-desc</tt>
		    <i>descriptorname</i> <i>range</i>
    <tr>
	<td valign="baseline">&nbsp;<td valign="baseline">&nbsp;:&nbsp;<td valign="baseline"><tt>-numfield</tt>
		    <i>datafield</i> <i>range</i>
    <tr>
	<td valign="baseline">&nbsp;<td valign="baseline">&nbsp;:&nbsp;<td valign="baseline"><tt>-svl</tt>
		    <i>svlfunction</i> <i>range</i>
    <tr>
	<td valign="baseline">&nbsp;<td valign="baseline">&nbsp;<td valign="baseline">&nbsp;

    <tr>
    <td valign="baseline"><i>range</i>
    <td valign="baseline">&nbsp;:&nbsp;
	  <td valign="baseline"><i>num</i>
	      | <i>num</i><tt>+</tt>
	      | <i>num</i><tt>-</tt>
	      | <i>num</i><tt>,</tt><i>num</i>
</table>
</blockquote>

<p><a name="sdfilter"></a></p><h2>Description</h2>

<p>
The <tt>sdfilter</tt> program removes records from an input collection of SD
files (based upon programmable filters) and writes the results to output SD
files; <tt>sdfilter</tt> is an SVL program intended to be run in MOE/batch.
The fundamental structure of operation of <tt>sdfilter</tt> is:

<ol>
    <li>Read and concatenate all specified input files.
    <li>Write records that satisfy the filters to the output file.
    <li>Write records that don't satisfy the filters to the filter file.
</ol>

<p>On most POSIX systems, the first syntax can be used: <tt>sdfilter</tt> looks
like a Unix command. If using an unusual shell, it may be necessary to  use the
second syntax. On Windows systems, use the third (batch file) or fourth syntax
lines (assuming <tt>cmd.exe</tt> is used to process commands).

<p>
There are several general options that modify the behavior of
<tt>sdfilter</tt>:
<blockquote>
<dl>
    <dt><tt>-help</tt>
    <dd>Prints a syntax summary to <tt>stderr</tt> and then exits.
    <p>
    <dt><tt>-verbose</tt>
    <dd>Prints progress information to <tt>stderr</tt> during the run.
    <p>
    <dt><tt>-quiet</tt>
    <dd>Suppresses the printing of progress information to <tt>stderr</tt>.
    This is the default.
</dl>
</blockquote>

<p>
<b>Argument Processing</b>.  The input arguments to <tt>sdfilter</tt> are
processed in left-to-right order.  If an argument starts with a dash ("-") and
is of length greater than one, it (and possibly subsequent arguments) is
taken as an option specification.  If an argument is of the form
@<i>filename</i> then the contents of <i>filename</i> are read and inserted
into the argument stream for further argument processing (which is useful to
avoid long command lines or to record commonly used arguments and files).
Otherwise, the argument is taken to be an input SD file.  Note: the
@<i>filename</i> can only appear where an option or filename would normally
be processed and not as the second argument to an option
(e.g. <tt>-o</tt>&nbsp;@<i>filename</i> specifies @<i>filename</i> as
the actual output file).
<p>
The input SD files are processed in left-to-right order.  The input file
"-" is interpreted as <tt>stdin</tt> (for use with pipes).  If there are no
explicit input files then <tt>stdin</tt> is used as the single input file.
For example (assuming Unix),
<pre>    sdfilter file1.sdf file2.sdf file3.sdf
</pre>
specifies three input files: "file1.sdf", "file2.sdf" and "file3.sdf" which
will be processed in the given order.  Input files containing "*" or "?" are
interpreted as filename patterns and each will be substituted with all
filenames that match the given pattern; for example, <tt>*.sdf</tt> will
be substituted with all filenames in the current directory that have a
<tt>.sdf</tt> suffix.
Note: On Unix systems double and single quotes are removed by the command
shell.  On Windows systems, such quotes are removed by MOE.  In both
systems filename patterns entered in quotes will be substituted by MOE.

<p>
<b>Output Files</b>.
By default, SD records that satisfy the filters will be written to
<tt>stdout</tt> and SD records that don't satisfy the filters will not
be written to any file.  However, there are options that will alter this
default behavior:
<blockquote>
<dl>
    <dt><tt>-o</tt> <i>filename</i>
    <dd>
    Specifies the name of the file to which SD records that satisfy the
    filters will be written.  If <i>filename</i> is "." then no output
    will be written.  If <i>filename</i> is "-" then the output will be
    written to <tt>stdout</tt>.

    <p>
    <dt><tt>-f</tt> <i>filename</i>
    <dd>
    Specifies the name of the file to which SD records that don't satisfy
    the filters will be written.  If <i>filename</i> is "." then no output
    will be written.  If <i>filename</i> is "-" then the output will be
    written to <tt>stdout</tt>.  If <tt>-f&nbsp;-</tt> is specified and
    no <tt>-o</tt> is specified then the normal <tt>-o</tt> output will
    be disabled.
    
    <p>
    <dt><tt>-stripdata</tt>
    <dd>
    This option forces all additional fields from the original SD files to be 
    removed, leaving only the molecular structure. The stripping is done upon
    reading, and does not apply to fields which are subsequently appended.

    <p>
    <dt><tt>-annotate</tt>
    <dd>
    If <tt>-f</tt> is specified then specifying <tt>-annotate</tt> will
    cause an additional SD data field to be written with each record
    written to the filter file.  This data field will contain the reason
    that the SD record was written to the filter file (i.e. the particular
    violation of a filter that the filtered record did not satisfy).
    
</dl>
</blockquote>

<p><b>Record Filters</b>.
The purpose of <tt>sdfilter</tt> is to remove SD records from the input SD
files based upon satisfaction of all of the optional record filters.  Many of
the filters require the specification of a range of acceptable values.  Such a
<i>range</i> argument can have one of the following forms:

<blockquote>
<dl>
    <dt><i>num</i>
    <dd>Specifies that a value must be equal to <i>num</i>.
    <p>
    <dt><i>num</i>-
    <dd>Specifies that a value must be less than or equal to <i>num</i>.
    <p>
    <dt><i>num</i>+
    <dd>Specifies that a value must be greater than or equal to <i>num</i>.
    <p>
    <dt><i>n</i>,<i>m</i>
    <dd>Specifies that a value must be greater than or equal to <i>n</i>
    and less than or equal to <i>m</i>.
    <p>
</dl>
</blockquote>

For example, <tt>-mw&nbsp;500-</tt> specifies that the molecular weight
must be less than or equal to 500.  With the foregoing in mind,
<tt>sdfilter</tt> can apply the following range-based filters:  In each
<p>
<blockquote>
<dl>
    <dt><tt>-acc</tt> <i>range</i>
    <dd>The number of hydrogen bond acceptors as defined by the
    <a class="svl" href="ph4_tlst.html">ph4_aAcceptor</a> function.
    This is different from the <tt>a_acc</tt> descriptor.
    <p>
    <dt><tt>-chiral</tt> <i>range</i>
    <dd>The number of chiral centers as defined by the
    <a class="svl" href="atom_g.htm">aRSWaterChiral</a> function.
    <p>
    <dt><tt>-don</tt> <i>range</i>
    <dd>The number of hydrogen bond donors as defined by the
    <a class="svl" href="ph4_tlst.html">ph4_aDonor</a> function.
    This is different from the <tt>a_don</tt> descriptor.
    <p>
    <dt><tt>-donacc</tt> <i>range</i>
    <dd>The sum of the number of hydrogen bond donors and acceptors
    <p>
    <dt><tt>-desc</tt> <i>descriptor</i> <i>range</i>
    <dd>
    The value of the MOE molecular descriptor <i>descriptor</i> must fall
    in the specified <i>range</i>.
    More than one <tt>-desc</tt> option may be specified.
    <p>
    <dt><tt>-elements</tt> <i>elist</i>
    <dd>
    The elements of the SD record must be entirely contained in the
    comma-separated list of elements specified by <i>elist</i>.
    <p>
    <dt><tt>-logp</tt> <i>range</i>
    <dd>
    The logP (octanol/water) using the SLogP method [Wildman&nbsp;1999].
    <p>
    <dt><tt>-logs</tt> <i>range</i>
    <dd>
    The log of the water solubility using method of [Hou&nbsp;2004].
    <p>
    <dt><tt>-mr</tt> <i>range</i>
    <dd>
    The molecular refractivity using the SMR method [Wildman&nbsp;1999].
    <p>
    <dt><tt>-mw</tt> <i>range</i>
    <dd>
    The molecular weight using standard values.
    <p>
    <dt><tt>-numfield</tt> <i>datafield</i> <i>range</i>
    <dd>
    The value of the MDL per-record data field <i>datafield</i>, interpreted
    as a numeric scalar, must fall in the specified <i>range</i>.
    More than one <tt>-numfield</tt> option may be specified.
    <p>
    <dt><tt>-racemic</tt> <i>range</i>
    <dd>The number of unconstrained chiral centers as defined by the
    <a class="svl" href="atom_g.htm">aRSWaterChiral</a>
	and <a class="svl" href="atom_p.htm">aForceRS</a> functions.
    <p>
    <dt><tt>-records</tt> <i>range</i>
    <dd>
    Only records at positions in the concatenated input files that
    fall in the specified range will be processed.
    <p>
    <dt><tt>-rotatable</tt> <i>range</i>
    <dd>The number of rotatable (non-ring) bonds excluding atoms with
    heavy degree less than or equal to 1,
    terminal -CH<sub>3</sub> -CF<sub>3</sub> -CCl<sub>3</sub>, -CMe<sub>3</sub>,
    (thio)ester, conjugated (thio)ester, amide (NC=O), NCN resonance,
    terminal triple, and double bonds.
    This is different from the <tt>b_rot*</tt> descriptors.
    <p>
    <dt><tt>-smarts</tt> <i>pattern</i> <i>range</i>
    <dd>
    The number of atoms that match the SMARTS pattern given by <i>pattern</i>
    must fall in the specified <i>range</i>.  This option should be used
    with care since atoms are counted per match and not per group; for example,
    "[OX1]~[CX3]~[OX1]" will result in two matches per atom for the same
    carboxylate group.
    More than one instance of <tt>-smarts</tt> may be specified.
    <p>
    <dt><tt>-svl</tt> <i>svlfunction</i> <i>range</i>
    <dd>
    The return value of the global SVL function <i>svlfunction</i> must
    fall in the specified <i>range</i>.  The function will be given the
    argument <tt>[mol,data1,data2]</tt> where <tt>mol</tt> is a database
    molecule, <tt>data1(i)</tt> is the i'th MDL data field line (that starts
    with &gt;) and <tt>data2(i)</tt> is a vector of character vectors, one
    for each data line.  The SVL function must return a scalar.
    More than one <tt>-svl</tt> option may be specified.
    <p>
    <dt><tt>-tpsa</tt> <i>range</i>
    <dd>
    The topological polar surface area (in square angstroms) using
    the method of [Ertl&nbsp;2000].
</dl>
</blockquote>
<p>
Note: with the exception of the <tt>-smarts</tt> option, only the rightmost
range is used when duplicate options are specified.
<p>
In addition to the range-based filters, <tt>sdfilter</tt> supports the
following flag-based filters:
<blockquote>
<dl>
    <dt><tt>-druglike</tt>
    <dd>
    The molecule must satisfy Lipinski's rule of 5 test for druglikeness
    [Lipinski&nbsp;1997].  Briefly, the Lipinski druglike test is that a
    molecular can have at most one violation of the following conditions:
    a)&nbsp;the number N or O that are hydrogen bond donors must be 5 or less;
    b)&nbsp;the number of N and O atoms must be 10 or less;
    c)&nbsp;the molecular weight must be 500 or less;
    and
    d)&nbsp;the logP must be 5 or less.
    <p>
    <dt><a name="leadlike"></a><tt>-leadlike</tt>
    <dd>
    The molecule must satisfy Oprea's test for leadlikeness [Oprea&nbsp;2000].
    Briefly, the Oprea's leadlike test is that a molecule can have at most one
    violation of the following conditions:
    a)&nbsp;the number N or O that are hydrogen bond donors must be 5 or less;
    b)&nbsp;the number of N and O atoms must be 8 or less;
    c)&nbsp;the molecular weight must be 450 or less;
    d)&nbsp;the logP must be in the range [-3.5,4.5], inclusive;
    e)&nbsp;the number of rings of size three through eight must be 4 or less;
    and,
    f)&nbsp;the number of rotatable bonds (as defined by Oprea) must be 10 or
    less.

    <p>
    <dt><tt>-nonreactive</tt>
    <dd>
    The molecule must not contain groups in a conservative list of
    reactive groups: acrylamide, acyclic diketyl, acyl halide, aldehyde,
    aliphatic imine, aliphatic ketone, aliphatic nitro, aliphatic (thio)ester,
    alkyl halide, anhydride, azide, aziridine, beta-heterounsubstituted
    carbonyl, epoxide, halopyrimidine, hetero-allyl, iso(thio)cyanate,
    maleimide, michael acceptor, perhalo ketone, phosphonate ester,
    phospho-, sulfonate ester, thiol, thio(urea), O-O/N-N/O-S/O-N single
    bonds and transition metal.
    <p>
    <dt><tt>-smallring</tt>
    <dd>
    The molecule must not contain a ring of size 9 or larger.
    <p>
    <dt><tt>-V2000</tt>
    <dd>
    The molecule data format must be MDL's V2000; other formats (such as
    V3000) are not written to the output.
</dl>
</blockquote>

<p>
<b>Example</b>.
A common use of <tt>sdfilter</tt> is to filter out compounds from an
SD file that are not leadlike (by some definition).  The following
<tt>sdfilter</tt> command can be used to apply a reasonable leadlike
filter to an SD file <tt>catalog.sdf</tt> and produce an
SD file <tt>leadlike.sdf</tt>

<blockquote><tt>
sdfilter @leadfilter catalog.sdf -o leadlike.sdf
</tt></blockquote>

<p>
where the file <tt>leadfilter</tt> contains rules to exclude compounds
that don't pass Oprea's leadlike test, contain reactive groups, too many
chiral centers, too large a ring, too many racemic centers, or contain
3 or more -CF<sub>2</sub> groups in a chain,
5 or more -CH<sub>2</sub> groups in a chain,
sulfates, nitrates,
7 or more fluorines,
4 or more halogens (other than fluorine),
or 2 or more nitro groups:

<blockquote><tt>
	-leadlike<br />
	-nonreactive<br />
	-smallring<br />
	-chiral 4-<br />
	-racemic 3-<br />
	-smarts [CX4Q4](F)(F)[CX4Q4](F)(F)[CX4Q4](F)(F)		0<br />
	-smarts [CX4Q2]!@[CX4Q2]!@[CX4Q2]!@[CX4Q2]!@[CX4Q2]	0<br />
	-smarts [OX2Q2][SX4]([OX1])([OX1])O			0<br />
	-smarts [OX2Q2][N+Q3](=[OX1])[OX1]			0<br />
	-smarts F						6-<br />
	-smarts [#G7!F]						3-<br />
	-smarts [N+](=[OX1])[OX1]				1-<br />
</tt></blockquote>

<h2>References</h2>

<p>
<table cellpadding="5">
<tr>
<td valign="baseline">[Lipinski&nbsp;1997]
<td valign="baseline">
Lipinski, C. A., <i>et al.</i>;
Experimental and Computational Approaches to Estimate Solubility
and Permeability in Drug Discovery and Development Settings.
<i>Adv. Drug Deliv. Rev. 23</i> (<b>1997</b>) 3-25.
<tr>
<td valign="baseline">[Wildman&nbsp;1999]
<td valign="baseline">
Wildman, S. A., Crippen, G. M.;
Prediction of Physiochemical Parameters by Atomic Contributions.
<i>J. Chem. Inf. Comput. Sci. 39(5)</i> (<b>1999</b>) 868-873.
<tr>
<td valign="baseline">[Ertl&nbsp;2000]
<td valign="baseline">
Ertl, P., Rohde, B., Selzer, P.;
Fast Calculation of Molecular Polar Surface Area as a Sum of
Fragment-Based Contributions and Its Application to the Prediction
of Drug Transport Properties.
<i>J. Med. Chem. 43</i> (<b>2000</b>) 3714-3717.
<tr>
<td valign="baseline">[Oprea&nbsp;2000]
<td valign="baseline">Oprea, T. I.;
Property Distribution of Drug-Related Chemical Databases.
<i>J. Comp. Aid. Mol. Des. 14</i> (<b>2000</b>) 251-264.
<tr>
<td valign="baseline">[Hou&nbsp;2004]
<td valign="baseline">
Hou, T. J., Xia, K., Zhang, W., Xu, X. J.;
ADME Evaluation in Drug Discovery. 4. Prediction of Aqueous
Solubility Based on Atom Contribution Approach.
<i>J. Chem. Inf. Comput. Sci. 44</i> (<b>2004</b>) 266-275.
</table>

<h2>See Also</h2>

<a class="svl" href="sddesc.htm">sddesc</a><br />
<a class="svl" href="sdfrag.htm">sdfrag</a><br />
<a class="svl" href="sdsort.htm">sdsort</a><br />
<a class="svl" href="sdstereo.htm">sdstereo</a><br />
<a class="svl" href="sdwash.htm">sdwash</a>

<p><a href="../../index.htm">MOE Table of Contents</a>&nbsp;&nbsp;<a href="../../fcnindex.html">SVL Function Index</a></p>
<hr noshade="noshade" />
<a href="http://www.chemcomp.com"><img src="../../images/flogo.gif"
alt="CCG Logo"
align="left" width="30" height="30" border="1" hspace="5" vspace="3" /></a>
<font size="2">
<a href="../../legal.html">Copyright</a> &copy; 1997-2010
<a href="http://www.chemcomp.com">Chemical Computing Group Inc.</a><br />
<a href="mailto:info@chemcomp.com"><i>info@chemcomp.com</i></a>
</font>
</body>
</html>
