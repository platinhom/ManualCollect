<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
"http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">


<!--
!!    MOE Online Manuals
!!    COPYRIGHT (C) 1997-2015
!!        CHEMICAL COMPUTING GROUP INC.  ALL RIGHTS RESERVED.
!!-->

<head>

<meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />

<script type="text/javascript" 
src="../../../include/jsincludes_moe.js"></script>

<link rel="stylesheet" type="text/css"
href="../../../include/manstyle.css" />


<meta keywords>
<meta functions FilePrompt>
<title>FilePrompt</title>

</head>

<body>
<div id="MoeHeader"></div>
<noscript>
	<span class="warning">Warning: JavaScript is disabled. This page will not display correctly.</span>
	<h1 class="title">MOE Documentation</h1>
	<hr noshade="noshade" />
	<style>.LaTeX {color: #C08080;}</style>
</noscript>

<h2>Syntax</h2>

<pre>
    filename = <a class="fcnlink" href="#FilePrompt">FilePrompt</a> [
	title :	'title',
	mode  :	'mode',
	path  :	'directory',
	filter:	'pattern',
	name  :	'filename',
	multi :	flag,
	list  :	['file','file', ...],
	recentDirs: ['dir','dir', ...],
	allowEmptyList : flag,
	allowDuplicates: flag
    ]
</pre>

<h3 class="obsolete">Obsolete Syntax</h3>

<pre>
    'filename' = <a class="fcnlink" href="#FilePrompt">FilePrompt</a> ['title', 'mode', 'directory/pattern']
</pre>

<p><a name="FilePrompt"></a></p>
<h2>Description</h2>

<p>Raises a file selection box (FSB) and returns 
the full path names of the selected files as tokens.
Null is returned if the Cancel button is pressed.
All parameters are optional.

<p><dl>
<dt><tt>title: 'title'</tt>
<dd>Title of the file selection box, specified as a token.
If the title is not specified, a default title is used.

<p><dt><tt>mode: 'mode'</tt>
<dd>File validation mode, specified as a token:

<ul>
    <li><tt>'open'</tt> or <tt>[]</tt>.
    The file name must refer to an existing file.

    <li><tt>'saveAs'</tt>.
    Patterns and directory names will not be permitted.
    If the file are already exists,
    the user is prompted for overwrite confirmation

    <li><tt>'file'</tt>.
    Patterns and directory names will not be permitted.
    The file may already exist and no overwrite confirmation is given.

    <li><tt>'dir'</tt>.
    The file name must refer to an existing directory.

    <li><tt>'none'</tt>.
    No validation of the file name will be performed.
</ul>

The default value is <tt>'open'</tt>.

<p><dt><tt>path: 'directory'</tt>
<dd>Path of the directory containing the file to be selected, specified
as a token.  If the path is not specified, or specified as an empty token
(<tt>''</tt>), then the current directory is used.

<p><dt><tt>filter: 'pattern'</tt>
<dd>Filename matching pattern, specified as a token, e.g. 
<tt>'*.svl'</tt>.
The file selection box will show only files matching the pattern.
If a pattern is not specified or is specified as an empty token,
all files will be shown.

<p><dt><tt>name: 'filename'</tt>
<dd>Filename that is to be displayed in the text area of the file
selection box upon opening the panel.  
If the filename is not specified, the text area
will display the filter.

<p><dt><tt>recentDirs: ['dir', 'dir', ...]</tt>
<dd>List of directories that will be appended to the pop-up list
of recent directories displayed by the file selection box.

<p><dt><tt>multi: flag</tt>
<dd>Flag indicating whether the user is able to select multiple items,
specified as a number:

<ul>
    <li><tt>0</tt> or <tt>[]</tt>:
	The function returns the file selected by the user in the file
	selection box.  Only one file can be returned.

    <li><tt>1</tt>:
	The window shows an additional file list.  The files
	selected by the user in the file selection box will be added
	to the file list and the function will return the contents
	of the file list.

    <li><tt>2</tt>:
	The window shows an additional file list, which can be enabled
	or disabled by the user.  If the file list is enabled, the files
	selected by the user in the file selection box will be added
	to the file list and the function will return the contents
	of the file list.  The file list starts disabled.
</ul>

The default value is 0.

<p><dt><tt>list: ['file', 'file', ...]</tt>
<dd>List of files that will be displayed in the file list.

<p><dt><tt>allowEmptyList: flag</tt>
<dd>If <tt>flag</tt> is non-zero, an empty file list is allowed.
If the parameter is not specified or is set to 0, then the function will not
allow an empty file list to be returned.

<p><dt><tt>allowDuplicates: flag</tt>
<dd>If <tt>flag</tt> is non-zero, then duplicate file names will
be allowed without any warning.
If the parameter is not specified or is 0, then the user
will be warned if a filename that is to be added to the list is already
present in the list.  The user has a choice to accept or to reject the
duplicate filename.  

</dl>

<h2>Examples</h2>

<p>Display FSB with the default title, in 'open' mode, in
the current working directory:

<pre>
    svl&gt; FilePrompt []
</pre>

<p>Display FSB with the multi-file selection mode with the
display restricted only to MDB files:

<pre>
    svl&gt; FilePrompt [multi:1, filter:'*.mdb']
</pre>

<h2>See Also</h2>

<p>
<a class="svl" href="wt_fsb.htm">FSB</a><br />
<a class="svl" href="wt_create.htm">WindowPrompt</a>

<noscript>
	<hr noshade="noshade" />
	<font size="2"> Copyright &copy; 1997&ndash;2015
	<a href="http://www.chemcomp.com">Chemical Computing Group Inc.</a> </font>
</noscript>
<div id="MoeFooter"></div>
</body>
</html>

