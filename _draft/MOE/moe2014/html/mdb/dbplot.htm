<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
"http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">

<!--
!!	dbplot.htm	Plotting Database Values chapter
!!-->

<!--
!!    MOE Online Manuals
!!    COPYRIGHT (C) 1997-2015
!!        CHEMICAL COMPUTING GROUP INC.  ALL RIGHTS RESERVED.
!!-->

<head>

<meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />

<script type="text/javascript" 
src="../include/jsincludes_moe.js"></script>

<link rel="stylesheet" type="text/css"
href="../include/manstyle.css" />


<meta panel Correlation Matrix>
<meta panel Correlation Plot>
<meta panel Database Correlation Plot>
<meta panel Database Correlation Matrix>
<meta panel Selected Fields Histogram>
<meta panel Database 3D Plot>
<meta panel Database 3D Plot Preferences>

<title>Plotting Database Values</title>
</head>

<body>
<div id="MoeHeader"></div>
<noscript>
	<span class="warning">Warning: JavaScript is disabled. This page will not display correctly.</span>
	<h1 class="title">MOE Documentation</h1>
	<hr noshade="noshade" />
	<style>.LaTeX {color: #C08080;}</style>
</noscript>

<ul>
<li><a href="#CorrelationPlot">Correlation Plot</a>
<li><a href="#CorrelationMatrix">Correlation Matrix</a>
<li><a href="#3DPlot">3D Plot</a>
  <ul>
  <li><a href="#Creating3DPlot">Creating a 3D Plot</a>
  <li><a href="#ModifyingAxisAttr">Modifying Axis Attributes</a>
  <li><a href="#SettingColors">Setting Colors</a>
  </ul>
<li><a href="#SelectedFieldsHistogram">Selected Fields Histogram</a>
</ul>


<p>Numeric fields in databases can be viewed and analyzed using a variety
of visualization utilities.  In addition to the 
<a href="db.htm#PlottingDatabaseValues">Database
Viewer Plot Area</a>, there are a number of plotting and analysis tools that
can be accessed through the <nobr><b>Compute&nbsp;|&nbsp;Analysis</b></nobr>
menu of the Database Viewer.

<a name="CorrelationPlot"></a>
<h2>Correlation Plot</h2>

<p>The Correlation Plot is used to plot two numeric fields against each
other in a scatter plot.  You will be prompted to select the
fields to plot along the horizontal (x) and vertical (y) axes in turn.
Once both fields are specified, a plot panel will open displaying
the correlation plot.  Note that entries containing incorrect numbers
(e.g. Inf or Nan) or a vector of numbers instead of a single number
will not appear in the Correlation Plot.

<p align=center>
<img src="dbplot/cmplot.png" alt="Selected Entries in Correlation Plot Panel">

<p>In the plot panel, the selection of data points mirrors the database
entry selection.  To select values in the plot, drag a selection box around
data points using the left mouse button.  The corresponding entries in
the database will also be selected in the Database Viewer.  The inverse
is also true. Selecting entries in the Database Viewer automatically
selects them in the Correlation Plot panel.  To deselect entries, use the
<nobr><b>Clear Selection</b></nobr> button in the plot panel or
turn off the selection state of a single entry through the Database Viewer.

<p>Press the <b>Hide&nbsp;Selection</b> button to remove data points
from the plot and reset the view. The corresponding entries in
the database will also be hidden in the Database Viewer. Conversely,
any changes to the visibility state of entries in the Database Viewer
automatically updates the Correlation Plot panel. To show all data points,
use the <b>DBV&nbsp;|&nbsp;Display&nbsp;|&nbsp;Entry&nbsp;Show All</b>
menu command.

<p><b>Data to Clipboard</b> can be used to send the correlation plot
data to the clipboard.  The data can then be imported to an external
application for further evaluation.

<p>The appearance of the Correlation Plot can be modified using the
<b>plot attributes</b> panel.  To open this panel press the <b>Attributes</b>
button.  There are several <i>pages</i> of attributes allowing for changes
to the titles, labels, and general display. 

<a name="CorrelationMatrix"></a>
<h2>Correlation Matrix</h2>

<p>A fast way of determining the correlation of any two fields in a
database is provided by the Correlation Matrix utility.  The displayed
correlation matrix is a color-coded matrix of all numeric fields in the
database, with the percent correlation indicated for each pair of fields.
(MOE will display a warning message if the number of
fields in the matrix exceeds a maximum limit.)

<p>The correlation matrix can also be displayed for selected numeric fields
only. In this case, you must select the numeric fields prior to invoking
the Correlation Matrix command.  If no fields are selected, then all
numeric fields in the database will be used in the calculations.

<img src="dbplot/cmatrix.png" class="floatright" alt="Correlation Matrix">

<p>Numeric field names are numbered and displayed vertically to the left
of the matrix.  Their order is the same as that in the database.  The field
numbers are also displayed in a row across the top of the matrix, again
in database order.  Each box in the matrix is labeled with the percent
correlation between the two corresponding numeric fields:

<p>
<ul>
<li>100 signifies complete correlation (-100 signifies that the fields are
inversely correlated)

<li>0 signifies no correlation
</ul>

<p>Boxes are color-coded by correlation. The higher the percentage,
the darker the box. For instance, 100 (complete correlation) is represented
by a black box, as is -100.  Colors lighten with diminishing magnitude.
0 (no correlation) is represented by a white box.

<p>Click on a box in the matrix to display the <a
href="#CorrelationPlot">Correlation Plot</a> of the corresponding numeric
fields.

<a name="3DPlot"></a>
<h2>3D Plot</h2>

<p>The 3D Plot application helps to visualize the relationships between
numeric data sets by plotting three database fields as a 3D dot plot in
the MOE Window.  By default, the data are decorrelated and then
normalized to a mean of 0 and a standard deviation of 1.
If desired, a fourth database field can be used to color the data points.

<p align="center"><img src="dbplot/3dplot_view.png" alt="Database 3D Plot">

<p>The visibility and selection state of the data points and the database
entries are synchronized.  Selecting a data point in the MOE Window will
result in the associated database entry being automatically selected in the
Database Viewer where the plot originated.  Similarly, selecting an
entry in the Database Viewer will select the related data point in the
plot. The same holds true for hiding/showing data points or entries.

<a name="Creating3DPlot"></a>
<h3>Creating a 3D Plot</h3>

To open the Database 3D Plot panel, use
<nobr><b>DBV | Compute | Analysis | 3D Plot</b></nobr>
in a Database Viewer.

<p align=center>
<img src="dbplot/3dplot.png" alt="Database 3D Plot Panel">

<p>
You can also invoke the panel by entering

<pre>
    run 'db3dplot.svl'
</pre>

<p>
which will prompt you for the name of a molecular database file to be used. 
<p>
<table width=100% cellpadding=5>
<tr>
<td valign=top><b>Database</b>
<td valign=top>
Filename of the database containing the data to be plotted.  
It is
possible to plot only a subset of the entries in the database by turning on
the <b><nobr>Selected Entries Only</nobr></b> checkbox.  In this case,
you must have the database open in a Database Viewer with the desired
entries selected prior to making the plot.

<tr>
<td valign=top><b>Plot Fields</b>
<td valign=top>
The fields to plot are selected using the <b><nobr>Plot Fields</nobr></b>
option menus.  Only numeric fields can be plotted.  By default, the X,
Y, and Z plot fields are initially set to the first three numeric fields
in the database.  Note, however, that if there are fields selected in the
source Database Viewer, these will be used for the initial values instead.

<tr>
<td valign=top>
<b>Decorrelate&nbsp;Axes</b><br>
<b>Normalize&nbsp;Axes</b>

<td valign=top>
Before being plotted, the data can be decorrelated and/or normalized.  The
<b><nobr>Decorrelate Axes</nobr></b> and <b><nobr>Normalize Axes</nobr></b>
options are used to respectively turn on or off the decorrelation and
normalization preprocessing steps.

<tr>
<td valign=top><b>Activity</b>
<td valign=top>
Data points can be colored according to the values of a database field
by using the <b>Activity</b> option menu. 

<tr>
<td valign=top><b>Threshold</b>
<td valign=top>

The color map is determined by
applying the coloring rules listed in the <b>Threshold</b> textfield.
Each threshold marks the beginning of a new color band in the plot.
Multiple thresholds are separated by either spaces or commas.  The
ellipsis (the character
sequence <tt>...</tt>) is used in the threshold list to abbreviate a
long regular sequence of thresholds.  When the ellipsis is encountered,
the size of the previous color band is repeated until the next threshold
takes effect or the end of the range is reached, whichever comes first.
For example, entering <tt>5%...</tt> will split the data into 20 color bands.

<p>Thresholds can be specified using either absolute numbers or
percentiles.  Any number followed by a <tt>%</tt> character is considered
a percentile.  When using absolute numbers, it is recommended to turn
off the <b><nobr>Decorrelate Axes</nobr></b> and <b><nobr>Normalize
Axes</nobr></b> options.
</table>

<p>Once all the options are defined, press the <b>Plot</b> button to
draw the plot in the MOE Window. To launch
a <a href="dbbrowse.htm">Database Browser</a> displaying the selected
data points, press <b>Browse</b>.
The controls for numerous visual aspects
of the plot, ranging from grid colors to axis titles, are accessed by
pressing <b>Preferences</b>.

<p>The database 3D plot uses atoms to mark the data points, and hence
adds atoms to the system. To delete data points, you can use the 
<a href="../moe/gui/se.htm">Sequence Editor</a> 
to delete the chain containing the plot atoms.  To remove the 3D
plot box drawn in the rendering area, delete the graphic object using the
<a href="../moe/gui/gobjman.htm">Graphics Object Manager</a>.

<a name="ModifyingAxisAttr"></a>
<h3>Modifying Axis Attributes</h3>

<p>Axis attributes are customizable from the Database 3D Plot Preferences
panel, which provides controls over titles, labels, range, tick spacing
and grid mode for each axis of the plot.  To open the Database 3D Plot
Preferences panel, press <b>Preferences</b> in the Database 3D Plot panel.

<p align=center>
<img src="dbplot/3dplot_axis.png" alt="Database 3D Plot Axis Attributes Page">

<p>
Select one of the X-Axis Attributes, Y-Axis Attributes or
Z-Axis Attributes pages to display the current settings of the axis of
interest.  If the data are decorrelated, the X, Y, and Z axis will show up 
initially as PCA1, PCA2 and PCA3 respectively, where
PCA stands for Principal Component Axis.

<p>
Press <b>Apply</b> to put any changes into effect.

<table width=100% cellpadding=5>
<tr>
<td valign=top><b>Axis Title</b>
<td valign=top>Each axis can have its title adjusted individually.
There are two modes for each axis:

<p><b>Auto</b>.  In auto mode, if the data are decorrelated,
the X, Y, and Z axis titles are PCA1, PCA2 and PCA3 
(Principal Component Axis) respectively.  Otherwise, if the raw data are
used, the title is the name of the database field plotted along the axis.

<p><b>Custom</b>.
In custom mode, a textfield is provided to enter the desired title.

<tr>
<td valign=top><b>Show Title</b>
<td valign=top>
If no titles are desired, they can be hidden by turning off the 
<b><nobr>Show Title</nobr></b> checkbox.

<tr>
<td valign=top><b>Axis Range</b>
<td valign=top>
The range of the axes displayed in the MOE Window are adjusted with
the <b><nobr>Axis Range</nobr></b> buttons.  
There are three modes:
<p>
<b>Span</b>.  The
axis covers the exact range of values of the associated database field --
the lowest value on the axis is the lowest value in the database field,
and the highest, the highest value in the field. 

<p><b>NxSD</b>. A more focused plot, where the axis will extend a number
(<b>N</b>) of standard deviations in both directions from the data mean. By
default, the value of N is 3, but can be modified by entering a new value in
the provided textfield.

<p><b>Custom</b>. Explicit control over the
axis range is available with the <b>Custom</b> mode.  In this mode,
two textfields are provided (<b>From</b>, <b>To</b>) to specify the start
and end points of the axis.

<tr>
<td valign=top><b>Tick Spacing</b>
<td valign=top>
Visual cues, or <i>ticks</i>, can be drawn along each axis to help
assess the position of data points.  The <b><nobr>Tick Spacing</nobr></b>
buttons are used to select the frequency of the ticks. 
There are three tick spacing modes:

<p><b>Auto</b>.
Tick interval is calculated at runtime in order to provide maximum
information with minimal clutter. If the axis range is specified in standard
deviations (NxSD Axis Range mode), then the tick units are also in standard
deviations. 

<p><b>NxSD</b>. Insert a tick every <b>N</b> standard deviations. By default,
the value of N is 1.

<p><b>Custom</b>.  Allows for ticks to be placed at any interval. By default,
the value is 1. Use the <b>Increment</b> textfield to set a new value.


<tr>
<td valign=top>
<b><nobr>Show Ticks</nobr></b><br>
<b><nobr>Show Tick Labels</nobr></b>

<td valgin=top>
Ticks and tick labels can be hidden by turning off the
<b><nobr>Show Ticks</nobr></b> and <b><nobr>Show Tick Labels</nobr></b>
checkboxes respectively.

<tr>
<td valign=top><b>Grid Mode</b>
<td valign=top>
In addition to ticks, each axis can support perpendicular grids
to further help in localizing data points.  For the X axis, YZ planes
can be drawn, for the Y axis, XZ planes, and for the Z axis, XY planes.
The <b><nobr>Grid Mode</nobr></b> buttons control the drawing of these
planes.   There are three modes:

<p><b>Backdrop</b>.  A single plane is drawn at the first (lowest value) tick
of the axis.  Backdrop is the default mode.

<p><b>Stack</b>.  Planar grids are inserted in the plot at each of the
axis ticks.

<p><b>None</b>.  Used to disable rendering of the grid planes.
</table>

<a name="SettingColors"></a>
<h3>Setting Colors</h3>

<p> The colors of the axis titles, grids and tick labels can all be
modified from the Colors page of the Database 3D Plot Preferences Panel.
To open the Database 3D Plot Preferences panel press <b>Preferences</b>
in the Database 3D Plot panel.

<p align=center>
<img src="dbplot/3dplot_colors.png" alt="Database 3D Plot Colors Page">

<p> Colors are specified as RGB (red, green, blue) intensities on a scale
from 0 to 255, with 255 being maximal intensity. Setting all to 0 yields
black, all to 255 yields white.  The <b>Color</b> option menu allows you to
choose which plot element to edit.  In order to facilitate color selection,
updates to the plot are immediate, <i>i.e.</i>, you do not have to press
<b>Apply</b> to put changes into effect.

<a name="SelectedFieldsHistogram"></a>
<h2>Selected Fields Histogram</h2>

<p>A histogram plot of one or more scalar numeric fields can be obtained
using <b>Selected Fields Histogram</b> application.
A histogram is a bar plot
giving the distribution of values in a particular field.  The values are
bucketed, and the number of counts per bucket are plotted.  Several fields
can be plotted in the histogram together, allowing you to compare their
distributions.

<p>Select the fields to plot and then choose
<b>DBV | Compute | Analysis | Selected Fields Histogram</b>.
The following panel appears:

<p align=center>
<img src="dbplot/histo.png">

<p>The histogram created is calculated using only the visible database
entries.  The histogram curves can be normalized in several ways, controlled
by the three options below the plot area:

<p><table width="100%">
<tr>
<td valign=top><b>Y in Percent</b>
<td valign=top>
If enabled then the Y values will be normalized
and the results will be displayed in percent.

<tr>
<td valign=top><b>Mean Center</b>
<td valign=top>
If enabled then the histograms will be translated horizontally so that the
mean is zero.

<tr>
<td valign=top><b>Normalize X</b>
<td valign=top>
If enabled then the histograms will be scaled
horizontally so that the variance is one.
</table>

<p>The number of buckets can be changed by modifying the <b>Number of Bins</b>
field and pressing the <b>Update Plot</b> button to refresh. By default, 100
bins are used in the plot.

<p>Database entries corresponding to histogram bins can be selected by
dragging a box in the plot.  The entries will be added to the current
entry selection.

<p>Further analysis of the histogram data can be obtained using the
<b>Report</b> and <b>Data To Clipboard</b> buttons:

<ul>
<li><b>Data To Clipboard</b>.
<p>Copies the data to the clipboard.
The data will be stored in the format <tt>"series name"</tt> followed
by a list of <tt>tab</tt> separated X and Y values, suitable for
pasting into other applications.

<p><li><b>Report</b>.
<p>Creates a text report with various statistics and opens it in an SVL
Text Editor window.
</ul>

<p>Settings for the plot display are modified using the <b>Selected
Fields Histogram Settings</b> panel.  To open this panel press the
<b>Settings...</b> button.  The following panel appears:

<p align=center>
<img src="dbplot/histoset.png" alt="histogram settings">

<p>
The desired title of the plot can be entered into the <b>Title</b> text box.
The various <b>Show</b> checkboxes and the <b>Background</b> pulldown
menu also apply to the whole plot.  Following this,
each series in the histogram is given a separate
line of controls allowing the name, color, line style and marker style
to be adjusted.  Note that the marker style is controlled by the last
two option menus together.


<h2>See Also</h2>

<a href="db.htm#PlottingDatabaseValues">Database Plot</a>

<noscript>
	<hr noshade="noshade" />
	<font size="2"> Copyright &copy; 1997&ndash;2015
	<a href="http://www.chemcomp.com">Chemical Computing Group Inc.</a> </font>
</noscript>
<div id="MoeFooter"></div>
</body>
</html>
