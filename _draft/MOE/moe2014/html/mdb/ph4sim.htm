<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
"http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">

<!--
!!	ph4sim.htm	Similarity search
!!-->

<!--
!!    MOE Online Manuals
!!    COPYRIGHT (C) 1997-2015
!!        CHEMICAL COMPUTING GROUP INC.  ALL RIGHTS RESERVED.
!!-->

<head>

<meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />

<script type="text/javascript" 
src="../include/jsincludes_moe.js"></script>

<link rel="stylesheet" type="text/css"
href="../include/manstyle.css" />


<meta index entry="fingerprints" subentry="similarity search">
<meta index entry="similarity search">

<meta panel MOE-Similarity>
<meta panel Fingerprint Similarity>
<meta panel Fingerprint Chooser (Similarity)>

<title>Similarity Searching</title>
</head>

<body>
<div id="MoeHeader"></div>
<noscript>
	<span class="warning">Warning: JavaScript is disabled. This page will not display correctly.</span>
	<h1 class="title">MOE Documentation</h1>
	<hr noshade="noshade" />
	<style>.LaTeX {color: #C08080;}</style>
</noscript>

<ul>
<li><a href="#Introduction">Introduction</a>
<li><a href="#Running">Running MOE-Similarity</a>
<li><a href="#SVL">SVL Commands</a>
</ul>

<h2><a name="Introduction">Introduction</a></h2>

<p>MOE-Similarity performs a search in a database for molecules that are
similar to a query molecule. To run a similarity search, the following
items are required:

<ol>
<li>
<i>Fingerprinted Database</i>.  A molecular database for which fingerprints
have already been calculated.  In the Database Viewer, use 
<b><span class="nobr">DBV | Compute | Fingerprint |
<a href="ph4calc.htm">Calculate</a></span></b> 
to calculate fingerprints if the search database does not contain them.

<p>
<li>
<i>Query Molecule.</i>  Search queries are defined by atoms (or a subset
of atoms) loaded in MOE.  In the MOE Window, use 
<b><nobr>MOE | File | <a href="../moe/gui/fileopen.htm">Open</a></nobr></b>
to load a query molecule.

</ol>

<h2><a name="Running">Running MOE-Similarity</a></h2>

<p>When ready to perform the search, open the database and choose
<b><span class="nobr">DBV | Compute | Fingerprint | Search</span></b>
in the Database Viewer.  The MOE-Similarity panel appears:

<p><center><img SRC="ph4sim/panel.png" alt="MOE-Similarity Panel"></center>

<table cellpadding=5 cellspacing=5>

<tr>
<td valign=top><b>Database</b>
<td>
Path and filename of the current database in which the search will be performed.
<tr>
<td valign=top><b>Entries</b>
<td>
Determines which entries will be used when performing the similarity search.
You may perform the search on all database entries or restrict it to
entries that are selected, visible or hidden.

<tr>
<td valign=top><b>Fingerprint</b>
<td>
Indicates the fingerprint system and similarity metric
used for the search.  Press the Set Fingerprint button (described below)
to change the fingerprint or the metrics.  

<br /><br />
<b>Note:</b> If you select a
fingerprint system that has not been applied to the database, you will not
be able to search (fingerprints must be calculated prior to searching).

<tr>
<td valign=top><b>Overlap</b>
<td>
Determines the strictness of the search.  All similarity metrics
return a number between 0 and 100%, where 100% means most similar.  
A <i>hit</i> is any molecule whose similarity
measure to the query molecule is greater than, or equal to, the Overlap
value.
<tr>
<td valign=top><b>Atoms</b>
<td>
When turned on, only the selected atoms in MOE
will be used to represent the query molecule.  Otherwise, all atoms will
be used to form the search query.

<tr>
<td valign=top><b>Visibility</b>
<td>
Controls the visibility of the similarity search results in the database:
<ul>
<li>Show Hits: Displays the hits (similar molecules) and hides the misses
<li>Hide Hits: Displays the misses and hides the hits
<li>Nothing: Displays all database entries
</ul>

<tr>
<td valign=top><b>Selection</b>
<td>
Controls the selection state of the similarity search results in the database:
<ul>
<li>Select Hits: Selects hits (provided they are visible) in the database
<li>Unselect Hits: Selects the misses and deselects the hits
<li>Nothing: No selection is performed in the database
</ul>

<tr>
<td valign=top><b>Set&nbsp;Fingerprint</b>
<td>
Displays the Fingerprint Chooser (Similarity) panel, which is used to
change the fingerprint and/or similarity metric used for the search.
</table>

<p>Once all the components necessary for the search are present, press the
Search button to start the process.  The button label changes to Busy during
the search.

<p>MOE-Similarity cannot perform a search under the following conditions:

<ul>
<li>The Search button turns to <b>No Fingerprint</b> when the database does not
contain a fingerprint field matching the chosen search fingerprint system.  Use
<span class="nobr">Compute | Fingerprint |
<a href="ph4calc.htm">Calculate</a></span> to calculate the
correct fingerprints in the database.

<p><li>The Search button turns to <b>No Query</b> if there are no atoms in the
system.
</ul>

<p>

Depending on the size of the database, the search may require some
time.  Note that it might take longer for certain fingerprint systems
to calculate a fingerprint for a given molecule, depending on the
complexity of the fingerprint.  The search always proceeds by calculating
a fingerprint for the query atoms.
<p><center>
<img src="ph4sim/choose_sim.png" alt="Fingerpring Chooser Panel">
</center>


<h2><a name="SVL">SVL Commands</a></h2>

<p><a class="svl" href="../moe/fcnref/ph4_mdb.htm#ph4_FingerprintMDB">ph4_FingerprintMDB</a>


<h2>See Also</h2>

<p>
<a href="ph4intro.htm">Introduction to Molecular Fingerprints</a><br>
<a href="db.htm">Molecular Database Viewer</a><br>


<noscript>
	<hr noshade="noshade" />
	<font size="2"> Copyright &copy; 1997&ndash;2015
	<a href="http://www.chemcomp.com">Chemical Computing Group Inc.</a> </font>
</noscript>
<div id="MoeFooter"></div>
</body>
</html>
