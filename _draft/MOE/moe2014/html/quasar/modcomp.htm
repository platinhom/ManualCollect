<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
"http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">

<!--
!!	modecomp.htm QuaSAR Model Composer & Evaluate
!!-->

<!--
!!    MOE Online Manuals
!!    COPYRIGHT (C) 1997-2015
!!        CHEMICAL COMPUTING GROUP INC.  ALL RIGHTS RESERVED.
!!-->

<head>

<meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />

<script type="text/javascript" 
src="../include/jsincludes_moe.js"></script>

<link rel="stylesheet" type="text/css"
href="../include/manstyle.css" />



<meta panel Model-Composer>
<meta panel Model-Evaluate>

<meta fileformat .mom>

<title>Creating and Evaluating Models</title>
</head>

<body>
<div id="MoeHeader"></div>
<noscript>
	<span class="warning">Warning: JavaScript is disabled. This page will not display correctly.</span>
	<h1 class="title">MOE Documentation</h1>
	<hr noshade="noshade" />
	<style>.LaTeX {color: #C08080;}</style>
</noscript>

<ul>
<li><a href="#Composer">MOE Model-Composer</a>
   <ul>
    <li><a href="#Files">Model Files</a>
    <li><a href="#Operation">Operation</a>
    <li><a href="#Parameters">Model Operations</a>
    <li><a href="#Options">Saving to a File</a>
    <li><a href="#Creating">Creating Models</a>
   </ul>
<li><a href="#Eval">Model-Evaluate: Evaluating a Model a Database</a>
</ul>

<a name="Composer"></a><h2>MOE Model-Composer</h2>


<p> The Model-Composer application is used to specify how to combine
the predictions of linear and binary 
<a href="model.htm">QSAR models</a>, 
<a href="../apps/ph4_guide.htm">pharmacophore queries</a>,
and <a href="../mdb/fpmodel.htm">fingerprint models</a> into a new model.
The resulting <i>composite model</i> can be saved as a <i>MOE model</i>
file, and subsequently <a href="#Eval">evaluated over a database</a>
or used in
<span class="nobr">
<a href="../apps/combitools.htm">Combinatorial Library</a></span>.


<p>To start the Model-Composer, choose either 
<span class="menu">DBV | Compute | Model | Composer</span> or
<span class="menu">MOE | Compute | QuaSAR | Model-Composer</span>.
The following panel appears:

<p><center><img src="modcomp/modcomp.png" alt="Model-Composer Panel"></center>

<a name="Files"></a><h3>Model Files</h3>

<p>The Models list is a list of model files specifying which models are to
be included in the composite model under construction.  A model file can be
any previously saved linear QSAR, binary QSAR, pharmacophore, fingerprint,
or composite model.  It can also be a database field.

Models are added to the list using the <b>Add</b> button,
and removed from the list using the <b>Remove</b> button.
In either case, multiple models can be added or removed at
a time.

<p>To include a database field in the model, press <b>DB Field</b>
which will open a file selection box for selecting database files
and fields.

<p>
Composite models (MOE models) can be loaded
into the Models list using the <b>Load</b> button
at the bottom.  This will replace any current items in the list
with the contents of the selected model file.

<h4>List display</h4>

<table>
<tr>
<td valign="top">
<b>Name</b>
<td valign="top"> An automatically-assigned unique model name, composed
of the model type suffixed by a number.  When the
chosen <b>Operation</b> is <b>eval</b>, this name is used to
identify the model in the expression text field.

<tr>
<td valign="top">
<b>Type</b>
<td valign="top">Type of model file.

<tr>
<td valign="top">
<b>Flags</b>
<td valign="top">
Indicators of the parameters specified for each model file.  The possible
flags are as follows:

    <blockquote>
    <table cellpadding="3" border="1">

    <tr>
    <td>l</td>
    <td>Log</td>
    </tr>

    <tr>
    <td>c</td>
    <td>Complement</td>
    </tr>

    <tr>
    <td>L</td>
    <td>Lower Threshold</td>
    </tr>

    <tr>
    <td>U</td>
    <td>Upper Threshold</td>
    </tr>

    </table>
    </blockquote>

<tr>
<td valign="top">
<b>Weight</b>
<td valign="top">Weight factor applied to the model prediction after
threshold parameters, complement, and log, if any.

<tr>
<td valign="top">
<b>File</b>
<td valign="top">Name of the model file.

</table>

<p>It is sometimes convenient to obtain information about
the contents of a particular model.
To do this, select the models of interest in
the model list, then press the <b>Info</b> button to the right
of the list.
The details of the selected models are displayed in separate panels.

<!--

<p>
The default model types and the information displayed are as follows:


<p>
<center><table cellspacing="4" cellpadding="4" border="1">
<tr>
<th>Model File Type
<th>Information Displayed
<th>Panel

<tr>
<td valign="top">View QuaSAR Model
<td valign="top">
QSAR Model File<br />
Database<br />
Activity Field<br />
Descriptors<br />

<td valign="top">
<img src="modcomp/info_qsar.gif" alt="View QuaSAR Model">

<tr>
<td valign="top">View Fingerprint Model
<td valign="top">
Fingerprint Model File<br />
Source Database<br />
Model Parameters<br />
<td valign="top">
<img src="modcomp/info_fp.gif" alt="View Fingerprint Model">

<tr>
<td valign="top">View Pharmacophore Model
<td valign="top">
Query Title<br />
PH4 Model File<br />
PH4 Scheme<br />
Partial Match<br />
Number of Features</br />
Number of Volumes</br />
Number of Constraints</br />
<td valign="top">
<img src="modcomp/info_ph4.gif" alt="View Pharmacophore Model">

<tr>
<td valign="top">View MOE Model
<td valign="top">
Model File<br />
Model Title<br />
Comment<br />
Model Files<br />
Operation<br />
<td valign="top">
<img src="modcomp/info_mom.gif" alt="View MOE Model">

</table>
</center>

-->

<a name="Operation"></a><h3>Operation</h3>

<p>The predictions of the models in the Models list are combined using a
specified arithmetic operation or expression.

<blockquote>
<table>
<tr>
<td valign="top"><b>product</b>
<td valign="top">All model predictions are multiplied together.

<tr>
<td valign="top"><b>sum</b>
<td valign="top">All model predictions are added together.

<tr>
<td valign="top"><b>average</b>
<td valign="top">The average of the model predictions is taken.

<tr>
<td valign="top"><b>min</b>
<td valign="top">The smallest model prediction is taken.

<tr>
<td valign="top"><b>max</b>
<td valign="top">The largest model prediction is taken.

<tr>
<td valign="top"><b>variance</b>
<td valign="top">The variance in the models is calculated.

<tr>
<td valign="top"><b>USER</b>
<td valign="top">
A user-specified function is used to combine all the model results.
The function must accept a vector of numbers as its argument.

<center>
<p><img src="modcomp/modcomp_user.png" alt="Operation USER" />
</center>

<tr>
<td valign="top"><b>eval</b>
<td valign="top">

An expression involving the model results is evaluated.  The expression
may reference models in the list by model name (e.g. <tt>$A</tt>).
To append a model name to the expression, <b>double-click</b> in the list.

<center>
<p><img src="modcomp/modcomp_eval.png" alt="Operation eval" />
</center>

</table>
</blockquote>


<a name="Parameters"></a><h3>Model Operations</h3>

<p>Each individual model in the Models list can have additional arithmetic
manipulations applied to its predictions.  These operations are specified in
the area below the list, and can be set for one or more models at a time.
First select the appropriate models in the list, then set the options.
Press <b>Apply</b>.

<p><b>Note:</b> The options are applied to the model results prior to
the combining <a href="#Operation">operation</a>.

<ul>

<li><b><tt>1-x</tt></b>.

If on, the complement of the model result is used in the combining
expression.  In this case, a <b>c</b>
will appear in the list.

<p><li><b><tt>log x</tt></b>.

If on, the logarithm of the model result is used in the combining
expression.  In this case, an <b>l</b>
will appear in the list.

<p><li><b><tt>1-log x</tt></b>.

If on, the complement of the log of the model result is used in the combining
expression.  In this case, both <b>c</b> and <b>l</b>
will appear in the list.

<p><li><b>Lower Threshold</b><br />
<b>Upper Threshold</b>

<p>The upper and lower thresholds define a range in which to
restrict the result.  If the lower threshold is used, then if
<b>lower threshold &lt;= result</b>,
a 1 will be used in subsequent calculations. Otherwise a 0 is used.

Conversely, if the upper threshold is used, then if
<b>result &lt; upper threshold</b>, a 1 will be used, otherwise 0.

If both thresholds are set, then a 1 will be used only if
<b>lower threshold &lt;= result &lt; upper threshold</b>, otherwise
0 is used.

<p>
The use of the lower and upper thresholds is indicated in the
list by <b>L</b> and <b>U</b>, respectively.  
One or both thresholds may be set.


<p><li><b>Weight</b>.
A scale factor applied to the model result.
Weighting is the last operation to be applied.


</ul>

<p>The order in which the parameters are applied to the prediction
of a given model is as follows:

<blockquote>
<table border="0">

<tr>
<td>1.
<td>Initial model prediction.
<td>&nbsp;
<td><i>p</i>

<tr>
<td>2.
<td>Apply logarithmic and/or complementation operations.
<td>&nbsp;
<td><span class="nobr">log (1 - <i>p</i>)</span>

<tr>
<td>3.
<td>Apply threshold(s).
<td>&nbsp;
<td><span class="nobr">log (1 - <i>p</i>)<i><sub>thresh</sub></i></span>

<tr>
<td>4.
<td>Apply weight.
<td>&nbsp;
<td><span class="nobr">W * (log (1 - <i>p</i>)<i><sub>thresh</sub></i>)</span>

</table>
</blockquote>

<a name="Options"></a><h3>Saving to a File</h3>

<p>To save the current model to a file, press the <b>Save</b> button
at the bottom of the Model-Composer panel.  The file is saved as a MOE
model (type <tt>moe_model</tt>), with default extension <tt>.mom</tt>
(<b>MO</b>E <b>M</b>odel).

<p>If the model includes MOE models, the contents of these models are merged
into the model list before saving.  For example, if file <tt>a.mom</tt>
is in the list of included models and contains a model constructed from
<tt>a.fit</tt> and <tt>b.fit</tt>, then it is these latter two models
that are saved to the output model file.  If the new model file were to
be subsequently loaded into the Model-Composer, the model list will show
the contents of the file to include <tt>a.fit</tt> and <tt>b.fit</tt>
rather than <tt>a.mom</tt>.

<p>
The listed model files and their parameters
are saved to the output file
along with any options set in the <b>Model Options</b> panel.

<p><center><img src="modcomp/modcomp_opt.png" alt="Model Options Panel"></center>

<p>The Model Options panel allows for setting the model
<b>Title</b> and <b>Comment</b>, as well as the write mode.
If <b>Write Binary</b> is on, then the individual models
making up the composite model will be written in binary form
to the model file.  This is useful when precision is an issue,
for example, in QSAR models.

<p>The options in the panel take effect only when <b>OK</b> is
pressed.  If <b>OK</b> is not pressed, the options will not be saved
to the model file.

<a name="Creating"></a><h3>Creating Models</h3>
<p>There are several methods of creating models to be used in the
Model Composer:

<p>
<ul>
<li><a href="model.htm">QuaSAR-Model</a>
<li><a href="../mdb/fpmodel.htm">MOE-FingerprintModel</a>
<li><a href="../apps/ph4_query.htm">Pharmacophore Query Editor</a>
<li><a href="#Composer">Model Composer</a>
</ul>


<a name="Eval"></a><h2>Model-Evaluate: Evaluating a Model on a Database</h2>

Linear and binary <a href="model.htm">QSAR models</a>,
<a href="../apps/ph4_guide.htm">pharmacophore queries</a>,
<a href="../mdb/fpmodel.htm">fingerprint models</a>,
and 
composite models (MOE models) can all be evaluated over
a database of molecular data using the
<b>Model-Evaluate</b> application.
This panel is accessed from the Database Viewer using
<span class="menu">DBV | Compute | Model | Evaluate</span>.

<p>If MOE/cluster (MOE/smp) is enabled, the calculation will be distributed over
the available host machines.

<p><center><img src="modcomp/modeval.png" alt="Model-Evaluate Panel"></center>

<ul>

<p><li><b>Database</b>. Database to perform the calculation on.

<p><li><b>Model File</b>. A previously saved file.  The model file
can be of any of the recognized types: linear QSAR, binary QSAR,
pharmacophore, fingerprint, or MOE model.

<p><li><b>Field</b>.  Name of the field to be used for saving the output
of the evaluation.  The field will be created or, if it already exists,
overwritten with the new results.

<p><li><b>Entries</b>. Specifies which entries are to be evaluated:
<b>All</b> entries in the database,
only the <b>Selected</b> entries in the database, or only the
<b>Visible</b> entries in the database.

<p><li><b>Use Descriptors in Database if Available</b>. If off, then
all model descriptors (variables) will be recalculated
regardless of what is available in
the database.  Otherwise, if a model descriptor is present as a field in
the database, then the values in the database field will be used
in the calculations.

</ul>

<p>Press <b>OK</b> to start the calculation.  

<p><b>Note:</b> If the model's
parameters were estimated using only QuaSAR-Descriptor molecule descriptors,
then only the molecule structure need be present in the molecular database.
If other descriptors were used in the parameter estimation, these
descriptors must also be present in the database.

</ol>

<h2>SVL Commands</h2>

<a class="svl" href="fcnref/modsave.htm">model_Save</a><br />
<a class="svl" href="fcnref/model.htm">model_EvaluateMDB</a>

<h2>See Also</h2>

<a href="model.htm">QuaSAR-Model</a><br />
<a href="../mdb/fpmodel.htm">MOE-FingerprintModel</a><br />
<a href="../apps/combitools.htm">Combinatorial Library</a><br />
<a href="../apps/ph4_query.htm">Pharmacophore Query Editor</a> <br />
<a href="descr.htm">QuaSAR-Descriptor</a><br />
<a href="qsar.htm">QuaSAR Overview</a>


<noscript>
	<hr noshade="noshade" />
	<font size="2"> Copyright &copy; 1997&ndash;2015
	<a href="http://www.chemcomp.com">Chemical Computing Group Inc.</a> </font>
</noscript>
<div id="MoeFooter"></div>
</body>
</html>
