<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
"http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">

<!--
!!    MOE 2010.10 On-Line Manuals
!!    COPYRIGHT (C) 2010
!!        CHEMICAL COMPUTING GROUP INC.  ALL RIGHTS RESERVED.
!!-->

<!--	randetc.html
!!
!!	12-may-2005 (ms) Modifyied examples
!!	21-mar-2005 (ms) Explained task_fork handling of random numbers
!!	21-feb-2005 (ms) Added randseed
!!-->

<head>

<meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
<link rel="stylesheet" type="text/css"
href="../../manstyle.css" />


<meta keywords>
<meta functions rand>
<meta functions randU>
<meta functions randE>
<meta functions randN>
<meta functions randseed>

<title>Random Number Generators</title>
</head>


<body  bgcolor="#ffffff">
<a href="../../index.htm"><img src="../../images/logo.gif"
alt="CCG Logo" align="right" width="174" height="55" border="0" /></a>
<h4>MOE 2010.10</h4>
<h2>Random Number Generators</h2>
<hr noshade="noshade" />

<h2>Syntax</h2>

<pre>
    val = <a class="fcnlink" href="#rand">rand</a> v 
    val = <a class="fcnlink" href="#randE">randE</a> v 
    val = <a class="fcnlink" href="#randN">randN</a> v 
    val = <a class="fcnlink" href="#randU">randU</a> v 

    seed = <a class="fcnlink" href="#randseed">randseed</a> []
    old_seed = <a class="fcnlink" href="#randseed">randseed</a> new_seed 
</pre>

<p><a name="rand"></a></p>
<h2>Description</h2>


<p>For each leaf element&nbsp;<tt>q</tt> of vector&nbsp;<tt>v</tt>, 
return a random number based on the specified probability distribution: 

<!-- DESC -->

<p>
<table width="100%" cellpadding="5">
<tr>
<td valign="baseline">
<a name="rand"></a><tt>rand</tt>

<td valign="baseline">Integer in the range:&nbsp;<tt>[0..q)</tt>
when&nbsp;q&nbsp;&gt;&nbsp;0, or&nbsp;<tt>(q..0]</tt>
when&nbsp;q&nbsp;&lt;&nbsp;0, or trivially&nbsp;<tt>0</tt>
when&nbsp;q&nbsp;=&nbsp;0.  The argument&nbsp;<tt>q</tt> is rounded
before the random number is generated.

<pre>
svl&gt; <span class="fcndef">rand</span> [10, 9, 14, [8, 4]] 
[2, 0, 11, [3, 0]] 
</pre>
</tr>

<tr>
<td valign="baseline">
<a name="rand"></a>
<a name="randE"></a><tt>randE</tt>
<td valign="baseline">Non-negative real number from exponential distribution 
(1/<i>q</i>)<i>e<sup>-x/q</sup></i>

<pre>
svl&gt; randE [10, 10, 10] 
[14.4387,24.0121,1.37647] 
</pre>
</tr>

<tr>
<td valign="baseline">
<a name="rand"></a>
<a name="randN"></a><tt>randN</tt>
<td valign="baseline">Real number from the normal distribution:

<p>
<img src="randetc/norm-dist.gif">

<p>taking zero mean&nbsp;<tt>(&mu;=0)</tt> and with standard
deviation&nbsp;<tt>q</tt>. 

<pre>
svl&gt; randN [10, [11, 12]] 
[ -10.6109, [7.4708,-1.74995] ]
</pre>
</tr>

<tr>
<td valign="baseline">
<a name="rand"></a>
<a name="randU"></a><tt>randU</tt>
<td valign="baseline">

Real number in the range:&nbsp;<tt>[0..q)</tt> when&nbsp;q&nbsp;&gt;&nbsp;0,
or&nbsp;<tt>(q..0]</tt> when&nbsp;q&nbsp;&lt;&nbsp;0, or trivially&nbsp;0
when&nbsp;q&nbsp;=&nbsp;0,

according to a uniform density distribution. 

<pre>
svl&gt; randU [10, 10, 10] 
[2.41069, 3.91353, 4.0776] 
</pre>
</tr>

</table>

<!-- ENDDESC -->

<p><a name="randseed"></a></p>
<p><hr>
The random functions

<tt>rand</tt>,
<tt>randU</tt>,
<tt>randE</tt>,
<tt>randN</tt>,
<tt>shuffle</tt>,
<tt>x_shuffle</tt>,
<tt>sample</tt>,
<tt>x_sample</tt>

use a random number generator.  In general, each call to these functions
returns a different value.  However, if the random number generator is
reset to the same state, then the same sequence of functions will return
the same sequence of values.  Function&nbsp;<tt>randseed</tt> changes
the state of the generator.  The effect of the change is limited to the
random functions of only the current task.  If the
function&nbsp;<tt>randseed</tt> is not called (or if it is called with
argument&nbsp;0), then the random functions use the <i>default</i>
random number generator.

<p>When a task that uses the default number generator is duplicated,
the child task will use the same, default random number generator.  However,
when a task that uses a non-default (seeded) random number generator is
duplicated, the child task will use a separate random number generator,
initialized to the same state as the generator of the parent task.

As a consequence, 1)&nbsp;the random number functions will return the same
result, whether they are called from the parent task or the child task and
2)&nbsp;the random numbers generated by the parent task are unaffected by
the actions of the child task.

<p><pre>rnd_state = <span class="fcndef">randseed</span> []
</pre>

Returns the current state of the random number generator.  The state is
represented by a vector of numbers.  If the default random number generator is
being used, the function returns&nbsp;0.

<p><pre><span class="fcndef">randseed</span> rnd_state
old_rnd_state = <span class="fcndef">randseed</span> rnd_state
</pre>

Resets the state of the random number generator to a previous state and returns
the current state.  The state is represented by a vector of numbers.  If the
default random number generator is being used, the function returns&nbsp;0.

Warning: If the argument is of the same shape as a valid state but does not
represent a valid state (e.g.&nbsp;a vector of all zeros), the random number
generators could lose its probabilistic properties.

<p><pre><span class="fcndef">randseed</span> seed
old_rnd_state = <span class="fcndef">randseed</span> seed
</pre>

Resets the state of the random number generator to a state derived from a
scalar seed and returns the current state.  If the default random number
generator is being used, the function returns&nbsp;0.

<p><pre><span class="fcndef">randseed</span> 0
old_rnd_state = <span class="fcndef">randseed</span> 0
</pre>

Resets the currently used generator back to the default random number
generator.  As a special case, when the argument is zero and the default random
number generator is being used, the function does&nbsp;<i>not</i>
return&nbsp;0, but the full state of the generator.

<p>Example:
Repeat the same sequence of random numbers:

<pre>
svl&gt; randseed 5; randU [1,1,1]
[0.12945,0.584205,0.859906]

svl&gt; randseed 5; randU [1,1,1]
[0.12945,0.584205,0.859906]
</pre>

<p>Example:<br />
Use a reproducible random numbers for a part of the code:

<pre>
    local s = randseed myseed;
    ... use random functions ...
    randseed s;
</pre>

<p>Example:<br />
Reproduce the result of a given function,&nbsp;<tt>fcn</tt>, when
the result the function <tt>fcn</tt> depends on the state
of the random number generator.
In order to reproduce the conditions for which the result fails
a given test,&nbsp;<tt>test&nbsp;x</tt>, we save the state of the random
number generator in the variable&nbsp;<tt>s</tt>.  The function
<tt>randseed</tt> is called twice in a row to guarantee that
the&nbsp;<i>full</i> state of the generator is saved even for the default
generator, for which a single&nbsp;<tt>randseed</tt> call would return
only&nbsp;0.

<pre>
    loop
        s = randseed randseed [];
        x = fcn arg;
    until test x endloop

    randseed s;
    x = fcn arg;
    print [test_x: test x];     // prints [test_x: 1]
</pre>

<p>Example:<br />

To show the effect of a task fork on random number generation,
print a sequence of random numbers from both the parent task and
the child task.

<pre>
    function test_rand seed
        randseed seed;
	write ['parent:\t{}\n', rand [10,10,10]];
	write ['child:\t{}\n', first task_call ['rand', [10,10,10]]];
    endfunction
</pre>

When the same, default random number generator is used by both the child and
the parent task, the sequences will differ.  Also, a different result
is printed with every call.

<pre>
svl&gt; test_rand 0     // global default generator
[5,7,1]
[9,8,0]
</pre>

When each task uses its own copy of a random number generator,
both copies initialized to the same seed, the printed sequences
will be identical.  Also, the same result is printed with every call.

<pre>
svl&gt; test_rand 1     // local generator seeded with 1
[6,9,1]
[6,9,1]
</pre>


<h2>See Also</h2>

<p>
<a class="svl" href="specfcn.htm">loggamma</a>
<a class="svl" href="sampletc.html">sample</a>
<a class="svl" href="serial.htm">serial</a> 
<a class="svl" href="sampletc.html">shuffle</a> 
</p>


<p><a href="../../index.htm">MOE Table of Contents</a>&nbsp;&nbsp;<a href="../../fcnindex.html">SVL Function Index</a></p>
<hr noshade="noshade" />
<a href="http://www.chemcomp.com"><img src="../../images/flogo.gif"
alt="CCG Logo"
align="left" width="30" height="30" border="1" hspace="5" vspace="3" /></a>
<font size="2">
<a href="../../legal.html">Copyright</a> &copy; 1997-2010
<a href="http://www.chemcomp.com">Chemical Computing Group Inc.</a><br />
<a href="mailto:info@chemcomp.com"><i>info@chemcomp.com</i></a>
</font>
</body>
</html>
