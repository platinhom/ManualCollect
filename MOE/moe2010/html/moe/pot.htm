<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
"http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">

<!--
!!    MOE 2010.10 On-Line Manuals
!!    COPYRIGHT (C) 2010
!!        CHEMICAL COMPUTING GROUP INC.  ALL RIGHTS RESERVED.
!!-->

<!--
!! 	pot.htm				Potential Setup Panel
!! 
!!	22-oct-2010 (kk) minor layout, cores, maximum threads, forcefield eqn
!!	27-may-2010 (kk) fix e_tor_t, e_ang_a; re-snapped panels; class="menu"
!! 	16-feb-2006 (pl) added reaction field stuff
!! 	06-oct-2004 (pl) created
!!-->

<head>

<meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
<link rel="stylesheet" type="text/css"
href="../manstyle.css" />



<meta panel Potential Setup>
<meta panel Partial Charge>

<title>Potential Energy Selection and Configuration</title>

<meta keywords />

</head>
<body>
<a href="../index.htm"><img src="../images/logo.gif"
alt="CCG Logo" align="right" width="174" height="55" border="0" /></a>
<h4>MOE 2010.10</h4>
<h2>Potential Energy Selection and Configuration</h2>
<hr noshade="noshade" />

<ul>
<li><a href="#Equation">The Forcefield Equation</a></li>
<li><a href="#Charge">Partial Charges</a></li>
<li><a href="#Forcefield">Forcefield Selection and Configuration</a></li>
<li><a href="#Parameters">Parameter Report</a></li>
<li><a href="#Restraints">Atom Restraints and Tethers</a></li>
<li><a href="#Wall">Wall Restraints</a></li>
<li><a href="#SVL">SVL Commands</a></li>
<li><a href="#References">References</a></li>
</ul>

<p>
The Potential Setup panel is used to select a forcefield in MOE, to configure
its parameters and to manage restraint forces applied to the atoms.
The potential energy of the currently loaded molecular system in MOE
is calculated according to the currently loaded forcefield, and
can be obtained using
<span class="menu">MOE | Compute | Potential Energy</span>.
The currently loaded forcefield is indicated by the label
on the <span class="nobr"><b>MOE | Footer |</b> <i>Forcefield</i></span>
button.  Pressing this button opens the Potential Setup panel;
this panel can also be opened by selecting
<span class="menu">MOE | Window | Potential Setup</span>.
</p>

<p>
The Potential Setup window has a number of separate pages and each will
be described below.
MOE supports a wide variety of forcefield parameter sets.  The following
table describes the standard distribution forcefields.
</p>
<table class="titlebar" width="100%" border="1" cellpadding="3">
<tr>
<th>Title</th>
<th>Reference</th>
<th>Description</th>
</tr>
<tr>
<td valign="top">Amber89</td>
<td valign="top">[Kollman&nbsp;1986]</td>
<td valign="top">
An all-atom forcefield parameterized for proteins and nucleic acids (ff89).
This forcefield is not suitable for most small organic molecules.
Partial charges are dictionary based; in MOE, non-dictionary charges are
set to Gasteiger [Gasteiger&nbsp;1980] charges.  Explicit Lone Pairs are
required for Sulfur.
</td></tr>
<tr>
<td valign="top">Amber94</td>
<td valign="top">[Kollman&nbsp;1995]</td>
<td valign="top">
An all-atom forcefield parameterized for proteins and nucleic acids (ff94).
This forcefield is not suitable for most small organic molecules.
Partial charges are dictionary based; in MOE, non-dictionary charges are
set to Gasteiger [Gasteiger&nbsp;1980] charges.
This forcefield is compatible with RESP and AM1-BCC [Jakalian&nbsp;2002]
charges.
Polar hydrogens have zero van der Waals radii.
</td></tr>
<tr>
<td valign="top">Amber99</td>
<td valign="top">[Wang&nbsp;2000]</td>
<td valign="top">
An all-atom forcefield parameterized for proteins and nucleic acids (ff99).
This forcefield is not suitable for most small organic molecules.
Partial charges are dictionary based; in MOE, non-dictionary charges are
set to Gasteiger [Gasteiger&nbsp;1980] charges.
This forcefield is compatible with RESP and AM1-BCC [Jakalian&nbsp;2002]
charges.
Polar hydrogens have zero van der Waals radii.
</td></tr>
<tr>
<td valign="top">CHARMM27</td>
<td valign="top">[MacKerell&nbsp;2004]</td>
<td valign="top">
An all-atom forcefield parameterized for proteins, DNA and RNA.
This forcefield is not suitable for most small organic molecules nor
heme groups.
A charge dictionary is used along with a bond-charge increments
model for small molecules.
</td></tr>
<tr>
<td valign="top">CHARMM22</td>
<td valign="top">[MacKerell&nbsp;1998]</td>
<td valign="top">
An all-atom forcefield parameterized for proteins and heme groups.
This forcefield is not suitable for most small organic molecules nor DNA.
Partial charges are based on bond-charge increments that reproduce
the original dictionary charges.
</td></tr>
<tr>
<td valign="top">Engh-Huber</td>
<td valign="top">[Engh&nbsp;1991]</td>
<td valign="top">
A united atom forcefield parameterized for crystallographic refinement
of proteins.  Explicit hydrogens are required for polar atoms (N and O).
This forcefield is not suitable for most small organic molecules nor DNA.
Partial charges are based on bond-charge increments that reproduce
the original dictionary charges.
</td></tr>
<tr>
<td valign="top">MMFF94</td>
<td valign="top">[Halgren&nbsp;1996]</td>
<td valign="top">
An all-atom forcefield parameterized for small organic molecules.
Partial charges are based on bond-charge increments.  Suitable for use
with Generalized Born solvation models.  Conjugated nitrogens are
tetrahedral.
</td></tr>
<tr>
<td valign="top">MMFF94s</td>
<td valign="top">[Halgren&nbsp;1999]</td>
<td valign="top">
An all-atom forcefield parameterized for small organic molecules.
Partial charges are based on bond-charge increments.  Suitable for use
with Generalized Born solvation models.  Conjugated nitrogens are less
tetrahedral than with MMFF94.
</td></tr>
<tr>
<td valign="top">MMFF94x</td>
<td valign="top">(unpublished)</td>
<td valign="top">
An all-atom forcefield parameterized for small organic molecules.
Partial charges are based on bond-charge increments.  Suitable for use
with Generalized Born solvation models.  Conjugated nitrogens are planar.
</td></tr>
<tr>
<td valign="top">OPLS-AA</td>
<td valign="top">[Jorgensen&nbsp;1996]</td>
<td valign="top">
An all-atom forcefield parameterized for proteins and some small organic
molecules.  Partial charges are based on bond-charge increments that reproduce
the original dictionary charges.  Polar hydrogens have zero van der Waals
radii.
</td></tr>
<tr>
<td valign="top">PEF95SAC</td>
<td valign="top">[Rasmussen&nbsp;1997]</td>
<td valign="top">
An all-atom forcefield parameterized for carbohydrates only.
Partial charges are based on bond-charge increments that reproduce
the original dictionary charges.
</td></tr>
<tr>
<td valign="top">Rule</td>
<td valign="top">(unpublished)</td>
<td valign="top">
An all-atom forcefield using rule-based parameters.  This forcefield is
used to test the MOE parameter default system and should not be used for
normal work.
</td></tr>
<tr>
<td valign="top">TAFF</td>
<td valign="top">(unpublished)</td>
<td valign="top">
An all-atom forcefield parameterized for small molecules.  Atoms have
Tripos atom types.  No claim is made with respect to accuracy to the
Sybyl forcefield.  Electrostatics are disabled.
</td></tr>
</table>


<a name="Equation"></a>
<h2>The Forcefield Equation</h2>
<p>
The potential energy of a molecular system is a function of the atomic
coordinates:
</p>
<p align="center">
 <img src="pot/E.png" alt="E(x)" />
</p>
<p>
Each of the energy terms is itself a sum involving particular kinds of
atomic interactions.  When
<span class="menu">MOE | Compute | Potential Energy</span> is
invoked, the individual terms are displayed in both the MOE Window
and the <a href="gui/svlcommands.html">SVL Commands Window</a>.
</p>
<p>
<i>E</i><sub>str</sub> is the bond stretch energy:
</p>

<p align="center">
 <img src="pot/e_str.png" alt="E str" />
</p>
<p>
where the sum extends over all bonds <i>i-j</i>;
<i>w</i><sub>str</sub> is a weight; <i>k<sub>ij</sub></i>,
<i>k'<sub>ij</sub></i> and <i>k"<sub>ij</sub></i> are the force constants,
and <i>L<sub>ij</sub></i> is the equilibrium bond length.
Morse potentials can be approximated sufficiently well by expanding the
Morse potential in a Taylor series about the equilibrium bond length and
truncating it to the quartic term.  In this way the linear term will be zero
(at equilibrium) and the constant term can be neglected.
</p>

<p>
<i>E</i><sub>ang</sub> is the bond angle bend energy:
</p>
<p align="center">
 <img src="pot/e_ang.png" alt="E ang" />
</p>
<p>
where the sum extends over all bond angles <i>i-j-k</i>;
<i>w</i><sub>ang</sub> is a weight;
<i>k<sub>ijk</sub></i>; <i>k'<sub>ijk</sub></i> and
<i>k"<sub>ijk</sub></i> are the force constants, <i>A<sub>ijk</sub></i> is
the equilibrium bond angle (in radians), <i>d<sub>ijk</sub></i> is either
<i>a<sub>ijk</sub></i> - <i>A<sub>ijk</sub></i> (angle form) or
cos&nbsp;<i>a<sub>ijk</sub></i> - cos&nbsp;<i>A<sub>ijk</sub></i>
(cosine form) depending on the functional form chosen for angle interactions,
and
</p>
<p align="center">
 <img src="pot/e_ang_a.png" alt="E ang a" />
</p>

<p>
For linear molecules (e.g. <i>sp</i> hybridization),
<i>k<sub>ijk</sub></i>&nbsp;(1&nbsp;+&nbsp;cos&nbsp;<i>a<sub>ijk</sub></i>)
is used in place of the quartic expression.  For octahedral and square-planar
geometries
<i>k<sub>ijk</sub></i>&nbsp;(1&nbsp;-&nbsp;cos&nbsp;(4<i>a<sub>ijk</sub></i>))
is used in place of the quartic expression.
</p>
<p>
<i>E</i><sub>stb</sub> is the stretch-bend energy:
</p>
<p align="center">
 <img src="pot/e_stb.png" alt="E stb" />
</p>
<p>
where the sum extends over all bond angles <i>i-j-k</i>;
<i>w</i><sub>stb</sub> is a weight, <i>k<sub>ijk</sub></i> and
<i>k<sub>kji</sub></i> are stretch-bend force constants, and the other
terms are as in the stretch and bond angle terms. Stretch-bend terms are
not used for linear or near-linear equilibrium angles.
</p>

<p>
<i>E</i><sub>oop</sub> is the out-of-plane energy:
</p>
<p align="center">
 <img src="pot/e_oop.png" alt="E oop" />
</p>
<p>
where the sum extends over all atoms <i>i</i> with three neighbors
<i>j</i>, <i>k</i>, and <i>l</i>;  <i>w</i><sub>oop</sub> is a weight,
k<i><sub>i;jkl</sub></i> is the out-of-plane force constant, and
<i>X<sub>i;jkl</sub></i> is the Wilson angle (the angle between the bond
<i>il</i> and the plane <i>ijk</i>).
In some forcefields the out-of-plane energy equation is the same as that
of torsion energies except that instead of using <i>i-j-k-l</i> atoms bonded
in sequence, the sum extends over atoms <i>i</i> with three bonded neighbors
<i>j, k</i> and <i>l</i>.
</p>

<p>
<i>E</i><sub>tor</sub> is the dihedral angle, or torsion energy:
</p>

<p align="center">
 <img src="pot/e_tor.png" alt="E tor" />
</p>
<p>
where the sum extends over all sets of four consecutive bonded atoms
<i>i-j-k-l</i>;  <i>w</i><sub>tor</sub> is a weight, <i>k<sub>n;ijkl</sub></i>
are force constants, <i>P<sub>n;ijkl</sub></i> are phase angle parameters
and
</p>

<p align="center">
 <img src="pot/e_tor_t.png" alt="E tor t" />
</p>

<p>
<i>E</i><sub>vdw</sub> is the van der Waals energy:
</p>
<p align="center">
 <img src="pot/e_vdw.png" alt="E vdw" />
</p>
<p>
where <i>w</i><sub>vdw</sub> is a weight, and <i>e<sub>ij</sub></i>,
<i>R<sub>ij</sub></i>, <i>m<sub>ij</sub></i> and <i>n<sub>ij</sub></i> are
forcefield parameters.  The <i>a</i> and <i>b</i> constants prevent division
by 0 and are called buffering constants.
<i>I</i><sup>vdw</sup> is an interaction scale factor defined to
be 0 for 1-2 and 1-3 interactions, a parameter set-dependent scale value for
1-4 interactions, and 1 for other interactions.  Although complicated,
with proper selection of parameters this form can reproduce the usual
12-6, 12-10 and 9-6 potentials.  <i>s</i> is the smoothing (cutoff)
function:
</p>

<p align="center"> <img src="pot/e_nb_s.png" alt="E nb s" />
</p>
<p>
where
<i>p</i>(<i>x</i>) = <i>x</i><sup>3</sup>
(6<i>x</i><sup>2</sup> - 15<i>x</i> + 10).
This polynomial has the properties that <i>p</i>(1)&nbsp;=&nbsp;1,
<i>p</i>(0)&nbsp;=&nbsp;0,
<i>p</i>'(0)&nbsp;=&nbsp;<i>p</i>'(1)&nbsp;=&nbsp;0 and
<i>p</i>''(0)&nbsp;=&nbsp;<i>p</i>''(1)&nbsp;=&nbsp;0.
By setting the cutoff parameters <i>r</i><sub>0</sub> and
<i>r</i><sub>1</sub>, a variety of smooth tapering functions that are
continuous in both their first and second derivatives can be created.
</p>

<a name="State"></a>
<p>
<i>T<sub>ij</sub></i> is an interaction scale factor used to scale
particular non-bonded interactions.  Associated with each atom <i>i</i> is
a <i>state value</i> <i>T<sub>i</sub></i>.  This state value is an integer
that can be set with the SVL function <tt>aSetState</tt>.  Given two atoms
<i>i</i> and <i>j</i>, the <i>T<sub>ij</sub></i> scale factor is defined
to be:
</p>

<p align="center">
 <img src="pot/e_state.png" alt="E state" />
</p>

<p>where T<sub>like</sub>, T<sub>unlike</sub> and T<sub>wild</sub> are
state parameters which can be
adjusted with the 
State Scale fields in the panel. 
For example, to disable interaction energies between two
molecules, set the state <i>T<sub>i</sub></i> of the atoms in the first
molecule to 1 and the <i>T<sub>i</sub></i> of the atoms in the second
molecule to 2.  Then set T<sub>like</sub> to 1 and T<sub>unlike</sub> to
0.  In this way, only the inter-molecular non-bonded forces will be
disabled, not the intra-molecular non-bonded forces.  Note that a
<i>T<sub>i</sub></i> of 0 is like a wildcard in that it will match any
other value. 
</p>

<p>
<a name="E_ele"><i>E</i><sub>ele</sub></a> is the electrostatics energy:
</p>
<p align="center">
    <img src="pot/e_ele.gif" width="733" height="197" alt="E ele" />
</p>
<p>
where <i>w</i><sub>ele</sub> is a weight,
<i>d</i> is the dielectric constant in the interior of the solute,
<i>d<sub>x</sub></i> is the dielectric constant of the solvent,
<i>s</i> and <i>T</i> are as in the van der Waals energy,
<i>q<sub>i</sub></i> is the partial charge on atom <i>i</i>,
<i>b</i><sub>ele</sub> is a buffering constant to prevent
zero denominators, <i>R<sub>c</sub></i> is the non-bonded
cutoff distance.
<i>I</i><sup>ele</sup>, similarly to <i>I</i><sup>vdw</sup>, is an
interaction scale factor defined to be 0 for 1-2 and 1-3 interactions, a
parameter set-dependent scale value for 1-4 interactions, and 1 for other
interactions.
</p>

<p>
<a name="E_sol"><i>E</i><sub>sol</sub></a>
is the implicit solvation energy calculated using the
Generalized Born model (GB/VI):
</p>
<p align="center">
 <img src="pot/e_sol.png" alt="E sol" />
</p>

<p>where <i>w</i><sub>sol</sub> and <i>W</i> are weights,
<i>d</i> is the dielectric constant in the interior of the solute,
<i>d<sub>x</sub></i> is the dielectric constant of the solvent
and <i>s</i> and <i>T</i> are as in the van der Waals energy.
<i>G<sub>i</sub></i> is the self energy
of atom <i>i</i> and is defined to be
</p>
<p align="center">
 <img src="pot/e_born.gif" width="487" height="67" alt="E born" />
</p>
<p>
where <i>R<sub>i</sub></i>  is the solvent model radius of
atom <i>i</i> and <i>V<sub>i</sub></i>  is an approximation to the Born Integral
[Wojciechowski&nbsp;2004].
</p>
<p>
<i>E</i><sub>res</sub> is the restraint energy and is described below.
</p>

<a name="Charge"></a>
<h2>Partial Charges</h2>

<p>If electrostatic energies are needed, the partial charges
(<i>q<sub>i</sub></i>) must be calculated prior to evaluating the
potential energy.  The SVL function <tt>pot_SetCharges</tt> calculates
the charges suggested by the currently loaded forcefield (each forcefield
parameter file can specify the partial charge method most suitable to the
parameters).
</p>

<p>To calculate partial charges on atoms of the molecular system
choose <span class="menu">MOE | Compute | Partial Charges</span>
in the MOE Window. The following panel appears:
</p>
<p align="center"><img src="pot/pcharge.png" alt="Partial Charge" /></p>

<p>You can then choose the method of calculating
partial charges, the set of atoms to operate on (selected atoms or all atoms),
and whether or not to adjust hydrogens and lone pairs.  To perform the
operation press the <b>OK</b> or <b>Apply</b> buttons.
</p>
<p>The partial charge for each atom is stored in the MOE internal atom data
structure and can be set to any arbitrary value.  You can use the SVL functions
<tt>aCharge</tt> and <tt>aSetCharge</tt> to get and to modify this
stored partial charge.  Some sets of forcefield parameters contain
specifications for the partial charge of each atom.  For example, the
AMBER forcefield described in [Kollman&nbsp;1984] and [Kollman&nbsp;1986]
uses a dictionary to set the partial charge of atoms in nucleic acids and
amino acids.  On the other hand, the MMFF94 forcefield described in
[Halgren&nbsp;1996] uses a bond charge increment method to set the
partial charges.
</p>
<p>MOE provides other methods of calculating partial charges: the PEOE
formalism [Gasteiger&nbsp;1980], the AM1/PM3/MNDO Hamiltonian charges
as calculated by MOPAC or Electrostatic Potential charges also calculated
with MOPAC.
The MOPAC charges are obtained from semi-empirical calculations using the
MOPAC Program.  MOPAC charges may require long calculation
times and are restricted to very small molecules (under 60 heavy atoms).
</p>
<p>
The PEOE (Partial Equalization of Orbital Electronegativities) method
of calculating charges is an iterative method in which charge is
transferred between bonded atoms until equilibrium.  To guarantee
convergence, the amount of charge transferred at each iteration is
damped with an exponentially decreasing scale factor. The amount of
charge transferred between atoms <i>i</i> and <i>j</i> at each iteration when
<i>X<sub>i</sub></i>&nbsp;&gt;&nbsp;<i>X<sub>j</sub></i> is:
</p>

<p align="center">
 <img src="pot/e_peoe.png" alt="E peoe" />
</p>

<p>where <i>X<sub>j</sub></i><sup>+</sup> is the electronegativity of the
positive ion of atom <i>j</i>. 
</p>

<a name="Forcefield"></a>
<h2>Forcefield Selection and Configuration</h2>

<p>
The Forcefield page is the first page that is displayed when the Potential
Setup panel is run.  This page allows selection of forcefields,
enabling or disabling of various energy terms, configuration of solvation
models and non-bonded interaction cutoffs:
</p>
<p align="center">
<img src="pot/f_page.png" alt="F page" />
</p>

<table width="100%" border="0" cellpadding="3">
<tr>
<td valign="top" width="15%"><b>Load</b></td>
<td valign="top">
Standard forcefields are selected from the <b>Load</b> menu (and loaded
immediately upon selection).  Non-standard forcefields may also be selected
by choosing the Other menu item.  The title and filename of the current
forcefield are displayed to the right.  A short description of the currently
loaded forcefield is displayed in the text area below.
</td></tr>
<tr>
<td valign="top"><b>Enable</b></td>
<td valign="top">
Each checkbox provides enable/disable control over the forcefield energy
terms.  <b>Bonded</b> refers to
<i>E</i><sub>str</sub>, <i>E</i><sub>ang</sub>, <i>E</i><sub>stb</sub>,
<i>E</i><sub>oop</sub>, and <i>E</i><sub>tor</sub>.
<b>van der Waals</b> refers to <i>E</i><sub>vdw</sub>.
<b>Electrostatics</b> refers to <i>E</i><sub>ele</sub>.
</td></tr>
<tr>
<td valign="top"><a name="Cutoff"><b>Cutoff</b></a></td>
<td valign="top">
If the checkbox is on then nonbonded cutoffs are applied to the nonbonded
energy terms.  The <b>On</b> and <b>Off</b> values refer to the
<i>r</i><sub>0</sub> and <i>r</i><sub>1</sub> parameters of the smoothing
function <i>s</i> in the energy equations.
</td></tr>
<tr>
<td valign="top"><b>Solvation</b></td>
<td valign="top">
The solvent model may configured by selecting the mode 
from the menu. <b>Gas Phase</b> disables E<sub>sol</sub> and uses the Coulomb
form of the <i>E</i><sub>ele</sub> equation. <b>Distance</b> disables 
E<sub>sol</sub> and uses the Distance Dependent Dielectric form of the
<i>E</i><sub>ele</sub> equation. <b>R-Field</b> disable E<sub>sol</sub> and
uses the Reaction Field form of the <i>E</i><sub>ele</sub> equation.
<b>Born</b> enables E<sub>sol</sub> and uses the Coulomb form of the
<i>E</i><sub>ele</sub> equation.  The interior dielectric constant
is set with <b>Dielectric</b> and the solvent dielectric is set with
<b>Exterior</b>.
</td></tr>
<tr>
<td valign="top"><b>Scale Like</b></td>
<td valign="top">
Sets the scale factors for the
<i>T</i><sub>like</sub>, <i>T</i><sub>unlike</sub> and
<i>T</i><sub>wild</sub> scaling factors terms in the non-bonded energy
equations.
</td></tr>
<tr>
<td valign="top"><b>Threads</b></td>
<td valign="top">
Sets the number of CPU threads to use in energy evaluations.  A value of 0
will cause MOE to use the same number of threads as there are processors
or cores on
the computer.  Otherwise, positive values indicate a specific number of
threads to use independent of the number of processors on the computer.
The maximum number of threads is 8.
</td></tr>
<tr>
<td valign="top"><b>Fix Hydrogens</b></td>
<td valign="top">
If there are missing hydrogens or if the forcefield requires united atoms
(implicit hydrogens) on some atoms then the <b>Fix Hydrogens</b> button should
be used to add and/or delete hydrogens according to the forcefield
specifications.
</td></tr>
<tr>
<td valign="top"><b>Fix Charges</b></td>
<td valign="top">
If the partial charges are different from those specified by the forcefield
then the <b>Fix Charges</b> button should be used to recalculate the partial
charges.
</td></tr>
</table>

<p>
The configuration parameters, other than the forcefield file itself, require
you press <b>Apply</b> to put them into effect.  Press <b>Restore</b> to
restore the parameters to the currently applicable parameters.
</p>

<a name="Parameters"></a>
<h2>Parameter Report</h2>

<p>
The Parameters page lists the parameters of the currently loaded forcefield
that are used for the current molecular system.  When developing new
forcefields, or applying a given forcefield to a molecule that may not be
appropriately parameterized, it may be necessary to find out exactly which
parameters are being used for each interaction.  The Parameters page of
the Potential Setup window is used for this purpose.
</p>
<p>
If no parameters are available for a particular interaction, MOE will
attempt to create reasonable parameters based on the element, atom type
and valence geometry of the atom in question.  Such parameters are called
missing parameters and are created by averaging similar atoms or using
element-wise defaults.  Certainly, these parameters are not ideal; however,
they produce reasonable conformations. If the <b>Display Missing Parameters
Only</b> checkbox is on, then only such missing parameters will be displayed.
</p>
<p>
The Parameters page lists the actual parameters used for the molecular system
in several lists: Atom Type, Bond Stretch, Angle Bend, Stretch-Bend,
Out-of-Plane and Torsion lists.  The <b>Parameter</b> dropdown list selects
which set of interactions are to be listed.  Each is explained below.
</p>

<table border="0" width="100%" cellpadding="5">
<tr>
<td valign="top"><img src="pot/p_atom.png" alt="P atom" /></td>
<td valign="top">
<b>Atom Type</b>
<p>
Each atom is listed on a separate line that contains its forcefield atom
type, its element symbol and atom index in the system, residue name,
mass (amu), partial charge, and van der Waals parameters.
</p>
<p>
The van der Waals parameters are the radius (Angstroms) and energy well
depth (Eps) at optimal interaction distance with a like atom type.  The
<i>m</i> and <i>n</i> are the exponents used in the Lennard-Jones type
interaction.
</p>
<p>
Lines that start with a &gt; denote atoms that cannot be assigned a
forcefield atom type.  Such atoms will receive default parameters which
are displayed in the appropriate columns.
</p>
<p>
Selecting a line in the list will cause the atoms involved in the interaction
to be selected in the MOE window.
</p></td></tr>
<tr>
<td valign="top"><img src="pot/p_str.png" alt="P str" /></td>
<td valign="top">
<b>Bond Stretch</b>
<p>
Each bond stretch interaction in the force field is listed.  For each
interaction, the atom names, numbers and types of the atoms involved
are given along with the equilibrium bond length (A) and the force
constants (kcal/mol/A<sup><i>i</i></sup>).
</p>
<p>
Lines that start with a &gt; denote interactions that cannot be assigned
explicit force constants.  Such interactions will receive default parameters
which are displayed in the appropriate columns.
</p>
<p>
Selecting a line in the list will cause the atoms involved in the interaction
to be selected in the MOE window.
</p></td></tr>
<tr>
<td valign="top"><img src="pot/p_ang.png" alt="P ang" /></td>
<td valign="top">
<b>Angle Bend</b>
<p>
Each bond angle interaction in the force field is listed.  For each
interaction, the numbers, names and types of the atoms involved are
displayed along with the equilibrium bond angle (deg) and the force
constants (kcal/mol/deg<sup><i>i</i></sup>).  The Urey-Bradley length
and force constant are also listed.
</p>
<p>
Lines that start with a &gt; denote interactions that cannot be assigned
explicit force constants.  Such interactions will receive default parameters
which are displayed in the appropriate columns.
</p>
<p>
Selecting a line in the list will cause the atoms involved in the interaction
to be selected in the MOE window.
</p></td></tr>
<tr>
<td valign="top"><img src="pot/p_stb.png" alt="P stb" /></td>
<td valign="top">
<b>Stretch-Bend</b>
<p>
Each stretch-bend interaction force in a bond angle in the force
field is listed.  For each interaction, the numbers, names and types
of the atoms involved are displayed along with the force constants
(kcal/mol/deg/A).
</p>
<p>
Lines that start with a &gt; denote interactions that cannot be assigned
explicit force constants.  Such interactions will receive default parameters
which are displayed in the appropriate columns.
</p>
<p>
Selecting a line in the list will cause the atoms involved in the interaction
to be selected in the MOE window.
</p></td></tr>
<tr>
<td valign="top"><img src="pot/p_oop.png" alt="P oop" /></td>
<td valign="top">
<b>Out-of-Plane</b>
<p>
Each out of plane interaction involving a planar atom with
coordination number 3 and an out of plane parameter is listed
</p>
<p>
Lines that start with a &gt; denote interactions that cannot be assigned
explicit force constants.  Such interactions will receive default parameters
which are displayed in the appropriate columns.
</p>
<p>
Selecting a line in the list will cause the atoms involved in the interaction
to be selected in the MOE window.
</p></td></tr>
<tr>
<td valign="top"><img src="pot/p_tor.png" alt="P tor" /></td>
<td valign="top">
<b>Torsion</b>
<p>
Each torsion involving 4 atoms bonded in a sequence is listed once.
The force constants for the Fourier expansion are in columns Ei and
the associated phase angles (degrees) are in columns Pi.
</p>
<p>
Lines that start with a &gt; denote interactions that cannot be assigned
explicit force constants.  Such interactions will receive default parameters
which are displayed in the appropriate columns.
</p>
<p>
Selecting a line in the list will cause the atoms involved in the interaction
to be selected in the MOE window.
</p></td></tr>
</table>

<p>
Press the <b>Report</b> button to create a version of the report in a MOE
text editor.  Press the <b>Refresh</b> button to recalculate the parameter
lists (although, in general, this is not required).
</p>

<a name="Restraints"></a>
<h2>Atom Restraints and Tethers</h2>

<p>
Restraints and tethers are extra terms added to the base potential function
to impose geometric conditions.  Whereas a constraint is a hard condition,
a restraint is softer in that a weight is used to create high energy values
when the constraint is violated. Restraints can be created with
<span class="menu">MOE | Edit | Potential | Restrain</span>.
Alternatively, the <tt>RestraintCreate</tt> SVL function can be used.
The Restraints page in the Potential Setup window is used to edit or delete
the restraints.  In MOE, the restraint energy is a sum of individual terms:
</p>
<p align="center">
<i>E</i><sub>res</sub> =
  <i>E<sub>d</sub></i> 
+ <i>E<sub>a</sub></i> 
+ <i>E<sub>t</sub></i> 
+ <i>E<sub>x</sub></i> 
+ <i>E<sub>h</sub></i> 
</p>

<p>where <i>E<sub>d</sub></i> is the distance restraint energy,
<i>E<sub>a</sub></i> is the angle restraint energy,
<i>E<sub>t</sub></i> is the torsion restraint energy,
<i>E<sub>x</sub></i> is the chiral/stereochemical restraint energy,
<i>E<sub>h</sub></i> is the tether energy,
Restraint terms are evaluated when the <b>Restraints</b> term is enabled
in the Forcefield page of the Potential Setup window.

Individual restraints are each parameterized with a weight, <i>w</i>, a
lower bound, <i>L</i> and upper bound <i>U</i>.  The restraint energy
is zero when a particular coordinate is within [<i>L</i>,<i>U</i>] and rises
sharply outside the interval.  Each form of restraint has a particular
functional form.
</p>
<p>
Distance restraints restrict the distance between two particular atoms and
are modeled with a function based upon
</p>
<p align="center"> <img src="pot/e_dist_r.png" alt="E dist r" />
</p>
<p>
which is used with <i>t</i> set to various values to achieve the restraint
conditions.  The function <i>p</i> is twice continuously differentiable since
<i>p'</i>(0) = 0, <i>p'</i>(1) = 1 and <i>p''</i>(0) = <i>p''</i>(1) = 0.  For
a particular distance restraint, the restraint energy is
</p>
<p align="center">
<i>E<sub>d</sub></i> = <i>w</i> [
    <i>p</i>(<i>L</i> - <i>r</i>) + <i>p</i>(<i>r</i> - <i>U</i>)
]
</p>
<p>
where <i>r</i> is the distance between the two atoms involved.  Atom tethers
also use the same functional form except that only one atom is involved
and the distance <i>r</i> is measured to a specific point in space.
Both L and U must be non-negative and L must be less than or equal to U.
</p>
<p>
Angle restraints restrict the angle between three atoms and are modeled with:
</p>
<p align="center">
<i>E<sub>a</sub></i> = 1000 <i>w</i> [
  max(0,&nbsp;cos&nbsp;<i>a</i>&nbsp;-&nbsp;cos&nbsp;L)<sup>3</sup>
+ max(0,&nbsp;cos&nbsp;U&nbsp;-&nbsp;cos&nbsp;<i>a</i>)<sup>3</sup>
]
</p>
<p>
where <i>a</i> is the interatomic angle and [L,U] is the desired interval
(in radians).  Both L and U must be non-negative and L must be less than
or equal to U.
</p>
<p>Dihedral restraints are modeled with:</p>

<p align="center">
10000<i>w</i> (1 - cos max(0,<i>d</i> - L))<sup>3</sup>
+ 10000<i>w</i> (1 - cos max(0,U - <i>d</i>))<sup>3</sup>
</p>
<p>
where <i>w</i> is the weight, <i>d</i> is the dihedral angle (in radians)
and [L,U] is the desired interval.  If L is less than or equal to U then
the interval is assumed to contain 0.5(L+U) otherwise the interval is
assumed not to contain the midpoint.
</p>
<p>
Chiral and stereochemical constraints are imposed on chiral atoms that have
three or four neighbors and a specified <i>R</i> or <i>S</i> designation,
or <i>E</i> or <i>Z</i> double bonds, which are set with the SVL function
<tt>aSetForceRS</tt>.  MOE will assign a very
large energy value to violations of chirality or stereochemistry.
</p>

<p>An atom tether is a distance restraint that restrains the distance not
between two atoms but between an atom and a fixed point in space.
Atom tethers can be set using either the <b>Tether</b> textfields or the
<b>Centroid</b> button of the <b>Restraints</b> page of the Potential Setup
panel.  These controls are used to assign tethers to all currently
selected atoms, or to all atoms if none are selected.  An individual tether
point in space can be entered manually into the <b>X</b>, <b>Y</b> and <b>Z</b>
textfields.  Alternatively,
the <b>Centroid</b> button fills the textfields with the centroid
of the currently selected atoms.
If a single atom is selected and <b>Centroid</b> pressed, the
tether point is the atom's current location.
In all cases, <b>Apply</b> must be pressed to put the tethers into effect.
</p>

<p>Temporary tethers used only for energy minimization are
available in the
<span class="menu">MOE | Compute |
<a href="../apps/emin.htm">Energy Minimize</span></a>
panel.
</p>

<p>
When the Restraints page of the Potential Setup window is selected,
the following is displayed:
</p>

<p align="center">
<img src="pot/r_page.png" alt="R page" />
</p>

<table width="100%" border="0" cellpadding="3">
<tr>
<td valign="top" width="20%"><b>Tethers</b></td>
<td valign="top">
If on, then Tether restraints will be displayed in the list.
</td></tr>
<tr>
<td valign="top"><b>Distances</b></td>
<td valign="top">
If on, then Distance restraints will be displayed in the list.
</td></tr>
<tr>
<td valign="top"><b>Angles</b></td>
<td valign="top">
If on, then Angle restraints will be displayed in the list.
</td></tr>
<tr>
<td valign="top"><b>Dihedrals</b></td>
<td valign="top">
If on, then Dihedral restraints will be displayed in the list.
</td></tr>
<tr>
<td valign="top"><b>Selected Only</b></td>
<td valign="top">
If on, then only restraints involving selected atoms will be displayed in
the list.
</td></tr>
<tr>
<td valign="top"><b>Weight</b></td>
<td valign="top">
The weight, or force constant, used for the restraint selected in the list.
</td></tr>
<tr>
<td valign="top"><b>L U</b></td>
<td valign="top">
The lower bound and upper bound restraint interval for the restraint
selected in the list.
</td></tr>
<tr>
<td valign="top"><b>Tether X, Y, Z</b></td>
<td valign="top">
The X, Y and Z coordinates of the reference point for tether restraints
selected in the list.
</td></tr>
<tr>
<td valign="top"><b>Centroid</b></td>
<td valign="top">
Press the <b>Centroid</b> to fill the X, Y and Z text fields with the
centroid of the atoms selected in the MOE window.  If no atoms are
selected then the centroid of all atoms is used.
</td></tr>
</table>

<p>
Press <b>OK</b> or <b>Apply</b> to effect changes to the restraints selected
in the list.  Text fields with empty contents will not result in any change.
Press <b>Delete</b> to delete the restraints selected in the list.
</p>

<a name="Wall"></a>
<h2>Wall Restraints</h2>

<p>
Wall restraints are used to force some or all atoms in the system to lie
in a specific box-type or ellipsoid-type region of space centered at a point
<i>c</i>&nbsp;=&nbsp;(<i>x</i><sub>0</sub>, <i>y</i><sub>0</sub>,
<i>z</i><sub>0</sub>) with dimensions
<i>D</i>&nbsp;=&nbsp;(<i>D<sub>x</sub></i>, <i>D<sub>y</sub></i>,
<i>D<sub>z</sub></i>).  The strength of the restraint is governed by a weight
<i>W</i>.
</p>
<p>
The fundamental functional form is
</p>
</p>
<p align="center"> <img src="pot/e_dist_r.png" alt="E dist r" />
</p>

<p>
which is used with <i>t</i> set to various values to achieve the restraint
conditions.  The function <i>p</i> is twice continuously differentiable since
<i>p'</i>(0) = 0, <i>p'</i>(1) = 1 and <i>p''</i>(0) = <i>p''</i>(1) = 0.
</p>
<p>
If the wall restraint type is ellipsoidal then an atom is restrained to
lie in an axis-aligned ellipsoidal region where <i>D</i> defines the radii
along each axis.  Zero values in <i>D</i> are treated as infinite to allow
definition of cylindrical regions.  For an atom with coordinates
(<i>x</i>,<i>y</i>,<i>z</i>) the ellipsoidal restraint energy
<i>E<sub>w</sub></i> is given by
</p>
<p align="center">
<i>E<sub>w</sub></i> = <i>W</i> <i>p</i>(<i>R</i> - 1), &nbsp;&nbsp;&nbsp;
<i>R</i> = sqrt(
      [ (<i>x</i> - <i>x</i><sub>0</sub>)/<i>D</i><sub>x</sub>]<sup>2</sup>
    + [ (<i>y</i> - <i>y</i><sub>0</sub>)/<i>D</i><sub>y</sub>]<sup>2</sup>
    + [ (<i>z</i> - <i>z</i><sub>0</sub>)/<i>D</i><sub>z</sub>]<sup>2</sup>
)
</p>

<p>
If the wall restraint is of box type then an atom is restrained to lie
in an axis-aligned box were <i>D</i> defines the half box dimensions of
each axis.  Zero values in <i>D</i> are treated as infinite.
For an atom with coordinates (<i>x</i>,<i>y</i>,<i>z</i>) the box restraint
energy <i>E</i> is given by
</p>
<p align="center">
<i>E<sub>w</sub></i> = <i>W</i> [
  <i>p</i>(<i>x</i> - <i>x</i><sub>0</sub> - <i>D<sub>x</sub></i>)
+ <i>p</i>(<i>x</i><sub>0</sub> - <i>D<sub>x</sub></i> - <i>x</i>)

+ <i>p</i>(<i>y</i> - <i>y</i><sub>0</sub> - <i>D<sub>y</sub></i>)
+ <i>p</i>(<i>y</i><sub>0</sub> - <i>D<sub>y</sub></i> - <i>y</i>)

+ <i>p</i>(<i>z</i> - <i>z</i><sub>0</sub> - <i>D<sub>z</sub></i>)
+ <i>p</i>(<i>z</i><sub>0</sub> - <i>D<sub>z</sub></i> - <i>z</i>)
]
</p>

<p>
If the Wall page of the Potential Setup window is selected, then following
will be displayed:
</p>
<p align="center">
<img src="pot/w_page.png" alt="W page" />
</p>

<table width="100%" border="0" cellpadding="3">
<tr>
<td valign="top" width="20%"><b>Weight</b></td>
<td valign="top">
The scaling constant, or weight <i>W</i> in the above equations.
</td></tr>
<tr>
<td valign="top"><b>Enable Wall Restraints</b></td>
<td valign="top">
If on, then wall restraints will be calculated (provided that restraint
calculations are enabled on the Forcefield page).  If off, then wall
restraints will be ignored.
</td></tr>
<tr>
<td valign="top"><b>Origin X, Y, Z</b></td>
<td valign="top">
The center coordinates (<i>x</i><sub>0</sub>, <i>y</i><sub>0</sub>,
<i>z</i><sub>0</sub>) in the restraint equations.  Press the <b>Centroid</b>
button to the right to set the center to the centroid of the selected atoms
in the MOE window.  If no atoms are selected then the centroid of all atoms
is used.
</td></tr>
<tr>
<td valign="top"><b>Radius X, Y, Z</b></td>
<td valign="top">
The dimensions (<i>D<sub>x</sub></i>, <i>D<sub>y</sub></i>,
<i>D<sub>z</sub></i>) in the restraint equations.  Zero values are treated
as infinite.  Press the <b>Centroid</b>
button to the right to set the radii to the dimensions of the atoms selected
in the MOE relative to the current Origin values.
If no atoms are selected then the atoms are used.
</td></tr>
<tr>
<td valign="top"><b>Options</b></td>
<td valign="top">
If <b>Apply Wall Restraints to Walled Atoms</b> is on then the wall restraints
will be calculated only for those atoms that have their <tt>aWall</tt> flag
set to one.  If off, the wall restraints will apply to all atoms.
<p>
If <b>Wall Restraints Define a Box</b> is on then the box-type restraint
equations are used.  If off, then the ellipsoid-type restraint equations are
used.
</p>
<p>
If <b>Draw Wall Restraints Region</b> is on then the wall limits will be
rendered in the MOE window (provided that
<span class="menu">Draw | Constraints</span> is also on).
</p></td></tr>
</table>

<p>
Press <b>OK</b> or <b>Apply</b> to effect changes to the wall restraints
parameters.  The graph displays the current wall restraint energy curve in
effect assuming that the origin is the center.  The first derivative
is displayed as well.  Press <b>Restore</b> display the
values currently in effect (all edits in the Wall page will be lost).
</p>

<a name="SVL"></a>
<h2>SVL Commands</h2>
<p>
<a href="fcnref/atom_p.htm">Atom Potential Functions</a><br />
<a href="fcnref/potfcn.htm">Potential Functions</a><br />
<a href="fcnref/restrain.html">RestraintCreate</a><br />
<a href="fcnref/ff_file.htm">Forcefield File Format</a><br />
</p>

<a name="References"></a>
<h2>References</h2>

<table cellpadding="5">

<tr> <!-- KEEP -->
<td valign="top">[Engh&nbsp;1991]</td>
<td>Engh, R.A., Huber, R.;
Accurate Bond and Angle Parameters for X-ray Protein Structure Refinement;
<i>Acta Cryst. A47</i> (<b>1991</b>) 392&ndash;400.
</td></tr>

<tr> <!-- KEEP -->
<td valign="top">[Gasteiger&nbsp;1980]</td>
<td>Gasteiger, J., Marsili, M.;
Iterative Partial Equalization Of Orbital Electronegativity - A Rapid Access
To Atomic Charges;
<I>Tetrahedron 26</I> (<b>1980</b>) 3219&ndash;3228.
</td></tr>

<tr> <!-- KEEP -->
<td valign="top">[Halgren&nbsp;1996]</td>
<td>Halgren, T.A.;
The Merck Force Field.;
<I>J. Comp. Chem. 17</I> (<b>1996</b>) 490&ndash;641.
</td></tr>


<tr> <!-- KEEP -->
<td valign="top">[Halgren&nbsp;1999]</td>
<td>Halgren, T.A.;
<i>J. Comput. Chem. 20</i> (<b>1999</b>) 720&ndash;729, 730&ndash;74.
</td></tr>

<tr> <!-- KEEP -->
<td valign="top">[Hawkins&nbsp;1995]</td>
<td> Hawkins, G.D., Cramer, C.J., Truhlar, D.G.;
Pairwise Solute Descreening of Solute Charges from a Dielectric Medium;
<i>Chem. Phys. Lett. 246</i> (<b>1995</b>) 122&ndash;129.
</td></tr>

<tr> <!-- KEEP -->
<td valign="top">[Jakalian&nbsp;2002]</td>
<td>Jakalian, A.; Jack, D.B.; Bayly, C.I.;
Fast, Efficient Generation of High-Quality Atomic Charges.  AM1-BCC Model: II.
Parameterization and Validation.  <i>J. Comput. Chem. 23</i>
(<b>2002</b>) 1623&ndash;1641.
</td></tr>

<tr> <!-- KEEP -->
<td valign="top">[Jorgensen&nbsp;1996]</td>
<td>Jorgensen W.L., Maxwell, D.S., Tirado-Rives, J.;
Development and Testing of the OPLS All-Atom Force Field on Conformational
Energetics and Properties of Organic Liquids;
<i>J. Am. Chem. Soc. 117</i> (<b>1996</b>) 11225&ndash;11236.
</td></tr>

<tr> <!-- KEEP -->
<td valign="top">[Kollman&nbsp;1986]</td>
<td>Weiner, S.J., Kollman, P.A., Nguyen, D.T., Case, D.A;
An All Atom Force Field for Simulations of Proteins and Nucleic Acids;
<I>J.&nbsp;Comp.&nbsp;Chem. 7</I> (<b>1986</b>) 230&ndash;252.
</td></tr>

<tr> <!-- KEEP -->
<td valign="top">[Kollman&nbsp;1995]</td>
<td>Cornell, W.D., Cieplak, P., Bayly, C.I., Gould, I.R., Merz, K.M. Jr.,
Ferguson, D.M., Spellmeyer, D.C., Fox, T., Caldwell, J.W., Kollman, P.A.;
A second generation force field for the simulation of proteins and nucleic
acids;
<i>J. Am. Chem. Soc. 177</i> (<b>1995</b>) 5179&ndash;5197.
</td></tr>

<tr> <!-- KEEP -->
<td valign="top">[MacKerell&nbsp;1998]</td>
<td>MacKerell et al;
All-atom empirical potential for molecular modeling and dynamics studies
of proteins;
<i>J. Phys. Chem. B 102</i> (<b>1998</b>) 3586&ndash;3616.
</td></tr>

<tr> <!-- KEEP -->
<td valign="top">[MacKerell&nbsp;2004]</td>
<td> MacKerell, A.D., Jr,. Feig, M., Brooks, C.L., III;
Extending the treatment of backbone energetics in protein force fields:
limitations of gas-phase quantum mechanics in reproducing protein
conformational distributions in molecular dynamics simulations;
<i>J. Comp. Chem. 25</i> (<b>2004</b>) 1400&ndash;1415.
</td></tr>

<tr> <!-- KEEP -->
<td valign="top">[Onufriev&nbsp;2000]</td>
<td>Onufriev, A., Bashford, D., Case, D.A.;
Modification of the Generalized Born Model Suitable for Macromolecules;
<i>J. Phys. Chem. B 104</i> (<b>2000</b>) 3712&ndash;3720.
</td></tr>

<tr> <!-- KEEP -->
<td valign="top">[Rasmussen&nbsp;1997]</td>
<td>Fabricius, J., Engelsen, S.B., Rasmussen, K.;
The Consistent Force Field. 5. PEF95SAC: Optimized Potential Energy Function
for Alcohols and Carbohydrates;
<i>J.&nbsp;Carbo.&nbsp;Chem. 16</i> (<b>1997</b>) 751&ndash;772.
</td></tr>

<tr> <!-- KEEP -->
<td valign="top">[Wang&nbsp;2000]</td>
<td>Wang, J., Cieplak, P., Kollman, P.A.;
How Well Does a Restrained Electrostatic Potential (RESP) Model Perform in
Calculating Conformational Energies of Organic and Biological Molecules?;
<i>J. Comput. Chem. 21</i> (<b>2000</b>) 1049&ndash;1074

<tr> <!-- KEEP -->
<td valign="top">[Wojciechowski&nbsp;2004]</td>
<td>Wojciechowski, M., Lesyng, B.;
Generalized Born Model: Analysis, Refinement and Applications to Proteins;
<i>J. Phys. Chem. B 108</i> (<b>2004</b>) 18368&ndash;18376.

</table>


<p><a href="../index.htm">MOE Table of Contents</a></p>
<hr noshade="noshade" />
<a href="http://www.chemcomp.com"><img src="../images/flogo.gif"
alt="CCG Logo"
align="left" width="30" height="30" border="1" hspace="5" vspace="3" /></a>
<font size="2">
<a href="../legal.html">Copyright</a> &copy; 1997-2010
<a href="http://www.chemcomp.com">Chemical Computing Group Inc.</a><br />
<a href="mailto:info@chemcomp.com"><i>info@chemcomp.com</i></a>
</font>
</body>
</html>
