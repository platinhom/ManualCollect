<!DOCTYPE html>
<html xmlns:MadCap="http://www.madcapsoftware.com/Schemas/MadCap.xsd" lang="en-US" xml:lang="en-US" data-mc-search-type="Stem" data-mc-help-system-file-name="Documentation.xml" data-mc-path-to-help-system="../" data-mc-target-type="WebHelp2" data-mc-runtime-file-type="Topic" data-mc-preload-images="false" data-mc-in-preview-mode="false" data-mc-toc-path="Installation and Jobs|Installation Guide|Preparing for Batch Queue Submission|Setup for Grid Engine Queueing Systems|License Checking for Grid Engine">
    <head>
        <meta name="viewport" content="width=device-width, initial-scale=1.0" />
        <meta charset="utf-8" />
        <meta http-equiv="X-UA-Compatible" content="IE=edge" />
        <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
        <link href="../Skins/Default/Stylesheets/Slideshow.css" rel="stylesheet" type="text/css" data-mc-generated="True" />
        <link href="../Skins/Default/Stylesheets/TextEffects.css" rel="stylesheet" type="text/css" data-mc-generated="True" />
        <link href="../Skins/Default/Stylesheets/Topic.css" rel="stylesheet" type="text/css" data-mc-generated="True" />
        <link href="../Skins/Default/Stylesheets/Components/Styles.css" rel="stylesheet" type="text/css" data-mc-generated="True" /><title>Configuring the Load Scripts for SGE</title>
        <link href="../Resources/Stylesheets/docs.css" rel="stylesheet" />
        <script src="../Resources/Scripts/custom.modernizr.js" type="text/javascript">
        </script>
        <script src="../Resources/Scripts/jquery.min.js" type="text/javascript">
        </script>
        <script src="../Resources/Scripts/require.min.js" type="text/javascript">
        </script>
        <script src="../Resources/Scripts/require.config.js" type="text/javascript">
        </script>
        <script src="../Resources/Scripts/foundation.min.js" type="text/javascript">
        </script>
        <script src="../Resources/Scripts/plugins.min.js" type="text/javascript">
        </script>
        <script src="../Resources/Scripts/MadCapAll.js" type="text/javascript">
        </script>
    </head>
    <body><a name="aanchor4389"></a>
        <MadCap:concept term="Installation/Jobs" /><a name="aanchor4390"></a>
        <MadCap:concept term="Installation and Jobs" /><a name="batch_queue_1876641381_785358"></a>
        <table class="NavLink" data-mc-conditions="Default.ScreenOnly">
            <tr class="NavLink">
                <td class="NavLeft"><span class="NavText">◀ <a class="NavLink MCXref xref xrefNavLink" href="batch_queue_sge_license_check_attributes.htm" xrefformat="{paratext}">Adding License Attributes for Grid Engine</a></span>
                </td>
                <td class="NavCenter"><span class="NavText"><a class="NavLink MCXref xref xrefNavLink" href="install_guideTOC.htm" xrefformat="{paratext}">Installation Guide</a></span>
                </td>
                <td class="NavRight"><span class="NavText"><a class="NavLink MCXref xref xrefNavLink" href="batch_queue_sge_license_check_install.htm" xrefformat="{paratext}">Installing the Load Script for Grid Engine</a> ▶</span>
                </td>
            </tr>
        </table>
        <h1 class="Title">Configuring the Load Scripts for Grid Engine</h1>
        <p>A script is provided that queries the FLEXlm license server and reports the number of tokens available for each license in a format that the queueing software can understand. To make sure the <code>lmutil</code> utility and license file can be found when the script is run by the queueing software, you need to add the locations of the program and the license file to the script, by editing the configuration section at the top of the script. You must have permission to change this file.</p>
        <table class="AutoNumber_p_Numbered1" style="width: 100%; margin-left: 0;" cellspacing="0" cellpadding="0">
            <col style="width: 0px;" />
            <col style="width: 32px;" />
            <col style="width: auto;" />
            <tr>
                <td valign="top" />
                <td class="AutoNumber_p_Numbered1" valign="top"><span>1.</span>
                </td>
                <td class="AutoNumber_p_Numbered1" valign="top" data-mc-autonum="1.">Use a text editor to edit the file <code>$SCHRODINGER/utilities/flexlm_sensor.pl</code>.</td>
            </tr>
        </table>
        <table class="AutoNumber_p_Numbered1_" style="width: 100%; margin-left: 0;" cellspacing="0" cellpadding="0">
            <col style="width: 0px;" />
            <col style="width: 32px;" />
            <col style="width: auto;" />
            <tr>
                <td valign="top" />
                <td class="AutoNumber_p_Numbered1" valign="top"><span>2.</span>
                </td>
                <td class="AutoNumber_p_Numbered1" valign="top" data-mc-autonum="2.">Edit the line beginning <code>my $LICENSE</code> so that the full path to the license file is between the quotation marks:</td>
            </tr>
        </table>
        <p class="Code1">my $LICENSE="<i class="UserReplace">full-path-to-license-file</i>";</p>
        <p class="Indented1">You can specify the license server instead of the license file as follows:</p>
        <p class="Code1">my $LICENSE="\@<i class="UserReplace">license-server</i>";</p>
        <p class="Indented1">or</p>
        <p class="Code1">my $LICENSE="<i class="UserReplace">port</i>\@<i class="UserReplace">license-server</i>";</p>
        <p class="Indented1">The backslash is necessary as Perl interprets @ as a special character.</p>
        <table class="AutoNumber_p_Numbered1_" style="width: 100%; margin-left: 0;" cellspacing="0" cellpadding="0">
            <col style="width: 0px;" />
            <col style="width: 32px;" />
            <col style="width: auto;" />
            <tr>
                <td valign="top" />
                <td class="AutoNumber_p_Numbered1" valign="top"><span>3.</span>
                </td>
                <td class="AutoNumber_p_Numbered1" valign="top" data-mc-autonum="3.">Edit the line beginning <code>my $LMUTIL</code> so that the full path to <code>lmutil</code> is between the quotation marks:</td>
            </tr>
        </table>
        <p class="Code1">my $LMUTIL="<i class="UserReplace">full-path-to-lmutil</i>";</p>
        <table class="AutoNumber_p_Numbered1_" style="width: 100%; margin-left: 0;" cellspacing="0" cellpadding="0">
            <col style="width: 0px;" />
            <col style="width: 32px;" />
            <col style="width: auto;" />
            <tr>
                <td valign="top" />
                <td class="AutoNumber_p_Numbered1" valign="top"><span>4.</span>
                </td>
                <td class="AutoNumber_p_Numbered1" valign="top" data-mc-autonum="4.">To reserve licenses for non-queue use, edit the line beginning <code>my $reserved</code> to set the value to the fraction or percentage of licenses to reserve. For example, either of the following lines reserves 20% of the licenses for non-queue use.</td>
            </tr>
        </table>
        <p class="Code1">my $reserved = 0.2;</p>
        <p class="Code1">my $reserved = "20%";</p>
        <table class="AutoNumber_p_Numbered1_" style="width: 100%; margin-left: 0;" cellspacing="0" cellpadding="0">
            <col style="width: 0px;" />
            <col style="width: 32px;" />
            <col style="width: auto;" />
            <tr>
                <td valign="top" />
                <td class="AutoNumber_p_Numbered1" valign="top"><span>5.</span>
                </td>
                <td class="AutoNumber_p_Numbered1" valign="top" data-mc-autonum="5.">To allow Grid Engine to handle license resources internally, edit the line beginning <code>my_$allow_internal_tracking</code> to set the value to 1. This allows Grid Engine to dispatch the job based on the license availability of either <code>complex_values - internal_count</code> or <code>load_values</code>.</td>
            </tr>
        </table>
        <p class="Code1">my $allow_internal_tracking = 1;</p>
        <table class="AutoNumber_p_Numbered1_" style="width: 100%; margin-left: 0;" cellspacing="0" cellpadding="0">
            <col style="width: 0px;" />
            <col style="width: 32px;" />
            <col style="width: auto;" />
            <tr>
                <td valign="top" />
                <td class="AutoNumber_p_Numbered1" valign="top"><span>6.</span>
                </td>
                <td class="AutoNumber_p_Numbered1" valign="top" data-mc-autonum="6.">Set the path to the qconf binary by editing the line beginning <code>my_$qconf</code>. This allows the load sensor to change the <code>complex_values</code> attribute, enabling internal tracking of license resource. </td>
            </tr>
        </table>
        <p class="Code1">my $qconf = <i>full-path-to-qconf-binary</i>;</p>
        <table class="AutoNumber_p_Numbered1_" style="width: 100%; margin-left: 0;" cellspacing="0" cellpadding="0">
            <col style="width: 0px;" />
            <col style="width: 32px;" />
            <col style="width: auto;" />
            <tr>
                <td valign="top" />
                <td class="AutoNumber_p_Numbered1" valign="top"><span>7.</span>
                </td>
                <td class="AutoNumber_p_Numbered1" valign="top" data-mc-autonum="7.">Save the modified script and close the editor.</td>
            </tr>
        </table>
        <p>Follow the instructions below to verify that the script is configured properly. If you test the script before and after specifying reserved licenses, you should see the number of licenses reported decrease by the specified percentage.</p>
        <table class="AutoNumber_p_Numbered1" style="width: 100%; margin-left: 0;" cellspacing="0" cellpadding="0">
            <col style="width: 0px;" />
            <col style="width: 32px;" />
            <col style="width: auto;" />
            <tr>
                <td valign="top" />
                <td class="AutoNumber_p_Numbered1" valign="top"><span>1.</span>
                </td>
                <td class="AutoNumber_p_Numbered1" valign="top" data-mc-autonum="1.">Enter the following command: </td>
            </tr>
        </table>
        <p class="Code1">perl $SCHRODINGER/utilities/<code>flexlm_sensor.pl</code></p>
        <table class="AutoNumber_p_Numbered1_" style="width: 100%; margin-left: 0;" cellspacing="0" cellpadding="0">
            <col style="width: 0px;" />
            <col style="width: 32px;" />
            <col style="width: auto;" />
            <tr>
                <td valign="top" />
                <td class="AutoNumber_p_Numbered1" valign="top"><span>2.</span>
                </td>
                <td class="AutoNumber_p_Numbered1" valign="top" data-mc-autonum="2.">Press the <span class="Keys">ENTER</span> key. </td>
            </tr>
        </table>
        <p>You should get a block of output like</p><pre>
begin
global:IMPACT_MAIN:20
global:MMLIBS:20
end
</pre>
        <p>showing the number of tokens available for each license. Pressing the <span class="Keys">Enter</span> key again updates the list, and the script waits for further input until you close the input stream by typing <span class="Keys">Ctrl+D</span>.</p>
        <p>The log output from the script is sent to the system logging facility (syslog), so you can examine the syslog to find information about the actions performed by the script. More verbose information is sent to the <code>$logfile</code> which is set manually (and optionally) inside the script.</p>
        <table class="NavLink" data-mc-conditions="Default.ScreenOnly">
            <tr class="NavLink">
                <td class="NavLeft"><span class="NavText">◀ <a class="NavLink MCXref xref xrefNavLink" href="batch_queue_sge_license_check_attributes.htm" xrefformat="{paratext}">Adding License Attributes for Grid Engine</a></span>
                </td>
                <td class="NavCenter"><span class="NavText"><a class="NavLink MCXref xref xrefNavLink" href="install_guideTOC.htm" xrefformat="{paratext}">Installation Guide</a></span>
                </td>
                <td class="NavRight"><span class="NavText"><a class="NavLink MCXref xref xrefNavLink" href="batch_queue_sge_license_check_install.htm" xrefformat="{paratext}">Installing the Load Script for Grid Engine</a> ▶</span>
                </td>
            </tr>
        </table>
    </body>
</html>