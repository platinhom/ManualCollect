<!DOCTYPE html>
<html xmlns:MadCap="http://www.madcapsoftware.com/Schemas/MadCap.xsd" lang="en-US" xml:lang="en-US" data-mc-search-type="Stem" data-mc-help-system-file-name="Documentation.xml" data-mc-path-to-help-system="../" data-mc-target-type="WebHelp2" data-mc-runtime-file-type="Topic" data-mc-preload-images="false" data-mc-in-preview-mode="false" data-mc-toc-path="User Manuals|Jaguar User Manual|Theory Overview for Jaguar Methods">
    <head>
        <meta name="viewport" content="width=device-width, initial-scale=1.0" />
        <meta charset="utf-8" />
        <meta http-equiv="X-UA-Compatible" content="IE=edge" />
        <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
        <link href="../Skins/Default/Stylesheets/Slideshow.css" rel="stylesheet" type="text/css" data-mc-generated="True" />
        <link href="../Skins/Default/Stylesheets/TextEffects.css" rel="stylesheet" type="text/css" data-mc-generated="True" />
        <link href="../Skins/Default/Stylesheets/Topic.css" rel="stylesheet" type="text/css" data-mc-generated="True" />
        <link href="../Skins/Default/Stylesheets/Components/Styles.css" rel="stylesheet" type="text/css" data-mc-generated="True" /><title>The ZORA Hamiltonian</title>
        <link href="../Resources/Stylesheets/docs.css" rel="stylesheet" />
        <script src="../Resources/Scripts/custom.modernizr.js" type="text/javascript">
        </script>
        <script src="../Resources/Scripts/jquery.min.js" type="text/javascript">
        </script>
        <script src="../Resources/Scripts/require.min.js" type="text/javascript">
        </script>
        <script src="../Resources/Scripts/require.config.js" type="text/javascript">
        </script>
        <script src="../Resources/Scripts/foundation.min.js" type="text/javascript">
        </script>
        <script src="../Resources/Scripts/plugins.min.js" type="text/javascript">
        </script>
        <script src="../Resources/Scripts/MadCapAll.js" type="text/javascript">
        </script>
    </head>
    <body><a name="aanchor4017"></a>
        <MadCap:concept term="User Manuals" /><a name="aanchor4018"></a>
        <MadCap:concept term="Jaguar" /><a name="jaguar_theory_2952449424_131818"></a><a name="jaguar_theory_2952449424_23308"></a>
        <table class="NavLink" data-mc-conditions="Default.ScreenOnly">
            <tr class="NavLink">
                <td class="NavLeft"><span class="NavText">◀ <a class="NavLink MCXref xref xrefNavLink" href="jaguar_theory_dft_lrc.htm">Long-Range-Corrected Density Functionals</a></span>
                </td>
                <td class="NavCenter"><span class="NavText"><a class="NavLink MCXref xref xrefNavLink" href="jaguar_user_manualTOC.htm">Jaguar User Manual</a></span>
                </td>
                <td class="NavRight">
                &#160;
        </td>
            </tr>
        </table>
        <h1 class="Title">The ZORA Hamiltonian</h1>
        <p>The effect of relativity on the motion of electrons near the nucleus changes the electronic structure. This effect increases with Z, so that for the lower half of the periodic table, inclusion of relativistic effects is necessary to get quantitative accuracy and frequently even qualitative accuracy. Even for the first transition series, relativistic effects on the 4s electron are larger than the 1 kcal/mol “chemical accuracy” threshold.</p>
        <p>The most rigorous introduction of relativistic effects is done with the Dirac Hamiltonian. A full implementation of the Hartree-Fock method with the Dirac Hamiltonian (Dirac-Hartree-Fock, or DHF) is 1 to 2 orders of magnitude more time-consuming than the usual nonrelativistic Hartree-Fock method. Consequently, many approximations to this method have been developed, derived in one way or another from the Dirac equation. For an introduction to relativistic effects in quantum chemistry, see the book by Dyall and Fægri <a class="Reference_Number MCXref xref xrefReference_Number" href="jaguar_references.htm#jaguar_references_1926199490_247425">[<span style="color: #0e6895;" class="mcFormatColor">187</span>]</a>.</p>
        <p>One popular way of including relativistic effects in density functional calculations is through the ZORA (zeroth-order regular approximation) Hamiltonian [<a class="Reference_Number MCXref xref xrefReference_Number" href="jaguar_references.htm#jaguar_references_1926199490_247200">[<span style="color: #0e6895;" class="mcFormatColor">190</span>]</a>, <a class="Reference_Number MCXref xref xrefReference_Number" href="jaguar_references.htm#jaguar_references_1926199490_247202">[<span style="color: #0e6895;" class="mcFormatColor">191</span>]</a>]. It is derived by eliminating the so-called “small component” of the Dirac wave function, leaving a two-component Hamiltonian that includes spin-free and spin-dependent operators, including the spin-orbit interaction. The ZORA Hamiltonian can be written as follows:</p>
        <table class="AutoNumber_p_Equation_" style="width: 100%;" cellspacing="0" cellpadding="0">
            <col style="width: auto;" />
            <col style="width: 100px;" />
            <col style="width: auto;" />
            <tr>
                <td class="AutoNumber_p_Equation_" valign="top" data-mc-autonum="(1)">
                    <img src="../GeneratedImages/Equations/Equation117.svg" alt="" class="_MCEquation_0 mcReset" />
                </td>
                <td class="AutoNumber_p_Equation_" valign="top"><span>(1)</span>
                </td>
                <td valign="top" />
            </tr>
        </table>
        <p>where c is the speed of light (approximately 137 in atomic units), and <span class="Symbol">s</span> is the vector of Pauli matrices,</p>
        <table class="AutoNumber_p_Equation_" style="width: 100%;" cellspacing="0" cellpadding="0">
            <col style="width: auto;" />
            <col style="width: 100px;" />
            <col style="width: auto;" />
            <tr>
                <td class="AutoNumber_p_Equation_" valign="top" data-mc-autonum="(2)">
                    <img src="../GeneratedImages/Equations/Equation118.svg" alt="" class="_MCEquation_0 mcReset" />
                </td>
                <td class="AutoNumber_p_Equation_" valign="top"><span>(2)</span>
                </td>
                <td valign="top" />
            </tr>
        </table>
        <p>As these are 2x2 matrices, the wave function is a 2-component vector, with the components representing alpha and beta spin. One can think of writing the spin functions as</p>
        <table class="AutoNumber_p_Equation_" style="width: 100%;" cellspacing="0" cellpadding="0">
            <col style="width: auto;" />
            <col style="width: 100px;" />
            <col style="width: auto;" />
            <tr>
                <td class="AutoNumber_p_Equation_" valign="top" data-mc-autonum="(3)">
                    <img src="../GeneratedImages/Equations/Equation119.svg" alt="" class="_MCEquation_0 mcReset" />
                </td>
                <td class="AutoNumber_p_Equation_" valign="top"><span>(3)</span>
                </td>
                <td valign="top" />
            </tr>
        </table>
        <p>The ZORA Hamiltonian can be rearranged by partitioning the denominator to give the nonrelativistic Hamiltonian with a relativistic correction,</p>
        <table class="AutoNumber_p_Equation_" style="width: 100%;" cellspacing="0" cellpadding="0">
            <col style="width: auto;" />
            <col style="width: 100px;" />
            <col style="width: auto;" />
            <tr>
                <td class="AutoNumber_p_Equation_" valign="top" data-mc-autonum="(4)">
                    <img src="../GeneratedImages/Equations/Equation120.svg" alt="" class="_MCEquation_0 mcReset" />.</td>
                <td class="AutoNumber_p_Equation_" valign="top"><span>(4)</span>
                </td>
                <td valign="top" />
            </tr>
        </table>
        <p>Finally, the properties of the Pauli matrices can be exploited to partition the relativistic correction into a spin-free and a spin-dependent part,</p>
        <table class="AutoNumber_p_Equation_" style="width: 100%;" cellspacing="0" cellpadding="0">
            <col style="width: auto;" />
            <col style="width: 100px;" />
            <col style="width: auto;" />
            <tr>
                <td class="AutoNumber_p_Equation_" valign="top" data-mc-autonum="(5)">
                    <img src="../GeneratedImages/Equations/Equation121.svg" alt="" class="_MCEquation_0 mcReset" />.</td>
                <td class="AutoNumber_p_Equation_" valign="top"><span>(5)</span>
                </td>
                <td valign="top" />
            </tr>
        </table>
        <p>If the last, spin-dependent, term is left out, the Hamiltonian is called the scalar ZORA Hamiltonian, spin-free ZORA Hamiltonian, or one-component ZORA Hamiltonian. When the last term is included, the Hamiltonian is called the spin-orbit ZORA Hamiltonian or two-component ZORA Hamiltonian.</p>
        <p>The ZORA Hamiltonian has some known issues. If you add a constant to the potential in any Hamiltonian, the energy should shift by the same constant. In ZORA this does not happen because the constant is also added in the denominator. This means that the ZORA Hamiltonian is not invariant to the electric gauge (the choice of the zero of potential, which involves shifting the zero by a constant). To alleviate this problem, the potential in the denominator (or in fact the entire relativistic correction) can be fixed, so that instead of the potential of the system it is a model potential <a class="Reference_Number MCXref xref xrefReference_Number" href="jaguar_references.htm#jaguar_references_1926199490_247204">[<span style="color: #0e6895;" class="mcFormatColor">192</span>]</a>. Thus we write the ZORA Hamiltonian as</p>
        <table class="AutoNumber_p_Equation_" style="width: 100%;" cellspacing="0" cellpadding="0">
            <col style="width: auto;" />
            <col style="width: 100px;" />
            <col style="width: auto;" />
            <tr>
                <td class="AutoNumber_p_Equation_" valign="top" data-mc-autonum="(6)">
                    <img src="../GeneratedImages/Equations/Equation122.svg" alt="" class="_MCEquation_0 mcReset" />.</td>
                <td class="AutoNumber_p_Equation_" valign="top"><span>(6)</span>
                </td>
                <td valign="top" />
            </tr>
        </table>
        <p>The second issue is what to include in the model potential. The ZORA Hamiltonian was originally derived from the one-electron Dirac equation, so <i>V</i><sup>MP</sup> is the bare nuclear potential. For use in many-electron systems, it should be derived instead from the Dirac-Hartree-Fock (DHF) equation or the Dirac-Kohn-Sham (DKS) equation. Derivation from the DHF equation results in a very complicated operator, and some approximation is needed <a class="Reference_Number MCXref xref xrefReference_Number" href="jaguar_references.htm#jaguar_references_1926199490_247215">[<span style="color: #0e6895;" class="mcFormatColor">193</span>]</a>. By neglecting small terms, the potential <i>V</i><sup>MP</sup> includes only the nuclear and electronic Coulomb potentials,</p>
        <table class="AutoNumber_p_Equation_" style="width: 100%;" cellspacing="0" cellpadding="0">
            <col style="width: auto;" />
            <col style="width: 100px;" />
            <col style="width: auto;" />
            <tr>
                <td class="AutoNumber_p_Equation_" valign="top" data-mc-autonum="(7)"><a name="jaguar_theory_2952449424_131858"></a>
                    <img src="../GeneratedImages/Equations/Equation123.svg" alt="" class="_MCEquation_0 mcReset" />.</td>
                <td class="AutoNumber_p_Equation_" valign="top"><span>(7)</span>
                </td>
                <td valign="top" />
            </tr>
        </table>
        <p>Derivation from the DKS equation is straightforward, and simply involves adding the electronic Coulomb and exchange-correlation potential to the nuclear potential in <i>V</i><sup>MP</sup>. </p>
        <table class="AutoNumber_p_Equation_" style="width: 100%;" cellspacing="0" cellpadding="0">
            <col style="width: auto;" />
            <col style="width: 100px;" />
            <col style="width: auto;" />
            <tr>
                <td class="AutoNumber_p_Equation_" valign="top" data-mc-autonum="(8)">
                    <img src="../GeneratedImages/Equations/Equation124.svg" alt="" class="_MCEquation_0 mcReset" />.</td>
                <td class="AutoNumber_p_Equation_" valign="top"><span>(8)</span>
                </td>
                <td valign="top" />
            </tr>
        </table>
        <p>The potential depends on the choice of density functional, and for a hybrid functional that includes exact exchange, which is not included in the model potential derived from the DHF equation. The compromise used in Jaguar is to add only the electronic Coulomb potential, as in <a class="Equation_Number MCXref xref xrefEquation_Number selected" href="#jaguar_theory_2952449424_131858">.</a>, as this accounts for the bulk of the many-electron effects. The potential is evaluated from the spherically averaged atomic initial guess, and is not changed subsequently.</p>
        <p>The third issue is that the eigenvalues of the ZORA Hamiltonian (or Fock matrix) are substantially lower than those from the Dirac Hamiltonian (or DHF matrix). This is due to the approximations made to derive the ZORA Hamiltonian, which as a result does not include all of the lowest-order relativistic effects. However, an a posteriori correction can be made to the eigenvalues and applied to the calculation of the total energy <a class="Reference_Number MCXref xref xrefReference_Number" href="jaguar_references.htm#jaguar_references_1926199490_247340">[<span style="color: #0e6895;" class="mcFormatColor">194</span>]</a>, as follows. </p>
        <p>The ZORA equation is derived by neglecting part of the normalization of the Dirac wave function. The operator for the normalization (the metric operator) with the lowest order correction included is</p>
        <table class="AutoNumber_p_Equation_" style="width: 100%;" cellspacing="0" cellpadding="0">
            <col style="width: auto;" />
            <col style="width: 100px;" />
            <col style="width: auto;" />
            <tr>
                <td class="AutoNumber_p_Equation_" valign="top" data-mc-autonum="(9)">
                    <img src="../GeneratedImages/Equations/Equation125.svg" alt="" class="_MCEquation_0 mcReset" />
                </td>
                <td class="AutoNumber_p_Equation_" valign="top"><span>(9)</span>
                </td>
                <td valign="top" />
            </tr>
        </table>
        <p>If we evaluate the matrix element of this operator for each orbital, and divide the eigenvalue, we get the scaled ZORA eigenvalues,</p>
        <table class="AutoNumber_p_Equation_" style="width: 100%;" cellspacing="0" cellpadding="0">
            <col style="width: auto;" />
            <col style="width: 100px;" />
            <col style="width: auto;" />
            <tr>
                <td class="AutoNumber_p_Equation_" valign="top" data-mc-autonum="(10)">
                    <img src="../GeneratedImages/Equations/Equation126.svg" alt="" class="_MCEquation_0 mcReset" />
                </td>
                <td class="AutoNumber_p_Equation_" valign="top"><span>(10)</span>
                </td>
                <td valign="top" />
            </tr>
        </table>
        <p>For a one-electron system, the scaled ZORA eigenvalues are exactly equal to the Dirac eigenvalues. For a many-electron system, this should still be a good approximation. To apply the scaling in the total energy, note that the energy can be written as </p>
        <table class="AutoNumber_p_Equation_" style="width: 100%;" cellspacing="0" cellpadding="0">
            <col style="width: auto;" />
            <col style="width: 100px;" />
            <col style="width: auto;" />
            <tr>
                <td class="AutoNumber_p_Equation_" valign="top" data-mc-autonum="(11)">
                    <img src="../GeneratedImages/Equations/Equation127.svg" alt="" class="_MCEquation_0 mcReset" />
                </td>
                <td class="AutoNumber_p_Equation_" valign="top"><span>(11)</span>
                </td>
                <td valign="top" />
            </tr>
        </table>
        <p>because the eigenvalue can be written as</p>
        <table class="AutoNumber_p_Equation_" style="width: 100%;" cellspacing="0" cellpadding="0">
            <col style="width: auto;" />
            <col style="width: 100px;" />
            <col style="width: auto;" />
            <tr>
                <td class="AutoNumber_p_Equation_" valign="top" data-mc-autonum="(12)">
                    <img src="../GeneratedImages/Equations/Equation128.svg" alt="" class="_MCEquation_0 mcReset" />
                </td>
                <td class="AutoNumber_p_Equation_" valign="top"><span>(12)</span>
                </td>
                <td valign="top" />
            </tr>
        </table>
        <p>The scaled ZORA energy is then calculated by replacing the ZORA eigenvalues in the energy expression with the scaled ZORA eigenvalues.</p>
        <p>In the implementation of ZORA, as the potential is in the denominator, it is difficult (if not impossible) to calculate the integrals analytically. In Jaguar (as in other codes), the integrand is tabulated on a grid: the ratio involving the potential is tabulated on the grid, the momentum operators are applied to the basis functions and the result is tabulated on the grid. The integrals are then evaluated by numerical integration. The same numerical integration methods are used as for DFT, with grids adjusted to produce accurate integrals of the ZORA relativistic correction operator. </p>
        <p>A further approximation is available, and is used as the default. As relativistic effects are localized near the nuclei, the ZORA integrals are evaluated as one-center integrals, with the model potential containing only the nuclear and electronic Coulomb potential for that center. This is called the “local” approximation, is gauge-invariant, and has zero derivatives with respect to nuclear displacements. The full evaluation of the integrals evaluated over all centers with potentials for all centers is labeled “global”. These integrals vary with internuclear distance.</p>
        <p>&#160;</p>
        <table class="NavLink" data-mc-conditions="Default.ScreenOnly">
            <tr class="NavLink">
                <td class="NavLeft"><span class="NavText">◀ <a class="NavLink MCXref xref xrefNavLink" href="jaguar_theory_dft_lrc.htm">Long-Range-Corrected Density Functionals</a></span>
                </td>
                <td class="NavCenter"><span class="NavText"><a class="NavLink MCXref xref xrefNavLink" href="jaguar_user_manualTOC.htm">Jaguar User Manual</a></span>
                </td>
                <td class="NavRight">
                &#160;
        </td>
            </tr>
        </table>
    </body>
</html>