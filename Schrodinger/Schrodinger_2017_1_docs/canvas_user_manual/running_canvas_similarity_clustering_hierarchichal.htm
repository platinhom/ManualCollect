<!DOCTYPE html>
<html xmlns:MadCap="http://www.madcapsoftware.com/Schemas/MadCap.xsd" lang="en-US" xml:lang="en-US" data-mc-search-type="Stem" data-mc-help-system-file-name="Documentation.xml" data-mc-path-to-help-system="../" data-mc-target-type="WebHelp2" data-mc-runtime-file-type="Topic" data-mc-preload-images="false" data-mc-in-preview-mode="false" data-mc-toc-path="User Manuals|Canvas User Manual|Running Applications from Canvas|Similarity, Dissimilarity, and Clustering in Canvas|Clustering Structures by Similarity or Distance in Canvas">
    <head>
        <meta name="viewport" content="width=device-width, initial-scale=1.0" />
        <meta charset="utf-8" />
        <meta http-equiv="X-UA-Compatible" content="IE=edge" />
        <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
        <link href="../Skins/Default/Stylesheets/Slideshow.css" rel="stylesheet" type="text/css" data-mc-generated="True" />
        <link href="../Skins/Default/Stylesheets/TextEffects.css" rel="stylesheet" type="text/css" data-mc-generated="True" />
        <link href="../Skins/Default/Stylesheets/Topic.css" rel="stylesheet" type="text/css" data-mc-generated="True" />
        <link href="../Skins/Default/Stylesheets/Components/Styles.css" rel="stylesheet" type="text/css" data-mc-generated="True" /><title>Hierarchical Clustering Options</title>
        <link href="../Resources/TableStyles/StandardRules.css" rel="stylesheet" data-mc-stylesheet-type="table" />
        <link href="../Resources/Stylesheets/docs.css" rel="stylesheet" />
        <script src="../Resources/Scripts/custom.modernizr.js" type="text/javascript">
        </script>
        <script src="../Resources/Scripts/jquery.min.js" type="text/javascript">
        </script>
        <script src="../Resources/Scripts/require.min.js" type="text/javascript">
        </script>
        <script src="../Resources/Scripts/require.config.js" type="text/javascript">
        </script>
        <script src="../Resources/Scripts/foundation.min.js" type="text/javascript">
        </script>
        <script src="../Resources/Scripts/plugins.min.js" type="text/javascript">
        </script>
        <script src="../Resources/Scripts/MadCapAll.js" type="text/javascript">
        </script>
    </head>
    <body><a name="aanchor3605"></a>
        <MadCap:concept term="User Manuals" /><a name="aanchor3606"></a>
        <MadCap:concept term="Canvas" /><a name="running_canvas_3200570573_747634"></a>
        <table class="NavLink" data-mc-conditions="Default.ScreenOnly">
            <tr class="NavLink">
                <td class="NavLeft"><span class="NavText">◀ <a class="NavLink MCXref xref xrefNavLink" href="running_canvas_similarity_clustering.htm">Clustering Structures by Similarity or Distance in Canvas</a></span>
                </td>
                <td class="NavCenter"><span class="NavText"><a class="NavLink MCXref xref xrefNavLink" href="canvas_user_manualTOC.htm">Canvas User Manual</a></span>
                </td>
                <td class="NavRight"><span class="NavText"><a class="NavLink MCXref xref xrefNavLink" href="running_canvas_similarity_clustering_lf_kmeans.htm">Leader-Follower and K-Means Clustering Options</a> ▶</span>
                </td>
            </tr>
        </table>
        <h1 class="Title">Hierarchical Clustering Options</h1>
        <p>The specific options for hierarchical clustering include the following:</p>
        <ul>
            <li value="1">
                <p class="ListPara">If the matrix is asymmetric, you can select <span class="GUI">Matrix is asymmetric</span> and then choose how to treat the off-diagonal elements. </p>
            </li>
            <li value="2">
                <p class="ListPara">You must choose a clustering linkage method, from the nine available methods. The linkage method describes how to calculate the distance between clusters. When you choose a linkage method, the description is displayed in the <span class="GUI">Description</span> text area. The linkage methods are listed in <a class="Table_Number MCXref xref xrefTable_Number selected" href="#running_canvas_3200570573_768475">Table 1</a>.</p>
                <p class="image">
                    <img src="hierarchical_clustering.png" style="margin: 2px;" />
                </p>
            </li>
        </ul>
        <p>The results of hierarchical clustering are not incorporated directly into the project. Instead, you can view a dendrogram of the clusters, and choose a set of clusters to export either to a file or to the spreadsheet. </p>
        <table class="TableStyle-StandardRules" style="caption-side: top;mc-table-style: url('../Resources/TableStyles/StandardRules.css');" cellspacing="0">
            <caption valign="top" style="padding-bottom: 7pt;">
                <p class="Table_Caption" data-mc-autonum="Table 1. "><span class="autonumber"><span>Table 1. </span></span><a name="running_canvas_3200570573_768475"></a><span class="_Override">Description of linkage methods for hierarchical clustering.</span>
                </p>
            </caption>
            <thead>
                <tr class="TableStyle-StandardRules-Head-Header1">
                    <td class="TableStyle-StandardRules-HeadE-Column1-Header1">
                        <p class="Cell_Heading">Method</p>
                    </td>
                    <td class="TableStyle-StandardRules-HeadD-Column1-Header1">
                        <p class="Cell_Heading">Description</p>
                    </td>
                </tr>
            </thead>
            <tbody>
                <tr class="TableStyle-StandardRules-Body-Body1">
                    <td class="TableStyle-StandardRules-BodyH-Column1-Body1">
                        <p class="Cell_Body"><span class="GUITable">Single</span>
                        </p>
                    </td>
                    <td class="TableStyle-StandardRules-BodyG-Column1-Body1">
                        <p class="Cell_Body">Closest inter-cluster pair (nearest neighbor)</p>
                    </td>
                </tr>
                <tr class="TableStyle-StandardRules-Body-Body1">
                    <td class="TableStyle-StandardRules-BodyE-Column1-Body1">
                        <p class="Cell_Body"><span class="GUITable">Complete</span>
                        </p>
                    </td>
                    <td class="TableStyle-StandardRules-BodyD-Column1-Body1">
                        <p class="Cell_Body">Farthest inter-cluster pair (farthest neighbor)</p>
                    </td>
                </tr>
                <tr class="TableStyle-StandardRules-Body-Body2">
                    <td class="TableStyle-StandardRules-BodyH-Column1-Body2">
                        <p class="Cell_Body"><span class="GUITable">Average</span>
                        </p>
                    </td>
                    <td class="TableStyle-StandardRules-BodyG-Column1-Body2">
                        <p class="Cell_Body">Average distance between all inter-cluster pairs</p>
                    </td>
                </tr>
                <tr class="TableStyle-StandardRules-Body-Body2">
                    <td class="TableStyle-StandardRules-BodyE-Column1-Body2">
                        <p class="Cell_Body"><span class="GUITable">Centroid</span>
                        </p>
                    </td>
                    <td class="TableStyle-StandardRules-BodyD-Column1-Body2">
                        <p class="Cell_Body">Euclidean distance between cluster centroids</p>
                    </td>
                </tr>
                <tr class="TableStyle-StandardRules-Body-Body1">
                    <td class="TableStyle-StandardRules-BodyH-Column1-Body1">
                        <p class="Cell_Body"><span class="GUITable">McQuitty</span>
                        </p>
                    </td>
                    <td class="TableStyle-StandardRules-BodyG-Column1-Body1">
                        <p class="Cell_Body">Average distance to the two clusters merged in forming a given cluster</p>
                    </td>
                </tr>
                <tr class="TableStyle-StandardRules-Body-Body1">
                    <td class="TableStyle-StandardRules-BodyE-Column1-Body1">
                        <p class="Cell_Body"><span class="GUITable">Ward</span>
                        </p>
                    </td>
                    <td class="TableStyle-StandardRules-BodyD-Column1-Body1">
                        <p class="Cell_Body">Sum of squared distances to merged cluster centroid (minimum variance)</p>
                    </td>
                </tr>
                <tr class="TableStyle-StandardRules-Body-Body2">
                    <td class="TableStyle-StandardRules-BodyH-Column1-Body2">
                        <p class="Cell_Body"><span class="GUITable">Weighted centroid</span>
                        </p>
                    </td>
                    <td class="TableStyle-StandardRules-BodyG-Column1-Body2">
                        <p class="Cell_Body">Weighted center of mass distance, also known as median</p>
                    </td>
                </tr>
                <tr class="TableStyle-StandardRules-Body-Body2">
                    <td class="TableStyle-StandardRules-BodyE-Column1-Body2">
                        <p class="Cell_Body"><span class="GUITable">Flexible beta</span>
                        </p>
                    </td>
                    <td class="TableStyle-StandardRules-BodyD-Column1-Body2">
                        <p class="Cell_Body">Weighted average intra-cluster and inter-cluster distances (Lance-Williams) with beta=0.25</p>
                    </td>
                </tr>
                <tr class="TableStyle-StandardRules-Body-Body1">
                    <td class="TableStyle-StandardRules-BodyB-Column1-Body1">
                        <p class="Cell_Body"><span class="GUITable">Schrödinger</span>
                        </p>
                    </td>
                    <td class="TableStyle-StandardRules-BodyA-Column1-Body1">
                        <p class="Cell_Body">Closest distance between terminal (right-to-left) points in 1D cluster orderings.</p>
                    </td>
                </tr>
            </tbody>
        </table>
        <p>To view the dendrogram, right-click on the job record in the <span class="GUI">Project View</span> panel and choose <span class="GUI">View</span>. In the <span class="GUI">Hierarchical Clustering Dendrogram</span> panel, you can choose the cluster set by the number of clusters, by the Kelley criterion <a class="Reference_Number MCXref xref xrefReference_Number" href="canvas_references.htm#canvas_references_3811068687_742779">[<span style="color: #0e6895;" class="mcFormatColor">4</span>]</a>, or by the merging distance. The merging distance is displayed as a tool tip when you pause the pointer over a split point. For the last of these, you must click <span class="GUI">Update</span> after changing the merging distance to view the new set of clusters. To change the scaling of the dendrogram, use the mouse wheel. You can export an image of the dendrogram in PNG, JPEG, or TIFF format by clicking <span class="GUI">Save Image</span>.</p>
        <p class="image">
            <img src="hierarchical_clustering_dendrogram.png" style="margin: 2px;" />
        </p>
        <p>By default, the dendrogram is colored by cluster membership. You can color the leaf nodes by the values of a property with a heat map, by selecting <span class="GUI">Color by property</span>, and clicking <span class="GUI">Edit Heat Map</span> to choose the properties and setting the color range for the property (see <a class="TopicLink MCXref xref xrefTopicLink" href="canvas_gui_organize_heatmap.htm#canvas_gui_2356900553_745322">Creating a Property Heat Map in the Canvas Spreadsheet</a>). The properties that you select are added to the option menu in the <span class="GUI">Hierarchical Clustering Dendrogram</span> panel, so you can switch between properties. To switch back to coloring by cluster membership, select <span class="GUI">Color by cluster</span>.</p>
        <p>When you have selected a set of clusters by any of the three methods, you can click <span class="GUI">Export</span> to export the clusters or their centroids to a file or to the spreadsheet. The <span class="GUI">Export Selection</span> dialog box opens, in which you can specify the destination and make other related settings. In addition to the structures, three properties are exported: Cluster, which is the cluster index, Centroid, which is 1 for the centroid of each cluster, and 0 otherwise, and Total, which is the number of structures in the cluster. If there is a tie for the centroid, the first structure is chosen.</p>
        <p>If you choose <span class="GUI">To file</span>, click <span class="GUI">Browse</span> to navigate to the location for the file, select the file format from Maestro, SD, or CSV, and name the file. You can export the structures in each cluster to a separate file, labeled with the cluster index, by selecting <span class="GUI">Place results into separate files</span>. CSV files include the structure name, a SMILES string for the structure, and the three properties. If you chose to export only the centroids, they are written to a single file.</p>
        <p>If you choose <span class="GUI">To spreadsheet</span>, the column names for the properties are derived from the property name by adding a prefix, which you can specify in the <span class="GUI">Name prefix</span> text box. The resulting column names are <i class="UserReplace">prefix</i><span class="GUI">:Cluster</span>, <i class="UserReplace">prefix</i><span class="GUI">:Centroid</span>, and <i class="UserReplace">prefix</i><span class="GUI">:Total</span>. The default prefix is <span class="GUI">HClust::</span><i class="UserReplace">jobname</i>. The clusters can be exported to separate views, named <i class="UserReplace">prefix</i><span class="GUI">::cluster&#160;N</span>, by selecting <span class="GUI">Place clusters in separate views</span>. If you chose to export only the centroids, they are written to a single view named <i class="UserReplace">prefix</i><span class="GUI">::centroids</span>.</p>
        <p>You can view the structures that belong to a cluster by clicking the “leaf” (the square at the bottom of the dendrogram) for one of the cluster members. A limited custom view is displayed that contains only the structures by default, with the background color of the cluster from the dendrogram. You can add properties to the view by choosing <span class="GUI">View </span>→<span class="GUI"> Manage Properties</span> and selecting the properties. When you do, these properties are added by default to any cluster view opened by clicking its leaf. To view the structures for more than one cluster, click in the dendrogram panel, then control-click the leaf. </p>
        <table class="NavLink" data-mc-conditions="Default.ScreenOnly">
            <tr class="NavLink">
                <td class="NavLeft"><span class="NavText">◀ <a class="NavLink MCXref xref xrefNavLink" href="running_canvas_similarity_clustering.htm">Clustering Structures by Similarity or Distance in Canvas</a></span>
                </td>
                <td class="NavCenter"><span class="NavText"><a class="NavLink MCXref xref xrefNavLink" href="canvas_user_manualTOC.htm">Canvas User Manual</a></span>
                </td>
                <td class="NavRight"><span class="NavText"><a class="NavLink MCXref xref xrefNavLink" href="running_canvas_similarity_clustering_lf_kmeans.htm">Leader-Follower and K-Means Clustering Options</a> ▶</span>
                </td>
            </tr>
        </table>
    </body>
</html>