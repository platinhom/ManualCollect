<!DOCTYPE html>
<html xmlns:MadCap="http://www.madcapsoftware.com/Schemas/MadCap.xsd" xml:lang="en-us" lang="en-us" data-mc-search-type="Stem" data-mc-help-system-file-name="Documentation.xml" data-mc-path-to-help-system="../" data-mc-target-type="WebHelp2" data-mc-runtime-file-type="Topic" data-mc-preload-images="false" data-mc-in-preview-mode="false" data-mc-toc-path="Tutorials|Protein-Ligand Database (PLDB) Tutorial">
    <head>
        <meta name="viewport" content="width=device-width, initial-scale=1.0" />
        <meta charset="utf-8" />
        <meta http-equiv="X-UA-Compatible" content="IE=edge" />
        <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
        <link href="../Skins/Default/Stylesheets/Slideshow.css" rel="stylesheet" type="text/css" data-mc-generated="True" />
        <link href="../Skins/Default/Stylesheets/TextEffects.css" rel="stylesheet" type="text/css" data-mc-generated="True" />
        <link href="../Skins/Default/Stylesheets/Topic.css" rel="stylesheet" type="text/css" data-mc-generated="True" />
        <link href="../Skins/Default/Stylesheets/Components/Styles.css" rel="stylesheet" type="text/css" data-mc-generated="True" /><title>Analyzing Lysine Interactions with Ligand Pyrroles</title>
        <link href="../Resources/Stylesheets/bootstrap.min.css" rel="stylesheet" type="text/css" />
        <link href="../Resources/Stylesheets/docs.css" rel="stylesheet" />
        <script src="../Resources/Scripts/custom.modernizr.js" type="text/javascript">
        </script>
        <script src="../Resources/Scripts/jquery.min.js" type="text/javascript">
        </script>
        <script src="../Resources/Scripts/require.min.js" type="text/javascript">
        </script>
        <script src="../Resources/Scripts/require.config.js" type="text/javascript">
        </script>
        <script src="../Resources/Scripts/foundation.min.js" type="text/javascript">
        </script>
        <script src="../Resources/Scripts/plugins.min.js" type="text/javascript">
        </script>
        <script src="../Resources/Scripts/MadCapAll.js" type="text/javascript">
        </script>
    </head>
    <body><a name="aanchor4475"></a>
        <MadCap:concept term="PLDB" /><a name="aanchor4476"></a>
        <MadCap:concept term="Tutorials" />
        <table class="NavLink">
            <tr class="NavLink">
                <td class="NavLeft"><span class="NavText">◀ <a href="pldb_tut_ligand_sim.htm" class="NavLink MCXref xref xrefNavLink" xrefformat="{paratext}">Using a Ligand Similarity Search to Find Factor Xa Binders</a></span>
                </td>
                <td class="NavCenter"><span class="NavText"><a class="NavLink MCXref xref xrefNavLink" href="pldb_tutorialTOC.htm" xrefformat="{paratext}">Protein-Ligand Database (PLDB) Tutorial</a></span>
                </td>
                <td class="NavRight"><span class="NavText"><a href="pldb_tut_hinge_indoles.htm" class="NavLink MCXref xref xrefNavLink" xrefformat="{paratext}">Finding Hinge-Binding Ligand Indoles</a> ▶</span>
                </td>
            </tr>
        </table>
        <h1>Analyzing Lysine Interactions with Ligand Pyrroles</h1>
        <p>In this exercise, we will go through the creation of a sample geometric search where we'll analyze how lysines interact with ligand pyrroles. Details of using the geometric search functionality can be found by clicking the Help button in the bottom-left corner of the search form.</p>
        <h3>Creating and Running the Query</h3>
        <ol start="1">
            <li value="1">
                <p>In the history panel, click the <span class="GUI">New Search</span> button to begin a new query. </p>
            </li>
            <li value="2">
                <p>In the sketcher, draw the pyrrole. Make sure you are drawing in ligand mode by selecting the <span class="GUI">Ligand</span> option from the <span class="GUI">Draw</span> menu at the bottom of the sketcher. For information on using the sketcher, see <a href="../maestro_tools_help/2d_sketcher.html" class="MCXref xref" xrefformat="{paratext}">2D Workspace Panel</a>.</p>
                <p>
                    <img src="ligand_receptor_mode.png" class="img-responsive" />
                </p>
                <p>In ligand mode, everything you draw in the sketcher appears in black, as below.</p>
                <p>
                    <img src="ligand_pyrrole.png" />
                    <br />
                </p>
            </li>
            <li value="3">
                <p>Click on the <span class="GUI">Add Residue</span> button  in the toolbar to the right of the sketcher, and click in the sketcher to add a residue to the workspace.</p>
                <p>
                    <img src="add_residue_button.png" />
                </p>
            </li>
            <li value="4">
                <p>Right-click on the residue and choose <span class="GUI">Edit Residue Type</span>.</p>
                <p>
                    <img src="pyrrole_query_set_residue.png" class="img-responsive" />
                </p>
            </li>
            <li value="5">
                <p>Select Lys from the menu and click <span class="GUI">OK</span>. <br /><img src="set_residue_type.png" class="img-responsive" /><br /><br /></p>
                <p>The resulting residue blob looks like this:</p>
                <p>
                    <img src="lys_residue_blob.png" />
                </p>
            </li>
            <li value="6">
                <p>Right-click on the residue and select <span class="GUI">Expand Residue</span>.</p>
                <p>
                    <img src="expanded_residue.png" class="img-responsive" />
                </p>
                <p>You may want to reorient or move these objects once you've added them to the sketcher. Select the rotate tool  from the toolbar to the left of the sketcher to rotate your selections by clicking and dragging them into the desired orientation. </p>
                <p>
                    <img src="../Resources/Images/Sketcher/rotate.png" />
                </p>
                <p>To move substructures in the sketcher, select the  move tool from the toolbar to the left of the sketcher.</p>
                <p>
                    <img src="../Resources/Images/Sketcher/move.png" />
                </p>
                <p>Then  drag the entity to the desired location. When using the rotate and move tools, you can tell which substructures you are operating on because they will become bold as you mouse over them. If you want to move or rotate the entire contents of the sketcher, you can do so by clicking and dragging far away from any substructures (in this case, none of the substructures will be bolded). You can use your scroll wheel or trackpad to zoom in and out in the sketcher. </p>
            </li>
            <li value="7">
                <p>Ensure that the lysine residue has a positively charged terminal nitrogen. If it doesn't, click the charge icon from the menu to the left of the sketcher, and click the terminal N.</p>
                <p>
                    <img src="../Resources/Images/Sketcher/increase_charge.png" />
                </p>
                <p>
                    <img src="pyrrole_query_charge.png" class="img-responsive" />
                    <br />
                </p>
            </li>
            <li value="8">
                <p>We are interested in making two geometric measurements. The first is the distance between the centroid of the pyrrole and the N, and the second is the angle between the vector from the lysine N to the centroid of the pyrrole and the plane formed by the pyrrole. We will draw the centroid, plane, and vector first, and then add the measurements.</p>
                <p>To create the centroid, click the centroid button  on the toolbar to the right of the sketcher, </p>
                <p>
                    <img src="centroid_button.png" />
                </p>
                <p>and lasso the pyrrole. </p>
                <p>A red dot is added to the center of the pyrrole ring.&#160; Hover over the red dot for a more complete description of the atoms used to determine the centroid, as shown below.</p>
                <p>
                    <img src="pyrrole_query_centroid.png" class="img-responsive" />
                </p>
            </li>
            <li value="9">
                <p>Create a plane object by clicking the plane button on the toolbar to the right of the sketcher and lassoing the pyrrole again.&#160; </p>
                <p>
                    <img src="plane_button.png" />
                </p>
                <p>The plane is represented by a square centered at the centroid of atoms used to specify the plane.</p>
                <p>
                    <img src="pyrrole_query_plane.png" class="img-responsive" />
                </p>
            </li>
            <li value="10">
                <p>Now click the vector button on the toolbar to the right of the sketcher. </p>
                <p>
                    <img src="vector_button.png" />
                </p>
                <p>Click the lysine N and then the centroid.</p>
                <p>
                    <img src="pyrrole_query_vector_tool.png" class="img-responsive" />
                </p>
                <p>Now that the centroid, vector, and plane are created, we can create the measurements. </p>
            </li>
            <li value="11">
                <p>Click the distance button on the toolbar to the right of the sketcher,</p>
                <p>
                    <img src="distance_button.png" />
                </p>
                <p> click the lysine N, then the centroid.</p>
                <p>
                    <img src="pyrrole_query_distance_constraint.png" class="img-responsive" />
                </p>
            </li>
            <li value="12">
                <p>Enter 4.5 Å for the distance constraint and click <span class="GUI">Ok</span>.</p>
            </li>
            <li value="13">
                <p>Click the angle button on the toolbar to the right of the sketcher. </p>
                <p>
                    <img src="angle_button.png" />
                </p>
                <p>Click the vector and then the plane to measure the angle between the vector and the plane.</p>
                <p>
                    <img src="pyrrole_query_vector_plane_angle.png" class="img-responsive" />
                </p>
                <p>The angle measurement is between the plane normal vector and the vector. However, plane normal vectors in the PLDB are not directional. So the angle between the vector and the plane will range from 0 to 90 degrees. We are interested in measuring this angle, but not using it as a constraint.</p>
            </li>
            <li value="14">
                <p>In the <span class="GUI">Input angle limits</span> dialog,  choose a constraint of <span class="GUI">Less than</span> from the menu, enter 90 degrees in the text box next to it, and click <span class="GUI">Ok</span>.</p>
                <p>
                    <img src="Input_angle_limits.png" class="img-responsive" />
                </p>
                <p>The resulting query is now ready to run.</p>
                <p>
                    <img src="pyrrole_query_finished_search.png" class="img-responsive" />
                </p>
            </li>
            <li value="15">
                <p>Enter "lysine pyrrole geometry" as the <span class="GUI">Search Name</span>  and click the <span class="GUI">Start Search</span> button. Once results for this query start to come in, we can continue to view the results.</p>
            </li>
        </ol>
        <h3>Viewing the Results</h3>
        <ol start="1">
            <li value="1">
                <p>As soon as results start to stream in for your query, click the <span class="GUI">View Results</span> button in the history panel to look at them.</p>
                <p>
                    <img src="view_results_lysine.png" class="img-responsive" />
                    <br />
                </p>
                <p>This query takes about an hour to finish running completely because it involves geometric measurements between a relatively common protein and ligand substructure. However, you do not need to wait for the query to be finished executing to open the results. Results may begin streaming in less than a minute (if there are not too many other queries  currently running on the database). To load new results into the results table as the query continues to run, click the <span class="GUI">Refresh</span> button in the top section of the panel. Once the query has finished running and all of the results have been pulled into the results table, the <span class="GUI">Refresh</span> button is deactivated.</p>
                <p>
                    <img src="pyrrole_query_running.png" class="img-responsive" />
                </p>
            </li>
            <li value="2">
                <p>You can see a high-level view of all of your query's results in the results panel. Each row in the results table represents one PLDB entry. Search criteria appear as columns in the results table. In this case, we see the values for the distance (column D1) and angle (column A1) constraints.</p>
                <p>More in-depth information on a per structure basis is available in the <span class="GUI">Complex</span>, <span class="GUI">Ligand</span>, <span class="GUI">Protein</span>, and <span class="GUI">Files</span> tabs to the right of the results table. For example, you can view a Ligand Interaction Diagram for each structure in the <span class="GUI">Complex</span> tab (see <a href="../maestro_tools_help/ligand_interaction_diagram.html" class="MCXref xref" xrefformat="{paratext}">Ligand Interaction Diagram Panel</a> for details on the diagram). </p>
                <p>Entries flagged as problematic appear in the results table with a red exclamation mark next to their value in the <span class="GUI">Code</span> column.</p>
                <p>
                    <img src="problematic_structure_exclamation.png" />
                </p>
                <p> You can see a list of the problems flagged by PLDB in the <span class="GUI">Complex</span> tab on the right hand side of the panel. For example, we see that structure 3EQ1 is flagged as problematic because it has atoms with near-zero occupancy.</p>
                <p>
                    <img src="results_table_geometric_query.png" class="img-responsive" />
                </p>
            </li>
            <li value="3">
                <p>Once the query is finished running, we can use the PLDB's plotting tools to get a higher-level view of our results. To open the plotting tools, click the Show Plots button in the bottom-left corner of the results panel (or the + button at the top of the results table).</p>
            </li>
            <li value="4">
                <p>Choose A1 from the "Bin by:" drop-down to generate a histogram of the angle between the vector from the lysine N to the centroid of the pyrrole and the plane formed by the pyrrole.</p>
                <p>
                    <img src="pyrrole_histogram_with_mouseover.png" class="img-responsive" />
                    <br />
                </p>
                <p>Mouse over bins in the histogram to see which ranges of values they contain and how many entries fall into each bin. Here, we can see that there are 23 results whose A1 measurement is between 29.65 and 38.92°.</p>
                <p>Clearly, there is a large peak from 10-30°, but it looks like there may be another peak at&#160; the upper end of distribution. </p>
            </li>
            <li value="5">
                <p>Let's investigate further by changing the <span class="GUI"># bins</span> value to 20. </p>
                <p>
                    <img src="bin_by_A1_20.png" class="img-responsive" />
                    <br />
                </p>
                <p>Now it is more clear that there are at least two groups of results: one whose A1 is between 10° and 40° and one whose is between 70° and 90°.</p>
            </li>
            <li value="6">
                <p>Click and drag to select the histogram bins in the rightmost peak.</p>
                <p>
                    <img src="select_hist_bins_70-90.png" class="img-responsive" />
                    <br />
                    <br />
                </p>
                <p>This brings all of the entries from those bins into the results table, and the filtered selection is indicated by the orange limit <i class="UserReplace">n</i> of <i class="UserReplace">m</i> bin(s) button (where <i class="UserReplace">n</i> is the number of selected bins and <i class="UserReplace">m</i> is the total number of bins). To bring all of the results back into the table, click on the orange button, and the filtering will be disabled. </p>
            </li>
            <li value="7">
                <p>Now let's take a look at these results in 3D. Click on the first row and shift-click on the last row in the results table to select all of the results. </p>
                <p>
                    <img src="select_all_result_table_rows.png" class="img-responsive" />
                </p>
            </li>
            <li value="8">
                <p>Click <span class="GUI">Import <i class="UserReplace">n</i> Selected Results to Project Table</span> (where <i class="UserReplace">n</i> is the number of selected results) in the right side of the results panel. </p>
                <p>The selected results are downloaded and added to the Maestro Project Table.</p>
            </li>
            <li value="9">
                <p>Once your results are imported into Maestro, you can see that the geometric constraints you queried on are depicted on the 3D structure.</p>
                <p>
                    <img src="geometric_constraints_3D.png" class="img-responsive" />
                </p>
                <p>Here, the plane is visualized in orange, and the vector between the centroid and protein is shown in yellow. The plane-angle vector, 85.44°, is labeled in magenta as A1 and the distance is shown in magenta to be 4.40 Å. </p>
                <p>These measurements and other properties can also be found in the Project Table, which you can open by clicking the Show Project Table button on the toolbar. </p>
                <p>
                    <img src="../Resources/Images/maestro/pt_open_button.png" class="img-responsive" />
                </p>
                <p>The distances can be found in the D1 column and the angles can be found in the A1 column.</p>
                <p>
                    <img src="pyrrole_project_table.png" class="img-responsive" />
                </p>
            </li>
            <li value="10">
                <p>In the <span class="GUI">Protein-Ligand Database</span> panel to the right of the 3D Workspace, click the arrows next to items like <span class="GUI">Binding Motifs</span> and <span class="GUI">Common Interactions</span> to show available structural annotations for an entry. Check the <span class="GUI">H-bond Acceptor</span>  checkbox to visualize all of the inter- and intra-ligand hydrogen bond acceptors as red spheres in the 3D viewer. </p>
                <p>
                    <img src="5DEG_structural_annos_hbond.png" class="img-responsive" />
                </p>
            </li>
            <li value="11">
                <p>Let's include all of the entries in the Workspace so we can visualize them all at once. From the Entry List in Maestro, click the circle for the first entry to include it in the Workspace, and shift-click the circle to the left of the last entry, to include all of the entries in the Workspace. This may take a couple of moments to work.</p>
                <p>
                    <img src="pyrrole_entry_list.png" class="img-responsive" />
                </p>
            </li>
            <li value="12">
                <p>In the <span class="GUI">Protein-Ligand Database</span> panel, choose <span class="GUI">Align by</span> → <span class="GUI">matched ligand substructure</span>. This aligns all of the included entries by the ligand substructure we originally queried on. We can also align by matched protein substructure or by matched ligand and protein substructure.</p>
                <p>
                    <img src="align_by_matched_lig_sub.png" class="img-responsive" />
                </p>
            </li>
            <li value="13">
                <p>In the <span class="GUI">Protein-Ligand Database</span> panel, choose <span class="GUI">Display</span> → <span class="GUI">only matched atoms</span> to display only the atoms involved in the original query. </p>
                <p>
                    <img src="display_only_matched_atoms.png" class="img-responsive" />
                </p>
                <p>We can then visualize the movement of the protein while the ligand is held constant.</p>
                <p>
                    <img src="pyrrole_aligned_structures.png" class="img-responsive" />
                </p>
            </li>
        </ol>
        <p>&#160;</p>
        <table class="NavLink">
            <tr class="NavLink">
                <td class="NavLeft"><span class="NavText">◀ <a href="pldb_tut_ligand_sim.htm" class="NavLink MCXref xref xrefNavLink" xrefformat="{paratext}">Using a Ligand Similarity Search to Find Factor Xa Binders</a></span>
                </td>
                <td class="NavCenter"><span class="NavText"><a class="NavLink MCXref xref xrefNavLink" href="pldb_tutorialTOC.htm" xrefformat="{paratext}">Protein-Ligand Database (PLDB) Tutorial</a></span>
                </td>
                <td class="NavRight"><span class="NavText"><a href="pldb_tut_hinge_indoles.htm" class="NavLink MCXref xref xrefNavLink" xrefformat="{paratext}">Finding Hinge-Binding Ligand Indoles</a> ▶</span>
                </td>
            </tr>
        </table>
    </body>
</html>