<!DOCTYPE html>
<html xmlns:MadCap="http://www.madcapsoftware.com/Schemas/MadCap.xsd" lang="en-US" xml:lang="en-US" data-mc-search-type="Stem" data-mc-help-system-file-name="Documentation.xml" data-mc-path-to-help-system="../" data-mc-target-type="WebHelp2" data-mc-runtime-file-type="Topic" data-mc-preload-images="false" data-mc-in-preview-mode="false" data-mc-toc-path="User Manuals|Covalent Docking User Manual|Docking Covalently Bound Ligands">
    <head>
        <meta name="viewport" content="width=device-width, initial-scale=1.0" />
        <meta charset="utf-8" />
        <meta http-equiv="X-UA-Compatible" content="IE=edge" />
        <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
        <link href="../Skins/Default/Stylesheets/Slideshow.css" rel="stylesheet" type="text/css" data-mc-generated="True" />
        <link href="../Skins/Default/Stylesheets/TextEffects.css" rel="stylesheet" type="text/css" data-mc-generated="True" />
        <link href="../Skins/Default/Stylesheets/Topic.css" rel="stylesheet" type="text/css" data-mc-generated="True" />
        <link href="../Skins/Default/Stylesheets/Components/Styles.css" rel="stylesheet" type="text/css" data-mc-generated="True" /><title>Preparing the Structures for Covalent Docking</title>
        <link href="../Resources/Stylesheets/docs.css" rel="stylesheet" />
        <script src="../Resources/Scripts/custom.modernizr.js" type="text/javascript">
        </script>
        <script src="../Resources/Scripts/jquery.min.js" type="text/javascript">
        </script>
        <script src="../Resources/Scripts/require.min.js" type="text/javascript">
        </script>
        <script src="../Resources/Scripts/require.config.js" type="text/javascript">
        </script>
        <script src="../Resources/Scripts/foundation.min.js" type="text/javascript">
        </script>
        <script src="../Resources/Scripts/plugins.min.js" type="text/javascript">
        </script>
        <script src="../Resources/Scripts/MadCapAll.js" type="text/javascript">
        </script>
    </head>
    <body><a name="aanchor271"></a>
        <MadCap:concept term="User Manuals" /><a name="aanchor272"></a>
        <MadCap:concept term="Covalent Docking" /><a name="covalent_docking_382949949_774443"></a>
        <table class="NavLink" data-mc-conditions="Default.ScreenOnly">
            <tr class="NavLink">
                <td class="NavLeft"><span class="NavText">◀ <a class="NavLink MCXref xref xrefNavLink" href="covalent_docking.htm">Docking Covalently Bound Ligands</a></span>
                </td>
                <td class="NavCenter"><span class="NavText"><a class="NavLink MCXref xref xrefNavLink" href="covalent_docking_user_manualTOC.htm">Covalent Docking User Manual</a></span>
                </td>
                <td class="NavRight"><span class="NavText"><a class="NavLink MCXref xref xrefNavLink" href="covdock_running.htm">Running Covalent Docking from Maestro</a> ▶</span>
                </td>
            </tr>
        </table>
        <h1 class="Title">Preparing the Structures for Covalent Docking</h1>
        <p>The receptor structure and the ligand structures should be prepared for use with Glide and Prime. The recommended procedure is to use the Protein Preparation Wizard for preparing the receptor, and LigPrep for preparing the ligands. Details of these tools and their use can be found in the <a class="Manual MCXref xref xrefManual" href="../protein_prep_user_manual/protein_prep_user_manualTOC.htm#protein_prep_user_manualtoc_753134425_41482">Protein Preparation Guide</a> and the <a class="Manual MCXref xref xrefManual" href="../ligprep_user_manual/ligprep_user_manualTOC.htm#ligprep_user_manualtoc_1995474008_59221">LigPrep User Manual</a>. An overview of the preparation needed for Glide is given in <a class="TopicLink MCXref xref xrefTopicLink" href="../glide_user_manual/glide_structureprep.htm#glide_structureprep_2883155952_45961">Protein and Ligand Preparation for Glide</a>.</p>
        <p>In addition to preparation with LigPrep, the ligand structures should contain the reactive functional group for the reaction by which the covalent bond is formed. This functional group is defined by a SMARTS pattern, which is displayed in the <span class="GUI">Covalent Docking</span> panel. The default SMARTS patterns are listed in <a class="Table_Number MCXref xref xrefTable_Number" href="covdock_running_chemistry.htm#covalent_docking_382949949_742667">Table 1</a>. Ligands that don’t match are skipped with a warning. However, you might want to filter the ligands so that your input file only contains ligands with the desired functional group.You can filter the ligands in the <span class="GUI">Ligand Filtering</span> panel, as follows.</p>
        <ol>
            <li value="1">
                <p>Choose<span class="GUI">Tasks → Ligand Preparation and Library Design → Ligand Filtering</span> in the Task Tool to open the <span class="GUI">Ligand Filtering</span> panel.</p>
                <p>
                    <img src="../Resources/Images/Common/ligand_filtering_functional_group_counts.png" style="margin: 2px;" />
                </p>
                <p class="figure" data-mc-autonum="Figure 1:"><span class="autonumber"><span>Figure 1:</span></span>The Ligand Filtering panel.</p>
            </li>
            <li value="2">
                <p>Select the source of ligands from the <span class="GUI">Use structures from</span> option menu.</p>
                <ul>
                    <li value="1">
                        <p class="ListPara">If you choose <span class="GUI">File</span>, click <span class="GUI">Browse</span> and select the file in the file selector that opens.</p>
                    </li>
                    <li value="2">
                        <p class="ListPara">If you choose <span class="GUI">Project Table</span>, select the ligands in the Project Table.</p>
                    </li>
                </ul>
            </li>
            <li value="3">
                <p>For <span class="GUI">Matching ligands</span>, ensure that <span class="GUI">Retain</span> is selected.</p>
                <p>It doesn’t matter what is selected for <span class="GUI">Ligand matches if</span>, as you will only use one criterion.</p>
            </li>
            <li value="4">
                <p>In the <span class="GUI">Functional Group Counts</span> tab, click <span class="GUI">New</span>. </p>
                <p>The <span class="GUI">Ligand Filtering - Add Definition</span> dialog box opens. As the functional group for the reaction is not likely to be included in the predefined list, you will have to add the definition for this functional group.</p>
                <p class="image">
                    <img src="../Resources/Images/Common/ligand_filtering_add_definition.png" style="margin: 2px;" />
                </p>
                <p class="figure" data-mc-autonum="Figure 2:"><span class="autonumber"><span>Figure 2:</span></span>The Add Definition dialog box.</p>
            </li>
            <li value="5">
                <p>Enter a name for the functional group in the <span class="GUI">Name of new functional group</span> text box. </p>
                <p>For example, use the reaction type. There must be no spaces in the name.</p>
            </li>
            <li value="6">
                <p>Copy or type the SMARTS pattern for the ligand reactive group into the <span class="GUI">SMARTS expression or selected functional group</span> text box.</p>
            </li>
            <li value="7">
                <p>If you intend to use the default pattern, you can copy it from <a class="Table_Number MCXref xref xrefTable_Number" href="covdock_running_chemistry.htm#covalent_docking_382949949_742667">Table 1</a>. If you intend to modify the default pattern, to make it more specific, you should instead use the <span class="GUI">Get From Selection</span> button, as this is the same procedure as is used in the <span class="GUI">Covalent Docking</span> panel. Display a ligand in the Workspace, select the atoms that you want to include in the SMARTS pattern, then click <span class="GUI">Get From Selection</span>. </p>
            </li>
            <li value="8">
                <p>Click <span class="GUI">Include</span>. </p>
                <p>The SMARTS pattern is listed in the lower text area. You can add more SMARTS patterns to the group by repeating the last two steps. You might want to do this if you intend to modify the default pattern. </p>
            </li>
            <li value="9">
                <p>Click <span class="GUI">Add</span>. </p>
                <p>The functional group is added under the <span class="GUI">User-defined</span> heading, at the bottom of the functional group list.</p>
            </li>
            <li value="10">
                <p>Select the functional group you just created. </p>
                <p>The name is displayed in the <span class="GUI">Functional group</span> text box.</p>
            </li>
            <li value="11">
                <p>Choose <span class="GUI">&gt;</span> from the option menu to the right, then enter 0 in the text box. </p>
            </li>
            <li value="12">
                <p>Click <span class="GUI">Add</span>.</p>
                <p>A new line is added in the <span class="GUI">Filtering definitions and criteria</span>. This line shows that the number of occurrences of the functional group in any ligand must be greater than zero for the ligand to be retained in the output. </p>
            </li>
            <li value="13">
                <p>If you want to add the filtered ligand set to the Project Table, click the <span class="GUI">Job Settings</span> (gear) button, and choose <span class="GUI">Append new entries</span> from the option menu in the <span class="GUI">Output</span> section.</p>
            </li>
            <li value="14">
                <p>Enter a job name in the <span class="GUI">Job name</span> text box, and click <span class="GUI">Run</span>.</p>
                <p>The job name is used to name the output file.</p>
            </li>
        </ol>
        <p>You can also run ligand filtering from the command line—see <a class="TopicLink MCXref xref xrefTopicLink" href="../general_utilities/general_utilities_ligfilter.htm#general_utilities_4076429009_22120">
            Filtering Structures by Property: ligfilter</a>.</p>
        <table class="NavLink" data-mc-conditions="Default.ScreenOnly">
            <tr class="NavLink">
                <td class="NavLeft"><span class="NavText">◀ <a class="NavLink MCXref xref xrefNavLink" href="covalent_docking.htm">Docking Covalently Bound Ligands</a></span>
                </td>
                <td class="NavCenter"><span class="NavText"><a class="NavLink MCXref xref xrefNavLink" href="covalent_docking_user_manualTOC.htm">Covalent Docking User Manual</a></span>
                </td>
                <td class="NavRight"><span class="NavText"><a class="NavLink MCXref xref xrefNavLink" href="covdock_running.htm">Running Covalent Docking from Maestro</a> ▶</span>
                </td>
            </tr>
        </table>
    </body>
</html>