<!DOCTYPE html>
<html xmlns:MadCap="http://www.madcapsoftware.com/Schemas/MadCap.xsd" lang="en-US" xml:lang="en-US" data-mc-search-type="Stem" data-mc-help-system-file-name="Documentation.xml" data-mc-path-to-help-system="../" data-mc-target-type="WebHelp2" data-mc-runtime-file-type="Topic" data-mc-preload-images="false" data-mc-in-preview-mode="false" data-mc-toc-path="Command References|MacroModel Command Reference|MacroModel Operation Codes|Free-Energy Perturbation Opcodes">
    <head>
        <meta name="viewport" content="width=device-width, initial-scale=1.0" />
        <meta charset="utf-8" />
        <meta http-equiv="X-UA-Compatible" content="IE=edge" />
        <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
        <link href="../Skins/Default/Stylesheets/Slideshow.css" rel="stylesheet" type="text/css" data-mc-generated="True" />
        <link href="../Skins/Default/Stylesheets/TextEffects.css" rel="stylesheet" type="text/css" data-mc-generated="True" />
        <link href="../Skins/Default/Stylesheets/Topic.css" rel="stylesheet" type="text/css" data-mc-generated="True" />
        <link href="../Skins/Default/Stylesheets/Components/Styles.css" rel="stylesheet" type="text/css" data-mc-generated="True" /><title>Free-Energy Perturbation Opcodes</title>
        <link href="../Resources/Stylesheets/docs.css" rel="stylesheet" />
        <script src="../Resources/Scripts/custom.modernizr.js" type="text/javascript">
        </script>
        <script src="../Resources/Scripts/jquery.min.js" type="text/javascript">
        </script>
        <script src="../Resources/Scripts/require.min.js" type="text/javascript">
        </script>
        <script src="../Resources/Scripts/require.config.js" type="text/javascript">
        </script>
        <script src="../Resources/Scripts/foundation.min.js" type="text/javascript">
        </script>
        <script src="../Resources/Scripts/plugins.min.js" type="text/javascript">
        </script>
        <script src="../Resources/Scripts/MadCapAll.js" type="text/javascript">
        </script>
    </head>
    <body><a name="aanchor1269"></a>
        <MadCap:concept term="Command Reference" /><a name="aanchor1270"></a>
        <MadCap:concept term="MacroModel" /><a name="opcodes_509685220_741061"></a>
        <table class="NavLink" data-mc-conditions="Default.ScreenOnly">
            <tr class="NavLink">
                <td class="NavLeft"><span class="NavText">◀ <a class="NavLink MCXref xref xrefNavLink" href="opcodes_mdmc.htm" xrefformat="{paratext}">Molecular Dynamics and Monte Carlo Simulation Opcodes</a></span>
                </td>
                <td class="NavCenter"><span class="NavText"><a class="NavLink MCXref xref xrefNavLink" href="macromodel_command_referenceTOC.htm" xrefformat="{paratext}">MacroModel Command Reference Manual</a></span>
                </td>
                <td class="NavRight"><span class="NavText"><a class="NavLink MCXref xref xrefNavLink" href="opcodes_mc.htm" xrefformat="{paratext}">Monte Carlo Simulation Opcodes</a> ▶</span>
                </td>
            </tr>
        </table>
        <h1 class="Title">Free-Energy Perturbation Opcodes</h1>
        <p>See <a class="TopicLink MCXref xref xrefTopicLink" href="mm_free_energy_pert.htm#mm_free_energy_pert_3887848488_738162" xrefformat="{paratext}">Free Energy Simulations with MacroModel</a> for an extended discussion, including a descriptive example.</p>
        <p>The opcodes in this section are linked below:</p>
        <p>
        </p>
        <h2 class="Opcode"><a name="opcodes_509685220_741064"></a><code class="Courier"><a name="opcodes_509685220_fega">FEGA</a></code> — Free Energy mutating Group Atom </h2>
        <p>This command allows explicit addition to the list of atoms whose parameters change during a free-energy perturbation simulation. It is rarely used, since ordinarily the free-energy perturbation group atoms are taken to be those atoms that change atom type between the starting and final structure, together with any atoms bonded to them. This command could be used to add to this list, in the event, for example, that the parameters of an atom beta to an atom undergoing mutation changed greatly due to the alteration of the mutating atom.</p>
        <p>Any <code>FEGA</code> commands must precede all other free-energy perturbation commands.</p>
        <table class="ArgTable">
            <tr class="ArgTable">
                <td class="ArgTable">
                    <p class="ArgDef">arg1-4</p>
                </td>
                <td class="ArgTable">
                    <p class="ArgDef">Atom numbers</p>
                </td>
            </tr>
            <tr class="ArgTable">
                <td class="ArgTable">
                    <p class="ArgValue">&lt; 0</p>
                </td>
                <td class="ArgTable">
                    <p class="ArgPara">Add all atoms in the molecule containing atom |arg| to the mutating atom group.</p>
                </td>
            </tr>
            <tr class="ArgTable">
                <td class="ArgTable">
                    <p class="ArgValue">&gt; 0</p>
                </td>
                <td class="ArgTable">
                    <p class="ArgPara">Add this atom to the mutating atom group.</p>
                </td>
            </tr>
        </table>
        <h2 class="Opcode"><a name="opcodes_509685220_741071"></a><code class="Courier"><a name="opcodes_509685220_feia">FEIA</a></code> — Free Energy Interaction Array generation </h2>
        <p>Generate the two interaction arrays for averaging. It is assumed that the input file contains two structure files which represent the starting and end points for the mutation. It is further assumed that these structures have the same number and ordering of all atoms. Dummy atoms (MacroModel type Du) should be used as counterparts for atoms which disappear or appear during the simulation.</p>
        <p>All constraints (<span class="OpcodeLink"><a href="opcodes_constrained_mini.htm#opcodes_509685220_fxat">FXAT</a></span>, <span class="OpcodeLink"><a href="opcodes_constrained_mini.htm#opcodes_509685220_fxdi">FXDI</a></span>, etc.) must be specified before <code>FEIA</code> if the constraints are to be active during the free-energy perturbation run.</p>
        <h2 class="Opcode"><a name="opcodes_509685220_781003"></a><code class="Courier"><a name="opcodes_509685220_feav">FEAV</a></code> — Free Energy AVeraging</h2>
        <p>This command, together with <span class="OpcodeLink"><a href="#opcodes_509685220_fesa">FESA</a></span>, ordinarily appears in a <span class="OpcodeLink"><a href="opcodes_flowcontrol.htm#opcodes_509685220_bgin">BGIN</a></span>/<span class="OpcodeLink"><a href="opcodes_flowcontrol.htm#opcodes_509685220_end">END</a></span> loop that sets up the simulation for each window in turn. The first time this command is encountered, the interaction array is generated with the value of lambda given by arg5. You would specify a nonzero value for arg5 in order to simulate some individual window, only, or to start a series of windows with some nonzero value of lambda. This might be useful, for example, if the computer crashed part way through an earlier simulation attempt. It is also used in network-distributed processing to instruct a given processor to run a simulation over only a single window.</p>
        <table class="ArgTable">
            <tr class="ArgTable">
                <td class="ArgTable">
                    <p class="ArgDef">arg1</p>
                </td>
                <td class="ArgTable">
                    <p class="ArgDef">Averaging protocol</p>
                </td>
            </tr>
            <tr class="ArgTable">
                <td class="ArgTable">
                    <p class="ArgValue">0</p>
                </td>
                <td class="ArgTable">
                    <p class="ArgPara">Altered parts of interaction arrays will be averaged. </p>
                </td>
            </tr>
            <tr class="ArgTable">
                <td class="ArgTable">
                    <p class="ArgValue">1</p>
                </td>
                <td class="ArgTable">
                    <p class="ArgPara">Intragroup interactions (see <span class="OpcodeLink"><a href="#opcodes_509685220_fega">FEGA</a></span> command) will be zeroed in the final interaction array (used primarily for testing).</p>
                </td>
            </tr>
            <tr class="ArgTable">
                <td class="ArgTable">
                    <p class="ArgDef">arg5</p>
                </td>
                <td class="ArgTable">
                    <p class="ArgDef">Coupling factor (<span class="Symbol">l</span>) for the current window</p>
                </td>
            </tr>
            <tr class="ArgTable">
                <td class="ArgTable">&#160;</td>
                <td class="ArgTable">
                    <p class="ArgPara">This is the fraction of structure 2 (the mutation end point, the second structure in the input file) mixed into the molecular representation in the current window.</p>
                </td>
            </tr>
        </table>
        <h2 class="Opcode"><a name="opcodes_509685220_741089"></a><code class="Courier"><a name="opcodes_509685220_fesa">FESA</a></code> — Free Energy SAmpling</h2>
        <p>Sampling protocol for a particular perturbation window. A maximum of 100 <code>FESA</code> commands (defining up to 100 free-energy perturbation windows) can be used. <code>FESA</code> is normally used within a <span class="OpcodeLink"><a href="opcodes_flowcontrol.htm#opcodes_509685220_bgin">BGIN</a></span>/<span class="OpcodeLink"><a href="opcodes_flowcontrol.htm#opcodes_509685220_end">END</a></span> loop to carry out the entire mutation. Arg7 and arg8 can be used to allow automatic extension of simulation time in a given window to improve convergence.</p>
        <table class="ArgTable">
            <tr class="ArgTable">
                <td class="ArgTable">
                    <p class="ArgDef">arg2</p>
                </td>
                <td class="ArgTable">
                    <p class="ArgDef">Maximum allowed number of step doublings</p>
                </td>
            </tr>
            <tr class="ArgTable">
                <td class="ArgTable">&#160;</td>
                <td class="ArgTable">
                    <p class="ArgPara">Simulation time (<span class="OpcodeLink"><a href="opcodes_mdmc.htm#opcodes_509685220_mdyn">MDYN</a></span>, <span class="OpcodeLink"><a href="opcodes_mdmc.htm#opcodes_509685220_mcsd">MCSD</a></span>) or number of steps (Monte Carlo) can be successively doubled to achieve user-defined convergence criteria. This argument allows control over this. See also arg7, arg8. </p>
                </td>
            </tr>
            <tr class="ArgTable">
                <td class="ArgTable">
                    <p class="ArgValue">0</p>
                </td>
                <td class="ArgTable">
                    <p class="ArgPara">2, if arg7 or arg8 are nonzero.</p>
                </td>
            </tr>
            <tr class="ArgTable">
                <td class="ArgTable">
                    <p class="ArgDef">arg5</p>
                </td>
                <td class="ArgTable">
                    <p class="ArgDef">Control of double-wide sampling—left half</p>
                </td>
            </tr>
            <tr class="ArgTable">
                <td class="ArgTable">&#160;</td>
                <td class="ArgTable">
                    <p class="ArgPara">Fraction of structure 1 for the left half of the double-wide sample. If arg5 is equal to the current window’s value of <span class="Symbol">l</span>, then no left sampling is done.</p>
                </td>
            </tr>
            <tr class="ArgTable">
                <td class="ArgTable">
                    <p class="ArgDef">arg6</p>
                </td>
                <td class="ArgTable">
                    <p class="ArgDef">Control of double-wide sampling—right half</p>
                </td>
            </tr>
            <tr class="ArgTable">
                <td class="ArgTable">&#160;</td>
                <td class="ArgTable">
                    <p class="ArgPara">Fraction of structure 1 for the right half of the double-wide sample. If arg6 is equal to the current window’s value of <span class="Symbol">l</span>, then no right sampling is done.</p>
                </td>
            </tr>
            <tr class="ArgTable">
                <td class="ArgTable">
                    <p class="ArgDef">arg7</p>
                </td>
                <td class="ArgTable">
                    <p class="ArgDef">Minimum allowed standard deviation (kJ/mol) </p>
                </td>
            </tr>
            <tr class="ArgTable">
                <td class="ArgTable">&#160;</td>
                <td class="ArgTable">
                    <p class="ArgPara">If the standard deviation of the free-energy difference for this window exceeds this value at end of the simulation, the simulation is doubled in length, in an attempt to improve the statistical uncertainty in the calculated free energy. A maximum of arg2 such doublings are allowed. By default, this option is off.</p>
                </td>
            </tr>
            <tr class="ArgTable">
                <td class="ArgTable">
                    <p class="ArgDef">arg 8</p>
                </td>
                <td class="ArgTable">
                    <p class="ArgDef">Maximum allowed difference in free energies (kJ/mol) </p>
                </td>
            </tr>
            <tr class="ArgTable">
                <td class="ArgTable">&#160;</td>
                <td class="ArgTable">
                    <p class="ArgPara">If the free-energy difference between the current and the previous window exceeds this amount at the end of the simulation, the simulation will be doubled in length in an attempt to improve convergence. A maximum of arg2 such extensions are allowed. By default, this option is inactive.</p>
                </td>
            </tr>
        </table>
        <h2 class="Opcode"><a name="opcodes_509685220_741107"></a><code class="Courier"><a name="opcodes_509685220_fesu">FESU</a></code> — Free Energy SUmmary</h2>
        <p>List summary of accumulated free-energy perturbation results for all sampling windows to <code>.log</code> file. </p>
        <table class="ArgTable">
            <tr class="ArgTable">
                <td class="ArgTable">
                    <p class="ArgDef">arg1</p>
                </td>
                <td class="ArgTable">
                    <p class="ArgDef">Energy units for output.</p>
                </td>
            </tr>
            <tr class="ArgTable">
                <td class="ArgTable">
                    <p class="ArgValue">0</p>
                </td>
                <td class="ArgTable">
                    <p class="ArgPara">Use kJ/mol.</p>
                </td>
            </tr>
            <tr class="ArgTable">
                <td class="ArgTable">
                    <p class="ArgValue">1</p>
                </td>
                <td class="ArgTable">
                    <p class="ArgPara">Use kcal/mol.</p>
                </td>
            </tr>
        </table>
        <table class="NavLink" data-mc-conditions="Default.ScreenOnly">
            <tr class="NavLink">
                <td class="NavLeft"><span class="NavText">◀ <a class="NavLink MCXref xref xrefNavLink" href="opcodes_mdmc.htm" xrefformat="{paratext}">Molecular Dynamics and Monte Carlo Simulation Opcodes</a></span>
                </td>
                <td class="NavCenter"><span class="NavText"><a class="NavLink MCXref xref xrefNavLink" href="macromodel_command_referenceTOC.htm" xrefformat="{paratext}">MacroModel Command Reference Manual</a></span>
                </td>
                <td class="NavRight"><span class="NavText"><a class="NavLink MCXref xref xrefNavLink" href="opcodes_mc.htm" xrefformat="{paratext}">Monte Carlo Simulation Opcodes</a> ▶</span>
                </td>
            </tr>
        </table>
    </body>
</html>