<!DOCTYPE html>
<html xmlns:MadCap="http://www.madcapsoftware.com/Schemas/MadCap.xsd" lang="en-US" xml:lang="en-US" data-mc-search-type="Stem" data-mc-help-system-file-name="Documentation.xml" data-mc-path-to-help-system="../" data-mc-target-type="WebHelp2" data-mc-runtime-file-type="Topic" data-mc-preload-images="false" data-mc-in-preview-mode="false" data-mc-toc-path="Command References|MacroModel Command Reference|Force-Field File Format|Substructure Section of the Force-Field File">
    <head>
        <meta name="viewport" content="width=device-width, initial-scale=1.0" />
        <meta charset="utf-8" />
        <meta http-equiv="X-UA-Compatible" content="IE=edge" />
        <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
        <link href="../Skins/Default/Stylesheets/Slideshow.css" rel="stylesheet" type="text/css" data-mc-generated="True" />
        <link href="../Skins/Default/Stylesheets/TextEffects.css" rel="stylesheet" type="text/css" data-mc-generated="True" />
        <link href="../Skins/Default/Stylesheets/Topic.css" rel="stylesheet" type="text/css" data-mc-generated="True" />
        <link href="../Skins/Default/Stylesheets/Components/Styles.css" rel="stylesheet" type="text/css" data-mc-generated="True" /><title>Force-Field File Substructure Examples</title>
        <link href="../Resources/Stylesheets/docs.css" rel="stylesheet" />
        <script src="../Resources/Scripts/custom.modernizr.js" type="text/javascript">
        </script>
        <script src="../Resources/Scripts/jquery.min.js" type="text/javascript">
        </script>
        <script src="../Resources/Scripts/require.min.js" type="text/javascript">
        </script>
        <script src="../Resources/Scripts/require.config.js" type="text/javascript">
        </script>
        <script src="../Resources/Scripts/foundation.min.js" type="text/javascript">
        </script>
        <script src="../Resources/Scripts/plugins.min.js" type="text/javascript">
        </script>
        <script src="../Resources/Scripts/MadCapAll.js" type="text/javascript">
        </script>
    </head>
    <body><a name="aanchor6360"></a>
        <MadCap:concept term="Command Reference" /><a name="aanchor6361"></a>
        <MadCap:concept term="MacroModel" /><a name="mmod_force_field_files_3963860785_738611"></a>
        <table class="NavLink" data-mc-conditions="Default.ScreenOnly">
            <tr class="NavLink">
                <td class="NavLeft"><span class="NavText">◀ <a class="NavLink MCXref xref xrefNavLink" href="mmod_force_field_files_subs_charge.htm" xrefformat="{paratext}">Force-Field Substructure Charge Processing</a></span>
                </td>
                <td class="NavCenter"><span class="NavText"><a class="NavLink MCXref xref xrefNavLink" href="macromodel_command_referenceTOC.htm" xrefformat="{paratext}">MacroModel Command Reference Manual</a></span>
                </td>
                <td class="NavRight"><span class="NavText"><a class="NavLink MCXref xref xrefNavLink" href="mmod_force_field_files_subs_geom.htm" xrefformat="{paratext}">Geometry-Dependent Parameters in the Force-Field File</a> ▶</span>
                </td>
            </tr>
        </table>
        <h1 class="Title">Force-Field File Substructure Examples</h1>
        <p>The following example shows a substructure specification for a cyclopropane nucleus. The <code>-3</code> and <code>-2</code> that appear alone on lines specify the format for the reading of subsequent lines. The <code>C</code>, <code>9</code>, <code>1</code>, <code>2</code>, etc. introducing other lines specify the nature of the information to be read. The <code>C</code> specifies that the title of a substructure is to be read, with the default (“continue”) matching behavior; an S (“stop”) in place of <code>C</code> would prevent the matched atoms in the structure being studied from being candidates for further substructure matches. In other words, <code>S</code> would override the “use last substructure match” default behavior for this particular substructure. <code>9</code> introduces a linear substructure specification within the <code>-3</code> format block and <code>1</code>, <code>2</code>, etc. introduce parameter specifications as follows, within the <code>-2</code> format block.</p><pre>
-3
&#160;C  Cyclopropanoid
 9  C3-C3-00-1
-2
 1   1   2                 1.5010     4.4000     0.0000
 1   1  C2                 1.4670     4.4000    -0.1500
 1   1  C3                 1.5050     4.4000     0.1500
 1   1  H1                 1.0860     4.6000     0.0000     
 2   1   2   3            60.0000     0.4500
 2   1   2  H1           119.7000     0.3600
 2   1   2  C3           118.2000     0.6000
 2   1   2  C2           118.2000     0.6000
 2  H1   1  H1           120.6000     0.3200
 2  C3   1  H1           123.5000     0.3600
 2  C3   1  C3           120.0000     0.4500
 2   1  C3  C3           112.4000     0.4500
 4   1   2  C3  H1         0.0000     0.0000     0.1200
 4   1   2  C3  C3         0.3000     0.0000     0.4500
 4  C3   1  C3  H1         0.0000     0.0000     0.6900
 4  H1   1  C3  H1         0.0000     0.0000     0.6900
 4  C3   1  C3  C3         0.0000     0.0000     0.0000
 4  H1   1  C3  C3         0.0000     0.0000     0.2670
</pre>
        <p>Substructure interaction lines can specify optional connected atoms, but if they do, then non-wildcard atom-types in the optional-atom list will be matched only against atoms not in the substructure. In this context, a wildcard atom-type is either <code>00</code>, which matches any atom type, or else one of the wildcard types for an element; for example, <code>C0</code> for any carbon. The numbers in the interaction proper (such as <code>1 2</code> in the first stretch shown) correspond to the numbers in the linear substructure notation. Atom types, when shown, correspond to matching atoms off the substructure.</p>
        <p>The following example shows a substructure for benzenoids, giving benzene-like bond lengths, angles, and force constants. Wild-card bond types are used to allow matching of any resonance form. Since the substructure is matched a total of 12 different ways, all aromatic bonds will be parameterized by this substructure (with length = 1.39 Å, force constant = 8.0667), etc. The torsion is generalized (the first and last entries are <code>00</code>, the wild-card atom type), so it represents the total barrier (recall that this handling is special for generalized torsions in substructures). The barriers used by the individual components would thus be V<sub>2</sub> = 36.8/4 kcal/mol.</p><pre>
-3
 C  Benzenoids (Beckhaus, ChemBer, 116, 86 (1983))
 9  C2*C2*AA*AA*AA*AA*1
-2
 1   1   2                 1.3900     8.0667     0.0000
 2   1   2   3           120.0000     0.4300
 4  00   1   2  00         0.0000    36.8000     0.0000
</pre>
        <p>The usual torsional parameter handling in substructures is that all parameters (V<sub>1</sub>, V<sub>2</sub>, and V<sub>3</sub>) for a matched torsional interaction are overwritten by the torsional parameters from a torsional substructure parameter line. It is possible to overwrite only specific components (e.g., only the V<sub>2</sub> component) by using the special parameter entry 99.9999 for the other components; this prevents overwriting. For example, the torsional parameter line below would replace only the V<sub>2</sub> barrier (with 2.5 kcal/mol) of an existing torsional interaction.</p><pre>
 4  00   2   3  00        99.9999     2.5000    99.9999
</pre>
        <p>Note again that the V<sub>2</sub> barrier specified here is the total barrier, because of the use of wild-card atom types.</p>
        <p>The following example shows how a specific set of charges (perhaps derived from ab initio quantum-mechanical studies) can be specified directly in a substructure. </p><pre>
-3
&#160;C  Imidazolium (AMBER HIP)
&#160;9  CU-N4=CU-N2-CU=1
-2
&#160;1   1   2                 1.3830   424.5000
...
&#160;8   0.1160   0.2480   0.2720   0.2480   0.1160                                        O 1         1 a JCC, 230 (86)
&#160;8   0.3530  -0.2125   0.7190  -0.2125   0.3530                                        O 1         1 b JACS, 765 (84)
</pre>
        <p>The purpose of the substructure above is to load the partial charges given in the line beginning <code>8</code>. The charges are placed on the substructure atoms in the order in which the atoms appear in the substructure notation. When using partial charges directly instead of bond dipoles, be sure that the total charge of the substructure sums to 0.0 for neutral substructures. Also check the final charge set using Maestro (the Electrostatics panel) to test your charge data.</p>
        <table class="NavLink" data-mc-conditions="Default.ScreenOnly">
            <tr class="NavLink">
                <td class="NavLeft"><span class="NavText">◀ <a class="NavLink MCXref xref xrefNavLink" href="mmod_force_field_files_subs_charge.htm" xrefformat="{paratext}">Force-Field Substructure Charge Processing</a></span>
                </td>
                <td class="NavCenter"><span class="NavText"><a class="NavLink MCXref xref xrefNavLink" href="macromodel_command_referenceTOC.htm" xrefformat="{paratext}">MacroModel Command Reference Manual</a></span>
                </td>
                <td class="NavRight"><span class="NavText"><a class="NavLink MCXref xref xrefNavLink" href="mmod_force_field_files_subs_geom.htm" xrefformat="{paratext}">Geometry-Dependent Parameters in the Force-Field File</a> ▶</span>
                </td>
            </tr>
        </table>
    </body>
</html>