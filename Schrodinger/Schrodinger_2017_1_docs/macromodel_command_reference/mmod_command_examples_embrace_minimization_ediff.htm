<!DOCTYPE html>
<html xmlns:MadCap="http://www.madcapsoftware.com/Schemas/MadCap.xsd" lang="en-US" xml:lang="en-US" data-mc-search-type="Stem" data-mc-help-system-file-name="Documentation.xml" data-mc-path-to-help-system="../" data-mc-target-type="WebHelp2" data-mc-runtime-file-type="Topic" data-mc-preload-images="false" data-mc-in-preview-mode="false" data-mc-toc-path="Command References|MacroModel Command Reference|MacroModel Command File Examples|Command File Examples for Embrace|MacroModel Example: Embrace Minimization Calculations">
    <head>
        <meta name="viewport" content="width=device-width, initial-scale=1.0" />
        <meta charset="utf-8" />
        <meta http-equiv="X-UA-Compatible" content="IE=edge" />
        <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
        <link href="../Skins/Default/Stylesheets/Slideshow.css" rel="stylesheet" type="text/css" data-mc-generated="True" />
        <link href="../Skins/Default/Stylesheets/TextEffects.css" rel="stylesheet" type="text/css" data-mc-generated="True" />
        <link href="../Skins/Default/Stylesheets/Topic.css" rel="stylesheet" type="text/css" data-mc-generated="True" />
        <link href="../Skins/Default/Stylesheets/Components/Styles.css" rel="stylesheet" type="text/css" data-mc-generated="True" /><title>Embrace Energy Difference Mode</title>
        <link href="../Resources/Stylesheets/docs.css" rel="stylesheet" />
        <script src="../Resources/Scripts/custom.modernizr.js" type="text/javascript">
        </script>
        <script src="../Resources/Scripts/jquery.min.js" type="text/javascript">
        </script>
        <script src="../Resources/Scripts/require.min.js" type="text/javascript">
        </script>
        <script src="../Resources/Scripts/require.config.js" type="text/javascript">
        </script>
        <script src="../Resources/Scripts/foundation.min.js" type="text/javascript">
        </script>
        <script src="../Resources/Scripts/plugins.min.js" type="text/javascript">
        </script>
        <script src="../Resources/Scripts/MadCapAll.js" type="text/javascript">
        </script>
    </head>
    <body><a name="aanchor5402"></a>
        <MadCap:concept term="Command Reference" /><a name="aanchor5403"></a>
        <MadCap:concept term="MacroModel" /><a name="mmod_command_examples_1066535316_746507"></a>
        <table class="NavLink" data-mc-conditions="Default.ScreenOnly">
            <tr class="NavLink">
                <td class="NavLeft"><span class="NavText">◀ <a class="NavLink MCXref xref xrefNavLink" href="mmod_command_examples_embrace_minimization_interaction.htm" xrefformat="{paratext}">Embrace Interaction Mode</a></span>
                </td>
                <td class="NavCenter"><span class="NavText"><a class="NavLink MCXref xref xrefNavLink" href="macromodel_command_referenceTOC.htm" xrefformat="{paratext}">MacroModel Command Reference Manual</a></span>
                </td>
                <td class="NavRight"><span class="NavText"><a class="NavLink MCXref xref xrefNavLink" href="mmod_command_examples_embrace_csearch.htm" xrefformat="{paratext}">MacroModel Example: Conformational Searches With Embrace</a> ▶</span>
                </td>
            </tr>
        </table>
        <h1 class="Title">Embrace Energy Difference Mode</h1>
        <p>Energy difference mode first applies the type of calculation selected (currently only minimization is supported) to the receptor by itself. For each ligand in turn, it then applies the calculation to the ligand by itself and the complex of the ligand with the receptor, and reports the energy difference. </p>
        <p>Below is an example command file for an Embrace job run in energy difference mode. A description of the opcodes used in the file follows.</p><pre>
embrace_input.mae
embrace_eDiff-out.mae
 FFLD      14      1      0      0     1.0000     0.0000     0.0000     0.0000
 SOLV       3      1      0      0     0.0000     0.0000     0.0000     0.0000
 EXNB       0      0      0      0     0.0000     0.0000     0.0000     0.0000
 BDCO       0      0      0      0    89.4427 99999.0000     0.0000     0.0000
 MBAE       1      0      0      0     0.0000     0.0000     0.0000     0.0000
 SUBS       0      0      0      0     0.0000     0.0000     0.0000     0.0000
 READ       0      0      0      0     0.0000     0.0000     0.0000     0.0000
 CONV       2      0      0      0     0.1000     0.0000     0.0000     0.0000
 MINI       1      0   2000      0     0.0000     0.0000     0.0000     0.0000
 BGIN       0      0      0      0     0.0000     0.0000     0.0000     0.0000
 READ       0      0      0      0     0.0000     0.0000     0.0000     0.0000
 CONV       2      0      0      0     0.1000     0.0000     0.0000     0.0000
 MINI       1      0   2000      0     0.0000     0.0000     0.0000     0.0000
 END        0      0      0      0     0.0000     0.0000     0.0000     0.0000
 MBAE      -1      0      0      0     0.0000     0.0000     0.0000     0.0000
</pre>
        <p><span class="CodeLink"><a href="opcodes_ffld.htm#opcodes_509685220_solv">SOLV</a></span>: The GB/SA effective water model is being used.</p>
        <p><span class="CodeLink"><a href="opcodes_ffld.htm#opcodes_509685220_ffld">FFLD</a></span>: This example uses OPLS_2005 with constant dielectric electrostatics, which is appropriate if GB/SA solvation is being used.</p>
        <p><span class="CodeLink"><a href="opcodes_ffld.htm#opcodes_509685220_exnb">EXNB</a></span>: Extended non-bonded cut-offs should be used with GB/SA solvation.</p>
        <p><code></code><span class="CodeLink"><a href="opcodes_embrace.htm#opcodes_509685220_mbae">MBAE</a></span>: Turn on Embrace.</p>
        <p class="Indented1">arg1 = 1: Using Energy Difference mode.</p>
        <p class="Indented1">arg2 = 0: MINI calculations being performed.</p>
        <p class="Indented1">arg3 = 0: Minimized complex structures are written to the output structure file.</p>
        <p><span class="CodeLink"><a href="opcodes_constrained_mini.htm#opcodes_509685220_subs">SUBS</a></span>: Substructures may be used. All opcodes related to the substructure should be defined in an <code>.sbc</code> file. The <code>.sbc</code> file should contain only lines referring to the receptor with the receptor atoms numbered starting from 1.</p>
        <p><span class="CodeLink"><a href="opcodes_file.htm#opcodes_509685220_read">READ</a></span>: The first <code>READ</code> command obtains the structure of the receptor.</p>
        <p><span class="CodeLink"><a href="opcodes_minimization.htm#opcodes_509685220_mini">MINI</a></span>: Minimize the energy of the receptor. Arg1=1 uses the PRCG minimization technique for up to arg3 (2000) iterations.</p>
        <p><span class="CodeLink"><a href="opcodes_flowcontrol.htm#opcodes_509685220_bgin">BGIN</a></span>: Start the loop which processes each ligand in turn.</p>
        <p><span class="CodeLink"><a href="opcodes_file.htm#opcodes_509685220_read">READ</a></span>: Sequentially read the ligand structures.</p>
        <p><span class="CodeLink"><a href="opcodes_minimization.htm#opcodes_509685220_mini">MINI</a></span>: Minimize first the current ligand structure, then minimize the receptor-ligand complex. Record the energy differences to the *<code>.log</code> file and to the output structure file.</p>
        <p><span class="CodeLink"><a href="opcodes_flowcontrol.htm#opcodes_509685220_end">END</a></span>: End the loop for ligands.</p>
        <p><span class="CodeLink"><a href="opcodes_embrace.htm#opcodes_509685220_mbae">MBAE</a></span>: When arg1&#160;=&#160;−1, Embrace is turned off. In this example, this command is not needed.</p>
        <p>Below is the Embrace output from the <code>.log</code> file for one ligand in a job run in energy difference mode, showing the energy differences upon complexation.</p><pre>
&#160;
 Embrace Energy Differences for Ligand #           1
 Ligand Name: Omo_4erkLig
      Total Energy(constraints) =      -43.3443 kJ/mol
   Total Energy(no constraints) =      -38.2964 kJ/mol
                 Valence Energy =       18.3260 kJ/mol
                            VDW =     -161.5383 kJ/mol
                  Electrostatic =      -60.9017 kJ/mol
        Explicit Hydrogen Bonds =        0.0000 kJ/mol
                      Solvation =      165.8165 kJ/mol
                     Constraint =       -5.0478 kJ/mol
                      Converged =    T
</pre>
        <p>In this example, <code>Converged = T</code> means that all minimization converged. If the value were <code>F</code> instead of <code>T</code>, then the energy differences would be suspect and the calculation may need to be repeated with more minimization steps. </p>
        <p>At the end of the log file is a table summarizing the results for all the ligands.</p>
        <p>Substructures can be specified using ASL. The substructure file has to be created by hand. An example of a substructure file that uses ASL is:</p><pre>
$SCHRODINGER/macromodel-v<i class="UserReplace">version</i>/samples/Examples/embrace_input_asl.sbc
</pre>
        <p>This file is used with the command file <code>embrace_eDiff_asl.com</code>, and is reproduced here:</p><pre>
 ASL1      -1 all
 FXAT       0       0       0       0 -1.0000     0.0000     0.0000     0.0000
 FXAT       0       0       0       0  0.0000     0.0000     0.0000     0.0000
 ASL1       0 not (mol.num 2) and fillres within 2.50 ( mol.num 2 )
 ASL1      -1 m. 2
 ASL2   100.0 (not(fillres within 2.5 m. 2)) and (fillres within 3.0 (fillres within 2.5 m. 2))
 ASL2    -1.0 (not(fillres within 3.0(fillres within 2.5 m. 2))) and (fillres within 3.0(fillres within 3.0(fillres within 2.5 m. 2)))
</pre>
        <p>Substructure addition and removal are performed with the  <span class="CodeLink"><a href="opcodes_constrained_mini.htm#opcodes_509685220_asl1">ASL1</a></span> command. Fixed and frozen atom definitions are made with the <span class="CodeLink"><a href="opcodes_constrained_mini.htm#opcodes_509685220_asl3">ASL2</a></span> command. See <a class="TopicLink MCXref xref xrefTopicLink" href="opcodes_constrained_mini.htm#opcodes_509685220_739476" xrefformat="{paratext}">Constrained Energy Minimization Opcodes</a> for information on the syntax of these commands. </p>
        <p>In the above example:</p>
        <p>The first three lines clear all free, fixed atom and frozen atom definitions respectively. Although this is not very useful in the context of Embrace, it is useful when a <span class="CodeLink"><a href="opcodes_constrained_mini.htm#opcodes_509685220_subs">SUBS</a></span> command is used within a <span class="CodeLink"><a href="opcodes_flowcontrol.htm#opcodes_509685220_bgin">BGIN</a></span>/<span class="CodeLink"><a href="opcodes_flowcontrol.htm#opcodes_509685220_end">END</a></span> loop.</p>
        <p>The fourth line adds the atoms defined by the ASL string to the substructure. In this case <code>mol.num 2</code> (molecule number 2) is the ligand. Thus, the binding site, consisting of residues within 2.5&#160;Å of the ligand, is added to the substructure.</p>
        <p>The fifth line indicates that the ligand should not be part of this substructure. Embrace calculations handle ligands separately.</p>
        <p>The sixth line specifies the atoms that are to be constrained with a force constant of 100.0 kJ mol<sup>−1</sup> Å<sup>−2</sup>. The ASL expression selects atoms that are within 3.0&#160;Å of the atoms defined by the fourth line, excluding atoms defined by the fourth line.</p>
        <p>The seventh line specifies the atoms that are to be frozen. The ASL expression selects atoms that are within 3.0&#160;Å of the atoms defined by the sixth line, excluding atoms defined by the sixth line.</p>
        <p class="Note" data-mc-autonum="&lt;b&gt;Note:&lt;/b&gt; "><span class="autonumber"><span><b>Note:</b> <![CDATA[ ]]></span></span>These two lines are wrapped in the example above, but should be a single line in the file. </p>
        <p>In this case the receptor is only one molecule. In cases where receptor consists of more than one molecule, use <code>mol.num </code><i class="UserReplace">n</i> or <code>m. </code><i class="UserReplace">n</i> for the ligand definition, where <i class="UserReplace">n</i> is the molecule number of the ligand.</p>
        <table class="NavLink" data-mc-conditions="Default.ScreenOnly">
            <tr class="NavLink">
                <td class="NavLeft"><span class="NavText">◀ <a class="NavLink MCXref xref xrefNavLink" href="mmod_command_examples_embrace_minimization_interaction.htm" xrefformat="{paratext}">Embrace Interaction Mode</a></span>
                </td>
                <td class="NavCenter"><span class="NavText"><a class="NavLink MCXref xref xrefNavLink" href="macromodel_command_referenceTOC.htm" xrefformat="{paratext}">MacroModel Command Reference Manual</a></span>
                </td>
                <td class="NavRight"><span class="NavText"><a class="NavLink MCXref xref xrefNavLink" href="mmod_command_examples_embrace_csearch.htm" xrefformat="{paratext}">MacroModel Example: Conformational Searches With Embrace</a> ▶</span>
                </td>
            </tr>
        </table>
    </body>
</html>