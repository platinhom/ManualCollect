<!DOCTYPE html>
<html xmlns:MadCap="http://www.madcapsoftware.com/Schemas/MadCap.xsd" lang="en-US" xml:lang="en-US" data-mc-search-type="Stem" data-mc-help-system-file-name="Documentation.xml" data-mc-path-to-help-system="../" data-mc-target-type="WebHelp2" data-mc-runtime-file-type="Topic" data-mc-preload-images="false" data-mc-in-preview-mode="false" data-mc-toc-path="Command References|MacroModel Command Reference|MacroModel Operation Codes|Constrained Energy Minimization Opcodes">
    <head>
        <meta name="viewport" content="width=device-width, initial-scale=1.0" />
        <meta charset="utf-8" />
        <meta http-equiv="X-UA-Compatible" content="IE=edge" />
        <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
        <link href="../Skins/Default/Stylesheets/Slideshow.css" rel="stylesheet" type="text/css" data-mc-generated="True" />
        <link href="../Skins/Default/Stylesheets/TextEffects.css" rel="stylesheet" type="text/css" data-mc-generated="True" />
        <link href="../Skins/Default/Stylesheets/Topic.css" rel="stylesheet" type="text/css" data-mc-generated="True" />
        <link href="../Skins/Default/Stylesheets/Components/Styles.css" rel="stylesheet" type="text/css" data-mc-generated="True" /><title>Constrained Energy Minimization Opcodes</title>
        <link href="../Resources/Stylesheets/docs.css" rel="stylesheet" />
        <script src="../Resources/Scripts/custom.modernizr.js" type="text/javascript">
        </script>
        <script src="../Resources/Scripts/jquery.min.js" type="text/javascript">
        </script>
        <script src="../Resources/Scripts/require.min.js" type="text/javascript">
        </script>
        <script src="../Resources/Scripts/require.config.js" type="text/javascript">
        </script>
        <script src="../Resources/Scripts/foundation.min.js" type="text/javascript">
        </script>
        <script src="../Resources/Scripts/plugins.min.js" type="text/javascript">
        </script>
        <script src="../Resources/Scripts/MadCapAll.js" type="text/javascript">
        </script>
    </head>
    <body><a name="aanchor9127"></a>
        <MadCap:concept term="Command Reference" /><a name="aanchor9128"></a>
        <MadCap:concept term="MacroModel" /><a name="opcodes_509685220_739476"></a><a name="opcodes_509685220_85701"></a>
        <table class="NavLink" data-mc-conditions="Default.ScreenOnly">
            <tr class="NavLink">
                <td class="NavLeft"><span class="NavText">◀ <a class="NavLink MCXref xref xrefNavLink" href="opcodes_minimization.htm" xrefformat="{paratext}">Energy Minimization Opcodes</a></span>
                </td>
                <td class="NavCenter"><span class="NavText"><a class="NavLink MCXref xref xrefNavLink" href="macromodel_command_referenceTOC.htm" xrefformat="{paratext}">MacroModel Command Reference Manual</a></span>
                </td>
                <td class="NavRight"><span class="NavText"><a class="NavLink MCXref xref xrefNavLink" href="opcodes_conf_comparison.htm" xrefformat="{paratext}">Conformational Comparison Opcodes</a> ▶</span>
                </td>
            </tr>
        </table>
        <h1 class="Title">Constrained Energy Minimization Opcodes</h1>
        <p>The opcodes in this section are linked below:</p>
        <p>
        </p>
        <h2 class="Opcode"><a name="opcodes_509685220_739478"></a><code class="Courier"><a name="opcodes_509685220_driv">DRIV</a></code> — carry out a geometry DRIVe </h2>
        <p>When included in a <span class="OpcodeLink"><a href="opcodes_flowcontrol.htm#opcodes_509685220_bgin">BGIN</a></span>/<span class="OpcodeLink"><a href="opcodes_flowcontrol.htm#opcodes_509685220_end">END</a></span> loop the <code>DRIV</code> command drives the specified geometric parameter through a set of fixed values. The parameter can be a dihedral angle, a bond angle, or a bond distance. The <code>DRIV</code> command should be followed by a <span class="OpcodeLink"><a href="opcodes_minimization.htm#opcodes_509685220_mini">MINI</a></span> (not an <span class="OpcodeLink"><a href="opcodes_energy.htm#opcodes_509685220_elst">ELST</a></span>) to evaluate the energy. The driving process involves adjusting the specified geometric parameter to the starting value and then setting a constraint with a large force constant (1000 kJ/mol) for that parameter. Then an energy minimization is carried out, and in the next pass through the <span class="OpcodeLink"><a href="opcodes_flowcontrol.htm#opcodes_509685220_bgin">BGIN</a></span>/<span class="OpcodeLink"><a href="opcodes_flowcontrol.htm#opcodes_509685220_end">END</a></span> loop the parameter is incremented by the value of arg7 and the process repeated. When the final value of the parameter (arg6) is reached or surpassed then a “grid” of energy values is written to a <code>.grd</code> file. This grid can be displayed as a contour map in Maestro (see <a class="TopicLink MCXref xref xrefTopicLink" xrefformat="{paratext}" data-mc-unresolved-link="import-link:plotting_316910284_84126">Plotting Coordinate Scan Results</a>); its format is described in <a class="TopicLink MCXref xref xrefTopicLink" href="mmod_grd_files.htm#mmod_grd_files_1939401851_738153" xrefformat="{paratext}">Format of MacroModel .grd Files</a>. </p>
        <p>You can have two consecutive <code>DRIV</code> commands to select two geometric parameters. You must specify the same type of parameter for each command: one angle and one distance is not an allowed combination. The inner loop runs over the parameter specified by the second <code>DRIV</code> command. Two <code>DRIV</code> commands are needed to calculate data for a Ramachandran-type plot.</p>
        <p class="Note" data-mc-autonum="&lt;b&gt;Note:&lt;/b&gt; "><span class="autonumber"><span><b>Note:</b> <![CDATA[ ]]></span></span>This opcode is incompatible with the use of <span class="OpcodeLink"><a href="opcodes_misc_debug.htm#opcodes_509685220_debg">DEBG</a></span><code> 23</code>. </p>
        <table class="ArgTable">
            <tr class="ArgTable">
                <td class="ArgTable">
                    <p class="ArgDef">arg1-4</p>
                </td>
                <td class="ArgTable">
                    <p class="ArgDef">Atom numbers </p>
                </td>
            </tr>
            <tr class="ArgTable">
                <td class="ArgTable">&#160;</td>
                <td class="ArgTable">
                    <p class="ArgPara">These define the geometric parameters to be driven. They must be valid atom numbers in the <i>filename</i><code>.mae</code> file For dihedral angles they must also define an angle that is rotatable, i.e., not one in which the four atoms lie in a ring. The geometric parameter is determined as follows:</p>
                    <ul class="ArgList">
                        <li class="ArgList" value="1">
                            <p class="ArgList">If arg3 and arg4 are zero, the distance defined by arg1 and arg2 is driven.</p>
                        </li>
                        <li class="ArgList" value="2">
                            <p class="ArgList">If arg4 is zero, the angle defined by arg1, arg2 and arg3 is driven. </p>
                        </li>
                        <li class="ArgList" value="3">
                            <p class="ArgList">If arg1–arg4 are non-zero, the dihedral angle defined by arg1–arg4 is driven. </p>
                        </li>
                    </ul>
                </td>
            </tr>
            <tr class="ArgTable">
                <td class="ArgTable">
                    <p class="ArgDef">arg5</p>
                </td>
                <td class="ArgTable">
                    <p class="ArgDef">Starting value </p>
                </td>
            </tr>
            <tr class="ArgTable">
                <td class="ArgTable">&#160;</td>
                <td class="ArgTable">
                    <p class="ArgPara">This does not need to be the current value in the <i>filename</i><code>.mae</code> file as MacroModel will first set the parameter to the required value. Must be nonzero for distance driving.</p>
                </td>
            </tr>
            <tr class="ArgTable">
                <td class="ArgTable">
                    <p class="ArgDef">arg6</p>
                </td>
                <td class="ArgTable">
                    <p class="ArgDef">Final value</p>
                </td>
            </tr>
            <tr class="ArgTable">
                <td class="ArgTable">&#160;</td>
                <td class="ArgTable">
                    <p class="ArgPara">The drive finishes when the parameter is greater than or equal to this value if arg7 is positive, or when the parameter is less than or equal to this value if arg7 is negative.</p>
                </td>
            </tr>
            <tr class="ArgTable">
                <td class="ArgTable">
                    <p class="ArgDef">arg7</p>
                </td>
                <td class="ArgTable">
                    <p class="ArgDef">Increment value </p>
                </td>
            </tr>
            <tr class="ArgTable">
                <td class="ArgTable">&#160;</td>
                <td class="ArgTable">
                    <p class="ArgPara">The increment must be nonzero. If arg7 is greater than zero then arg5 must be smaller than arg6, otherwise the drive would never terminate. Similarly, if arg7 is less than zero, arg5 must be greater than arg6. </p>
                </td>
            </tr>
            <tr class="ArgTable">
                <td class="ArgTable">&#160;</td>
                <td class="ArgTable">
                    <p class="ArgPara">The actual number of steps is given by the formula:</p>
                </td>
            </tr>
            <tr class="ArgTable">
                <td class="ArgTable">&#160;</td>
                <td class="ArgTable">
                    <p class="ArgPara"><i>N</i>= ABS(arg5−arg6)/arg7 +1</p>
                </td>
            </tr>
            <tr class="ArgTable">
                <td class="ArgTable">&#160;</td>
                <td class="ArgTable">
                    <p class="ArgPara">The maximum allowable value of <i>N</i> is 100. In the usual use of the <code>DRIV</code> command (i.e., two <code>DRIV</code> commands in a file), <i>N</i><sup>2</sup> energy minimizations are done.</p>
                </td>
            </tr>
            <tr class="ArgTable">
                <td class="ArgTable">
                    <p class="ArgDef">arg8</p>
                </td>
                <td class="ArgTable">
                    <p class="ArgDef">Constraint Force Constant </p>
                </td>
            </tr>
            <tr class="ArgTable">
                <td class="ArgTable">
                    <p class="ArgValue">0 </p>
                </td>
                <td class="ArgTable">
                    <p class="ArgPara">Use the default value of 1000 </p>
                </td>
            </tr>
            <tr class="ArgTable">
                <td class="ArgTable">
                    <p class="ArgValue">&gt; 0</p>
                </td>
                <td class="ArgTable">
                    <p class="ArgPara">Use this value</p>
                </td>
            </tr>
            <tr class="ArgTable">
                <td class="ArgTable">&#160;</td>
                <td class="ArgTable">
                    <p class="ArgPara">Units for the force constant vary with type of drive: kJ&#160;mol<sup>-1</sup>&#160;Å<sup>-2</sup> for distances, kJ&#160;mol<sup>-1</sup>&#160;radian<sup>-2</sup> for angles, and kJ&#160;mol<sup>-1</sup> for torsions.</p>
                </td>
            </tr>
        </table>
        <h2 class="Opcode"><a name="opcodes_509685220_778253"></a><code class="Courier"><a name="opcodes_509685220_subs">SUBS</a></code> — define a SUBStructure for subsequent minimization</h2>
        <p>Arg1-4 are atom numbers of the substructure: those atoms that are allowed to move without restriction in the environment of anchored atoms. This command is normally used with <span class="OpcodeLink"><a href="#opcodes_509685220_fxat">FXAT</a></span> commands, which restrain the position of atoms at the periphery of the substructure. The substructure and associated <span class="OpcodeLink"><a href="#opcodes_509685220_fxat">FXAT</a></span> commands are commonly produced using the substructure editor of Maestro. There are two principal reasons to do this:</p>
        <ul>
            <li value="1">
                <p class="ListPara">To “tether” part of a molecule in space. This is ordinarily done using <span class="OpcodeLink"><a href="#opcodes_509685220_fxat">FXAT</a></span> commands but no <code>SUBS</code> commands.</p>
            </li>
            <li value="2">
                <p class="ListPara">To save computing time by ignoring part of the system believed to be irrelevant. If both <code>SUBS</code> and <span class="OpcodeLink"><a href="#opcodes_509685220_fxat">FXAT</a></span> commands appear, then atoms that are not specified in either command are completely ignored in the simulation.</p>
            </li>
        </ul>
        <p class="Note" data-mc-autonum="&lt;b&gt;Note:&lt;/b&gt; "><span class="autonumber"><span><b>Note:</b> <![CDATA[ ]]></span></span>When <code>SUBS</code> and <span class="OpcodeLink"><a href="#opcodes_509685220_fxat">FXAT</a></span> commands appear together, any interaction except a stretch consisting only of <span class="OpcodeLink"><a href="#opcodes_509685220_fxat">FXAT</a></span> atoms is eliminated, provided the following conditions hold: </p>
        <ul class="ListCompact">
            <li value="1">The <span class="OpcodeLink"><a href="#opcodes_509685220_fxat">FXAT</a></span> atoms in question are not specified by any <code>SUBS</code> command.
    </li>
            <li value="2">The flat-bottom half-width is zero for all the <span class="OpcodeLink"><a href="#opcodes_509685220_fxat">FXAT</a></span> atoms concerned. 
    </li>
            <li value="3">Neither <span class="OpcodeLink"><a href="opcodes_misc_debug.htm#opcodes_509685220_debg">DEBG</a></span> <code>17</code> nor <span class="OpcodeLink"><a href="opcodes_misc_debug.htm#opcodes_509685220_debg">DEBG</a></span> <code>28</code> is specified. 
    </li>
        </ul>
        <p>The elimination of these interactions saves time, since <span class="OpcodeLink"><a href="#opcodes_509685220_fxat">FXAT</a></span> atoms will not move much; however, stretches are always included since without them the “fixed” atoms tend to adopt unrealistic relative positions even for rather high tethering potentials.</p>
        <p>If a <code>SUBS</code> command appears in the <code>.com</code> file with a zero-valued first argument, then MacroModel looks for a file named <i>filename</i><code>.sbc</code>, in which it expects to find <code>SUBS</code>, <span class="OpcodeLink"><a href="#opcodes_509685220_fxat">FXAT</a></span>, <span class="OpcodeLink"><a href="#opcodes_509685220_asl1">ASL1</a></span>, <span class="OpcodeLink"><a href="#opcodes_509685220_asl2">ASL2</a></span>, and <span class="OpcodeLink"><a href="#opcodes_509685220_asl3">ASL3</a></span> commands. This file can be produced either manually or using Maestro. <span class="OpcodeLink"><a href="#opcodes_509685220_asl1">ASL1</a></span>, <span class="OpcodeLink"><a href="#opcodes_509685220_asl2">ASL2</a></span> and <span class="OpcodeLink"><a href="#opcodes_509685220_asl3">ASL3</a></span> commands must be added manually. Additional <code>SUBS</code> commands with atom numbers can be used to direct additional atoms to be added to the set in the <code>.sbc</code> file. </p>
        <p>A typical use of both <code>SUBS</code> formats simultaneously might be simulating the binding of a large molecule to a list of small molecules. The <code>.sbc</code> file would define the substructure and fixed atoms for the large molecule. The first <code>SUBS</code> command in the <code>.com</code> file would have a zero-valued first argument and would set up the substructure for the large molecule. Subsequent <code>SUBS</code> commands would include the small molecules in the simulation. The input data files for each job would contain the large molecule first, ensuring that its numbering scheme, like that in the <code>.sbc</code> file, remains constant over the series of runs.</p>
        <p>If a negative number is given for any of arg1 through arg4, then the entire molecule containing that atom number is defined as a part of the substructure. For <span class="OpcodeLink"><a href="opcodes_embrace.htm#opcodes_509685220_mbae">MBAE</a></span> calculations a <code>.sbc</code> file should be used to specify the substructure.</p>
        <p><code>SUBS</code> commands with nonzero first arguments must come after <span class="OpcodeLink"><a href="opcodes_file.htm#opcodes_509685220_read">READ</a></span> commands. <code>SUBS</code> commands with zero first arguments must come before <span class="OpcodeLink"><a href="opcodes_file.htm#opcodes_509685220_read">READ</a></span>, because the <code>.sbc</code> file is read during structure file reads.</p>
        <table class="ArgTable">
            <tr class="ArgTable">
                <td class="ArgTable">
                    <p class="ArgDef">arg1</p>
                </td>
                <td class="ArgTable">
                    <p class="ArgDef">Substructure atom number</p>
                </td>
            </tr>
            <tr class="ArgTable">
                <td class="ArgTable">
                    <p class="ArgValue">0</p>
                </td>
                <td class="ArgTable">
                    <p class="ArgPara">Obtain information from <code>.sbc</code> file; arg3 and arg4 are ignored.</p>
                    <table class="ArgTable">
                        <tr class="ArgTable">
                            <td class="ArgTable">
                                <p class="ArgDef">arg2</p>
                            </td>
                            <td class="ArgTable">
                                <p class="ArgDef">File for substructure specification</p>
                            </td>
                        </tr>
                        <tr class="ArgTable">
                            <td class="ArgTable">
                                <p class="ArgValue">1</p>
                            </td>
                            <td class="ArgTable">
                                <p class="ArgValue">Use <i>jobname</i><code>.sbc</code>.</p>
                            </td>
                        </tr>
                        <tr class="ArgTable">
                            <td class="ArgTable">
                                <p class="ArgValue"><span class="Symbol">¹ </span>1</p>
                            </td>
                            <td class="ArgTable">
                                <p class="ArgValue">Use <i>current_rootname</i><code>.sbc</code>. For example, if a single rewind has been done then <i>current_rootname</i> is <i>jobname</i><code>-out</code>.</p>
                            </td>
                        </tr>
                    </table>
                </td>
            </tr>
            <tr class="ArgTable">
                <td class="ArgTable">
                    <p class="ArgValue">&gt; 0</p>
                </td>
                <td class="ArgTable">
                    <p class="ArgPara">Atom number.</p>
                    <table class="ArgTable">
                        <tr class="ArgTable">
                            <td class="ArgTable">
                                <p class="ArgDef">arg2-4</p>
                            </td>
                            <td class="ArgTable">
                                <p class="ArgDef">Substructure atom number</p>
                            </td>
                        </tr>
                        <tr class="ArgTable">
                            <td class="ArgTable">
                                <p class="ArgValue">&gt; 0</p>
                            </td>
                            <td class="ArgTable">
                                <p class="ArgValue">Atom number.</p>
                            </td>
                        </tr>
                    </table>
                </td>
            </tr>
            <tr class="ArgTable">
                <td class="ArgTable">
                    <p class="ArgDef">arg5</p>
                </td>
                <td class="ArgTable">
                    <p class="ArgDef">Add/Delete atoms</p>
                </td>
            </tr>
            <tr class="ArgTable">
                <td class="ArgTable">
                    <p class="ArgValue">0</p>
                </td>
                <td class="ArgTable">
                    <p class="ArgPara">Default, add the atoms listed to the substructure.</p>
                </td>
            </tr>
            <tr class="ArgTable">
                <td class="ArgTable">
                    <p class="ArgValue">−1</p>
                </td>
                <td class="ArgTable">
                    <p class="ArgPara">Remove the atoms listed from the substructure.</p>
                </td>
            </tr>
        </table>
        <h2 class="Opcode"><a name="opcodes_509685220_778364"></a><code class="Courier"><a name="opcodes_509685220_asl1">ASL1</a></code> — ASL expression for substructure</h2>
        <p>Specify ASL syntax for a substructure. This command is intended to make it easier to set up standardized substructures that can be reused in different calculations on different molecular systems.</p>
        <p class="Note" data-mc-autonum="&lt;b&gt;Note:&lt;/b&gt; "><span class="autonumber"><span><b>Note:</b> <![CDATA[ ]]></span></span>This special command can only be used in substructure (<code>.sbc</code>) files: it cannot be used in command (<code>.com</code>) files. </p>
        <p>The format of this command is similar to that of regular opcodes, starting with a 4-character string. The first argument is a floating-point number that has the same meaning as arg5 of <span class="OpcodeLink"><a href="#opcodes_509685220_subs">SUBS</a></span>, and the second argument is a string. </p>
        <table class="ArgTable">
            <tr class="ArgTable">
                <td class="ArgTable">
                    <p class="ArgDef">arg1</p>
                </td>
                <td class="ArgTable">
                    <p class="ArgDef">Add/Delete atoms </p>
                </td>
            </tr>
            <tr class="ArgTable">
                <td class="ArgTable">
                    <p class="ArgValue">0</p>
                </td>
                <td class="ArgTable">
                    <p class="ArgPara">Add the atoms defined by the ASL expression to the substructure. (Default)</p>
                </td>
            </tr>
            <tr class="ArgTable">
                <td class="ArgTable">
                    <p class="ArgValue">−1</p>
                </td>
                <td class="ArgTable">
                    <p class="ArgPara">Remove the atoms defined by the ASL expression from the substructure.</p>
                </td>
            </tr>
            <tr class="ArgTable">
                <td class="ArgTable">
                    <p class="ArgDef">arg2</p>
                </td>
                <td class="ArgTable">
                    <p class="ArgDef">ASL expression</p>
                </td>
            </tr>
            <tr class="ArgTable">
                <td class="ArgTable">&#160;</td>
                <td class="ArgTable">
                    <p class="ArgPara">See the <a href="../maestro_command_reference/maestro_command_referenceTOC.htm">Maestro Command Reference Manual</a> for information on ASL syntax. </p>
                </td>
            </tr>
        </table>
        <h2 class="Opcode"><a name="opcodes_509685220_778384"></a><code class="Courier"><a name="opcodes_509685220_asl2">ASL2</a></code> — ASL expression for fixed and frozen atoms</h2>
        <p>Specify ASL syntax for fixed and frozen atoms, similar to the <span class="OpcodeLink"><a href="#opcodes_509685220_fxat">FXAT</a></span> opcode. This command is intended to make it easier to set up standardized substructures that can be reused in different calculations on different molecular systems.</p>
        <p class="Note" data-mc-autonum="&lt;b&gt;Note:&lt;/b&gt; "><span class="autonumber"><span><b>Note:</b> <![CDATA[ ]]></span></span>This special command can only be used in substructure (<code>.sbc</code>) files: it cannot be used in command (<code>.com</code>) files. </p>
        <p>The format of this command is similar to that of regular opcodes, starting with a 4-character string. The optional first argument is a 4-digit integer, the second argument is a 7-digit floating-point number, and the third argument is a string, separated by single spaces. Space must not be left on the line for the first argument if it is not given. </p>
        <table class="ArgTable">
            <tr class="ArgTable">
                <td class="ArgTable">
                    <p class="ArgDef">arg1</p>
                </td>
                <td class="ArgTable">
                    <p class="ArgDef">Half-width for flat-bottomed constraint (optional) </p>
                </td>
            </tr>
            <tr class="ArgTable">
                <td class="ArgTable">
                    <p class="ArgValue">&gt; 0</p>
                </td>
                <td class="ArgTable">
                    <p class="ArgPara">Specify the half-width in units of 0.1&#160;Å of the flat-bottom section of the constraint for the atoms defined by the ASL expression. This is defined in the same way as arg4 of <span class="OpcodeLink"><a href="#opcodes_509685220_fxat">FXAT</a></span>.</p>
                </td>
            </tr>
            <tr class="ArgTable">
                <td class="ArgTable">
                    <p class="ArgDef">arg2</p>
                </td>
                <td class="ArgTable">
                    <p class="ArgDef">Fix or freeze atoms </p>
                </td>
            </tr>
            <tr class="ArgTable">
                <td class="ArgTable">
                    <p class="ArgValue">&gt; 0</p>
                </td>
                <td class="ArgTable">
                    <p class="ArgPara">Specify the force constant in kJ&#160;mol<sup>−1</sup>&#160;Å<sup>−2</sup> for the atoms defined by the ASL expression, which are “fixed” atoms.</p>
                </td>
            </tr>
            <tr class="ArgTable">
                <td class="ArgTable">
                    <p class="ArgValue">−1</p>
                </td>
                <td class="ArgTable">
                    <p class="ArgPara">Freeze the atoms defined by the ASL expression. </p>
                </td>
            </tr>
            <tr class="ArgTable">
                <td class="ArgTable">
                    <p class="ArgDef">arg3</p>
                </td>
                <td class="ArgTable">
                    <p class="ArgDef">ASL expression</p>
                </td>
            </tr>
            <tr class="ArgTable">
                <td class="ArgTable">&#160;</td>
                <td class="ArgTable">
                    <p class="ArgPara">See the <a href="../maestro_command_reference/maestro_command_referenceTOC.htm">Maestro Command Reference Manual</a> for information on ASL syntax. </p>
                </td>
            </tr>
        </table>
        <h2 class="Opcode"><a name="opcodes_509685220_783489"></a><code class="Courier"><a name="opcodes_509685220_asl3">ASL3</a></code> — ASL expression for fixed and frozen ligand atoms in Embrace calculations </h2>
        <p>Specify ASL syntax for fixed and frozen ligand atoms in Embrace calculations, similar to the <span class="OpcodeLink"><a href="#opcodes_509685220_fxat">FXAT</a></span> opcode. This command is intended to make it easier to set up standardized substructures that can be reused in different calculations on different molecular systems.</p>
        <p class="Note" data-mc-autonum="&lt;b&gt;Note:&lt;/b&gt; "><span class="autonumber"><span><b>Note:</b> <![CDATA[ ]]></span></span>This special command can only be used in substructure (<code>.sbc</code>) files: it cannot be used in command (<code>.com</code>) files. </p>
        <p>The format of this command is similar to that of regular opcodes, starting with a 4-character string.The optional first argument is a 4-digit integer, the second argument is a 7-digit floating-point number, and the third argument is a string, separated by single spaces. Space must not be left on the line for the first argument if it is not given. </p>
        <table class="ArgTable">
            <tr class="ArgTable">
                <td class="ArgTable">
                    <p class="ArgDef">arg1</p>
                </td>
                <td class="ArgTable">
                    <p class="ArgDef">Half-width for flat-bottomed constraint (optional) </p>
                </td>
            </tr>
            <tr class="ArgTable">
                <td class="ArgTable">
                    <p class="ArgValue">&gt; 0</p>
                </td>
                <td class="ArgTable">
                    <p class="ArgPara">Specify the half-width in units of 0.1&#160;Å of the flat-bottom section of the constraint for the atoms defined by the ASL expression.This is defined in the same way as arg4 of <span class="OpcodeLink"><a href="#opcodes_509685220_fxat">FXAT</a></span>.</p>
                </td>
            </tr>
            <tr class="ArgTable">
                <td class="ArgTable">
                    <p class="ArgDef">arg2</p>
                </td>
                <td class="ArgTable">
                    <p class="ArgDef">Fix or freeze atoms </p>
                </td>
            </tr>
            <tr class="ArgTable">
                <td class="ArgTable">
                    <p class="ArgValue">&gt; 0</p>
                </td>
                <td class="ArgTable">
                    <p class="ArgPara">Specify the force constant in kJ&#160;mol<sup>−1</sup>&#160;Å<sup>−2</sup> for the atoms defined by the ASL expression, which are “fixed” atoms.</p>
                </td>
            </tr>
            <tr class="ArgTable">
                <td class="ArgTable">
                    <p class="ArgValue">−1</p>
                </td>
                <td class="ArgTable">
                    <p class="ArgPara">Freeze the atoms defined by the ASL expression. </p>
                </td>
            </tr>
            <tr class="ArgTable">
                <td class="ArgTable">
                    <p class="ArgDef">arg3</p>
                </td>
                <td class="ArgTable">
                    <p class="ArgDef">ASL expression</p>
                </td>
            </tr>
            <tr class="ArgTable">
                <td class="ArgTable">&#160;</td>
                <td class="ArgTable">
                    <p class="ArgPara">See the <a href="../maestro_command_reference/maestro_command_referenceTOC.htm">Maestro Command Reference Manual</a> for information on ASL syntax. </p>
                </td>
            </tr>
        </table>
        <h2 class="Opcode"><a name="opcodes_509685220_739502"></a><code class="Courier"><a name="opcodes_509685220_fxat">FXAT</a></code> — FiX ATom</h2>
        <p>Fix or freeze the position of the atom given in arg1. We use the term “fix” to mean “tether in place using a constraint”; thus “fixed” atoms can move. We use the term “frozen” to denote “rigidly freeze in place.” Frozen atoms cannot move at all.</p>
        <p>This command is generally used with the <span class="OpcodeLink"><a href="#opcodes_509685220_subs">SUBS</a></span> command to fix or freeze the positions of certain atoms at the periphery of the substructure being minimized. See the description of the <span class="OpcodeLink"><a href="#opcodes_509685220_subs">SUBS</a></span> command for a description.</p>
        <p>When doing substructure (<span class="OpcodeLink"><a href="#opcodes_509685220_subs">SUBS</a></span>) calculations with <code>FXAT</code> restraints having no free flat bottom region (arg4 = 0), interactions wholly involving the fixed atoms, other than stretches, are eliminated from the interaction array unless <span class="OpcodeLink"><a href="opcodes_misc_debug.htm#opcodes_509685220_debg">DEBG</a></span><code> 17</code> or <code>28</code> is set. This is primarily to improve the speed of the computation; when the force constant is large, as it is by default, the <code>FXAT</code> constraints, together with the stretch interactions, maintain reasonable local geometries. </p>
        <p>The constraint potential, <i>E</i><sub class="SubItal">c</sub>, for a fixed atom is calculated using the equation</p>
        <p class="EquationNoNum">
            <img src="../GeneratedImages/Equations/Equation202.svg" alt="" class="_MCEquation_0 mcReset" />
        </p>
        <p>where <img src="../GeneratedImages/Equations/Equation203.svg" alt="" class="_MCEquation_0 mcReset" />, <i class="BoldItalic">R</i> is the current position and <b>R</b><sub>0</sub> is the desired position (arg6-arg8), <i>k</i> is the force constant (arg5), and <span class="Symbol">s</span> is the half-width of the flat-bottomed potential (arg4).</p>
        <p>When using low force constants to “gently” constrain atomic positions, local geometries become unreasonable unless debug switch 17 is set. Also, unless mutual interactions between <code>FXAT</code> atoms are active, solvation energies for systems involving <code>FXAT</code> have no absolute meaning, although comparisons between conformers are still meaningful.</p>
        <p>When using <code>FXAT</code> commands in molecular dynamics (e.g., doing substructure molecular dynamics), it is appropriate to use substantially reduced force constants (arg5, e.g., 50-100) so that realistic flexibility and rapid thermal equilibration is possible.</p>
        <p>If two <code>FXAT</code> commands specify the same atom, the second replaces the first.</p>
        <p>A <code>FXAT</code> command must come after <span class="OpcodeLink"><a href="opcodes_file.htm#opcodes_509685220_read">READ</a></span> commands.</p>
        <p>Note that for <span class="OpcodeLink"><a href="opcodes_embrace.htm#opcodes_509685220_mbae">MBAE</a></span> calculations, <code>FXAT</code> commands should be placed in a <code>.sbc</code> file.</p>
        <table class="ArgTable">
            <tr class="ArgTable">
                <td class="ArgTable">
                    <p class="ArgDef">arg1</p>
                </td>
                <td class="ArgTable">
                    <p class="ArgDef">Fixed atom number</p>
                </td>
            </tr>
            <tr class="ArgTable">
                <td class="ArgTable">
                    <p class="ArgValue">0</p>
                </td>
                <td class="ArgTable">
                    <p class="ArgPara">Clear or modify fixed and/or frozen atom constraints, depending on the values of the other arguments. A typical use for this facility is in homology modeling, when one might want to perform a minimization with frozen or “tight” fixed constraints, then repetitively diminish the constraints and reminimize. When arg1 is 0, the other args are interpreted as follows. </p>
                    <table class="ArgTable">
                        <tr class="ArgTable">
                            <td class="ArgTable">
                                <p class="ArgDef">arg2</p>
                            </td>
                            <td class="ArgTable">
                                <p class="ArgDef">Selection of atom classes to modify</p>
                            </td>
                        </tr>
                        <tr class="ArgTable">
                            <td class="ArgTable">
                                <p class="ArgValue">0 </p>
                            </td>
                            <td class="ArgTable">
                                <p class="ArgValue">Constraints are removed from all fixed and frozen atoms.</p>
                            </td>
                        </tr>
                        <tr class="ArgTable">
                            <td class="ArgTable">
                                <p class="ArgValue">&gt; 0</p>
                            </td>
                            <td class="ArgTable">
                                <p class="ArgValue">Fixed atoms are modified according to values of arg4 and arg5.</p>
                            </td>
                        </tr>
                        <tr class="ArgTable">
                            <td class="ArgTable">
                                <p class="ArgValue">&lt; 0</p>
                            </td>
                            <td class="ArgTable">
                                <p class="ArgValue">Frozen atoms are modified according to values of arg4 and arg5.</p>
                            </td>
                        </tr>
                        <tr class="ArgTable">
                            <td class="ArgTable">
                                <p class="ArgDef">arg4</p>
                            </td>
                            <td class="ArgTable">
                                <p class="ArgDef">Flat-bottomed constraint changes</p>
                            </td>
                        </tr>
                        <tr class="ArgTable">
                            <td class="ArgTable">
                                <p class="ArgValue">0</p>
                            </td>
                            <td class="ArgTable">
                                <p class="ArgValue">Remove constraints if arg5 is zero; make no changes if arg5 is nonzero.</p>
                            </td>
                        </tr>
                        <tr class="ArgTable">
                            <td class="ArgTable">
                                <p class="ArgValue">&gt; 0</p>
                            </td>
                            <td class="ArgTable">
                                <p class="ArgValue">Set the flat-bottom half widths to arg4/10 (e.g., arg4=1 sets the flat-bottom half widths to 0.1&#160;Å)</p>
                            </td>
                        </tr>
                        <tr class="ArgTable">
                            <td class="ArgTable">
                                <p class="ArgValue">&lt; 0</p>
                            </td>
                            <td class="ArgTable">
                                <p class="ArgValue">Set the flat-bottom half-widths to zero.</p>
                            </td>
                        </tr>
                        <tr class="ArgTable">
                            <td class="ArgTable">
                                <p class="ArgDef">arg5</p>
                            </td>
                            <td class="ArgTable">
                                <p class="ArgDef">Force constant changes</p>
                            </td>
                        </tr>
                        <tr class="ArgTable">
                            <td class="ArgTable">
                                <p class="ArgValue">0</p>
                            </td>
                            <td class="ArgTable">
                                <p class="ArgValue">Remove constraints if arg4 is zero; </p>
                            </td>
                        </tr>
                        <tr class="ArgTable">
                            <td class="ArgTable">
                                <p class="ArgValue">&gt; 0</p>
                            </td>
                            <td class="ArgTable">
                                <p class="ArgValue">Convert frozen atoms to fixed with a force constant of arg5 if arg2 &lt; 0; multiply the force constant by arg4 if arg2 &gt; 0 (e.g., arg5=0.1 lowers the fixed-atom force constants to 1/10 their current values). The flat-bottom half width is set by arg4. </p>
                            </td>
                        </tr>
                        <tr class="ArgTable">
                            <td class="ArgTable">
                                <p class="ArgValue">&lt; 0</p>
                            </td>
                            <td class="ArgTable">
                                <p class="ArgValue">Convert fixed atoms to frozen atoms if arg2 &gt; 0. </p>
                            </td>
                        </tr>
                    </table>
                </td>
            </tr>
            <tr class="ArgTable">
                <td class="ArgTable">
                    <p class="ArgValue">&gt; 0</p>
                </td>
                <td class="ArgTable">
                    <p class="ArgPara">Specify fixed or frozen status for the atom specified; this can override a previous specification for the same atom.</p>
                    <table class="ArgTable">
                        <tr class="ArgTable">
                            <td class="ArgTable">
                                <p class="ArgDef">arg4</p>
                            </td>
                            <td class="ArgTable">
                                <p class="ArgDef">Half width of a flat bottom restraint</p>
                            </td>
                        </tr>
                        <tr class="ArgTable">
                            <td class="ArgTable">&#160;</td>
                            <td class="ArgTable">
                                <p class="ArgParaIndent">Specified in tenths of an Angstrom (an integer).</p>
                            </td>
                        </tr>
                        <tr class="ArgTable">
                            <td class="ArgTable">
                                <p class="ArgDef">arg5</p>
                            </td>
                            <td class="ArgTable">
                                <p class="ArgDef">Force constant (kJ mol<sup>-1</sup> Å<sup>-2</sup>)</p>
                            </td>
                        </tr>
                        <tr class="ArgTable">
                            <td class="ArgTable">&#160;</td>
                            <td class="ArgTable">
                                <p class="ArgParaIndent">The units of the force constant are configurable by means of the <code>FIX</code> multiplier in the force-field file in use. Internally, the program uses kJ&#160;mol<sup>−1</sup> as its energy unit, so that, after multiplication by the multiplier, <code>FXAT</code> force constants have these units. Most force-field files we supply specify a <code>FIX</code> multiplier of 4.184. Thus, the units given in the <code>.com</code> file, and in the Maestro interface, correspond to kcal/mol for these force fields. In other words, the default versions of the force field files for AMBER*, MM2*, MM3*, OPLS, and MMFF indicate that fixed-atom constraints have the units of kcal mol<sup>-1</sup> Å<sup>-2</sup>, but the units of fixed-atom constraints for the OPLS_2005 and later OPLS force fields are kJ mol<sup>-1</sup> Å<sup>-2</sup>.</p>
                            </td>
                        </tr>
                        <tr class="ArgTable">
                            <td class="ArgTable">
                                <p class="ArgValue">0</p>
                            </td>
                            <td class="ArgTable">
                                <p class="ArgValue">500.0 (default).</p>
                            </td>
                        </tr>
                        <tr class="ArgTable">
                            <td class="ArgTable">
                                <p class="ArgValue">&gt; 0</p>
                            </td>
                            <td class="ArgTable">
                                <p class="ArgValue">Use this value instead of default.</p>
                            </td>
                        </tr>
                        <tr class="ArgTable">
                            <td class="ArgTable">
                                <p class="ArgValue">&lt; 0</p>
                            </td>
                            <td class="ArgTable">
                                <p class="ArgValue">“Freeze” this atom—make it completely unmovable. All interactions (including stretches) composed of such atoms are removed, unless <span class="OpcodeLink"><a href="opcodes_misc_debug.htm#opcodes_509685220_debg">DEBG</a></span><code> 17</code> is specified. Movable atoms still feel the effect of such atoms. </p>
                            </td>
                        </tr>
                        <tr class="ArgTable">
                            <td class="ArgTable">
                                <p class="ArgDef">arg6-8</p>
                            </td>
                            <td class="ArgTable">
                                <p class="ArgDef">Desired X,Y,Z coordinates of atom </p>
                            </td>
                        </tr>
                        <tr class="ArgTable">
                            <td class="ArgTable">&#160;</td>
                            <td class="ArgTable">
                                <p class="ArgParaIndent">If all zero, the atom is fixed at its starting coordinates.</p>
                            </td>
                        </tr>
                    </table>
                </td>
            </tr>
        </table>
        <h2 class="Opcode"><a name="opcodes_509685220_739542"></a><code class="Courier"><a name="opcodes_509685220_fxdi">FXDI</a></code> — FiX DIstance</h2>
        <p>This command supplies energetic restraints to interatomic distances. This command provides flat-bottom energetic restraint wells, in which there is no penalty for limited user-defined deviations from the equilibrium distance. This command is useful for restraining energy minimizations and molecular dynamics simulations to geometries with desired internuclear proximities (e.g., from NOE experiments).</p>
        <p>The constraint potential, <i>E</i><sub class="SubItal">c</sub>, for a fixed distance is calculated using the equation</p>
        <p class="EquationNoNum">
            <img src="../GeneratedImages/Equations/Equation204.svg" alt="" class="_MCEquation_0 mcReset" />
        </p>
        <p>where</p>
        <p class="EquationNoNum">
            <img src="../GeneratedImages/Equations/Equation205.svg" alt="" class="_MCEquation_0 mcReset" />
        </p>
        <p>
            <img src="../GeneratedImages/Equations/Equation206.svg" alt="" class="_MCEquation_0 mcReset" />, <i class="BoldItalic">R</i><sub class="SubItal">i</sub> and <b>R</b><sub class="SubItal">j</sub> are the positions of the atoms <i>i</i> and <i>j</i> that define the distance, <i>d</i><sub>0</sub> is the desired position (arg6), <i>k</i> is the force constant (arg5) and <span class="Symbol">s</span> is the half width of the flat-bottomed potential (arg7).</p>
        <p class="Note" data-mc-autonum="&lt;b&gt;Note:&lt;/b&gt; "><span class="autonumber"><span><b>Note:</b> <![CDATA[ ]]></span></span>With hydrogens bound to carbon in force fields MM2 and MM3, the restraint is applied between the van der Waals positions of the hydrogen (e.g., with a (C)H in MM2, the hydrogen is treated as if it were at a position shifted 8.5% of the C-H bond length toward the C).</p>
        <p>If two <code>FXDI</code> commands specify the same atoms, the second replaces the first.</p>
        <p>Note that for <span class="OpcodeLink"><a href="opcodes_embrace.htm#opcodes_509685220_mbae">MBAE</a></span> calculations, <code>FXDI</code> commands should be placed in a <code>.sbc</code> file.</p>
        <table class="ArgTable">
            <tr class="ArgTable">
                <td class="ArgTable">
                    <p class="ArgDef">arg1</p>
                </td>
                <td class="ArgTable">
                    <p class="ArgDef">Atom 1</p>
                </td>
            </tr>
            <tr class="ArgTable">
                <td class="ArgTable">
                    <p class="ArgValue">0</p>
                </td>
                <td class="ArgTable">
                    <p class="ArgPara">Clear all existing <code>FXDI</code> constraints </p>
                </td>
            </tr>
            <tr class="ArgTable">
                <td class="ArgTable">
                    <p class="ArgDef">arg2</p>
                </td>
                <td class="ArgTable">
                    <p class="ArgDef">Atom 2</p>
                </td>
            </tr>
            <tr class="ArgTable">
                <td class="ArgTable">
                    <p class="ArgDef">arg4</p>
                </td>
                <td class="ArgTable">
                    <p class="ArgDef">Nonbonded control</p>
                </td>
            </tr>
            <tr class="ArgTable">
                <td class="ArgTable">
                    <p class="ArgValue">1</p>
                </td>
                <td class="ArgTable">
                    <p class="ArgPara">The corresponding nonbonded interaction is eliminated from the interaction array. Used to allow fixed distances for atoms which are close in space.</p>
                </td>
            </tr>
            <tr class="ArgTable">
                <td class="ArgTable">
                    <p class="ArgDef">arg5</p>
                </td>
                <td class="ArgTable">
                    <p class="ArgDef">Force constant in kJ mol<sup>−1</sup> Å<sup>−2</sup> (default 100.0)·</p>
                </td>
            </tr>
            <tr class="ArgTable">
                <td class="ArgTable">
                    <p class="ArgDef">arg6</p>
                </td>
                <td class="ArgTable">
                    <p class="ArgDef">Desired distance (Å)</p>
                </td>
            </tr>
            <tr class="ArgTable">
                <td class="ArgTable">
                    <p class="ArgValue">0</p>
                </td>
                <td class="ArgTable">
                    <p class="ArgPara">Use initial value.</p>
                </td>
            </tr>
            <tr class="ArgTable">
                <td class="ArgTable">
                    <p class="ArgValue">&gt; 0</p>
                </td>
                <td class="ArgTable">
                    <p class="ArgPara">Use this value.</p>
                </td>
            </tr>
            <tr class="ArgTable">
                <td class="ArgTable">
                    <p class="ArgDef">arg7</p>
                </td>
                <td class="ArgTable">
                    <p class="ArgDef">Half-width of flat bottom part of the potential well</p>
                </td>
            </tr>
        </table>
        <h2 class="Opcode"><a name="opcodes_509685220_744721"></a><code class="Courier"><a name="opcodes_509685220_fxba">FXBA</a></code> — FiX Bond Angles</h2>
        <p>This command supplies energetic restraints to planar angles defined by the locations of triplets of atoms.</p>
        <p>The constraint potential, <i>E</i><sub>c</sub>, for a fixed bond angle is calculated using the equation</p>
        <p class="EquationNoNum">
            <img src="../GeneratedImages/Equations/Equation207.svg" alt="" class="_MCEquation_0 mcReset" />
        </p>
        <p>where <span class="Symbol">q</span> is the current bond angle, <span class="Symbol">q</span><sub>0</sub> is the desired bond angle (arg6), and <i>k</i> is the force constant (arg5).</p>
        <p>If two <code>FXBA</code> commands specify the same bond angle, the second replaces the first.</p>
        <p>Note that for <span class="OpcodeLink"><a href="opcodes_embrace.htm#opcodes_509685220_mbae">MBAE</a></span> calculations, <code>FXBA</code> commands should be placed in a <code>.sbc</code> file.</p>
        <table class="ArgTable">
            <tr class="ArgTable">
                <td class="ArgTable">
                    <p class="ArgDef">arg1</p>
                </td>
                <td class="ArgTable">
                    <p class="ArgDef">Atom 1</p>
                </td>
            </tr>
            <tr class="ArgTable">
                <td class="ArgTable">
                    <p class="ArgValue">0</p>
                </td>
                <td class="ArgTable">
                    <p class="ArgPara">Clear all existing <code>FXBA</code> constraints </p>
                </td>
            </tr>
            <tr class="ArgTable">
                <td class="ArgTable">
                    <p class="ArgDef">arg2</p>
                </td>
                <td class="ArgTable">
                    <p class="ArgDef">Atom 2</p>
                </td>
            </tr>
            <tr class="ArgTable">
                <td class="ArgTable">
                    <p class="ArgDef">arg3</p>
                </td>
                <td class="ArgTable">
                    <p class="ArgDef">Atom 3</p>
                </td>
            </tr>
            <tr class="ArgTable">
                <td class="ArgTable">
                    <p class="ArgDef">arg5</p>
                </td>
                <td class="ArgTable">
                    <p class="ArgDef">Force constant (default = 100 kJ/mol·rad<sup>2</sup>)</p>
                </td>
            </tr>
            <tr class="ArgTable">
                <td class="ArgTable">
                    <p class="ArgDef">arg6</p>
                </td>
                <td class="ArgTable">
                    <p class="ArgDef">Desired nonzero angle (degrees)</p>
                </td>
            </tr>
            <tr class="ArgTable">
                <td class="ArgTable">
                    <p class="ArgValue">0</p>
                </td>
                <td class="ArgTable">
                    <p class="ArgPara">Use initial value.</p>
                </td>
            </tr>
            <tr class="ArgTable">
                <td class="ArgTable">
                    <p class="ArgValue">&gt; 0</p>
                </td>
                <td class="ArgTable">
                    <p class="ArgPara">Use this value.</p>
                </td>
            </tr>
            <tr class="ArgTable">
                <td class="ArgTable">
                    <p class="ArgDef">arg7</p>
                </td>
                <td class="ArgTable">
                    <p class="ArgDef">Half-width of flat bottom well (degrees).</p>
                </td>
            </tr>
        </table>
        <h2 class="Opcode"><a name="opcodes_509685220_739595"></a><code class="Courier"><a name="opcodes_509685220_fxta">FXTA</a></code> — FiX Torsion Angles </h2>
        <p>This command is used for restraining dihedral angles defined by the position of quartets of atoms. Such wells, particularly when the flat-bottomed option is used, are useful when minimizing crude structures in which some approximate torsional angle is known (e.g., from NMR coupling constants) but an exact value is not available. They are also useful in molecular dynamics to prevent major conformational changes without affecting the local conformational trajectory of the simulation. Using arg7=0.0, the same simple restraint in MacroModel to fix a torsion angle at arg6 is used.</p>
        <p>The constraint potential, <i>E</i><sub>c</sub>, for a fixed torsional angle is calculated using the equation</p>
        <p class="EquationNoNum">
            <img src="../GeneratedImages/Equations/Equation208.svg" alt="" class="_MCEquation_0 mcReset" />
        </p>
        <p>If two <code>FXTA</code> commands specify the same torsional angle, the second replaces the first, unless arg8 is nonzero.</p>
        <p>Note that for <span class="OpcodeLink"><a href="opcodes_embrace.htm#opcodes_509685220_mbae">MBAE</a></span> calculations, <code>FXTA</code> commands should be placed in a <code>.sbc</code> file.</p>
        <table class="ArgTable">
            <tr class="ArgTable">
                <td class="ArgTable">
                    <p class="ArgDef">arg1</p>
                </td>
                <td class="ArgTable">
                    <p class="ArgDef">Atom 1</p>
                </td>
            </tr>
            <tr class="ArgTable">
                <td class="ArgTable">
                    <p class="ArgValue">0</p>
                </td>
                <td class="ArgTable">
                    <p class="ArgPara">Clear all existing <code>FXTA</code> constraints</p>
                </td>
            </tr>
            <tr class="ArgTable">
                <td class="ArgTable">
                    <p class="ArgDef">arg2-4</p>
                </td>
                <td class="ArgTable">
                    <p class="ArgDef">Atoms 2-4</p>
                </td>
            </tr>
            <tr class="ArgTable">
                <td class="ArgTable">
                    <p class="ArgDef">arg5</p>
                </td>
                <td class="ArgTable">
                    <p class="ArgDef">Force constant k in kJ/mol (default: 1000)</p>
                </td>
            </tr>
            <tr class="ArgTable">
                <td class="ArgTable">
                    <p class="ArgDef">arg6</p>
                </td>
                <td class="ArgTable">
                    <p class="ArgDef">Desired torsion angle, in degrees</p>
                </td>
            </tr>
            <tr class="ArgTable">
                <td class="ArgTable">
                    <p class="ArgValue">&lt;360</p>
                </td>
                <td class="ArgTable">
                    <p class="ArgPara">Use this value.</p>
                </td>
            </tr>
            <tr class="ArgTable">
                <td class="ArgTable">
                    <p class="ArgValue">&gt;360</p>
                </td>
                <td class="ArgTable">
                    <p class="ArgPara">Use the initial value.</p>
                </td>
            </tr>
            <tr class="ArgTable">
                <td class="ArgTable">
                    <p class="ArgDef">arg7</p>
                </td>
                <td class="ArgTable">
                    <p class="ArgDef">Half-width of flat bottom in degrees</p>
                </td>
            </tr>
            <tr class="ArgTable">
                <td class="ArgTable">
                    <p class="ArgValue">0</p>
                </td>
                <td class="ArgTable">
                    <p class="ArgPara">A standard 1-fold cosine well will be used.</p>
                </td>
            </tr>
            <tr class="ArgTable">
                <td class="ArgTable">
                    <p class="ArgDef">arg8</p>
                </td>
                <td class="ArgTable">
                    <p class="ArgDef">Multiplicity</p>
                </td>
            </tr>
            <tr class="ArgTable">
                <td class="ArgTable">
                    <p class="ArgValue">&gt; 1</p>
                </td>
                <td class="ArgTable">
                    <p class="ArgPara">Allows specification of several allowed ranges for the same set of torsion angles, using a method described by Sefler et al. <a class="Reference_Number MCXref xref xrefReference_Number" href="mmod_references.htm#mmod_references_3670527510_741422" xrefformat="[{color #0E6895}{paranumonly}{/color}]">[<span style="color: #0e6895;" class="mcFormatColor">29</span>]</a>. If arg8 is two, for example, ranges around two dihedral angles can be specified in order to enforce constraints obtained from analysis of NMR coupling constants by means of the Karplus equation. In this example, two <code>FXTA</code> commands are expected for the same values of arg1-4. For each such <code>FXTA</code> command, you should specify a desired central position in arg6 and a flat-bottom half-width in arg7. When the last specification is read for a given atom set (for example, when the second <code>FXTA</code> interaction is read for an atom set with an arg8 value of two), MacroModel resets the central angles and half-widths for the set to values that achieve your original input specification. <span class="OpcodeLink"><a href="opcodes_misc_debug.htm#opcodes_509685220_debg">DEBG</a></span><code> 14</code> makes this visible.</p>
                </td>
            </tr>
        </table>
        <h2 class="Opcode"><a name="opcodes_509685220_739617"></a><code class="Courier"><a name="opcodes_509685220_fxco">FXCO</a></code> — FiX COnstraints</h2>
        <p>Generates a series of <span class="OpcodeLink"><a href="#opcodes_509685220_fxta">FXTA</a></span> torsional constraints with flat bottoms to hold the input structure in its starting conformation. This opcode must come after any <span class="OpcodeLink"><a href="#opcodes_509685220_subs">SUBS</a></span> opcodes that are present and after the <span class="OpcodeLink"><a href="opcodes_file.htm#opcodes_509685220_read">READ</a></span> opcode that reads the structure for which these constraints are to be generated.</p>
        <table class="ArgTable">
            <tr class="ArgTable">
                <td class="ArgTable">
                    <p class="ArgDef">arg1</p>
                </td>
                <td class="ArgTable">
                    <p class="ArgDef">Mode selection</p>
                </td>
            </tr>
            <tr class="ArgTable">
                <td class="ArgTable">
                    <p class="ArgValue">0</p>
                </td>
                <td class="ArgTable">
                    <p class="ArgPara"><span class="OpcodeLink"><a href="#opcodes_509685220_fxta">FXTA</a></span> for all torsions.</p>
                </td>
            </tr>
            <tr class="ArgTable">
                <td class="ArgTable">
                    <p class="ArgValue">1</p>
                </td>
                <td class="ArgTable">
                    <p class="ArgPara"><span class="OpcodeLink"><a href="#opcodes_509685220_fxta">FXTA</a></span> for all but double bonds.</p>
                </td>
            </tr>
            <tr class="ArgTable">
                <td class="ArgTable">
                    <p class="ArgValue">2</p>
                </td>
                <td class="ArgTable">
                    <p class="ArgPara"><span class="OpcodeLink"><a href="#opcodes_509685220_fxta">FXTA</a></span> for all but bonds between sp<sup>2</sup> atoms.</p>
                </td>
            </tr>
            <tr class="ArgTable">
                <td class="ArgTable">
                    <p class="ArgDef">arg2</p>
                </td>
                <td class="ArgTable">
                    <p class="ArgDef">Clear prior constraints</p>
                </td>
            </tr>
            <tr class="ArgTable">
                <td class="ArgTable">
                    <p class="ArgValue">0</p>
                </td>
                <td class="ArgTable">
                    <p class="ArgPara">No (default)</p>
                </td>
            </tr>
            <tr class="ArgTable">
                <td class="ArgTable">
                    <p class="ArgValue">1</p>
                </td>
                <td class="ArgTable">
                    <p class="ArgPara">Yes</p>
                </td>
            </tr>
            <tr class="ArgTable">
                <td class="ArgTable">
                    <p class="ArgDef">arg5</p>
                </td>
                <td class="ArgTable">
                    <p class="ArgDef">Force constant</p>
                </td>
            </tr>
            <tr class="ArgTable">
                <td class="ArgTable">&#160;</td>
                <td class="ArgTable">
                    <p class="ArgPara">Default: 1000.</p>
                </td>
            </tr>
            <tr class="ArgTable">
                <td class="ArgTable">
                    <p class="ArgDef">arg6</p>
                </td>
                <td class="ArgTable">
                    <p class="ArgDef">Angular half-width</p>
                </td>
            </tr>
            <tr class="ArgTable">
                <td class="ArgTable">&#160;</td>
                <td class="ArgTable">
                    <p class="ArgPara">Default: 60.</p>
                </td>
            </tr>
        </table>
        <h2 class="Opcode"><a name="opcodes_509685220_780661"></a><code class="Courier"><a name="opcodes_509685220_fxhb">FXHB</a></code> — FiX Hydrogen Bonds </h2>
        <p>Generates a series of distance (FXDI) and angle (FXBA) flat-bottomed constraints to constrain the geometry of hydrogen bonds.</p>
        <table class="ArgTable">
            <tr class="ArgTable">
                <td class="ArgTable">
                    <p class="ArgDef">arg1</p>
                </td>
                <td class="ArgTable">
                    <p class="ArgDef"> Donor Atom</p>
                </td>
            </tr>
            <tr class="ArgTable">
                <td class="ArgTable">
                    <p class="ArgValue">0</p>
                </td>
                <td class="ArgTable">
                    <p class="ArgPara">Constrain all hydrogen bonds. Possible hydrogen bonds are restricted to:</p>
                    <ul class="ArgListCompact">
                        <li class="ArgListCompact" value="1">
                            <p class="ArgListCompact">Hydrogen - Acceptor distance &lt; 2.5 A, </p>
                        </li>
                        <li class="ArgListCompact" value="2">
                            <p class="ArgListCompact">D-H-A angle &lt; 90 degrees,</p>
                        </li>
                        <li class="ArgListCompact" value="3">
                            <p class="ArgListCompact">H-A-R angle &lt; 60 degrees.</p>
                        </li>
                    </ul>
                </td>
            </tr>
            <tr class="ArgTable">
                <td class="ArgTable">
                    <p class="ArgValue">&gt; 0</p>
                </td>
                <td class="ArgTable">
                    <p class="ArgPara">Donor atom number. If arg1 &gt; 0, then:</p>
                    <table class="ArgTable">
                        <tr class="ArgTable">
                            <td class="ArgTable">
                                <p class="ArgDef">arg2 </p>
                            </td>
                            <td class="ArgTable">
                                <p class="ArgDef">Hydrogen atom</p>
                            </td>
                        </tr>
                        <tr class="ArgTable">
                            <td class="ArgTable">
                                <p class="ArgDef">arg3 </p>
                            </td>
                            <td class="ArgTable">
                                <p class="ArgDef">Acceptor atom</p>
                            </td>
                        </tr>
                    </table>
                </td>
            </tr>
            <tr class="ArgTable">
                <td class="ArgTable">
                    <p class="ArgDef">arg5</p>
                </td>
                <td class="ArgTable">
                    <p class="ArgDef">H–A distance constraint value </p>
                </td>
            </tr>
            <tr class="ArgTable">
                <td class="ArgTable">&#160;</td>
                <td class="ArgTable">
                    <p class="ArgPara">The half-width of the flat-bottomed constraint is set to 0.5&#160;Å</p>
                </td>
            </tr>
            <tr class="ArgTable">
                <td class="ArgTable">
                    <p class="ArgValue">0</p>
                </td>
                <td class="ArgTable">
                    <p class="ArgPara">use 1.85&#160;Å</p>
                </td>
            </tr>
            <tr class="ArgTable">
                <td class="ArgTable">
                    <p class="ArgValue">−1</p>
                </td>
                <td class="ArgTable">
                    <p class="ArgPara">use the current value</p>
                </td>
            </tr>
            <tr class="ArgTable">
                <td class="ArgTable">
                    <p class="ArgValue">&gt; 0</p>
                </td>
                <td class="ArgTable">
                    <p class="ArgPara">use this value</p>
                </td>
            </tr>
            <tr class="ArgTable">
                <td class="ArgTable">
                    <p class="ArgDef">arg6</p>
                </td>
                <td class="ArgTable">
                    <p class="ArgDef">D-H-A angle constraint value</p>
                </td>
            </tr>
            <tr class="ArgTable">
                <td class="ArgTable">&#160;</td>
                <td class="ArgTable">
                    <p class="ArgPara">The half-width of the flat-bottomed constraint is set to 30<span class="Symbol">°</span>.</p>
                </td>
            </tr>
            <tr class="ArgTable">
                <td class="ArgTable">
                    <p class="ArgValue">0</p>
                </td>
                <td class="ArgTable">
                    <p class="ArgPara">use 180<span class="Symbol">°</span></p>
                </td>
            </tr>
            <tr class="ArgTable">
                <td class="ArgTable">
                    <p class="ArgValue">−1</p>
                </td>
                <td class="ArgTable">
                    <p class="ArgPara">use the current value</p>
                </td>
            </tr>
            <tr class="ArgTable">
                <td class="ArgTable">
                    <p class="ArgValue">&gt; 0</p>
                </td>
                <td class="ArgTable">
                    <p class="ArgPara">use this value</p>
                </td>
            </tr>
        </table>
        <p class="Note" data-mc-autonum="&lt;b&gt;Note:&lt;/b&gt; "><span class="autonumber"><span><b>Note:</b> <![CDATA[ ]]></span></span>The H–A–R angle is not constrained.</p>
        <table class="NavLink" data-mc-conditions="Default.ScreenOnly">
            <tr class="NavLink">
                <td class="NavLeft"><span class="NavText">◀ <a class="NavLink MCXref xref xrefNavLink" href="opcodes_minimization.htm" xrefformat="{paratext}">Energy Minimization Opcodes</a></span>
                </td>
                <td class="NavCenter"><span class="NavText"><a class="NavLink MCXref xref xrefNavLink" href="macromodel_command_referenceTOC.htm" xrefformat="{paratext}">MacroModel Command Reference Manual</a></span>
                </td>
                <td class="NavRight"><span class="NavText"><a class="NavLink MCXref xref xrefNavLink" href="opcodes_conf_comparison.htm" xrefformat="{paratext}">Conformational Comparison Opcodes</a> ▶</span>
                </td>
            </tr>
        </table>
    </body>
</html>