<!DOCTYPE html>
<html xmlns:MadCap="http://www.madcapsoftware.com/Schemas/MadCap.xsd" lang="en-US" xml:lang="en-US" data-mc-search-type="Stem" data-mc-help-system-file-name="Documentation.xml" data-mc-path-to-help-system="../" data-mc-target-type="WebHelp2" data-mc-runtime-file-type="Topic" data-mc-preload-images="false" data-mc-in-preview-mode="false" data-mc-toc-path="Command References|MacroModel Command Reference|MacroModel Operation Codes|LigPrep Opcodes">
    <head>
        <meta name="viewport" content="width=device-width, initial-scale=1.0" />
        <meta charset="utf-8" />
        <meta http-equiv="X-UA-Compatible" content="IE=edge" />
        <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
        <link href="../Skins/Default/Stylesheets/Slideshow.css" rel="stylesheet" type="text/css" data-mc-generated="True" />
        <link href="../Skins/Default/Stylesheets/TextEffects.css" rel="stylesheet" type="text/css" data-mc-generated="True" />
        <link href="../Skins/Default/Stylesheets/Topic.css" rel="stylesheet" type="text/css" data-mc-generated="True" />
        <link href="../Skins/Default/Stylesheets/Components/Styles.css" rel="stylesheet" type="text/css" data-mc-generated="True" /><title>LigPrep Opcodes</title>
        <link href="../Resources/Stylesheets/docs.css" rel="stylesheet" />
        <script src="../Resources/Scripts/custom.modernizr.js" type="text/javascript">
        </script>
        <script src="../Resources/Scripts/jquery.min.js" type="text/javascript">
        </script>
        <script src="../Resources/Scripts/require.min.js" type="text/javascript">
        </script>
        <script src="../Resources/Scripts/require.config.js" type="text/javascript">
        </script>
        <script src="../Resources/Scripts/foundation.min.js" type="text/javascript">
        </script>
        <script src="../Resources/Scripts/plugins.min.js" type="text/javascript">
        </script>
        <script src="../Resources/Scripts/MadCapAll.js" type="text/javascript">
        </script>
    </head>
    <body><a name="aanchor2779"></a>
        <MadCap:concept term="Command Reference" /><a name="aanchor2780"></a>
        <MadCap:concept term="MacroModel" /><a name="opcodes_509685220_791056"></a><a name="opcodes_509685220_63802"></a>
        <table class="NavLink" data-mc-conditions="Default.ScreenOnly">
            <tr class="NavLink">
                <td class="NavLeft"><span class="NavText">◀ <a class="NavLink MCXref xref xrefNavLink" href="opcodes_confgen.htm" xrefformat="{paratext}">ConfGen Opcodes</a></span>
                </td>
                <td class="NavCenter"><span class="NavText"><a class="NavLink MCXref xref xrefNavLink" href="macromodel_command_referenceTOC.htm" xrefformat="{paratext}">MacroModel Command Reference Manual</a></span>
                </td>
                <td class="NavRight">
                &#160;
        </td>
            </tr>
        </table>
        <h1 class="Title">LigPrep Opcodes</h1>
        <p>The LigPrep opcodes require a LigPrep license to use. The opcodes in this section are linked below:</p>
        <p>
        </p>
        <h2 class="Opcode"><a name="opcodes_509685220_chip"><a name="opcodes_509685220_802122"></a>CHIP — CHIrality Protocol</a>
        </h2>
        <p><code>CHIP</code> instructs MacroModel to adjust its behavior appropriately for enforcing chiralities and avoiding common pitfalls encountered for structures that were originally 2D. <code>CHIP</code> is intended to be used within a <code>.com</code> file that would otherwise be a fairly typical MCMM serial search.</p>
        <p><code>CHIP</code> modifies the behavior of the <span class="CodeLink"><a href="opcodes_file.htm#opcodes_509685220_read">READ</a></span>, <span class="CodeLink"><a href="opcodes_csearch.htm#opcodes_509685220_mcmm">MCMM</a></span> and <span class="CodeLink"><a href="opcodes_minimization.htm#opcodes_509685220_mini">MINI</a></span> opcodes. When <code>CHIP</code> has been specified, structures read in with the <span class="CodeLink"><a href="opcodes_file.htm#opcodes_509685220_read">READ</a></span> opcode are examined for chiral atom properties. For each chiral atom specified up to 4 improper torsional potentials are added to encourage the atom to adopt the chirality requested. In addition, each atom in the structure is displaced by a small random displacement to encourage the system to leave saddle points during minimizations. Sometimes hydrogen atoms are placed in positions inconsistent with the chirality of atoms that they are bonded to. When this problem is detected the hydrogen is repositioned to facilitate minimization to the correct geometry.</p>
        <p>The behavior of the <span class="CodeLink"><a href="opcodes_csearch.htm#opcodes_509685220_mcmm">MCMM</a></span> opcode is tightly coupled with the <span class="CodeLink"><a href="opcodes_minimization.htm#opcodes_509685220_mini">MINI</a></span> opcode. In a serial search, when <code>CHIP</code> has been specified, the search proceeds as follows: </p>
        <table class="AutoNumber_p_Numbered1" style="width: 100%; margin-left: 0;" cellspacing="0" cellpadding="0">
            <col style="width: 0px;" />
            <col style="width: 32px;" />
            <col style="width: auto;" />
            <tr>
                <td valign="top" />
                <td class="AutoNumber_p_Numbered1" valign="top"><span>1.</span>
                </td>
                <td class="AutoNumber_p_Numbered1" valign="top" data-mc-autonum="1.">The structure is read using <span class="CodeLink"><a href="opcodes_file.htm#opcodes_509685220_read">READ</a></span>, whose behavior is modified as described above. </td>
            </tr>
        </table>
        <table class="AutoNumber_p_Numbered1_" style="width: 100%; margin-left: 0;" cellspacing="0" cellpadding="0">
            <col style="width: 0px;" />
            <col style="width: 32px;" />
            <col style="width: auto;" />
            <tr>
                <td valign="top" />
                <td class="AutoNumber_p_Numbered1" valign="top"><span>2.</span>
                </td>
                <td class="AutoNumber_p_Numbered1" valign="top" data-mc-autonum="2."><a name="opcodes_509685220_802129"></a>An initial minimization is performed on this structure with the additional improper torsional potentials in effect. </td>
            </tr>
        </table>
        <table class="AutoNumber_p_Numbered1_" style="width: 100%; margin-left: 0;" cellspacing="0" cellpadding="0">
            <col style="width: 0px;" />
            <col style="width: 32px;" />
            <col style="width: auto;" />
            <tr>
                <td valign="top" />
                <td class="AutoNumber_p_Numbered1" valign="top"><span>3.</span>
                </td>
                <td class="AutoNumber_p_Numbered1" valign="top" data-mc-autonum="3."><a name="opcodes_509685220_802131"></a>A second minimization is performed with the additional improper torsional potentials turned off. </td>
            </tr>
        </table>
        <table class="AutoNumber_p_Numbered1_" style="width: 100%; margin-left: 0;" cellspacing="0" cellpadding="0">
            <col style="width: 0px;" />
            <col style="width: 32px;" />
            <col style="width: auto;" />
            <tr>
                <td valign="top" />
                <td class="AutoNumber_p_Numbered1" valign="top"><span>4.</span>
                </td>
                <td class="AutoNumber_p_Numbered1" valign="top" data-mc-autonum="4.">If the bond lengths deviate from their ideal values by less than a specified value no search is performed and the next step (<a class="Step_Number MCXref xref xrefStep_Number" href="#opcodes_509685220_802676" xrefformat="Step {paranumonly} ">Step 5 </a>) is skipped. Significantly distorted bonds are a good indicator that a portion of the molecule is passing through the center of a small ring. </td>
            </tr>
        </table>
        <table class="AutoNumber_p_Numbered1_" style="width: 100%; margin-left: 0;" cellspacing="0" cellpadding="0">
            <col style="width: 0px;" />
            <col style="width: 32px;" />
            <col style="width: auto;" />
            <tr>
                <td valign="top" />
                <td class="AutoNumber_p_Numbered1" valign="top"><span>5.</span>
                </td>
                <td class="AutoNumber_p_Numbered1" valign="top" data-mc-autonum="5."><a name="opcodes_509685220_802676"></a>A short MCMM search is performed. Each structure generated is minimized using the same two-stage procedure described in <a class="Step_Number MCXref xref xrefStep_Number" href="#opcodes_509685220_802129" xrefformat="Step {paranumonly} ">Step 2 </a> and <a class="Step_Number MCXref xref xrefStep_Number" href="#opcodes_509685220_802131" xrefformat="Step {paranumonly} ">Step 3 </a>. </td>
            </tr>
        </table>
        <table class="AutoNumber_p_Numbered1_" style="width: 100%; margin-left: 0;" cellspacing="0" cellpadding="0">
            <col style="width: 0px;" />
            <col style="width: 32px;" />
            <col style="width: auto;" />
            <tr>
                <td valign="top" />
                <td class="AutoNumber_p_Numbered1" valign="top"><span>6.</span>
                </td>
                <td class="AutoNumber_p_Numbered1" valign="top" data-mc-autonum="6.">The structure is checked to see if it has adopted the requested chiralities. If so it is saved to the output structure file. If not, by default the structure is not recorded in the output structure file.</td>
            </tr>
        </table>
        <table class="ArgTable">
            <tr class="ArgTable">
                <td class="ArgTable">
                    <p class="ArgDef">arg1 </p>
                </td>
                <td class="ArgTable">
                    <p class="ArgDef">Chirality enforcement</p>
                </td>
            </tr>
            <tr class="ArgTable">
                <td class="ArgTable">
                    <p class="ArgValue">−1</p>
                </td>
                <td class="ArgTable">
                    <p class="ArgPara">Turn on the requirement for LigPrep licensing, but do not turn on chirality enforcement behavior. </p>
                </td>
            </tr>
            <tr class="ArgTable">
                <td class="ArgTable">
                    <p class="ArgValue">0 </p>
                </td>
                <td class="ArgTable">
                    <p class="ArgPara">Turn on the requirement for LigPrep licensing, and turn on chirality enforcement behavior.</p>
                </td>
            </tr>
            <tr class="ArgTable">
                <td class="ArgTable">
                    <p class="ArgDef">arg2 </p>
                </td>
                <td class="ArgTable">
                    <p class="ArgDef">Recording structures with incorrect chiralities</p>
                </td>
            </tr>
            <tr class="ArgTable">
                <td class="ArgTable">
                    <p class="ArgValue">−1</p>
                </td>
                <td class="ArgTable">
                    <p class="ArgPara">Write structures whose chiralities do not match those requested in the output structure file along with structures whose chiralities do match. These structures have the property <code>b_mmod_Chiralities_Consistent-</code><i class="UserReplace">Force_field_name</i> set to 0 (for FALSE). </p>
                </td>
            </tr>
            <tr class="ArgTable">
                <td class="ArgTable">
                    <p class="ArgValue">0,1 </p>
                </td>
                <td class="ArgTable">
                    <p class="ArgPara">Do not write structures whose chiralities do not match those requested in the output structure file.</p>
                </td>
            </tr>
            <tr class="ArgTable">
                <td class="ArgTable">
                    <p class="ArgDef">arg3 </p>
                </td>
                <td class="ArgTable">
                    <p class="ArgDef">Search control for strained structures </p>
                </td>
            </tr>
            <tr class="ArgTable">
                <td class="ArgTable">&#160;</td>
                <td class="ArgTable">
                    <p class="ArgPara">Strained structures are defined as those structures with bond lengths differing from the equilibrium bond length by more than the value specified by arg7. </p>
                </td>
            </tr>
            <tr class="ArgTable">
                <td class="ArgTable">
                    <p class="ArgValue">−1</p>
                </td>
                <td class="ArgTable">
                    <p class="ArgPara">Never perform searches on strained structures. </p>
                </td>
            </tr>
            <tr class="ArgTable">
                <td class="ArgTable">
                    <p class="ArgValue">0,1</p>
                </td>
                <td class="ArgTable">
                    <p class="ArgPara">Perform an MCMM search on strained structures.</p>
                </td>
            </tr>
            <tr class="ArgTable">
                <td class="ArgTable">
                    <p class="ArgDef">arg4 </p>
                </td>
                <td class="ArgTable">
                    <p class="ArgDef">Random displacement control </p>
                </td>
            </tr>
            <tr class="ArgTable">
                <td class="ArgTable">&#160;</td>
                <td class="ArgTable">
                    <p class="ArgPara">Displacing atoms by small random amounts is useful in shifting minimizations away from saddle points, a problem that often arises in structures that were originally 2D. The maximum displacement is controlled by arg6. </p>
                </td>
            </tr>
            <tr class="ArgTable">
                <td class="ArgTable">
                    <p class="ArgValue">−1</p>
                </td>
                <td class="ArgTable">
                    <p class="ArgPara">Do not randomly displace each atom after a new structure has been read in.</p>
                </td>
            </tr>
            <tr class="ArgTable">
                <td class="ArgTable">
                    <p class="ArgValue">0,1</p>
                </td>
                <td class="ArgTable">
                    <p class="ArgPara">Randomly displace each atom after a new structure has been read in.</p>
                </td>
            </tr>
            <tr class="ArgTable">
                <td class="ArgTable">
                    <p class="ArgDef">arg5 </p>
                </td>
                <td class="ArgTable">
                    <p class="ArgDef">Chirality enforcement force constant in kJ/mol </p>
                </td>
            </tr>
            <tr class="ArgTable">
                <td class="ArgTable">&#160;</td>
                <td class="ArgTable">
                    <p class="ArgPara">Must be non-negative. The size of the force constant for the improper torsions. Equivalent to arg5 of FXTA. Default value: 1000.0 kJ/mol</p>
                </td>
            </tr>
            <tr class="ArgTable">
                <td class="ArgTable">
                    <p class="ArgDef">arg6 </p>
                </td>
                <td class="ArgTable">
                    <p class="ArgDef">Maximum size of random displacement in Å</p>
                </td>
            </tr>
            <tr class="ArgTable">
                <td class="ArgTable">&#160;</td>
                <td class="ArgTable">
                    <p class="ArgPara">Must be non-negative. The maximum size of the random change in angstroms. introduced into each of the X,Y, and Z coordinates of each atom in the structure. The random change is chosen with a uniform probability on the range indicated. Default value: 0.05&#160;Å. </p>
                </td>
            </tr>
            <tr class="ArgTable">
                <td class="ArgTable">
                    <p class="ArgDef">arg7 </p>
                </td>
                <td class="ArgTable">
                    <p class="ArgDef">Extent of bond distortion in Å that triggers a search </p>
                </td>
            </tr>
            <tr class="ArgTable">
                <td class="ArgTable">&#160;</td>
                <td class="ArgTable">
                    <p class="ArgPara">Must be 0 or greater than 0.05. If any bond is distorted away from the equilibrium bond length by more than this amount after the initial minimization then a full conformational search is to be performed provided that arg3 is not <span class="Symbol">&#8209;</span>1. Default value: 0.25&#160;Å.</p>
                </td>
            </tr>
            <tr class="ArgTable">
                <td class="ArgTable">
                    <p class="ArgDef">arg8 </p>
                </td>
                <td class="ArgTable">
                    <p class="ArgDef">CHIP verbosity </p>
                </td>
            </tr>
            <tr class="ArgTable">
                <td class="ArgTable">
                    <p class="ArgValue">0</p>
                </td>
                <td class="ArgTable">
                    <p class="ArgPara">Normal level of reporting to the <code>.log</code> file. </p>
                </td>
            </tr>
            <tr class="ArgTable">
                <td class="ArgTable">
                    <p class="ArgValue">1</p>
                </td>
                <td class="ArgTable">
                    <p class="ArgPara">Turn on verbose reporting of <code>CHIP</code> processing to the <code>.log</code> file. </p>
                </td>
            </tr>
        </table>
        <h2 class="Opcode"><a name="opcodes_509685220_chop"><a name="opcodes_509685220_802172"></a>CHOP — CHirality OPtions</a>
        </h2>
        <p>The <code>CHOP</code> opcode allows you to change some of the behavior associated with the <code>CHIP</code> opcode in MacroModel calculations.</p>
        <table class="ArgTable">
            <tr class="ArgTable">
                <td class="ArgTable">
                    <p class="ArgDef">arg1</p>
                </td>
                <td class="ArgTable">
                    <p class="ArgDef">Saving problematic structures</p>
                </td>
            </tr>
            <tr class="ArgTable">
                <td class="ArgTable">&#160;</td>
                <td class="ArgTable">
                    <p class="ArgPara">Structures that do not have the correct chiralities or are severely distorted are not placed in the output structure file for the <code>bmin</code> stage of <code>ligprep</code>. This option controls wether these such structures are saved to an auxiliary output file, <i class="UserReplace">jobname</i><code>_bmout-bad.mae</code>.</p>
                </td>
            </tr>
            <tr class="ArgTable">
                <td class="ArgTable">
                    <p class="ArgValue">0 </p>
                </td>
                <td class="ArgTable">
                    <p class="ArgPara">Do not save problematic structures</p>
                </td>
            </tr>
            <tr class="ArgTable">
                <td class="ArgTable">
                    <p class="ArgValue">!= 0 </p>
                </td>
                <td class="ArgTable">
                    <p class="ArgPara">Save problematic structures</p>
                </td>
            </tr>
            <tr class="ArgTable">
                <td class="ArgTable">
                    <p class="ArgDef">arg2</p>
                </td>
                <td class="ArgTable">
                    <p class="ArgDef">Scaling factor for conformational search steps if ring_conf could not find a template</p>
                </td>
            </tr>
            <tr class="ArgTable">
                <td class="ArgTable">&#160;</td>
                <td class="ArgTable">
                    <p class="ArgPara">Scale the number of steps in the conformational search if a template could not be found by <code>ring_conf</code>. The number of steps is set by arg1 of <span class="CodeLink"><a href="opcodes_csearch.htm#opcodes_509685220_mcmm">MCMM</a></span>. </p>
                </td>
            </tr>
            <tr class="ArgTable">
                <td class="ArgTable">
                    <p class="ArgValue">&gt; 0</p>
                </td>
                <td class="ArgTable">
                    <p class="ArgPara">Scale the number of conformational search steps by this value. The default scaling factor is 2.</p>
                </td>
            </tr>
            <tr class="ArgTable">
                <td class="ArgTable">
                    <p class="ArgDef">arg5</p>
                </td>
                <td class="ArgTable">
                    <p class="ArgDef">Force constant for the torsional constraints that are used to enforce chiralities</p>
                </td>
            </tr>
            <tr class="ArgTable">
                <td class="ArgTable">
                    <p class="ArgValue">&lt; 0</p>
                </td>
                <td class="ArgTable">
                    <p class="ArgPara">Do not use torsional constraints</p>
                </td>
            </tr>
            <tr class="ArgTable">
                <td class="ArgTable">
                    <p class="ArgValue">0</p>
                </td>
                <td class="ArgTable">
                    <p class="ArgPara">Use the default value of 500.0 kJ/mol</p>
                </td>
            </tr>
            <tr class="ArgTable">
                <td class="ArgTable">
                    <p class="ArgValue">&gt; 0</p>
                </td>
                <td class="ArgTable">
                    <p class="ArgPara">Use this value (kJ/mol) for the force constant.</p>
                </td>
            </tr>
            <tr class="ArgTable">
                <td class="ArgTable">
                    <p class="ArgDef">arg6</p>
                </td>
                <td class="ArgTable">
                    <p class="ArgDef">Maximum average stretch energy for acceptable molecules</p>
                </td>
            </tr>
            <tr class="ArgTable">
                <td class="ArgTable">&#160;</td>
                <td class="ArgTable">
                    <p class="ArgPara">Conformations of molecules containing more than 9 bonds with stretch energies greater than this value are eliminated from consideration.</p>
                </td>
            </tr>
            <tr class="ArgTable">
                <td class="ArgTable">
                    <p class="ArgValue">0</p>
                </td>
                <td class="ArgTable">
                    <p class="ArgPara">use a value of 9 kJ/mol</p>
                </td>
            </tr>
            <tr class="ArgTable">
                <td class="ArgTable">
                    <p class="ArgValue">&lt; 0</p>
                </td>
                <td class="ArgTable">
                    <p class="ArgPara">turn off elimination of molecules by average stretch energy</p>
                </td>
            </tr>
            <tr class="ArgTable">
                <td class="ArgTable">
                    <p class="ArgValue">&gt; 0</p>
                </td>
                <td class="ArgTable">
                    <p class="ArgPara">use this value (in units of kJ/mol)</p>
                </td>
            </tr>
            <tr class="ArgTable">
                <td class="ArgTable">
                    <p class="ArgDef">arg7</p>
                </td>
                <td class="ArgTable">
                    <p class="ArgDef">Maximum deviation of a bond angle involving hydrogen</p>
                </td>
            </tr>
            <tr class="ArgTable">
                <td class="ArgTable">&#160;</td>
                <td class="ArgTable">
                    <p class="ArgPara">Conformations in which a bond angle involving at least one hydrogen atom deviates from the ideal bond angle given by the force field by more than this value are eliminated.</p>
                </td>
            </tr>
            <tr class="ArgTable">
                <td class="ArgTable">
                    <p class="ArgValue">0</p>
                </td>
                <td class="ArgTable">
                    <p class="ArgPara">use a value of 25 degrees</p>
                </td>
            </tr>
            <tr class="ArgTable">
                <td class="ArgTable">
                    <p class="ArgValue">&lt; 0</p>
                </td>
                <td class="ArgTable">
                    <p class="ArgPara">turn off elimination of conformations by this mechanism</p>
                </td>
            </tr>
            <tr class="ArgTable">
                <td class="ArgTable">
                    <p class="ArgValue">&gt; 0</p>
                </td>
                <td class="ArgTable">
                    <p class="ArgPara">use this value (in units of degrees)</p>
                </td>
            </tr>
        </table>
        <p>&#160;</p>
        <table class="NavLink" data-mc-conditions="Default.ScreenOnly">
            <tr class="NavLink">
                <td class="NavLeft"><span class="NavText">◀ <a class="NavLink MCXref xref xrefNavLink" href="opcodes_confgen.htm" xrefformat="{paratext}">ConfGen Opcodes</a></span>
                </td>
                <td class="NavCenter"><span class="NavText"><a class="NavLink MCXref xref xrefNavLink" href="macromodel_command_referenceTOC.htm" xrefformat="{paratext}">MacroModel Command Reference Manual</a></span>
                </td>
                <td class="NavRight">
                &#160;
        </td>
            </tr>
        </table>
    </body>
</html>