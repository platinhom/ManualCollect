<!DOCTYPE html>
<html xmlns:MadCap="http://www.madcapsoftware.com/Schemas/MadCap.xsd" lang="en-US" xml:lang="en-US" data-mc-search-type="Stem" data-mc-help-system-file-name="Documentation.xml" data-mc-path-to-help-system="../" data-mc-target-type="WebHelp2" data-mc-runtime-file-type="Topic" data-mc-preload-images="false" data-mc-in-preview-mode="false" data-mc-toc-path="Help|FEP+ Help">
    <head>
        <meta name="viewport" content="width=device-width, initial-scale=1.0" />
        <meta charset="utf-8" />
        <meta http-equiv="X-UA-Compatible" content="IE=edge" />
        <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
        <link href="../Skins/Default/Stylesheets/Slideshow.css" rel="stylesheet" type="text/css" data-mc-generated="True" />
        <link href="../Skins/Default/Stylesheets/TextEffects.css" rel="stylesheet" type="text/css" data-mc-generated="True" />
        <link href="../Skins/Default/Stylesheets/Topic.css" rel="stylesheet" type="text/css" data-mc-generated="True" />
        <link href="../Skins/Default/Stylesheets/Components/Styles.css" rel="stylesheet" type="text/css" data-mc-generated="True" />
        <link href="../Resources/Stylesheets/docs.css" rel="stylesheet" type="text/css" /><title>FEP Mapper Panel</title>
        <script src="../Resources/Scripts/custom.modernizr.js" type="text/javascript">
        </script>
        <script src="../Resources/Scripts/jquery.min.js" type="text/javascript">
        </script>
        <script src="../Resources/Scripts/require.min.js" type="text/javascript">
        </script>
        <script src="../Resources/Scripts/require.config.js" type="text/javascript">
        </script>
        <script src="../Resources/Scripts/foundation.min.js" type="text/javascript">
        </script>
        <script src="../Resources/Scripts/plugins.min.js" type="text/javascript">
        </script>
        <script src="../Resources/Scripts/MadCapAll.js" type="text/javascript">
        </script>
    </head>
    <body><a name="aanchor3805"></a>
        <MadCap:concept term="Help Topics" /><a name="aanchor3806"></a>
        <MadCap:concept term="FEP+" />
        <table class="navlink">
            <tr>
                <td class="navlink"><a class="navbutton" href="#using">Using</a>
                </td>
                <td class="navlink"><a class="navbutton" href="#features">Features</a>
                </td>
                <td class="navlink"><a class="navbutton" href="#links">Links</a>
                </td>
            </tr>
        </table>
        <h1 class="title">FEP Mapper Panel</h1><a name="summary"></a>
        <p>Build a perturbation scheme for FEP calculations on a set of congeneric ligands, and run the job to perform the calculations of the relative binding free energy.</p>
        <p class="opening">To open this panel, choose <span class="GUI">Tasks → Free Energy Perturbation → FEP Mapper</span> in the Task Tool.</p>
        <h2><a name="using"></a>Using the FEP Mapper Panel</h2>
        <p data-mc-conditions="Global.toolbuttons and">For a tutorial exercise in using this panel, see <a href="fep_mapper_tutorial.html">FEP Mapper Tutorial</a>. </p>
        <p data-mc-conditions="Global.toolbuttons and">For more information on the scientific considerations and related procedures, see <a href="../fep_user_manual/fep_map_considerations.htm" class="MCXref xref" xrefformat="{paratext}">Considerations for Generating FEP Maps</a> and <a href="../fep_user_manual/fep_mapper_running.htm" class="MCXref xref" xrefformat="{paratext}">Setting Up and Running an FEP Mapper Job</a>.</p>
        <p><b>To import ligands and a receptor</b>, do one of the following:</p>
        <ul>
            <li value="1">
                <p>Select the receptor and the desired ligands in the Project Table, then click <span class="GUI">Project Table</span> for <span class="GUI">Import from</span> in the <span class="GUI">FEP Mapper</span> panel.</p>
            </li>
            <li value="2">
                <p>Click <span class="GUI">File</span> for <span class="GUI">Import from</span> and select a Maestro file that contains the receptor and the ligands (such as a pose viewer file, <code>_pv.maegz</code>).</p>
            </li>
        </ul>
        <p><b>To set up a new perturbation scheme:</b>
        </p>
        <ol>
            <li value="1">
                <p>Open the <span class="GUI">FEP Mapper</span> panel.</p>
            </li>
            <li value="2">
                <p>Import the receptor and the desired ligands as described above.</p>
                <p>The title of the receptor entry is displayed below the <span class="GUI">Import from</span> buttons. The ligands are added to the table, and represented in the graph area, without connections.</p>
            </li>
            <li value="3">
                <p>Check the box in the <span class="GUI">Bias</span> column for any ligand you want to emphasize when the graph is built.</p>
                <p>The bias boosts the similarity between ligands, which is used to determine whether to connect two ligands.</p>
            </li>
            <li value="4">
                <p>(Optional) Enter the binding affinity for any ligand you want to emphasize when the graph is built.</p>
                <p>The similarity is boosted by a fixed amount for any ligand whose binding affinity is specified.  The affinity is also used in the analysis of the FEP results in the <a href="fep_mapper_analysis.html"><span class="GUI">FEP Mapper Analysis</span> panel</a>.</p>
                <p>You can use a Maestro property for the binding affinity by right-clicking the heading of the <span class="GUI">Affinity</span> column and choosing<span class="GUI"> Import from structure property</span>, then choosing the property in the dialog box that opens. The units that the affinity is given in can also be selected in this dialog box; the affinity is then converted to kcal/mol. You can also set the affinity for any ligand by editing the table cell.</p>
            </li>
            <li value="5">
                <p>Click <span class="GUI">Create Graph</span>.</p>
                <p>A dialog box is displayed, indicating that the construction of the perturbation scheme is in progress. When this task finishes, the perturbation scheme is displayed in the panel.</p>
            </li>
        </ol>
        <p>The diagram consists of 2D ligand structures in boxes, connected by lines. The lines represent allowed perturbations, and are shaded by the similarity of the ligands they connect: darker is more similar. You can select ligands and connections by clicking on them, or dragging over them. You can add or remove ligands or connections from the selection with control-click. The selected objects are highlighted in yellow.</p>
        <p><b>To rearrange the layout:</b>
        </p>
        <ul>
            <li value="1">Drag a ligand box to reposition it.</li>
            <li value="2">Drag over several ligand boxes, then drag them to reposition the group.</li>
            <li value="3">Drag with the right mouse button to move the entire diagram.</li>
            <li value="4">Use the mouse wheel to zoom in or out.</li>
        </ul>
        <p><b>To highlight particular perturbations:</b>
        </p>
        <ul>
            <li value="1">Pause the pointer over a ligand. The ligands to which it is not directly connected, with their connections, are dimmed.</li>
        </ul>
        <p><b>To delete ligands or connections from the diagram:</b>
        </p>
        <ol>
            <li value="1">Select the ligands and connections.</li>
            <li value="2">
                <p>Click the <span class="GUI">Delete</span> button.</p> <img src="../Resources/Images/desmond/delete.png" /></li>
        </ol>
        <p><b>To add ligands or connections to the diagram:</b>
        </p>
        <ol>
            <li value="1">
                <p>Click the <span class="GUI">Add</span> button.</p> <img src="../Resources/Images/desmond/new_connection.png" /></li>
            <li value="2">Select the ligands and connections.</li>
        </ol>
        <p><b>To submit a job</b> for the relative binding free energy using the perturbation scheme, you can use the Job toolbar. If you have not entered affinity data for the ligands, a warning is displayed. If you do not want to see the warning in future, you can select an option to suppress it in the warning dialog box.</p>
        <p>To submit a job from the command line, use the <code>fep_plus</code> command. Use the <code>-h</code> option to get help on using the command.</p>
        <p><b>To restart a job</b> use the following command:</p>
        <p><code>fep_plus -RESTART <i>checkpoint-file</i> -HOST <i>master-host</i> -SUBHOST <i>subjob-host</i> -JOBNAME <i>jobname</i></code>
        </p>
        <p>The restarted job runs the previously failed connections. No data is kept from the failed connections, which are rerun from the beginning.</p>
        <h2><a name="features"></a>FEP Mapper Panel Features</h2>
        <ul>
            <li value="1"><a href="#feature0"><span class="GUI">Import from</span> buttons</a>
            </li>
            <li value="2"><a href="#ligands">Ligands table</a>
            </li>
            <li value="3"><a href="#feature2"><span class="GUI">Generate Map</span> button</a>
            </li>
            <li value="4"><a href="#feature3">Toolbar</a>
            </li>
            <li value="5"><a href="#feature4">Perturbation scheme diagram</a>
            </li>
            <li value="6"><a href="#job_toolbar">Job toolbar</a>
            </li>
            <li value="7"><a href="#status_bar">Status bar</a>
            </li>
        </ul>
        <dl>
            <dt><a name="feature0"></a><span class="GUI">Import from</span> buttons</dt>
            <dd>
                <p>Use these buttons to import the receptor and ligands or to import an existing perturbation scheme, which contains the receptor and ligands. The receptor and ligands must be imported together; you cannot do multiple imports to add a receptor or ligands.</p>
                <ul>
                    <li value="1">
                        <p><span class="GUI">Project Table</span>—Import the receptor and ligands from the selected entries in the Project Table.</p>
                    </li>
                    <li value="2">
                        <p><span class="GUI">File</span>—Import the receptor and the ligands from a Maestro file, or import a perturbation scheme, which includes the receptor, ligands, and graph data, from a file. Opens a file selector in which you can choose the file type, navigate to and open the file. Perturbation scheme files have the extension <code>.fmp</code>, <code>.pkl</code>, or <code>_fep.map</code>.</p>
                    </li>
                </ul>
                <p>When the structures are imported, the ligands are listed in the table below. The title of the receptor entry is displayed below the buttons. If a perturbation scheme is imported, it is displayed. Any ligands from the previous scheme that are displayed in the Workspace are removed from the Workspace, but any other structures that are in the Workspace remain in the Workspace.</p>
            </dd>
            <dt><a name="ligands"></a>Ligands table</dt>
            <dd>
                <p>This table lists the ligands that you imported from the Project Table. The table columns are described below.</p>
                <ul>
                    <li value="1"><span class="GUI">Title</span>—Title of the ligand, from the Project Table.</li>
                    <li value="2"><span class="GUI">Status</span>—Provides information on the suitability of the ligand for FEP calculations. <span class="GUI">OK</span> indicates that the ligand passes all the tests; <span class="GUI">X</span> indicates that the ligand failed some tests. The tests that it failed are listed in the tooltip.</li>
                    <li value="3"><span class="GUI">Bias</span>—Column of check boxes that can be use to bias the graph construction to draw more connections to the ligand. The biasing is done by boosting the calculated similarity to other ligands. If you change the bias settings, you must click <span class="GUI">Generate Map</span> to generate a graph with the new settings.</li>
                    <li value="4"><span class="GUI">Affinity</span>—Binding affinity of the ligand. Any ligand whose binding affinity you enter is favored in the construction of the graph, by adding a further bias to the similarity.  The affinity is also used in the analysis of the FEP results in the <a href="fep_mapper_analysis.html"><span class="GUI">FEP Mapper Analysis</span> panel</a>. You can choose a Maestro property for the affinity by right-clicking in the column heading and choosing <span class="GUI">Import from structure property</span>, then choosing a property in the dialog box that opens. The units that the affinity is given in can also be selected in this dialog box; the affinity is then converted to kcal/mol. You can also edit individual cells to set or change the affinity.</li>
                </ul>
            </dd>
            <dt><a name="feature2"></a><span class="GUI">Generate Map</span> button</dt>
            <dd>
                <p>Create the perturbation scheme from the ligands in the table. The ligand structures are analyzed to find possible perturbations between them. This may take a few minutes, depending on the number of ligands. A progress dialog box is displayed while the analysis is running. When the analysis finishes, the diagram showing the possible perturbations is displayed.</p>
                <p>The graph is constructed by determining the maximum common substructure between the ligands (using Canvas MCS with special atom types for FEP), and calculating the similarity. Connections are made between structures with high similarity. The similarity between one ligand and the rest can be boosted by setting the affinity or selecting the <span class="GUI">Bias</span> option for that ligand in the ligands table.</p>
                <p>Once you generate a graph, the button text changes to <span class="GUI">Map Generated</span> and the button is deactivated. When you edit the graph or make changes in the ligands table, the button text changes back to <span class="GUI">Generate Map</span> and the button is reactivated. You can then click the button to create a new graph, for example with a different bias.</p>
                <p>The similarity score is based on several ingredients:</p>
                <ul>
                    <li value="1">A minimum number of heavy atoms in the maximum common substructure: if there are too few, the similarity score is set to zero.</li>
                    <li value="2">Difference in heavy-atom counts in the mutated part of the structures: a larger difference gives a smaller score</li>
                    <li value="3">If the net charge changes, the similarity score is set to zero</li>
                    <li value="4">RMSD of the core: a larger RMSD gives a smaller score.</li>
                    <li value="5">Bias towards a molecule (user's input)</li>
                    <li value="6">Flipped rings cause a low similarity</li>
                </ul>
            </dd>
            <dt><a name="feature3"></a>Toolbar</dt>
            <dd>
                <p>The toolbar has the following buttons:</p>
                <table>
                    <tr>
                        <td>
                            <img src="../Resources/Images/desmond/undo_grayscale.png" />
                        </td>
                        <td><span class="GUI">Undo</span>
                            <br />Undo changes to the perturbation scheme. You can undo multiple changes.
</td>
                    </tr>
                    <tr>
                        <td>
                            <img src="../Resources/Images/desmond/redo_grayscale.png" />
                        </td>
                        <td><span class="GUI">Redo</span>
                            <br />Redo changes to the perturbation scheme. You can redo multiple undone changes.
</td>
                    </tr>
                    <tr>
                        <td>
                            <img src="../Resources/Images/desmond/network_grayscale.png" height="25" width="25" />
                        </td>
                        <td><span class="GUI">Auto-layout</span>
                            <br />Automatically optimize the layout of the graph in the panel.
</td>
                    </tr>
                    <tr>
                        <td>
                            <img src="../Resources/Images/desmond/plus_grayscale.png" />
                        </td>
                        <td><span class="GUI">Add new connection</span>
                            <br />Add a connection between two ligands in the perturbation diagram. Click this
button, then click the ligands to add the connection.
</td>
                    </tr>
                    <tr>
                        <td>
                            <img src="../Resources/Images/desmond/minus_grayscale.png" />
                        </td>
                        <td><span class="GUI">Delete</span>
                            <br />Delete the selected ligands and connections from the perturbation scheme. 
</td>
                    </tr>
                </table>
            </dd>
            <dt><a name="feature4"></a>Perturbation scheme diagram</dt>
            <dd>
                <p>The diagram consists of 2D ligand structures in boxes, connected by lines. The lines represent allowed perturbations. You can select ligands and connections by clicking on them, or dragging over them. You can add ligands or connections to the selection, or remove them from the selection, with control-click. The selected objects are highlighted in yellow. Selected ligands are included in the Workspace.</p>
                <p>You can show similarity scores for the connected ligands next to the connections by selecting <span class="GUI">Show similarity scores</span>. The scores are updated as changes are made to the map. The shade of gray used for the connections is related to the similarity score for the connected structures: darker lines mean more similar structures.</p>
            </dd>
            <dt><a name="job_toolbar"></a>Job toolbar</dt>
            <dd>
                <p>Manage job submission. See <a href="../maestro_help/job_toolbar.html">Job Toolbar</a> for a description of this toolbar.</p>
            </dd>
            <dt><a name="status_bar"></a>Status bar</dt>
            <dd>
                <p>The status bar displays information about the current job settings for the panel. This includes the job name, task name and task settings (if any), number of subjobs (if any) and the host name and job incorporation setting. It also displays a message for a short time when you start a new job.</p>
                <p>The status bar also contains the <span class="GUI">Help</span> button, which opens the help topic for the panel.</p>
                <p>
                    <img src="../Resources/Images/Toolbuttons/help.png" />
                </p>
            </dd>
        </dl>
        <h2><a name="links"></a>Related Topics</h2>
        <ul>
            <li value="1"><a href="fep_mapper_analysis.html" class="MCXref xref" xrefformat="{paratext}">FEP Mapper Analysis Panel</a>
            </li>
            <li value="2"><a href="fep_mapper_tutorial.html" class="MCXref xref" xrefformat="{paratext}">FEP Mapper Tutorial</a>
            </li>
        </ul>
    </body>
</html>