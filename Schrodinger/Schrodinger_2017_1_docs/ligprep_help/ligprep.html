<!DOCTYPE html>
<html xmlns:MadCap="http://www.madcapsoftware.com/Schemas/MadCap.xsd" lang="en-US" xml:lang="en-US" data-mc-search-type="Stem" data-mc-help-system-file-name="Documentation.xml" data-mc-path-to-help-system="../" data-mc-target-type="WebHelp2" data-mc-runtime-file-type="Topic" data-mc-preload-images="false" data-mc-in-preview-mode="false" data-mc-toc-path="Help|Ligprep Help">
    <head>
        <meta name="viewport" content="width=device-width, initial-scale=1.0" />
        <meta charset="utf-8" />
        <meta http-equiv="X-UA-Compatible" content="IE=edge" />
        <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
        <link href="../Skins/Default/Stylesheets/Slideshow.css" rel="stylesheet" type="text/css" data-mc-generated="True" />
        <link href="../Skins/Default/Stylesheets/TextEffects.css" rel="stylesheet" type="text/css" data-mc-generated="True" />
        <link href="../Skins/Default/Stylesheets/Topic.css" rel="stylesheet" type="text/css" data-mc-generated="True" />
        <link href="../Skins/Default/Stylesheets/Components/Styles.css" rel="stylesheet" type="text/css" data-mc-generated="True" />
        <link href="../Resources/Stylesheets/docs.css" rel="stylesheet" type="text/css" /><title>LigPrep Panel</title>
        <script src="../Resources/Scripts/custom.modernizr.js" type="text/javascript">
        </script>
        <script src="../Resources/Scripts/jquery.min.js" type="text/javascript">
        </script>
        <script src="../Resources/Scripts/require.min.js" type="text/javascript">
        </script>
        <script src="../Resources/Scripts/require.config.js" type="text/javascript">
        </script>
        <script src="../Resources/Scripts/foundation.min.js" type="text/javascript">
        </script>
        <script src="../Resources/Scripts/plugins.min.js" type="text/javascript">
        </script>
        <script src="../Resources/Scripts/MadCapAll.js" type="text/javascript">
        </script>
    </head>
    <body><a name="aanchor3843"></a>
        <MadCap:concept term="Help Topics" /><a name="aanchor3844"></a>
        <MadCap:concept term="LigPrep" />
        <table class="navlink">
            <tr>
                <td class="navlink"><a class="navbutton" href="#using">Using</a>
                </td>
                <td class="navlink"><a class="navbutton" href="#features">Features</a>
                </td>
                <td class="navlink"><a class="navbutton" href="#links">Links</a>
                </td>
            </tr>
        </table>
        <h1 class="title">LigPrep Panel</h1><a name="summary"></a>
        <p>The <span class="GUI">LigPrep</span> panel is used to to set up and start ligand preparation calculations. The main objective of LigPrep is to take 2D or 3D structures and produce the corresponding low-energy 3D structures for use by programs such as Glide and QikProp. The input and output can be in SD or Maestro format. LigPrep can produce multiple output structures for each input structure by generating different protonation states, stereochemistry, tautomers, and ring conformations.</p>
        <p class="opening">To open this panel, choose <span class="GUI">Tasks → Ligand Preparation and Library Design → LigPrep</span> in the Task Tool.</p>
        <h2><a name="using"></a>Using the LigPrep Panel</h2>
        <p>To run a LigPrep job, choose a structure source, make settings in the panel, then click <span class="GUI">Run</span> to run the job with the current job settings. If you want to change the job settings, click the <span class="GUI">Settings</span> button arrow and choose <span class="GUI">Job Settings</span>. In the <span class="GUI">Job Settings</span> dialog box, you can choose a job name and one or more hosts to run the job on, and click <span class="GUI">Run</span> to run the job. If you choose to run on multiple hosts, you can select the hosts from the <span class="GUI">Hosts</span> table, and set the number of subjobs in the <span class="GUI">Separate job into <i>N</i> subjobs</span> text box. By default the number of subjobs is set to the number of processors used.</p>
        <p>If you obtain the structures from a file, the file can be in Maestro, SD, or SMILES format. The SMILES file can be in one of two formats:</p>
        <ul>
            <li value="1"><code>.smi</code> file—Text file with one SMILES string and an optional title per line</li>
            <li value="2"><code>.csv</code> file—Comma-separated file with SMILES string as the first field, title as the second, followed by optional properties.</li>
        </ul>
        <p>If you want to run the job later from the command line, you can write an input file by clicking  the <span class="GUI">Settings</span> button arrow and choosing <span class="GUI">Write</span>. This file can then be used with the <span class="GUI">ligprep</span> command to run the job. You can also read settings from an input file by  clicking  the <span class="GUI">Settings</span> button arrow and choosing <span class="GUI">Read</span>, then choosing the input file in the file selector that opens. The settings from the file are applied to the panel. </p>
        <p>The number of structures produced can vary a great deal, depending on the ligands being processed. The factors affecting the number of structures produced are described below:</p>
        <ul>
            <li value="1">
                <p>In the <span class="GUI">Stereoisomers</span> section, only <span class="GUI">Generate all combinations</span> should result in many more structures. For individual ligands the increase can be as large as 2<sup><i>n</i></sup>, where <i>n</i> is the number of chiral centers. For large data sets the increase is typically around 1.5, but is very dependent on the classes of molecules being processed. You can reduce the number of structures produced by entering a smaller value in <span class="GUI">Generate stereoisomers (maximum)</span>, however this does increase the risk of missing important stereoisomers.</p>
            </li>
            <li value="2">
                <p>In the <span class="GUI">Ionization</span> section, only <span class="GUI">Generate possible states at target pH</span> should increase the number of structures. The increase is typically a factor of approximately 1.4 for a pH range of 2.0. Reducing the pH range significantly reduces this factor.</p>
            </li>
            <li value="3">
                <p>The <span class="GUI">Generate tautomers</span> option typically increases the number of structures by less than 20%.</p>
            </li>
        </ul>
        <p>The structures that are produced can be filtered on the basis of various predefined descriptors. These descriptors are counts of various kinds of structural components, including a range of functional groups. You can filter the structures generated by LigPrep using a file that defines conditions on these descriptors. The descriptors are:</p>
        <table cellpadding="1">
            <tr>
                <td>Num rings</td>
                <td>&#160;</td>
                <td>Num heteroaromatic rings</td>
            </tr>
            <tr>
                <td>Num aromatic rings</td>
                <td>&#160;</td>
                <td>Num aliphatic rings</td>
            </tr>
            <tr>
                <td>Num rotatable bonds</td>
                <td>&#160;</td>
                <td>Num atoms</td>
            </tr>
            <tr>
                <td>Molecular weight</td>
                <td>&#160;</td>
                <td>Num chiral centers</td>
            </tr>
            <tr>
                <td>Num neutral amines</td>
                <td>&#160;</td>
                <td>Num amide hydrogens</td>
            </tr>
            <tr>
                <td>Num divalent oxygen atoms</td>
                <td>&#160;</td>
                <td>Num neutral donor groups</td>
            </tr>
            <tr>
                <td>Num charged donor groups</td>
                <td>&#160;</td>
                <td>Num neutral acceptor groups</td>
            </tr>
            <tr>
                <td>Num charged acceptor groups</td>
                <td>&#160;</td>
                <td>Num reactive groups</td>
            </tr>
            <tr>
                <td>Num acidic hydrogens</td>
                <td>&#160;</td>
                <td>Num donor groups</td>
            </tr>
            <tr>
                <td>Num acceptor groups</td>
                <td>&#160;</td>
                <td>&#160;</td>
            </tr>
        </table>
        <p>This file can be created by clicking <span class="GUI">Create</span>, and constructing the list of criteria in the <a href="../maestro_tools_help/ligfilter.html"><span class="GUI">Ligand Filtering </span> dialog box</a>. An example input file is given below. Comment lines start with ##.</p><pre xml:space="preserve">
##Remove molecules that have a molecular weight of greater than 650
Molecular weight &gt;650.0
## Remove molecules with too many H-bond acceptor and donor atoms
Num acceptor groups &gt;3
Num donor groups &gt;3
##Remove molecules with fewer than 10 atoms
Num atoms &lt;10
</pre>
        <p>For syntax information, see the <a href="../general_utilities/general_utilities_ligfilter.htm"><code>ligfilter</code></a> description.</p>
        <p>Generating large numbers of output structures (&gt;150,000) in a single run can be very time consuming. If you want to generate large numbers of structures, you can distribute the LigPrep job across multiple processors on a multiprocessor host, by selecting the host and entering the number of processors in the <span class="GUI">Job Settings</span> dialog box.</p>
        <p>If structures cannot be processed for some reason, the input structures are copied to a file named <i>jobname</i><code>-failed.</code><i>ext</i>, which is in the same format as the input file. The structure numbers from the input file are reported at the end of a log file, along with the stage in which the failure occurred.</p>
        <h2><a name="features"></a>LigPrep Panel Features</h2>
        <ul>
            <li value="1"><a href="#structures"><span class="GUI">Use structures from</span> option menu</a>
            </li>
            <li value="2"><a href="#PTbutton"><span class="GUI">Open Project Table</span> button</a>
            </li>
            <li value="3"><a href="#filebrowse"><span class="GUI">File name</span> text box and <span class="GUI">Browse</span> button</a>
            </li>
            <li value="4"><a href="#feature3"><span class="GUI">Filter criteria file</span> text box and buttons</a>
            </li>
            <li value="5"><a href="#feature4"><span class="GUI">Force field</span> option menu</a>
            </li>
            <li value="6"><a href="#custom_ff"><span class="GUI">Customize</span> button</a>
            </li>
            <li value="7"><a href="#use_custom_ff"><span class="GUI">Use customized version</span> option</a>
            </li>
            <li value="8"><a href="#feature5"><span class="GUI">Ionization</span> section</a>
            </li>
            <li value="9"><a href="#feature8"><span class="GUI">Desalt</span> option</a>
            </li>
            <li value="10"><a href="#feature9"><span class="GUI">Generate tautomers</span> option</a>
            </li>
            <li value="11"><a href="#feature6"><span class="GUI">Stereoisomers</span> section</a>
            </li>
            <li value="12"><a href="#feature10"><span class="GUI">Output format</span> options</a>
            </li>
            <li value="13"><a href="#job_toolbar">Job toolbar</a>
            </li>
            <li value="14"><a href="#status_bar">Status bar</a>
            </li>
        </ul>
        <dl>
            <dt><a name="structures"></a><span class="GUI"><span class="SnippetUseFromLabel">Use structures from</span></span> option menu</dt>
            <dd>
                <p>Choose the source of the structures for <span class="SnippetCurrentTask">the current task</span>. </p>
                <ul>
                    <li value="1" data-mc-conditions="Snippet.PTn"><span class="GUI">Project Table (<i>n</i> selected entries)</span>—Use the entries that are currently selected in the Project Table. The number of entries selected is shown on the menu item.  An icon is displayed to the right which you can click to open the Project Table and select entries.</li>
                    <li value="2" data-mc-conditions="Snippet.WSn"><span class="GUI">Workspace (<i>n</i> included entries)</span>—Use the entries that are currently included in the Workspace, treated as separate structures. The number of entries in the Workspace is shown on the menu item. The Workspace should not contain a scratch entry.   An  icon is displayed to the right which you can click to open the Project Table and include or exclude entries.</li>
                    <li value="3" data-mc-conditions="Snippet.File"><span class="GUI">File</span>—Use the structures from the specified file. When this option is selected, the <span class="GUI"><span class="SnippetFileBrowseLabel">File name</span></span> text box and <span class="GUI">Browse</span> button are displayed.  Click <span class="GUI">Browse</span> and navigate to the file you want to use. The file name is displayed in the text box when you click <span class="GUI">Open</span> in the file selector. You can also enter the file name in the text box.</li>
                </ul>
            </dd>
            <dt><a name="PTbutton"></a><span class="GUI">Open Project Table</span> button</dt>
            <dd>
                <p>Open the <span class="GUI">Project Table</span> panel, so you can select or include the entries for the source of the structures.
<br style="margin-bottom: 10px;" /><img src="../Resources/Images/Toolbuttons/projecttable.png" /><br style="margin-bottom: 10px;" /></p>
            </dd>
            <dt><a name="filebrowse"></a><span class="GUI"><span class="SnippetFileBrowseLabel">File name</span></span> text box and <span class="GUI">Browse</span> button</dt>
            <dd>
                <p>If you chose  from the <span class="GUI"><span class="SnippetUseFromLabel">Use structures from</span></span> option menu, enter the file name in this text box, or click <span class="GUI">Browse</span> and navigate to the file. The name of the file you selected is displayed in the text box. </p>
            </dd>
            <dt><a name="feature3"></a><span class="GUI">Filter criteria file</span> text box and buttons</dt>
            <dd>
                <p>Enter the name of a file that contains criteria on molecular descriptors for filtering, click <span class="GUI">Browse</span> to select an existing filter criteria file, or click <span class="GUI">Create</span> to create a new filter criteria file in the <a href="../maestro_tools_help/ligfilter.html"><span class="GUI">Ligand Filtering</span> dialog box</a>.</p>
            </dd>
            <dt><a name="feature4"></a><span class="GUI">Force field</span> option menu</dt>
            <dd>
                <p>Select the force field to use for minimization of structures. Two choices are available: <span class="GUI">OPLS_2005</span> and <span class="GUI">OPLS3</span>. The default is <span class="GUI">OPLS3</span> if it is available, otherwise it is <span class="GUI">OPLS_2005</span>, unless you set the default in the <a href="../maestro_help/preferences.html#jobs_forcefield"><span class="GUI">Preferences</span> panel</a>.</p>
            </dd><a name="custom_ff"></a>
            <dt><span class="GUI">Customize</span> button</dt>
            <dd>
                <p>Customize the torsions in the OPLS3 force field for a set of molecules by refitting to quantum-mechanical calculations. Opens the <a href="../maestro_tools_help/force_field_builder.html"><span class="GUI">Force Field Builder</span> panel</a>. Only available when you choose OPLS3 from the <span class="GUI">Force field</span> option menu.</p>
            </dd><a name="use_custom_ff"></a>
            <dt><span class="GUI">Use customized version</span> option</dt>
            <dd>
                <p>Use your customized version of the OPLS3 force field, rather than the standard version in the distribution. Only available when you choose OPLS3 from the <span class="GUI">Force field</span> option menu. This option is set by default to the value of the <span class="GUI">Use custom parameters by default</span> option in the <span class="GUI">Preferences</span> panel, under <a href="../maestro_help/preferences.html#jobs_forcefield"><span class="GUI">Jobs - Force field</span></a>.</p>
            </dd>
            <dt><a name="feature5"></a><span class="GUI">Ionization</span> section</dt>
            <dd>
                <p>Select a strategy for determining the ionization state of the ligand. The ionization states are generated by adding or removing protons from the ligand.</p>
                <ul>
                    <li value="1">
                        <p><span class="GUI">Do not change</span>: Do not change the ionization state of the ligand.</p>
                    </li>
                    <li value="2">
                        <p><span class="GUI">Neutralize</span>: Ensure that the ligand is neutral by adding or removing protons, according to the pK<sub>a</sub> values of the acidic or basic sites.</p>
                    </li>
                    <li value="3">
                        <p><span class="GUI">Generate possible states at target pH</span>: Generate ionization states that are significantly populated in the pH range specified by the values in the two text boxes. There are two programs available for generating the states, listed next to <span class="GUI">Using</span>:</p>
                        <ul>
                            <li value="1">
                                <p><span class="GUI">Ionizer</span>—use the Ionizer (the default)</p>
                            </li>
                            <li value="2">
                                <p><span class="GUI">Epik</span>—use Epik. Epik has two options that can be used:</p>
                                <p><span class="GUI">Add metal binding states</span>—Generate states that are appropriate for binding to metals in addition to the normal ionization states.</p>
                                <p><span class="GUI">Include original state</span>—Include the original ionization state in addition to the generated states.</p>
                            </li>
                        </ul>
                        <p>To use Epik, you must have an Epik license, as Epik is a separate product. Ionizer is included with LigPrep. Epik is more comprehensive in its treatment than Ionizer.</p>
                    </li>
                </ul>
            </dd>
            <dt><a name="feature8"></a><span class="GUI">Desalt</span> option</dt>
            <dd>
                <p>Structures from some databases can consist of multiple molecules, one of which is the ligand. In many cases, the extra molecules are counter ions or water molecules. Select this option to remove all but the molecule with the largest number of atoms.</p>
            </dd>
            <dt><a name="feature9"></a><span class="GUI">Generate tautomers</span> option</dt>
            <dd>
                <p>Tautomers are thermally accessible and interchangeable isomers of molecules in which the non-hydrogen topology of the molecule remains unmodified while hydrogen atoms are relocated and bond orders change. Select this option to generate tautomers with significant populations for each input structure. This option is recommended for preparing ligands for both Glide and QikProp calculations. If you selected <span class="GUI">Epik</span> for ionization, it will also be used for generating tautomers.</p>
            </dd>
            <dt><a name="feature6"></a><span class="GUI">Stereoisomers</span> section</dt>
            <dd>
                <p>Select the treatment of stereochemical information in the input and the generation of stereoisomers in the output. There are three options under the <span class="GUI">Computation</span> heading that control the source of stereoisomers:</p>
                <ul>
                    <li value="1">
                        <p><span class="GUI">Retain specified chiralities (vary other chiral centers)</span>— Keep the information on chiralities from the input file, and fix these chiralities for the entire calculation. Chirality information includes parities and bond directions from SD files, and the chirality property from Maestro files. Maestro chiralities are only written by the <code>stereoizer</code> utility. If the configuration or chirality of a chiral center is not specified, the two possible chiralities are generated in the output.</p>
                    </li>
                    <li value="2">
                        <p><span class="GUI">Determine chiralities from 3D structure</span>— Discard all chirality information in the input file, and determine the chirality from the 3D geometry. These chiralities are held fixed. For centers whose chirality is indeterminate, structures for the two possible chiralities for each center are generated. (Sets the <code>-g</code> option of the <span class="GUI">ligprep</span> command.)</p>
                    </li>
                    <li value="3">
                        <p><span class="GUI">Generate all combinations</span>— Discard all chirality information, both from input file properties and from the 3D geometry, and generate all possible configurations that result from the combination of chiralities on each chiral center. (Sets the <code>-ac</code> option of the <span class="GUI">ligprep</span> command.)</p>
                    </li>
                </ul>
                <p>You can limit the number of stereoisomers to generate in the <span class="GUI">Generate at most <i>N</i> per ligand</span> text box.</p>
                <p>Select <span class="GUI">For SD V2000 input, generate enantiomers if the chiral flag is 0</span>, if you have SD input and want both enantiomers to be generated if the chiral flag is set to zero. The default is to generate only the enantiomer represented by the specified chiralities. This setting is stored as a preference, so it is preserved across Maestro sessions.</p>
                <p>When stereoisomers are generated for fused ring systems, the correlation between chiralities on chiral centers in the rings is taken into account, and invalid combinations are not generated.</p>
            </dd>
            <dt><a name="feature10"></a><span class="GUI">Output format</span> options</dt>
            <dd>
                <p>Specify the file format for the output file. If you want to incorporate the structures into the current project, you must select <span class="GUI">Maestro</span> for the format. In Maestro format, the structures are written to the file <i>jobname</i><code>.maegz</code>. In SDF format, the structures are written to the file <i>jobname</i><code>.sdf</code>.</p>
            </dd>
            <dt><a name="job_toolbar"></a>Job toolbar</dt>
            <dd>
                <p>Manage job submission. See <a href="../maestro_help/job_toolbar.html">Job Toolbar</a> for a description of this toolbar.</p>
            </dd>
            <dt><a name="status_bar"></a>Status bar</dt>
            <dd>
                <p>The status bar displays information about the current job settings for the panel. This includes the job name, task name and task settings (if any), number of subjobs (if any) and the host name and job incorporation setting. It also displays a message for a short time when you start a new job.</p>
                <p>The status bar also contains the <span class="GUI">Help</span> button, which opens the help topic for the panel.</p>
                <p>
                    <img src="../Resources/Images/Toolbuttons/help.png" />
                </p>
            </dd>
        </dl>
        <h2><a name="links"></a>Related Topics</h2>
        <ul>
            <li value="1"><a href="../maestro_projects_help/project_overview.html" class="MCXref xref" xrefformat="{paratext}">Project Facility Overview</a>
            </li>
            <li value="2"><a href="../maestro_projects_help/project_table.html" class="MCXref xref" xrefformat="{paratext}">Project Table Panel</a>
            </li>
            <li value="3"><a href="../maestro_tools_help/ligfilter.html" class="MCXref xref" xrefformat="{paratext}">Ligand Filtering Panel</a>
            </li>
            <li value="4"><a href="../maestro_help/job_settings.html" class="MCXref xref" xrefformat="{paratext}">Job Settings Dialog Box</a>
            </li>
            <li value="5"><a href="../maestro_help/monitor_panel.html" class="MCXref xref" xrefformat="{paratext}">Monitor Panel</a>
            </li>
        </ul>
    </body>
</html>