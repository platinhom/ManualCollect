<!DOCTYPE html>
<html xmlns:MadCap="http://www.madcapsoftware.com/Schemas/MadCap.xsd" lang="en-US" xml:lang="en-US" data-mc-search-type="Stem" data-mc-help-system-file-name="Documentation.xml" data-mc-path-to-help-system="../" data-mc-target-type="WebHelp2" data-mc-runtime-file-type="Topic" data-mc-preload-images="false" data-mc-in-preview-mode="false" data-mc-toc-path="Command References|Prime Command Reference|Prime Command Syntax">
    <head>
        <meta name="viewport" content="width=device-width, initial-scale=1.0" />
        <meta charset="utf-8" />
        <meta http-equiv="X-UA-Compatible" content="IE=edge" />
        <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
        <link href="../Skins/Default/Stylesheets/Slideshow.css" rel="stylesheet" type="text/css" data-mc-generated="True" />
        <link href="../Skins/Default/Stylesheets/TextEffects.css" rel="stylesheet" type="text/css" data-mc-generated="True" />
        <link href="../Skins/Default/Stylesheets/Topic.css" rel="stylesheet" type="text/css" data-mc-generated="True" />
        <link href="../Skins/Default/Stylesheets/Components/Styles.css" rel="stylesheet" type="text/css" data-mc-generated="True" /><title>blast—Run Blast Searches</title>
        <link href="../Resources/TableStyles/StandardRules.css" rel="stylesheet" data-mc-stylesheet-type="table" />
        <link href="../Resources/TableStyles/Formatting.css" rel="stylesheet" data-mc-stylesheet-type="table" />
        <link href="../Resources/Stylesheets/docs.css" rel="stylesheet" />
        <script src="../Resources/Scripts/custom.modernizr.js" type="text/javascript">
        </script>
        <script src="../Resources/Scripts/jquery.min.js" type="text/javascript">
        </script>
        <script src="../Resources/Scripts/require.min.js" type="text/javascript">
        </script>
        <script src="../Resources/Scripts/require.config.js" type="text/javascript">
        </script>
        <script src="../Resources/Scripts/foundation.min.js" type="text/javascript">
        </script>
        <script src="../Resources/Scripts/plugins.min.js" type="text/javascript">
        </script>
        <script src="../Resources/Scripts/MadCapAll.js" type="text/javascript">
        </script>
    </head>
    <body><a name="aanchor2425"></a>
        <MadCap:concept term="Command Reference" /><a name="aanchor2426"></a>
        <MadCap:concept term="Prime" /><a name="prime_commands_1525853049_782924"></a>
        <table class="NavLink" data-mc-conditions="Default.ScreenOnly">
            <tr class="NavLink">
                <td class="NavLeft"><span class="NavText">◀ <a class="NavLink MCXref xref xrefNavLink" href="prime_commands.htm">Prime Command Syntax</a></span>
                </td>
                <td class="NavCenter"><span class="NavText"><a class="NavLink MCXref xref xrefNavLink" href="prime_command_referenceTOC.htm">Prime Command Reference Manual</a></span>
                </td>
                <td class="NavRight"><span class="NavText"><a class="NavLink MCXref xref xrefNavLink" href="prime_commands_prime.htm">prime—Build and Refine Protein Structures</a> ▶</span>
                </td>
            </tr>
        </table>
        <h1 class="Title">blast—Run Blast Searches</h1>
        <p>The <code>blast</code> script provides an interface to the Blast and PSIBlast programs from NCBI (see <a href="http://www.ncbi.nlm.nih.gov/books/NBK21097/">http://www.ncbi.nlm.nih.gov/books/NBK21097/</a> for information), while also supporting standard Schrodinger Job Control options. All options are passed on to the script via an input file. </p>
        <p class="Heading3Nonum">Syntax</p><pre>
$SCHRODINGER/blast <i class="UserReplace">jobname</i> [<i class="UserReplace">options</i>] 
</pre>
        <p>Input is read from the file <i class="UserReplace">jobname</i><code>.inp</code>. Output is written by default to <i class="UserReplace">jobname</i><code>.out</code>.</p>
        <p class="Heading3Nonum">Input File</p>
        <p>Keywords control the operation of the <code>blast</code> script, and are listed in <a class="Table_Number MCXref xref xrefTable_Number selected" href="#prime_commands_1525853049_762628">Table 1</a>. Most keywords are simply a translation of options available from the <code>blastall</code> or <code>blastpgp</code> executables distributed by NCBI. For optional keywords, the Blast default values are used. Since these defaults can differ between different version of Blast they are not listed here.</p>
        <table class="TableStyle-StandardRules" style="caption-side: top;mc-table-style: url('../Resources/TableStyles/StandardRules.css');" cellspacing="0">
            <caption valign="top" style="padding-bottom: 7pt;">
                <p class="Table_Caption" data-mc-autonum="Table 1. "><span class="autonumber"><span>Table 1. </span></span><a name="prime_commands_1525853049_762628"></a>Keywords for the blast script</p>
            </caption>
            <thead>
                <tr class="TableStyle-StandardRules-Head-Header1">
                    <td class="TableStyle-StandardRules-HeadE-Column1-Header1">
                        <p class="Cell_Heading">Keyword</p>
                    </td>
                    <td class="TableStyle-StandardRules-HeadD-Column1-Header1">
                        <p class="Cell_Heading">Description</p>
                    </td>
                </tr>
            </thead>
            <tbody>
                <tr class="TableStyle-StandardRules-Body-Body1">
                    <td class="TableStyle-StandardRules-BodyH-Column1-Body1">
                        <p class="Cell_Body"><code>QUERY_FILE </code><i class="UserReplace">filename</i>
                        </p>
                    </td>
                    <td class="TableStyle-StandardRules-BodyG-Column1-Body1">
                        <p class="Cell_Body">Required. Name of the FASTA file containing the input/query sequence </p>
                    </td>
                </tr>
                <tr class="TableStyle-StandardRules-Body-Body1">
                    <td class="TableStyle-StandardRules-BodyE-Column1-Body1">
                        <p class="Cell_Body"><code>DATABASE </code>{<code>nr</code> | <code>pdb</code>} </p>
                    </td>
                    <td class="TableStyle-StandardRules-BodyD-Column1-Body1">
                        <p class="Cell_Body">Database to be used in the search. In a default installation the two allowed values are <code>nr</code> and <code>pdb</code>.</p>
                    </td>
                </tr>
                <tr class="TableStyle-StandardRules-Body-Body2">
                    <td class="TableStyle-StandardRules-BodyH-Column1-Body2">
                        <p class="Cell_Body"><code>ALIGNMENT_FORMAT </code><i class="UserReplace">value</i>
                        </p>
                    </td>
                    <td class="TableStyle-StandardRules-BodyG-Column1-Body2">
                        <p class="Cell_Body">Alignment view options (Blast <code>-m</code> option). Allowed values are:</p>
                        <table class="TableCellTable">
                            <tr class="TableCellTable">
                                <td class="TableCellTable">
                                    <p class="Cell_Body"><code>0</code>
                                    </p>
                                </td>
                                <td class="TableCellTable">
                                    <p class="Cell_Body">&#160;pairwise</p>
                                </td>
                            </tr>
                            <tr class="TableCellTable">
                                <td class="TableCellTable">
                                    <p class="Cell_Body"><code>1</code>
                                    </p>
                                </td>
                                <td class="TableCellTable">
                                    <p class="Cell_Body">&#160;query-anchored showing identities</p>
                                </td>
                            </tr>
                            <tr class="TableCellTable">
                                <td class="TableCellTable">
                                    <p class="Cell_Body"><code>2</code>
                                    </p>
                                </td>
                                <td class="TableCellTable">
                                    <p class="Cell_Body">&#160;query-anchored no identities</p>
                                </td>
                            </tr>
                            <tr class="TableCellTable">
                                <td class="TableCellTable">
                                    <p class="Cell_Body"><code>3</code>
                                    </p>
                                </td>
                                <td class="TableCellTable">
                                    <p class="Cell_Body">&#160;flat query-anchored, show identities</p>
                                </td>
                            </tr>
                            <tr class="TableCellTable">
                                <td class="TableCellTable">
                                    <p class="Cell_Body"><code>4</code>
                                    </p>
                                </td>
                                <td class="TableCellTable">
                                    <p class="Cell_Body">&#160;flat query-anchored, no identities</p>
                                </td>
                            </tr>
                            <tr class="TableCellTable">
                                <td class="TableCellTable">
                                    <p class="Cell_Body"><code>5</code>
                                    </p>
                                </td>
                                <td class="TableCellTable">
                                    <p class="Cell_Body">&#160;query-anchored no identities and blunt ends</p>
                                </td>
                            </tr>
                            <tr class="TableCellTable">
                                <td class="TableCellTable">
                                    <p class="Cell_Body"><code>6</code>
                                    </p>
                                </td>
                                <td class="TableCellTable">
                                    <p class="Cell_Body">&#160;flat query-anchored, no identities and blunt ends</p>
                                </td>
                            </tr>
                            <tr class="TableCellTable">
                                <td class="TableCellTable">
                                    <p class="Cell_Body"><code>7</code>
                                    </p>
                                </td>
                                <td class="TableCellTable">
                                    <p class="Cell_Body">&#160;XML Blast output</p>
                                </td>
                            </tr>
                            <tr class="TableCellTable">
                                <td class="TableCellTable">
                                    <p class="Cell_Body"><code>8</code>
                                    </p>
                                </td>
                                <td class="TableCellTable">
                                    <p class="Cell_Body">&#160;tabular </p>
                                </td>
                            </tr>
                            <tr class="TableCellTable">
                                <td class="TableCellTable">
                                    <p class="Cell_Body"><code>9</code>
                                    </p>
                                </td>
                                <td class="TableCellTable">
                                    <p class="Cell_Body">&#160;tabular with comment lines</p>
                                </td>
                            </tr>
                            <tr class="TableCellTable">
                                <td class="TableCellTable">
                                    <p class="Cell_Body"><code>m2io</code>
                                    </p>
                                </td>
                                <td class="TableCellTable">
                                    <p class="Cell_Body">&#160;Maestro format (default)</p>
                                </td>
                            </tr>
                        </table>
                    </td>
                </tr>
                <tr class="TableStyle-StandardRules-Body-Body2">
                    <td class="TableStyle-StandardRules-BodyE-Column1-Body2">
                        <p class="Cell_Body"><code>EXPECT</code><i class="UserReplace">value</i>
                        </p>
                    </td>
                    <td class="TableStyle-StandardRules-BodyD-Column1-Body2">
                        <p class="Cell_Body">Expectation value (E) (Blast <code>-e</code> option).</p>
                    </td>
                </tr>
                <tr class="TableStyle-StandardRules-Body-Body1">
                    <td class="TableStyle-StandardRules-BodyH-Column1-Body1">
                        <p class="Cell_Body"><code>FILTER</code> {<code>true</code> | <code>false</code>}</p>
                    </td>
                    <td class="TableStyle-StandardRules-BodyG-Column1-Body1">
                        <p class="Cell_Body">Filter query sequence: DUST with <code>blastn</code>, SEG with others. (Blast <code>-F</code> option).</p>
                    </td>
                </tr>
                <tr class="TableStyle-StandardRules-Body-Body1">
                    <td class="TableStyle-StandardRules-BodyE-Column1-Body1">
                        <p class="Cell_Body"><code>GAP_OPEN_COST </code><i class="UserReplace">value</i>
                        </p>
                    </td>
                    <td class="TableStyle-StandardRules-BodyD-Column1-Body1">
                        <p class="Cell_Body">Cost to open a gap (Blast <code>-G</code> option)</p>
                    </td>
                </tr>
                <tr class="TableStyle-StandardRules-Body-Body2">
                    <td class="TableStyle-StandardRules-BodyH-Column1-Body2">
                        <p class="Cell_Body"><code>GAP_EXTEND_COST </code><i class="UserReplace">value</i>
                        </p>
                    </td>
                    <td class="TableStyle-StandardRules-BodyG-Column1-Body2">
                        <p class="Cell_Body">Cost to extend a gap (Blast <code>-E</code> option)</p>
                    </td>
                </tr>
                <tr class="TableStyle-StandardRules-Body-Body2">
                    <td class="TableStyle-StandardRules-BodyE-Column1-Body2">
                        <p class="Cell_Body"><code>MATRIX </code><i class="UserReplace">type</i>
                        </p>
                    </td>
                    <td class="TableStyle-StandardRules-BodyD-Column1-Body2">
                        <p class="Cell_Body">Sequence similarity matrix to use for the alignments. Allowed values of <i class="UserReplace">type</i> are <code>BLOSUM45</code>, <code>BLOSUM62</code>, <code>BLOSUM80</code>, <code>PAM30</code>, <code>PAM70</code></p>
                    </td>
                </tr>
                <tr class="TableStyle-StandardRules-Body-Body1">
                    <td class="TableStyle-StandardRules-BodyH-Column1-Body1">
                        <p class="Cell_Body"><code>MAX_ROUNDS </code><i class="UserReplace">n</i>
                        </p>
                    </td>
                    <td class="TableStyle-StandardRules-BodyG-Column1-Body1">
                        <p class="Cell_Body">Maximum number of passes to use in multipass version (PSI-Blast <code>-j</code> option); only applies to runs using <code>PROGRAM blastpgp</code></p>
                    </td>
                </tr>
                <tr class="TableStyle-StandardRules-Body-Body1">
                    <td class="TableStyle-StandardRules-BodyE-Column1-Body1">
                        <p class="Cell_Body"><code>E_VALUE_THRESHOLD </code><i class="UserReplace">value</i>
                        </p>
                    </td>
                    <td class="TableStyle-StandardRules-BodyD-Column1-Body1">
                        <p class="Cell_Body">e-value threshold for inclusion in multipass model (PSIBlast <code>-h</code> option).</p>
                    </td>
                </tr>
                <tr class="TableStyle-StandardRules-Body-Body2">
                    <td class="TableStyle-StandardRules-BodyH-Column1-Body2">
                        <p class="Cell_Body"><code>OUTPUT_FILE </code><i class="UserReplace">filename</i>
                        </p>
                    </td>
                    <td class="TableStyle-StandardRules-BodyG-Column1-Body2">
                        <p class="Cell_Body">Name of the output file. Default: <i class="UserReplace">jobname</i><code>.out</code>. </p>
                    </td>
                </tr>
                <tr class="TableStyle-StandardRules-Body-Body2">
                    <td class="TableStyle-StandardRules-BodyE-Column1-Body2">
                        <p class="Cell_Body"><code>PROGNAME </code><i class="UserReplace">name</i>
                        </p>
                    </td>
                    <td class="TableStyle-StandardRules-BodyD-Column1-Body2">
                        <p class="Cell_Body">Type of blast search to run. The allowed values are <code>blastp</code>, <code>blastpgp</code>, and <code>bl2seq</code> (for pairwise alignments). Default: <code>blastp</code>.</p>
                    </td>
                </tr>
                <tr class="TableStyle-StandardRules-Body-Body1">
                    <td class="TableStyle-StandardRules-BodyH-Column1-Body1">
                        <p class="Cell_Body"><code>TEMPLATE_FILE </code><i class="UserReplace">filename</i>
                        </p>
                    </td>
                    <td class="TableStyle-StandardRules-BodyG-Column1-Body1">
                        <p class="Cell_Body">Name of the FASTA file that contains the template sequence (<code>bl2seq</code> <code>-j</code> option). Only applies to pairwise alignments using <code>bl2seq</code></p>
                    </td>
                </tr>
                <tr class="TableStyle-StandardRules-Body-Body1">
                    <td class="TableStyle-StandardRules-BodyE-Column1-Body1">
                        <p class="Cell_Body"><code>PSSM_ASCII_OUTFILE &#160;&#160;&#160;</code><i class="UserReplace">filename</i>
                        </p>
                    </td>
                    <td class="TableStyle-StandardRules-BodyD-Column1-Body1">
                        <p class="Cell_Body">ASCII output file for PSI-BLAST matrix (PSIBlast <code>-Q</code> option).</p>
                    </td>
                </tr>
                <tr class="TableStyle-StandardRules-Body-Body2">
                    <td class="TableStyle-StandardRules-BodyH-Column1-Body2">
                        <p class="Cell_Body"><code>EXPAND_HITS </code>{<code>true</code> | <code>&#160;&#160;&#160;false</code>} </p>
                    </td>
                    <td class="TableStyle-StandardRules-BodyG-Column1-Body2">
                        <p class="Cell_Body">Expand redundant hits, based on information in the NCBI define for a particular hit. Only available when using Maestro format.</p>
                    </td>
                </tr>
                <tr class="TableStyle-StandardRules-Body-Body2">
                    <td class="TableStyle-StandardRules-BodyB-Column1-Body2">
                        <p class="Cell_Body"><code>SHOW </code>{<code>all</code> | <code>pdb</code>} </p>
                    </td>
                    <td class="TableStyle-StandardRules-BodyA-Column1-Body2">
                        <p class="Cell_Body">Allows the user to restrict the types of hits that are included in the output. <code>all</code> includes all hits; <code>pdb</code> only includes hits from the PDB. Only available when using Maestro format.</p>
                    </td>
                </tr>
            </tbody>
        </table>
        <p class="Heading3Nonum">Return Value and Errors</p>
        <p><code>blast</code> returns 0 if successful and a non-zero value in all other cases.</p>
        <p class="Heading3Nonum">Examples</p>
        <p>The following is an example input file; <code>query.aa</code> is the query sequence in FASTA format.</p><pre>
QUERY_FILE        query.aa
PROGNAME          blastp
DATABASE          pdb
</pre>
        <p class="Heading3Nonum">Environment Variables</p>
        <p>The following environment variables are supported by the blast script:</p>
        <table class="TableStyle-Formatting" style="caption-side: top;mc-table-style: url('../Resources/TableStyles/Formatting.css');" cellspacing="0">
            <tbody>
                <tr class="Formatting">
                    <td class="TableStyle-Formatting-BodyH-Column1-">
                        <p><code>PSP_BLASTDB</code>
                        </p>
                    </td>
                    <td class="TableStyle-Formatting-BodyG-Column1-">
                        <p>directory containing the customized Blast databases</p>
                    </td>
                </tr>
                <tr class="Formatting">
                    <td class="TableStyle-Formatting-BodyB-Column1-">
                        <p><code>PSP_BLAST_DIR</code>
                        </p>
                    </td>
                    <td class="TableStyle-Formatting-BodyA-Column1-">
                        <p>directory containing a custom Blast installation</p>
                    </td>
                </tr>
            </tbody>
        </table>
        <table class="NavLink" data-mc-conditions="Default.ScreenOnly">
            <tr class="NavLink">
                <td class="NavLeft"><span class="NavText">◀ <a class="NavLink MCXref xref xrefNavLink" href="prime_commands.htm">Prime Command Syntax</a></span>
                </td>
                <td class="NavCenter"><span class="NavText"><a class="NavLink MCXref xref xrefNavLink" href="prime_command_referenceTOC.htm">Prime Command Reference Manual</a></span>
                </td>
                <td class="NavRight"><span class="NavText"><a class="NavLink MCXref xref xrefNavLink" href="prime_commands_prime.htm">prime—Build and Refine Protein Structures</a> ▶</span>
                </td>
            </tr>
        </table>
    </body>
</html>