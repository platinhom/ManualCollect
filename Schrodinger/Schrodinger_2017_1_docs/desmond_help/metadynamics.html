<!DOCTYPE html>
<html xmlns:MadCap="http://www.madcapsoftware.com/Schemas/MadCap.xsd" lang="en-US" xml:lang="en-US" data-mc-search-type="Stem" data-mc-help-system-file-name="Documentation.xml" data-mc-path-to-help-system="../" data-mc-target-type="WebHelp2" data-mc-runtime-file-type="Topic" data-mc-preload-images="false" data-mc-in-preview-mode="false" data-mc-toc-path="Help|Desmond Help" data-mc-conditions="">
    <head>
        <meta name="viewport" content="width=device-width, initial-scale=1.0" />
        <meta charset="utf-8" />
        <meta http-equiv="X-UA-Compatible" content="IE=edge" />
        <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
        <link href="../Skins/Default/Stylesheets/Slideshow.css" rel="stylesheet" type="text/css" data-mc-generated="True" />
        <link href="../Skins/Default/Stylesheets/TextEffects.css" rel="stylesheet" type="text/css" data-mc-generated="True" />
        <link href="../Skins/Default/Stylesheets/Topic.css" rel="stylesheet" type="text/css" data-mc-generated="True" />
        <link href="../Skins/Default/Stylesheets/Components/Styles.css" rel="stylesheet" type="text/css" data-mc-generated="True" />
        <link href="../Resources/Stylesheets/docs.css" rel="stylesheet" type="text/css" /><title>Metadynamics Panel</title>
        <script src="../Resources/Scripts/custom.modernizr.js" type="text/javascript">
        </script>
        <script src="../Resources/Scripts/jquery.min.js" type="text/javascript">
        </script>
        <script src="../Resources/Scripts/require.min.js" type="text/javascript">
        </script>
        <script src="../Resources/Scripts/require.config.js" type="text/javascript">
        </script>
        <script src="../Resources/Scripts/foundation.min.js" type="text/javascript">
        </script>
        <script src="../Resources/Scripts/plugins.min.js" type="text/javascript">
        </script>
        <script src="../Resources/Scripts/MadCapAll.js" type="text/javascript">
        </script>
    </head>
    <body><a name="aanchor7452"></a>
        <MadCap:concept term="Help Topics" /><a name="aanchor7453"></a>
        <MadCap:concept term="Desmond" />
        <table class="navlink">
            <tr>
                <td class="navlink"><a class="navbutton" href="#using">Using</a>
                </td>
                <td class="navlink"><a class="navbutton" href="#features">Features</a>
                </td>
                <td class="navlink"><a class="navbutton" href="#links">Links</a>
                </td>
            </tr>
        </table>
        <h1 class="title">Metadynamics Panel</h1><a name="summary"></a>
        <p>Run a metadynamics simulation on one or more collective variables.</p>
        <p class="opening">To open this panel, choose <span class="GUI">Tasks → Free Energy Calculations → Metadynamics</span> in the Task Tool.</p>
        <h2><a name="using"></a>Using the Metadynamics Panel</h2>
        <p>Metadynamics is a technique in which the potential for one or more chosen variables ("collective variables") is modified by periodically adding a repulsive potential of Gaussian shape at the location given by particular values of the variables. These repulsive Gaussians eventually fill up the well that is being sampled, and force the calculation to sample elsewhere. At certain points in the simulation, the sum of the Gaussians and the free-energy surface (FES) becomes flat, and therefore the sum of Gaussians is the negative image of the FES.</p>
        <p>The parameters that control the accuracy of the simulation are the height and width of the Gaussian potential and the interval at which the Gaussians are added. The accuracy of the results is inversely proportional to the height for a given interval for addition of the Gaussian. However, if smaller heights are used, the simulation takes longer. The accuracy of the results increases as the time interval increases, but the simulation time also increases. The accuracy is not very sensitive to the ratio of the height to the interval, but smaller values of this ratio increase the accuracy. The width of the Gaussian should be roughly 1/4 to 1/3 of the average fluctuations of the collective variable during a free MD run.</p>
        <p>To set up a collective variable, </p>
        <ol>
            <li value="1">
                <p>Select an option for the type of variable: <span class="GUI">Distance</span>, <span class="GUI">Angle</span>, or <span class="GUI">Dihedral</span>.</p>
                <p> More flexible definitions can only be made from the command line.</p>
            </li>
            <li value="2">
                <p>Select an option for the atoms that define the collective variable:</p>
                <ul>
                    <li value="1"><span class="GUI">Specify atoms</span>—specify the variable in terms of individual atoms. </li>
                    <li value="2"><span class="GUI">Specify center of mass</span>—specify the variable in terms of the centers of mass of collections of atoms (e.g. residues in a loop). This is useful for examining larger scale motions.</li>
                </ul>
            </li>
            <li value="3">
                <p> Pick the atoms needed to define the collective variable.</p>
                <ul>
                    <li value="1"><span class="GUI">Specify atoms</span>—Select <span class="GUI">Pick atoms</span> then pick the required number of atoms in the Workspace. The atom numbers are listed in the <span class="GUI">Atom</span><i class="UserReplace">N</i> text boxes as you pick.</li>
                    <li value="2"><span class="GUI">Specify center of mass</span>—Pick atoms in the Workspace, then click <span class="GUI">Get from Selection</span>. The ASL expression for the atoms is entered in the <span class="GUI">Group</span> <i class="UserReplace">N</i> text box, and the next text box is selected. Repeat the process for each group box.</li>
                </ul>
            </li>
            <li value="4">
                <p>Set the width of the Gaussian in the <span class="GUI">Width</span> text box. </p>
            </li>
            <li value="5">
                <p>(Optional) For distance variables, you can place a barrier (“wall”) at a given distance in the <span class="GUI">Wall at</span> text box. </p>
                <p>Introducing a wall prevents the system from moving too far in the direction defined by the collective variable. </p>
            </li>
            <li value="6">Click <span class="GUI">Add</span> to add the collective variable to the table. </li>
        </ol>
        <p> To remove a variable from the simulation, select it in the table and click <span class="GUI">Remove</span>. Setting up more than two collective variables can create sampling problems. </p>
        <p>In the <span class="GUI">Simulation</span> section, you can make settings for the metadynamics job. The settings for the simulation time, recording interval, ensemble class and model system relaxation are the same as for a molecular dynamics simulation, and are described in <a class="TopicLink MCXref xref xrefTopicLink" href="../desmond_user_manual/desmond_panels_md.htm#desmond_panels_3537631757_743821" xrefformat="{paratext}">Desmond Molecular Dynamics Simulations</a>. The default ensemble for metadynamics is NPT.  </p>
        <h2><a name="features"></a>Metadynamics Panel Features</h2>
        <ul>
            <li value="1"><a href="#model_system"><span class="GUI">Model system</span> section</a>
            </li>
            <li value="2"><a href="#feature2"><span class="GUI">Simulation</span> section</a>
            </li>
            <li value="3"><a href="#job_toolbar">Job toolbar</a>
            </li>
            <li value="4"><a href="#status_bar">Status bar</a>
            </li>
        </ul>
        <h3><a name="model_system"></a>Model system section</h3>
        <p>In this section, you select the model system that you will use for the simulation. A valid model system must contain both the coordinates of the particles and the force field parameters. A file of a valid model system normally has the <code>.cms</code> extension. You can use the <a href="system_builder.html"><span class="GUI">System Builder</span> panel</a> to prepare the model system for any structure that you have. If you want to build an amorphous structure from scratch, you can use the <a href="../materials_help/disordered_system_builder.html"><span class="GUI">Disordered System Builder</span> panel</a> to create a model system.</p>
        <p>The option menu offers two choices for the source of the model system:</p>
        <ul>
            <li value="1">
                <p><span class="GUI">Load from Workspace</span>—Load the model system from the Workspace. When you choose this option, the <span class="GUI">Load</span> button is displayed to the right of the menu. Click this button to load the model system.</p>
            </li>
            <li value="2">
                <p><span class="GUI">Import from file</span>—Import the model system from a file. When you choose this option, a text box and <span class="GUI">Browse</span> button are displayed to the right of the menu. You can enter the name of the file in the text box, or click <span class="GUI">Browse</span> and navigate to the file.</p>
                <p data-mc-conditions="Snippet.desmond_cpt">You can choose to import a model system file (<code>.cms</code>) or a checkpoint file (<code>.cpt</code>).</p>
                <p data-mc-conditions="Snippet.desmond_cpt">If you import a model system file, it  must contain a model system that has already been prepared. When the file is imported, a message about the system is displayed below the option menu.</p>
                <p data-mc-conditions="Snippet.desmond_cpt">If you import a checkpoint file, most of the panel controls are unavailable. The purpose of the checkpoint file is to restart an interrupted simulation, so the parameters of the simulation cannot be altered. You can change the total simulation time, and then start the job.</p>
            </li>
        </ul>
        <h3><a name="feature2"></a>Simulation section</h3>
        <ul>
            <li value="1"><a href="#feature2.3"><span class="GUI">Collective variable</span> options</a>
            </li>
            <li value="2"><a href="#feature2.5"><span class="GUI">Atom</span> text boxes</a>
            </li>
            <li value="3"><a href="#feature2.6"><span class="GUI">Width</span> text box</a>
            </li>
            <li value="4"><a href="#feature2.7"><span class="GUI">Wall at</span> text box</a>
            </li>
            <li value="5"><a href="#feature2.4"><span class="GUI">Pick atoms</span> option</a>
            </li>
            <li value="6"><a href="#feature2.8"><span class="GUI">Add</span> and <span class="GUI">Remove</span> buttons</a>
            </li>
            <li value="7"><a href="#feature2.9">Collective Variable table</a>
            </li>
            <li value="8"><a href="#feature2.16"><span class="GUI">Relaxation protocol</span> text box and Browse button</a>
            </li>
            <li value="9"><a href="#feature2.12"><span class="GUI">Ensemble class</span> option menu</a>
            </li>
            <li value="10"><a href="#feature2.1"><span class="GUI">Height</span> text box</a>
            </li>
            <li value="11"><a href="#feature2.2"><span class="GUI">Interval</span> text box</a>
            </li>
            <li value="12"><a href="#feature2.10"><span class="GUI">Simulation time</span> text boxes</a>
            </li>
            <li value="13"><a href="#feature2.11"><span class="GUI">Recording interval</span> text boxes</a>
            </li>
            <li value="14"><a href="#feature2.19"><span class="GUI">Approximate number of frames</span> text box</a>
            </li>
            <li value="15"><a href="#feature2.18"><span class="GUI">Temperature</span> text box</a>
            </li>
            <li value="16"><a href="#feature2.13"><span class="GUI">Pressure</span> text box</a>
            </li>
            <li value="17"><a href="#feature2.14"><span class="GUI">Surface tension</span> text box</a>
            </li>
            <li value="18"><a href="#feature2.15"><span class="GUI">Relax model system before simulation</span> option</a>
            </li>
            <li value="19"><a href="#feature2.17"><span class="GUI">Advanced options</span> button</a>
            </li>
        </ul>
        <dl>
            <dt><a name="feature2.3"></a><span class="GUI">Collective variable type</span> options</dt>
            <dd>
                <p>Select the type of collective variable to use for the sampled degree of freedom.</p>
            </dd>
            <dt><a name="feature2.5"></a><span class="GUI">Atom</span><i>N</i> text boxes</dt>
            <dd>
                <p>These text boxes display the atom number of the atoms picked for the collective variable, and are displayed when <span class="GUI">Specify atoms</span> is selected.</p>
            </dd>
            <dt><a name="feature2.6"></a><span class="GUI">Width</span> text box</dt>
            <dd>
                <p>Width (rms width) of the repulsive Gaussian potential, in angstroms or radians. The width should be roughly 1/4 to 1/3 of the average fluctuations of the collective variable during a free MD run. The default values are 0.05&#160;Å for distances, 2.5° for angles, and 5° for dihedrals.</p>
            </dd>
            <dt><a name="feature2.7"></a><span class="GUI">Wall at</span> text box</dt>
            <dd>
                <p>Distance along the collective variable at which a barrier is placed. Introducing a wall prevents the system from moving too far in the direction defined by the collective variable. Only applies to distance variables.</p>
            </dd>
            <dt><a name="feature2.4"></a><span class="GUI">Pick atoms</span> option</dt>
            <dd>
                <p>Select this option to pick the atoms for the collective variable: two for a distance, three for an angle, and four for a dihedral.</p>
            </dd>
            <dt><a name="feature2.8"></a><span class="GUI">Add</span> and <span class="GUI">Remove</span> buttons</dt>
            <dd>
                <p>Add the collective variable defined above to the table, or remove the selected variable from the table.</p>
            </dd>
            <dt><a name="feature2.9"></a>Collective variable table</dt>
            <dd>
                <p>This table lists the collective variable atom numbers with their parameters. You can select a single row to remove from the table. The table is noneditable.</p>
            </dd>
            <dt><a name="feature2.10"></a><span class="GUI">Simulation time</span> text boxes</dt>
            <dd>
                <p>Specify the total time of the simulation, in ns, in the <span class="GUI">total</span> text box. The <span class="GUI">elapsed</span> text box displays the amount of time the simulation has already run, if you are restarting a simulation. For new simulations it should contain zero. This text box cannot be edited. Changing the total simulation time changes the trajectory recording interval, to maintain a maximum of 1000 frames in the trajectory.</p>
            </dd>
            <dt><a name="feature2.11"></a><span class="GUI">Recording interval</span> text boxes</dt>
            <dd>
                <p>Specify the recording interval for the energy and the trajectory. Enter a value in ps in the text box. Values entered in this text box are rounded to an integer multiple of the far time step size. By default, the far time step size is 0.006&#160;ps. This time step size is set in the <a href="advanced_options_db.html#integration"><span class="GUI">Integration</span> tab</a> of the <span class="GUI">Advanced Options</span> dialog box, in the <span class="GUI">RESPA integrator</span> section. If you adjust the trajectory recording interval, the number of frames is updated. </p>
            </dd>
            <dt><a name="feature2.19"></a><span class="GUI">Approximate number of frames</span> text box</dt>
            <dd>
                <p>Specify the approximate number of frames in the trajectory. This value is coupled with the recording interval for the trajectory and the simulation time: the number of frames times the trajectory recording interval is the total simulation time. If you adjust the number of frames, the recording interval is modified. </p>
            </dd>
            <dt><a name="feature2.12"></a><span class="GUI">Ensemble class</span> option menu</dt>
            <dd>
                <p>Choose the ensemble class from this option menu.The available classes are: NVE, NVT, NPT, NPAT, and NPγT. The default class is NPT.</p>
            </dd>
            <dt><a name="feature2.1"></a><span class="GUI">Height</span> text box</dt>
            <dd>
                <p>Height of the repulsive Gaussian potential. The accuracy of the results is inversely proportional to the height for a given interval for addition of the Gaussian. However, if smaller heights are used, the simulation takes longer. The accuracy is not very sensitive to the ratio of the height to the interval, but smaller values of this ratio increase the accuracy.</p>
            </dd>
            <dt><a name="feature2.2"></a><span class="GUI">Interval</span> text box</dt>
            <dd>
                <p>Time interval at which the repulsive Gaussian potential is added. The accuracy of the results increases as the time interval increases, but the simulation time also increases.</p>
            </dd>
            <dt><a name="feature2.18"></a><span class="GUI">Temperature</span> text box</dt>
            <dd>
                <p>Specify the temperature to be used. Not available for the NVE ensemble class.</p>
            </dd>
            <dt><a name="feature2.13"></a><span class="GUI">Pressure</span> text box</dt>
            <dd>
                <p>Specify the pressure to be used. Not available for the NVT or NVE ensemble class.</p>
            </dd>
            <dt><a name="feature2.14"></a><span class="GUI">Surface tension</span> text box</dt>
            <dd>
                <p>Specify the surface tension to be used. Only available for the NPγT ensemble class.</p>
            </dd>
            <dt><a name="feature2.15"></a><span class="GUI">Relax model system before simulation</span> option</dt>
            <dd>
                <p>When selected, a series of minimizations and short molecular dynamics simulations are performed to relax the model system before performing the simulation you set up. The relaxation procedure follows a default protocol. Normally, this option is needed only for model systems that have just been prepared with the <span class="GUI">System Builder</span> panel and have not been relaxed.</p>
            </dd>
            <dt><a name="feature2.16"></a><span class="GUI">Relaxation protocol</span> text box and <span class="GUI">Browse</span> button</dt>
            <dd>
                <p>Specify the protocol for the relaxation. The protocol is defined in an <code>.msj</code> file, which you can open by clicking <span class="GUI">Browse</span> and navigating to the file. The default protocol is described in the <i>Desmond User Manual</i>.</p>
            </dd>
            <dt><a name="feature2.17"></a><span class="GUI">Advanced options</span> button</dt>
            <dd>
                <p>Opens the <a href="advanced_options_db.html"><span class="GUI">Advanced Options</span> dialog box</a>, in which you can control many more of the detailed settings for the simulation than are available in the panel.</p>
            </dd>
        </dl>
        <h3><a name="job_toolbar"></a>Job toolbar</h3>
        <p>Manage job submission. See <a href="../maestro_help/job_toolbar.html">Job Toolbar</a> for a description of this toolbar.</p>
        <h3><a name="status_bar"></a>Status bar</h3>
        <p>The status bar displays information about the current job settings for the panel. This includes the job name, task name and task settings (if any), number of subjobs (if any) and the host name and job incorporation setting. It also displays a message for a short time when you start a new job.</p>
        <p>The status bar also contains the <span class="GUI">Help</span> button, which opens the help topic for the panel.</p>
        <p>
            <img src="../Resources/Images/Toolbuttons/help.png" />
        </p>
        <h2><a name="links"></a>Related Topics</h2>
        <ul>
            <li value="1"><a href="advanced_options_db.html" class="MCXref xref" xrefformat="{paratext}">Desmond — Advanced Options Dialog Box</a>
            </li>
            <li value="2"><a class="TopicLink MCXref xref xrefTopicLink" href="../desmond_user_manual/desmond_panels_md.htm#desmond_panels_3537631757_743821" xrefformat="{paratext}">Desmond Molecular Dynamics Simulations</a>
            </li>
        </ul>
    </body>
</html>