

<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>Product Specific Modules &mdash; Schrödinger Python Suite 2012 Documentation</title>
    <link rel="stylesheet" href="_static/default.css" type="text/css" />
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '',
        VERSION:     '4.1',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="_static/jquery.js"></script>
    <script type="text/javascript" src="_static/underscore.js"></script>
    <script type="text/javascript" src="_static/doctools.js"></script>
    <link rel="top" title="Schrödinger Python Suite 2012 Documentation" href="index.html" />
    <link rel="next" title="Canvas 1.4 Python API" href="canvas.html" />
    <link rel="prev" title="Interacting with Maestro" href="maestro_overview.html" /> 
  </head>
  <body>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="canvas.html" title="Canvas 1.4 Python API"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="maestro_overview.html" title="Interacting with Maestro"
             accesskey="P">previous</a> |</li>
        <li><a href="overview.html">Schrödinger Python Suite 2012 Documentation</a> &raquo;</li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body">
            
  <div class="section" id="product-specific-modules">
<h1>Product Specific Modules<a class="headerlink" href="#product-specific-modules" title="Permalink to this headline">¶</a></h1>
<span class="target" id="index-0"></span><div class="section" id="canvas">
<h2>Canvas<a class="headerlink" href="#canvas" title="Permalink to this headline">¶</a></h2>
<div class="section" id="the-python-canvas-package">
<h3>The Python Canvas Package<a class="headerlink" href="#the-python-canvas-package" title="Permalink to this headline">¶</a></h3>
<p>The <a class="reference external" href="api/schrodinger.application.canvas-module.html">canvas package</a> contains links to the various Canvas Python modules,
including modules for fingerprint generation, similarity, and clustering.
See the <a class="reference internal" href="canvas.html#canvas-api"><em>Canvas 1.4 Python API</em></a> documentation for details on using the core
classes. These modules hide many of the lower-level details of fingerprint
generation and related tasks, as well as providing standard GUI and command
line components that allow setting all the options for fingerprint,
similarity and clustering.</p>
</div>
<div class="section" id="checking-out-a-canvas-license">
<h3>Checking out a Canvas License<a class="headerlink" href="#checking-out-a-canvas-license" title="Permalink to this headline">¶</a></h3>
<p>Using the Canvas Python API requires a Canvas license. Scripts that intend
to use Canvas functionality must first checkout a Canvas license using the
following lines of code:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="kn">import</span> <span class="nn">schrodinger.application.canvas.utils</span> <span class="kn">as</span> <span class="nn">canvasutils</span>
<span class="n">lic</span> <span class="o">=</span> <span class="n">canvasutils</span><span class="o">.</span><span class="n">get_license</span><span class="p">(</span><span class="n">canvasutils</span><span class="o">.</span><span class="n">LICENSE_FULL</span><span class="p">)</span>
</pre></div>
</div>
<p>If no license is available, the <a class="reference external" href="api/schrodinger.application.canvas.utils-module.html#get_license">get_license</a> function will raise an
<tt class="xref py py-exc docutils literal"><span class="pre">Exception</span></tt>.  The variable <tt class="docutils literal"><span class="pre">lic</span></tt> must remain in scope as long as any
Canvas functionality is intended to be used. When it goes out of scope, the
license is released.</p>
</div>
<div class="section" id="converting-structures-to-chmmol-objects">
<h3>Converting Structures to ChmMol Objects<a class="headerlink" href="#converting-structures-to-chmmol-objects" title="Permalink to this headline">¶</a></h3>
<p>Low-level Canvas functions do not use <tt class="xref py py-obj docutils literal"><span class="pre">Structure</span></tt> objects directly but
instead use <tt class="xref py py-obj docutils literal"><span class="pre">ChmMol</span></tt> objects. To convert between the two use the following
(&#8220;st&#8221; is a Structure object obtained using one of the methods described
earlier in the document):</p>
<div class="highlight-python"><div class="highlight"><pre><span class="kn">import</span> <span class="nn">schrodinger.application.canvas.base</span> <span class="kn">as</span> <span class="nn">canvas</span>

<span class="n">adaptor</span> <span class="o">=</span> <span class="n">canvas</span><span class="o">.</span><span class="n">ChmMmctAdaptor</span><span class="p">()</span>
<span class="n">mol</span> <span class="o">=</span> <span class="n">adaptor</span><span class="o">.</span><span class="n">create</span><span class="p">(</span><span class="n">st</span><span class="o">.</span><span class="n">handle</span><span class="p">,</span> <span class="n">canvas</span><span class="o">.</span><span class="n">ChmMmctAdaptor</span><span class="o">.</span><span class="n">NoStereo</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="section" id="fingerprint-generation-and-similarity">
<h3>Fingerprint Generation and Similarity<a class="headerlink" href="#fingerprint-generation-and-similarity" title="Permalink to this headline">¶</a></h3>
<p>What follows is a simple example showing how to generate fingerprints
for two structures and calculate the similarity between the two
structures based on those fingerprints:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="kn">from</span> <span class="nn">schrodinger</span> <span class="kn">import</span> <span class="n">structure</span>
<span class="kn">from</span> <span class="nn">schrodinger.application.canvas</span> <span class="kn">import</span> <span class="n">fingerprint</span>
<span class="kn">from</span> <span class="nn">schrodinger.application.canvas</span> <span class="kn">import</span> <span class="n">similarity</span>
<span class="kn">from</span> <span class="nn">schrodinger.utils</span> <span class="kn">import</span> <span class="n">log</span>
<span class="kn">import</span> <span class="nn">sys</span>

<span class="kn">import</span> <span class="nn">schrodinger.application.canvas.base</span> <span class="kn">as</span> <span class="nn">canvas</span>

<span class="n">lic</span> <span class="o">=</span> <span class="n">canvas</span><span class="o">.</span><span class="n">ChmLicenseFull</span><span class="p">()</span>
<span class="k">if</span> <span class="ow">not</span> <span class="n">lic</span><span class="o">.</span><span class="n">isValid</span><span class="p">():</span>
    <span class="k">print</span> <span class="s">&quot;A full Canvas license is required&quot;</span>
    <span class="n">sys</span><span class="o">.</span><span class="n">exit</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>

<span class="n">logger</span> <span class="o">=</span> <span class="n">log</span><span class="o">.</span><span class="n">get_output_logger</span><span class="p">(</span><span class="s">&quot;FPExample:&quot;</span><span class="p">)</span>
<span class="n">fp_gen</span> <span class="o">=</span> <span class="n">fingerprint</span><span class="o">.</span><span class="n">CanvasFingerprintGenerator</span><span class="p">(</span> <span class="n">logger</span><span class="o">=</span><span class="n">logger</span> <span class="p">)</span>
<span class="n">fp_sim</span> <span class="o">=</span> <span class="n">similarity</span><span class="o">.</span><span class="n">CanvasFingerprintSimilarity</span><span class="p">(</span> <span class="n">logger</span><span class="o">=</span><span class="n">logger</span> <span class="p">)</span>

<span class="c"># Read first and second structures from input file</span>
<span class="n">sr</span> <span class="o">=</span> <span class="n">structure</span><span class="o">.</span><span class="n">StructureReader</span><span class="p">(</span><span class="n">sys</span><span class="o">.</span><span class="n">argv</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
<span class="n">st1</span> <span class="o">=</span> <span class="n">sr</span><span class="o">.</span><span class="n">next</span><span class="p">()</span>
<span class="n">st2</span> <span class="o">=</span> <span class="n">sr</span><span class="o">.</span><span class="n">next</span><span class="p">()</span>

<span class="c"># Generate with default fingerprint settings:</span>
<span class="n">fp1</span> <span class="o">=</span> <span class="n">fp_gen</span><span class="o">.</span><span class="n">generate</span><span class="p">(</span><span class="n">st1</span><span class="p">)</span>
<span class="n">fp2</span> <span class="o">=</span> <span class="n">fp_gen</span><span class="o">.</span><span class="n">generate</span><span class="p">(</span><span class="n">st2</span><span class="p">)</span>

<span class="c"># Calculate and print similarity:</span>
<span class="n">fp_sim</span><span class="o">.</span><span class="n">setMetric</span><span class="p">(</span><span class="s">&quot;Tanimoto&quot;</span><span class="p">)</span>
<span class="k">print</span> <span class="s">&quot;Tanimoto Similarity = </span><span class="si">%5.2f</span><span class="s">&quot;</span> <span class="o">%</span> <span class="n">fp_sim</span><span class="o">.</span><span class="n">calculateSimilarity</span><span class="p">(</span><span class="n">fp1</span><span class="p">,</span><span class="n">fp2</span><span class="p">)</span>
<span class="n">fp_sim</span><span class="o">.</span><span class="n">setMetric</span><span class="p">(</span><span class="s">&quot;Dice&quot;</span><span class="p">)</span>
<span class="k">print</span> <span class="s">&quot;Dice Similarity     = </span><span class="si">%5.2f</span><span class="s">&quot;</span> <span class="o">%</span> <span class="n">fp_sim</span><span class="o">.</span><span class="n">calculateSimilarity</span><span class="p">(</span><span class="n">fp1</span><span class="p">,</span><span class="n">fp2</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="desmond">
<span id="index-1"></span><h2>Desmond<a class="headerlink" href="#desmond" title="Permalink to this headline">¶</a></h2>
<p>The <a class="reference external" href="api/schrodinger.application.desmond-module.html">desmond</a> and <a class="reference external" href="api/schrodinger.trajectory-module.html">schrodinger.trajectory</a> packages contain modules for
various Desmond-related operations.  For example, to extract frame 47 from a
trajectory:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="kn">from</span> <span class="nn">schrodinger.trajectory.desmondsimulation</span> <span class="kn">import</span> <span class="n">DesmondSimulation</span>
<span class="n">csim</span> <span class="o">=</span> <span class="n">DesmondSimulation</span><span class="p">(</span><span class="n">cms_file</span><span class="p">,</span> <span class="n">trj_directory</span><span class="p">)</span>
<span class="n">frame</span> <span class="o">=</span> <span class="n">csim</span><span class="o">.</span><span class="n">getFrame</span><span class="p">(</span><span class="mi">47</span><span class="p">)</span>
<span class="n">st</span> <span class="o">=</span> <span class="n">frame</span><span class="o">.</span><span class="n">getStructure</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="section" id="glide">
<span id="index-2"></span><h2>Glide<a class="headerlink" href="#glide" title="Permalink to this headline">¶</a></h2>
<p>The <a class="reference external" href="api/schrodinger.application.glide-module.html">glide package</a> helps to set up Glide jobs via keyword-value pairs.</p>
<div class="section" id="calculate-enrichment-from-virtual-screening">
<h3>Calculate Enrichment from Virtual Screening<a class="headerlink" href="#calculate-enrichment-from-virtual-screening" title="Permalink to this headline">¶</a></h3>
<p>The <a class="reference external" href="api/schrodinger.analysis.enrichment-module.html">analysis.enrichment module</a> helps to calculate enrichments based on
known actives and the number of decoys in screen.</p>
<div class="highlight-python"><div class="highlight"><pre><span class="kn">import</span> <span class="nn">schrodinger.analysis.enrichment</span> <span class="kn">as</span> <span class="nn">enrichment</span>
<span class="n">efcalc</span> <span class="o">=</span> <span class="n">enrichment</span><span class="o">.</span><span class="n">Calculator</span><span class="p">(</span>
    <span class="n">actives_file_name</span> <span class="o">=</span> <span class="s">&quot;my_actives.txt&quot;</span><span class="p">,</span>  <span class="c"># Active titles, one per line.</span>
    <span class="n">results</span> <span class="o">=</span> <span class="s">&quot;screen_results.rept&quot;</span><span class="p">,</span>       <span class="c"># Glide report file.</span>
    <span class="n">total_decoys</span> <span class="o">=</span> <span class="mi">1000</span>
<span class="p">)</span>
<span class="n">efcalc</span><span class="o">.</span><span class="n">calculateMetrics</span><span class="p">()</span>         <span class="c"># Calculate a default suite of terms.</span>
<span class="n">efcalc</span><span class="o">.</span><span class="n">report</span><span class="p">()</span>                   <span class="c"># Print default report to standard out.</span>
<span class="n">efcalc</span><span class="o">.</span><span class="n">savePlot</span><span class="p">()</span>                 <span class="c"># Create default graph png.</span>
<span class="k">print</span> <span class="n">efcalc</span><span class="o">.</span><span class="n">calcBEDROC</span><span class="p">(</span><span class="n">alpha</span><span class="o">=</span><span class="mi">20</span><span class="p">)</span> <span class="c"># Print the BEDROC metric value</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="jaguar">
<span id="index-3"></span><h2>Jaguar<a class="headerlink" href="#jaguar" title="Permalink to this headline">¶</a></h2>
<p>The <a class="reference external" href="api/schrodinger.application.jaguar-module.html">jaguar package</a> helps to set up Jaguar (QM) tasks. For example, to set
up and run a Jaguar 6-31g** geometry optimization:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="kn">import</span> <span class="nn">schrodinger.application.jaguar.input</span> <span class="kn">as</span> <span class="nn">jagInput</span>
<span class="kn">import</span> <span class="nn">schrodinger.job.jobcontrol</span> <span class="kn">as</span> <span class="nn">jc</span>
<span class="nb">input</span> <span class="o">=</span> <span class="n">jagInput</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="s">&quot;inputFile.mae&quot;</span><span class="p">)</span>
<span class="nb">input</span><span class="o">.</span><span class="n">setValue</span><span class="p">(</span><span class="s">&quot;basis&quot;</span><span class="p">,</span><span class="s">&quot;6-31G**&quot;</span><span class="p">)</span>
<span class="nb">input</span><span class="o">.</span><span class="n">setValue</span><span class="p">(</span><span class="s">&quot;dftname&quot;</span><span class="p">,</span><span class="s">&quot;B3LYP&quot;</span><span class="p">)</span>
<span class="nb">input</span><span class="o">.</span><span class="n">setValue</span><span class="p">(</span><span class="s">&quot;igeopt&quot;</span><span class="p">,</span><span class="s">&quot;1&quot;</span><span class="p">)</span> <span class="c"># Do geometry optimization</span>
<span class="n">jagFileName</span> <span class="o">=</span> <span class="s">&quot;jag631.in&quot;</span>
<span class="nb">input</span><span class="o">.</span><span class="n">saveAs</span><span class="p">(</span><span class="n">jagFileName</span><span class="p">)</span>
<span class="n">run_command</span> <span class="o">=</span> <span class="p">[</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">environ</span><span class="p">[</span><span class="s">&#39;SCHRODINGER&#39;</span><span class="p">],</span> <span class="s">&#39;jaguar&#39;</span><span class="p">),</span>
               <span class="s">&quot;run&quot;</span><span class="p">,</span>
               <span class="n">jagFileName</span><span class="p">]</span>
<span class="n">job</span> <span class="o">=</span> <span class="n">jc</span><span class="o">.</span><span class="n">launch_job</span><span class="p">(</span><span class="n">run_command</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="section" id="macromodel">
<span id="index-4"></span><h2>MacroModel<a class="headerlink" href="#macromodel" title="Permalink to this headline">¶</a></h2>
<p>The <a class="reference external" href="api/schrodinger.application.macromodel-module.html">macromodel package</a> helps to set up and run MacroModel tasks. To use
this module productively, you should be familiar with the MacroModel
Reference Manual. As a starting point, see the documentation for the
<a class="reference external" href="api/schrodinger.application.macromodel.utils.ComUtil-class.html">ComUtil</a> and <a class="reference external" href="api/schrodinger.application.macromodel.utils.SbcUtil-class.html">SbcUtil</a> classes.</p>
<p>A few examples of simplified scripts follow.</p>
<p>Set up and run a Monte Carlo multiple minimum conformation search job with
non-default options:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="kn">import</span> <span class="nn">schrodinger.application.macromodel.utils</span> <span class="kn">as</span> <span class="nn">mmodutils</span>
<span class="kn">import</span> <span class="nn">schrodinger.job.jobcontrol</span> <span class="kn">as</span> <span class="nn">jc</span>
<span class="kn">import</span> <span class="nn">sys</span>

<span class="n">mcu</span> <span class="o">=</span> <span class="n">mmodutils</span><span class="o">.</span><span class="n">ComUtil</span><span class="p">(</span><span class="n">ffld</span><span class="o">=</span><span class="s">&#39;mmffs&#39;</span><span class="p">)</span>

<span class="c"># Use extended torsion sampling.</span>
<span class="n">mcu</span><span class="o">.</span><span class="n">AUTO</span><span class="p">[</span><span class="mi">8</span><span class="p">]</span> <span class="o">=</span> <span class="mi">3</span>

<span class="c"># Write the com file for a Monte Carlo multiple minimum conformation</span>
<span class="c"># search. (To actually run this script, you need to set</span>
<span class="c"># input_structure_file.)</span>
<span class="n">com_file</span> <span class="o">=</span> <span class="n">mcu</span><span class="o">.</span><span class="n">mcmm</span><span class="p">(</span><span class="n">input_structure_file</span><span class="p">)</span>

<span class="n">cmd_args</span> <span class="o">=</span> <span class="n">mcu</span><span class="o">.</span><span class="n">getLaunchCommand</span><span class="p">(</span><span class="n">com_file</span><span class="p">)</span>
<span class="n">job</span> <span class="o">=</span> <span class="n">jc</span><span class="o">.</span><span class="n">launch_job</span><span class="p">(</span><span class="n">cmd_args</span><span class="p">)</span>
<span class="n">job</span><span class="o">.</span><span class="n">wait</span><span class="p">()</span>

<span class="k">print</span> <span class="p">(</span><span class="s">&quot;MCMM job status: </span><span class="si">%s</span><span class="s">&quot;</span> <span class="o">%</span> <span class="n">job</span><span class="o">.</span><span class="n">Status</span><span class="p">)</span>
<span class="n">mcmm_output_file</span> <span class="o">=</span> <span class="n">job</span><span class="o">.</span><span class="n">StructureOutputFile</span>
</pre></div>
</div>
<p>Set up and run a geometry minimization with restraints defined by an Atom
Selection Language expression. This is specified within a MacroModel
substructure file with the <tt class="docutils literal"><span class="pre">ASL2</span></tt> code.</p>
<div class="highlight-python"><div class="highlight"><pre><span class="kn">import</span> <span class="nn">schrodinger.application.macromodel.utils</span> <span class="kn">as</span> <span class="nn">mmodutils</span>
<span class="kn">import</span> <span class="nn">schrodinger.job.jobcontrol</span> <span class="kn">as</span> <span class="nn">jc</span>

<span class="n">mcu</span> <span class="o">=</span> <span class="n">mmodutils</span><span class="o">.</span><span class="n">ComUtil</span><span class="p">(</span><span class="n">subs</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>

<span class="c"># Write the com file for a geometry optimization.</span>
<span class="c"># (To run this script, you should set input_structure_file. For the</span>
<span class="c"># script to do something interesting, the input structure file should</span>
<span class="c"># have more than one molecule. :-)</span>
<span class="n">com_file</span> <span class="o">=</span> <span class="n">mcu</span><span class="o">.</span><span class="n">mini</span><span class="p">(</span><span class="n">input_structure_file</span><span class="p">)</span>

<span class="c"># Set up the MacroModel substructure file.</span>
<span class="n">sbu</span> <span class="o">=</span> <span class="n">mmodutils</span><span class="o">.</span><span class="n">SbcUtil</span><span class="p">()</span>

<span class="c"># Specify the force constant for Cartesian restraints.</span>
<span class="n">sbu</span><span class="o">.</span><span class="n">ASL2</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="mi">200</span>
<span class="c"># Specify the ASL identifying the restrained atoms.</span>
<span class="n">sbu</span><span class="o">.</span><span class="n">ASL2</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="s">&#39;mol.n 1&#39;</span>
<span class="n">sbu_args</span> <span class="o">=</span> <span class="p">[</span><span class="n">com_file</span><span class="p">,</span> <span class="s">&#39;ASL2&#39;</span><span class="p">]</span>
<span class="n">sbc_file</span> <span class="o">=</span> <span class="n">sbu</span><span class="o">.</span><span class="n">writeSbcFile</span><span class="p">(</span><span class="n">sbu_args</span><span class="p">)</span>

<span class="n">cmd_args</span> <span class="o">=</span> <span class="n">mcu</span><span class="o">.</span><span class="n">getLaunchCommand</span><span class="p">(</span><span class="n">com_file</span><span class="p">)</span>
<span class="n">job</span> <span class="o">=</span> <span class="n">jc</span><span class="o">.</span><span class="n">launch_job</span><span class="p">(</span><span class="n">cmd_args</span><span class="p">)</span>
<span class="n">job</span><span class="o">.</span><span class="n">wait</span><span class="p">()</span>

<span class="k">print</span> <span class="p">(</span><span class="s">&quot;MINI job status: </span><span class="si">%s</span><span class="s">&quot;</span> <span class="o">%</span> <span class="n">job</span><span class="o">.</span><span class="n">Status</span><span class="p">)</span>
<span class="n">mini_output_file</span> <span class="o">=</span> <span class="n">job</span><span class="o">.</span><span class="n">StructureOutputFile</span>
</pre></div>
</div>
<p>Set up and run a systematic pseudo-Monte Carlo conformation search,
dynamically assigning restraints to a ligand core (<tt class="docutils literal"><span class="pre">SUBS</span></tt> and <tt class="docutils literal"><span class="pre">FXAT</span></tt>):</p>
<div class="highlight-python"><div class="highlight"><pre><span class="kn">import</span> <span class="nn">schrodinger.application.macromodel.utils</span> <span class="kn">as</span> <span class="nn">mmodutils</span>
<span class="kn">import</span> <span class="nn">schrodinger.structutils.analyze</span> <span class="kn">as</span> <span class="nn">analyze</span>
<span class="kn">import</span> <span class="nn">schrodinger.structure</span> <span class="kn">as</span> <span class="nn">structure</span>

<span class="n">mcu</span> <span class="o">=</span> <span class="n">mmodutils</span><span class="o">.</span><span class="n">ComUtil</span><span class="p">(</span><span class="n">subs</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>

<span class="c"># Write the com file for a systematic pseudo-Monte Carlo multiple</span>
<span class="c"># minimum conformation search.</span>
<span class="n">com_file</span> <span class="o">=</span> <span class="n">mcu</span><span class="o">.</span><span class="n">spmc</span><span class="p">(</span><span class="n">input_structure_file</span><span class="p">)</span>

<span class="c"># Find the atoms to be restrained via ASL and SMARTS; anything in a</span>
<span class="c"># 6-membered ring.</span>
<span class="n">st</span> <span class="o">=</span> <span class="n">structure</span><span class="o">.</span><span class="n">StructureReader</span><span class="p">(</span><span class="n">input_structure_file</span><span class="p">)</span><span class="o">.</span><span class="n">next</span><span class="p">()</span>
<span class="n">core_pattern</span> <span class="o">=</span> <span class="s">&#39;SMARTS. &quot;r6&quot;&#39;</span>
<span class="n">core_atoms</span> <span class="o">=</span> <span class="n">analyze</span><span class="o">.</span><span class="n">evaluate_asl</span><span class="p">(</span><span class="n">st</span><span class="p">,</span> <span class="s">&quot;withinbonds 1 </span><span class="si">%s</span><span class="s">&quot;</span> <span class="o">%</span> <span class="n">core_pattern</span><span class="p">)</span>
<span class="n">attachment_atoms</span> <span class="o">=</span> <span class="n">analyze</span><span class="o">.</span><span class="n">evaluate_asl</span><span class="p">(</span><span class="n">st</span><span class="p">,</span> <span class="s">&quot;not withinbonds 1 </span><span class="si">%s</span><span class="s">&quot;</span> <span class="o">%</span> <span class="n">core_pattern</span><span class="p">)</span>

<span class="c"># Set up and write the substructure file with the restraints.</span>
<span class="n">sbu</span> <span class="o">=</span> <span class="n">mmodutils</span><span class="o">.</span><span class="n">SbcUtil</span><span class="p">()</span>
<span class="n">sbc_args</span> <span class="o">=</span> <span class="p">[</span><span class="n">com_file</span><span class="p">]</span>
<span class="n">sbc_args</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">sbu</span><span class="o">.</span><span class="n">setSubs</span><span class="p">(</span><span class="n">attachment_atoms</span><span class="p">))</span>
<span class="n">sbc_args</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">sbu</span><span class="o">.</span><span class="n">setFixed</span><span class="p">(</span><span class="n">core_atoms</span><span class="p">))</span>
<span class="n">sbu</span><span class="o">.</span><span class="n">writeSbcFile</span><span class="p">(</span><span class="n">sbc_args</span><span class="p">)</span>

<span class="n">cmd_args</span> <span class="o">=</span> <span class="n">mcu</span><span class="o">.</span><span class="n">getLaunchCommand</span><span class="p">(</span><span class="n">com_file</span><span class="p">)</span>
<span class="n">job</span> <span class="o">=</span> <span class="n">jc</span><span class="o">.</span><span class="n">launch_job</span><span class="p">(</span><span class="n">cmd_args</span><span class="p">)</span>
<span class="n">job</span><span class="o">.</span><span class="n">wait</span><span class="p">()</span>

<span class="k">print</span> <span class="p">(</span><span class="s">&quot;SPMC job status: </span><span class="si">%s</span><span class="s">&quot;</span> <span class="o">%</span> <span class="n">job</span><span class="o">.</span><span class="n">Status</span><span class="p">)</span>
<span class="n">spmc_output_file</span> <span class="o">=</span> <span class="n">job</span><span class="o">.</span><span class="n">StructureOutputFile</span>
</pre></div>
</div>
</div>
<div class="section" id="mcpro">
<span id="index-5"></span><h2>MCPRO+<a class="headerlink" href="#mcpro" title="Permalink to this headline">¶</a></h2>
<p>The <a class="reference external" href="api/schrodinger.application.mcpro-module.html">mcpro package</a> contains a <a class="reference external" href="api/schrodinger.application.mcpro.zmat-module.html">zmat module</a> for working with zmat
structures. It also contains various helper functions for the MCPRO+ GUI.</p>
</div>
<div class="section" id="prime">
<span id="index-6"></span><h2>Prime<a class="headerlink" href="#prime" title="Permalink to this headline">¶</a></h2>
<p>The <a class="reference external" href="api/schrodinger.application.prime-module.html">prime package</a> contains modules for reading and writing Prime input
files and for fixing structures for use with Prime.</p>
<p>The <a class="reference external" href="api/schrodinger.protein-module.html">protein package</a> contains other modules for protein-related tasks,
such as:</p>
<blockquote>
<ul class="simple">
<li>The <a class="reference external" href="api/schrodinger.protein.assignment-module.html">assignment module</a> for optimizing hydroxyl, thiol and water
orientiations, Chi-flips of asparagine, glutamine and histidine, and
protonation states of aspartic acid, glutamic acid, and histidine.</li>
<li>The <a class="reference external" href="api/schrodinger.protein.captermini-module.html">captermini module</a> for capping uncapped terminal residues.</li>
<li>The <a class="reference external" href="api/schrodinger.protein.findhets-module.html">findhets module</a> for finding <em>het</em> (non-protein) compounds in
structures.</li>
<li>The <a class="reference external" href="api/schrodinger.protein.rotamers-module.html">rotamers module</a> provides a rotamer library that can be applied
to protein sidechains.</li>
</ul>
</blockquote>
<p>The <tt class="file docutils literal"><span class="pre">adjust_residue_numbering_panel.py</span></tt> script on the <a class="reference external" href="http://www.schrodinger.com/scripts2012.html">Script
Center</a> contains an example of protein structure alignment. The script
also renumbers protein residues based on the alignment.</p>
<p>In addition, the <a class="reference external" href="api/schrodinger.structutils.build-module.html">schrodinger.structutils.build</a> module contains a useful
<tt class="xref py py-obj docutils literal"><span class="pre">mutate</span></tt> function.</p>
<p>Here is an example of residue mutation and rotamer-library sampling:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="kn">from</span> <span class="nn">schrodinger.structutils</span> <span class="kn">import</span> <span class="n">build</span>
<span class="kn">from</span> <span class="nn">schrodinger.protein</span> <span class="kn">import</span> <span class="n">rotamers</span>

<span class="n">residue</span> <span class="o">=</span> <span class="n">st</span><span class="o">.</span><span class="n">residue</span><span class="p">[</span><span class="n">index_of_residue_to_mutate</span><span class="p">]</span>
<span class="c"># Here, mut_type is the three-letter code for the new residue.</span>
<span class="n">build</span><span class="o">.</span><span class="n">mutate</span><span class="p">(</span><span class="n">st</span><span class="p">,</span> <span class="n">residue</span><span class="o">.</span><span class="n">atom</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">mut_type</span><span class="p">)</span>
<span class="n">rotamer_lib</span> <span class="o">=</span> <span class="n">rotamers</span><span class="o">.</span><span class="n">Rotamers</span><span class="p">(</span> <span class="n">st</span><span class="p">,</span> <span class="n">residue</span><span class="o">.</span><span class="n">atom</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="p">)</span>
<span class="k">for</span> <span class="n">rotamer</span> <span class="ow">in</span> <span class="n">rotamer_lib</span><span class="o">.</span><span class="n">rotamers</span><span class="p">:</span>
    <span class="n">rotamer</span><span class="o">.</span><span class="n">apply</span><span class="p">()</span>
    <span class="c"># Operate on the new structure - compute energy, analyze or write</span>
    <span class="c"># the structure.</span>
</pre></div>
</div>
<p>The <a class="reference external" href="api/schrodinger.application.prepwizard-module.html">prepwizard module</a> also contains useful functions for manipulating
protein structures. For example, to fill missing loops in a protein
structure, based on a FASTA file sequence:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="kn">import</span> <span class="nn">schrodinger.application.prepwizard</span> <span class="kn">as</span> <span class="nn">pw</span>
<span class="n">filled_st</span> <span class="o">=</span> <span class="n">pw</span><span class="o">.</span><span class="n">fill_missing_loops</span><span class="p">(</span><span class="n">input_st</span><span class="p">,</span> <span class="n">fasta_file</span><span class="p">,</span> <span class="n">prime_jobname</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="section" id="qsite">
<span id="index-7"></span><h2>QSite<a class="headerlink" href="#qsite" title="Permalink to this headline">¶</a></h2>
<p>The <a class="reference external" href="api/schrodinger.application.qsite-module.html">qsite package</a> helps to set up QSite jobs.</p>
</div>
<div class="section" id="vsw">
<span id="index-8"></span><h2>VSW<a class="headerlink" href="#vsw" title="Permalink to this headline">¶</a></h2>
<p>The <a class="reference external" href="api/schrodinger.application.vsw-module.html">vsw package</a> contains modules for
<abbr title="Virtual Screening Workflow">VSW</abbr>, including pipelining functionality
for VSW jobs.</p>
<p>For example, to use VSW pipelining to write a QikProp job for a file of
ligands <tt class="docutils literal"><span class="pre">ligands_file</span></tt>:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="kn">import</span> <span class="nn">schrodinger.application.vsw.input</span> <span class="kn">as</span> <span class="nn">vswinput</span>
<span class="n">input_file</span> <span class="o">=</span> <span class="n">jobname</span> <span class="o">+</span> <span class="s">&#39;.inp&#39;</span>
<span class="n">txt</span><span class="o">=</span><span class="s">&quot;&quot;&quot;</span>
<span class="s">&quot;&quot;&quot;</span>
<span class="n">writer</span> <span class="o">=</span> <span class="n">vswinput</span><span class="o">.</span><span class="n">Writer</span><span class="p">(</span><span class="n">input_file</span><span class="p">,</span> <span class="n">comment</span><span class="o">=</span><span class="n">txt</span><span class="p">)</span>
<span class="n">writer</span><span class="o">.</span><span class="n">addVar</span><span class="p">(</span><span class="s">&#39;LIGANDS&#39;</span><span class="p">,</span> <span class="s">&#39;Structures&#39;</span><span class="p">,</span> <span class="p">[</span><span class="n">ligands_file</span><span class="p">])</span>
<span class="n">writer</span><span class="o">.</span><span class="n">addStage</span><span class="p">(</span><span class="s">&#39;RUN_QIKPROP&#39;</span><span class="p">,</span>
                <span class="s">&#39;qikprop.QikPropStage&#39;</span><span class="p">,</span>
                <span class="p">[</span><span class="s">&#39;LIGANDS&#39;</span><span class="p">],</span>
                <span class="p">[</span><span class="s">&#39;OUTPUT_LIGANDS&#39;</span><span class="p">])</span>
<span class="n">writer</span><span class="o">.</span><span class="n">write</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>


          </div>
        </div>
      </div>
      <div class="sphinxsidebar">
        <div class="sphinxsidebarwrapper">
  <h3><a href="overview.html">Table Of Contents</a></h3>
  <ul>
<li><a class="reference internal" href="#">Product Specific Modules</a><ul>
<li><a class="reference internal" href="#canvas">Canvas</a><ul>
<li><a class="reference internal" href="#the-python-canvas-package">The Python Canvas Package</a></li>
<li><a class="reference internal" href="#checking-out-a-canvas-license">Checking out a Canvas License</a></li>
<li><a class="reference internal" href="#converting-structures-to-chmmol-objects">Converting Structures to ChmMol Objects</a></li>
<li><a class="reference internal" href="#fingerprint-generation-and-similarity">Fingerprint Generation and Similarity</a></li>
</ul>
</li>
<li><a class="reference internal" href="#desmond">Desmond</a></li>
<li><a class="reference internal" href="#glide">Glide</a><ul>
<li><a class="reference internal" href="#calculate-enrichment-from-virtual-screening">Calculate Enrichment from Virtual Screening</a></li>
</ul>
</li>
<li><a class="reference internal" href="#jaguar">Jaguar</a></li>
<li><a class="reference internal" href="#macromodel">MacroModel</a></li>
<li><a class="reference internal" href="#mcpro">MCPRO+</a></li>
<li><a class="reference internal" href="#prime">Prime</a></li>
<li><a class="reference internal" href="#qsite">QSite</a></li>
<li><a class="reference internal" href="#vsw">VSW</a></li>
</ul>
</li>
</ul>

  <h4>Previous topic</h4>
  <p class="topless"><a href="maestro_overview.html"
                        title="previous chapter">Interacting with Maestro</a></p>
  <h4>Next topic</h4>
  <p class="topless"><a href="canvas.html"
                        title="next chapter">Canvas 1.4 Python API</a></p>
<div id="searchbox" style="display: none">
  <h3>Quick search</h3>
    <form class="search" action="search.html" method="get">
      <input type="text" name="q" size="18" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    <p class="searchtip" style="font-size: 90%">
    Enter search terms or a module, class or function name.
    </p>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="canvas.html" title="Canvas 1.4 Python API"
             >next</a> |</li>
        <li class="right" >
          <a href="maestro_overview.html" title="Interacting with Maestro"
             >previous</a> |</li>
        <li><a href="overview.html">Schrödinger Python Suite 2012 Documentation</a> &raquo;</li> 
      </ul>
    </div>
    <div class="footer">
        &copy; Copyright 2009-2011 Schrödinger, LLC.
      Created using <a href="http://sphinx.pocoo.org/">Sphinx</a> 1.0.4.
    </div>
  </body>
</html>