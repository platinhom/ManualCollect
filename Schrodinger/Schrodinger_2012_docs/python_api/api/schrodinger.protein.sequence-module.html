<?xml version="1.0" encoding="ascii"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
          "DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head>
  <title>schrodinger.protein.sequence</title>
  <link rel="stylesheet" href="epydoc.css" type="text/css" />
  <script type="text/javascript" src="epydoc.js"></script>
</head>

<body bgcolor="white" text="black" link="blue" vlink="#204080"
      alink="#204080">
<!-- ==================== NAVIGATION BAR ==================== -->
<table class="navbar" border="0" width="100%" cellpadding="0"
       bgcolor="#a0c0ff" cellspacing="0">
  <tr valign="middle">
  <!-- Home link -->
      <th>&nbsp;&nbsp;&nbsp;<a
        href="schrodinger-module.html">Home</a>&nbsp;&nbsp;&nbsp;</th>

  <!-- Tree link -->
      <th>&nbsp;&nbsp;&nbsp;<a
        href="module-tree.html">Trees</a>&nbsp;&nbsp;&nbsp;</th>

  <!-- Index link -->
      <th>&nbsp;&nbsp;&nbsp;<a
        href="identifier-index.html">Indices</a>&nbsp;&nbsp;&nbsp;</th>

  <!-- Help link -->
      <th>&nbsp;&nbsp;&nbsp;<a
        href="help.html">Help</a>&nbsp;&nbsp;&nbsp;</th>

  <!-- Project homepage -->
      <th class="navbar" align="right" width="100%">
        <table border="0" cellpadding="0" cellspacing="0">
          <tr><th class="navbar" align="center"
            >Suite 2012 Schrodinger Python API</th>
          </tr></table></th>
  </tr>
</table>
<table width="100%" cellpadding="0" cellspacing="0">
  <tr valign="top">
    <td width="100%">
      <span class="breadcrumbs">
        <a href="schrodinger-module.html">Package&nbsp;schrodinger</a> ::
        <a href="schrodinger.protein-module.html">Package&nbsp;protein</a> ::
        Module&nbsp;sequence
      </span>
    </td>
    <td>
      <table cellpadding="0" cellspacing="0">
        <!-- hide/show private -->
        <tr><td align="right"><span class="options">[<a href="javascript:void(0);" class="privatelink"
    onclick="toggle_private();">hide&nbsp;private</a>]</span></td></tr>
        <tr><td align="right"><span class="options"
            >[<a href="frames.html" target="_top">frames</a
            >]&nbsp;|&nbsp;<a href="schrodinger.protein.sequence-module.html"
            target="_top">no&nbsp;frames</a>]</span></td></tr>
      </table>
    </td>
  </tr>
</table>
<!-- ==================== MODULE DESCRIPTION ==================== -->
<h1 class="epydoc">Module sequence</h1><p class="nomargin-top"></p>
<p>This module allows to iterate over all sequences in a given protein 
  CT, and to iterate over residues of each (in sequence order).</p>

<!-- ==================== CLASSES ==================== -->
<a name="section-Classes"></a>
<table class="summary" border="1" cellpadding="3"
       cellspacing="0" width="100%" bgcolor="white">
<tr bgcolor="#70b0f0" class="table-header">
  <td colspan="2" class="table-header">
    <table border="0" cellpadding="0" cellspacing="0" width="100%">
      <tr valign="top">
        <td align="left"><span class="table-header">Classes</span></td>
        <td align="right" valign="top"
         ><span class="options">[<a href="#section-Classes"
         class="privatelink" onclick="toggle_private();"
         >hide private</a>]</span></td>
      </tr>
    </table>
  </td>
</tr>
<tr>
    <td width="15%" align="right" valign="top" class="summary">
      <span class="summary-type">&nbsp;</span>
    </td><td class="summary">
        <a href="schrodinger.protein.sequence.Sequence-class.html" class="summary-name">Sequence</a><br />
      Class representing a sequence of protein residues.
    </td>
  </tr>
</table>
<!-- ==================== FUNCTIONS ==================== -->
<a name="section-Functions"></a>
<table class="summary" border="1" cellpadding="3"
       cellspacing="0" width="100%" bgcolor="white">
<tr bgcolor="#70b0f0" class="table-header">
  <td colspan="2" class="table-header">
    <table border="0" cellpadding="0" cellspacing="0" width="100%">
      <tr valign="top">
        <td align="left"><span class="table-header">Functions</span></td>
        <td align="right" valign="top"
         ><span class="options">[<a href="#section-Functions"
         class="privatelink" onclick="toggle_private();"
         >hide private</a>]</span></td>
      </tr>
    </table>
  </td>
</tr>
<tr>
    <td width="15%" align="right" valign="top" class="summary">
      <span class="summary-type">&nbsp;</span>
    </td><td class="summary">
      <table width="100%" cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td><span class="summary-sig"><a name="get_structure_sequences"></a><span class="summary-sig-name">get_structure_sequences</span>(<span class="summary-sig-arg">st</span>)</span><br />
      Iterates over all sequences in the given structure.</td>
          <td align="right" valign="top">
            
            
          </td>
        </tr>
      </table>
      
    </td>
  </tr>
<tr>
    <td width="15%" align="right" valign="top" class="summary">
      <span class="summary-type">&nbsp;</span>
    </td><td class="summary">
      <table width="100%" cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td><span class="summary-sig"><a href="schrodinger.protein.sequence-module.html#find_generalized_pattern" class="summary-sig-name">find_generalized_pattern</a>(<span class="summary-sig-arg">sequence_list</span>,
        <span class="summary-sig-arg">pattern</span>,
        <span class="summary-sig-arg">validate_pattern</span>=<span class="summary-sig-default">False</span>)</span><br />
      Finds a generalized sequence pattern within specified sequences.</td>
          <td align="right" valign="top">
            
            
          </td>
        </tr>
      </table>
      
    </td>
  </tr>
<tr>
    <td width="15%" align="right" valign="top" class="summary">
      <span class="summary-type">&nbsp;</span>
    </td><td class="summary">
      <table width="100%" cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td><span class="summary-sig"><a href="schrodinger.protein.sequence-module.html#convert_sequence_for_pattern_search" class="summary-sig-name">convert_sequence_for_pattern_search</a>(<span class="summary-sig-arg">seq</span>,
        <span class="summary-sig-arg">sasa_by_atom</span>=<span class="summary-sig-default">None</span>)</span><br />
      Converts a sequence object to dictonary required by 
      find_generalized_pattern function.</td>
          <td align="right" valign="top">
            
            
          </td>
        </tr>
      </table>
      
    </td>
  </tr>
<tr>
    <td width="15%" align="right" valign="top" class="summary">
      <span class="summary-type">list of lists of integer tuples or None</span>
    </td><td class="summary">
      <table width="100%" cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td><span class="summary-sig"><a href="schrodinger.protein.sequence-module.html#find_pattern" class="summary-sig-name">find_pattern</a>(<span class="summary-sig-arg">seq</span>,
        <span class="summary-sig-arg">pattern</span>)</span><br />
      Find pattern matches in a specified Sequence object.</td>
          <td align="right" valign="top">
            
            
          </td>
        </tr>
      </table>
      
    </td>
  </tr>
</table>
<!-- ==================== VARIABLES ==================== -->
<a name="section-Variables"></a>
<table class="summary" border="1" cellpadding="3"
       cellspacing="0" width="100%" bgcolor="white">
<tr bgcolor="#70b0f0" class="table-header">
  <td colspan="2" class="table-header">
    <table border="0" cellpadding="0" cellspacing="0" width="100%">
      <tr valign="top">
        <td align="left"><span class="table-header">Variables</span></td>
        <td align="right" valign="top"
         ><span class="options">[<a href="#section-Variables"
         class="privatelink" onclick="toggle_private();"
         >hide private</a>]</span></td>
      </tr>
    </table>
  </td>
</tr>
<tr>
    <td width="15%" align="right" valign="top" class="summary">
      <span class="summary-type">&nbsp;</span>
    </td><td class="summary">
        <a name="__package__"></a><span class="summary-name">__package__</span> = <code title="'schrodinger.protein'"><code class="variable-quote">'</code><code class="variable-string">schrodinger.protein</code><code class="variable-quote">'</code></code>
    </td>
  </tr>
</table>
<!-- ==================== FUNCTION DETAILS ==================== -->
<a name="section-FunctionDetails"></a>
<table class="details" border="1" cellpadding="3"
       cellspacing="0" width="100%" bgcolor="white">
<tr bgcolor="#70b0f0" class="table-header">
  <td colspan="2" class="table-header">
    <table border="0" cellpadding="0" cellspacing="0" width="100%">
      <tr valign="top">
        <td align="left"><span class="table-header">Function Details</span></td>
        <td align="right" valign="top"
         ><span class="options">[<a href="#section-FunctionDetails"
         class="privatelink" onclick="toggle_private();"
         >hide private</a>]</span></td>
      </tr>
    </table>
  </td>
</tr>
</table>
<a name="find_generalized_pattern"></a>
<div>
<table class="details" border="1" cellpadding="3"
       cellspacing="0" width="100%" bgcolor="white">
<tr><td>
  <table width="100%" cellpadding="0" cellspacing="0" border="0">
  <tr valign="top"><td>
  <h3 class="epydoc"><span class="sig"><span class="sig-name">find_generalized_pattern</span>(<span class="sig-arg">sequence_list</span>,
        <span class="sig-arg">pattern</span>,
        <span class="sig-arg">validate_pattern</span>=<span class="sig-default">False</span>)</span>
  </h3>
  </td><td align="right" valign="top"
    >&nbsp;
    </td>
  </tr></table>
  
  <pre class="literalblock">

Finds a generalized sequence pattern within specified sequences.
NOTE: The search is performed in the forward direction only.

@param: sequence_list
@type: list of sequences to search.

       Each sequence is a dictionary including amino acid strings 
       and associated data. The amino acid string should be ungapped. 
       The dictionary should include 'amino_acids' key and optionally 
       'secondary_structure', 'solvent_accessibility' and 'flexibility' 
       keys:
         
       - sequence is expressed as uppercase 1-letter code:

           sequence['amino_acids'] = 'ACDEFGHIKLMNPQRSTVWY' 
               (sequence in 1-letter code, mandatory)

       - secondary structure usese 'h', 'e' and ' ' symbols:

           sequence['secondary_structure'] = 'hhhhh     eeeee     '

       - solvent accessibility uses 'e' (exposed) and ' ' (buried)
           symbols:
           
           sequence['solvent_accessibiliy' = 'eeeee     eeeee     '

       - flexibility uses 'f' (flexible) and ' ' (not flexible)
           symbols:

           sequence['flexibility'] = '     fffff     fffff'

@param: pattern
@type: Pattern defined using extended PROSITE syntax.
        
       - standard IUPAC one-letter codes are used for all amino acids

       - each element in a pattern is separated using '-' symbol

       - symbol 'x' is used for position where any amino acid is accepted

       - ambiguities are listed using the acceptable amino acids between
         square brackets, e.g. [ACT] means Ala, Cys or Thr
       
       - amino acids not accepted for a given position are indicated 
         by listing them between curly brackets, e.g. {GP} means 'not Gly
         and not Pro' 

       - repetition is indicated using parentheses, e.g. A(3) means 
         Ala-Ala-Ala, x(2,4) means between 2 to 4 any residues
        
       - the following lowercase characters can be used as additional 
         flags:

           - 'x' means any amino acid
           - 'a' means acidic residue: [DE]
           - 'b' means basic residue: [KR]
           - 'o' means hydrophobic residue: [ACFILPWVY]
           - 'p' means aromatic residue: [WYF]
           - 's' means solvent exposed residue
           - 'h' means helical residue
           - 'e' means extended residue
           - 'f' means flexible residue

       - Each position can optionally by followed by @&lt;res_num&gt; expression
         that will match the position with a given residue number.

       - Entire pattern can be followed by :&lt;index&gt; expression that defines
         a 'hotspot' in the pattern. When the hotspot is defined, only
         a single residue corresponding to (pattern_match_start+index-1) 
         will be returned as a match. The index is 1-based and can be used 
         to place the hotspot outside of the pattern (can also be 
         a negative number).

    Pattern examples:

        - N-{P}-[ST] : Asn-X-Ser or Thr (X != Pro)
        - N[sf]-{P}[sf]-[ST][sf] : as above, but all residues flexible 
          OR solvent exposed
        - Nsf-{P}sf-[ST]sf : as above, but all residues flexible 
          AND solvent exposed
        - Ns{f} : Asn solvent exposed AND not in flexible region
        - N[s{f}] : Asn solvent exposed OR not in flexible region
        - [ab]{K}{s}f : acidic OR basic, with exception of Lys, 
          flexible AND not solvent exposed
        - Ahe : Ala helical AND extended - no match possible
        - A[he] : Ala helical OR extended
        - A{he} : Ala coiled chain conformation (not helical nor extended)
        - [ST] : Ser OR Thr
        - ST : Ser AND Thr - no match possible

@type validate_pattern: boolean
@param validate_pattern: If True, the function will validate the pattern
         without performing the search (the sequences parameter will be
         ignored) and return True if the pattern is valid, or False 
         otherwise. The default is False.

@rtype: list of lists of integer tuples or False if the pattern is invalid
@return: None if the specified input pattern was incorrect.
         Otherwise, it returns a list of lists of matches for each
         input sequence. Each match is a (start, end) tuple where
         start and end are matching sequence positions.

</pre>
  <dl class="fields">
  </dl>
</td></tr></table>
</div>
<a name="convert_sequence_for_pattern_search"></a>
<div>
<table class="details" border="1" cellpadding="3"
       cellspacing="0" width="100%" bgcolor="white">
<tr><td>
  <table width="100%" cellpadding="0" cellspacing="0" border="0">
  <tr valign="top"><td>
  <h3 class="epydoc"><span class="sig"><span class="sig-name">convert_sequence_for_pattern_search</span>(<span class="sig-arg">seq</span>,
        <span class="sig-arg">sasa_by_atom</span>=<span class="sig-default">None</span>)</span>
  </h3>
  </td><td align="right" valign="top"
    >&nbsp;
    </td>
  </tr></table>
  
  <p>Converts a sequence object to dictonary required by 
  find_generalized_pattern function. Because the conversion can be time 
  consuming, it should be done once per sequence.</p>
  <p>Optionally a list of atom SASAs for each atom in the CT can be 
  specified. If it's not specified, it will get calculated by calling 
  analyze.calculate_sasa_by_atom().</p>
  <dl class="fields">
  </dl>
</td></tr></table>
</div>
<a name="find_pattern"></a>
<div>
<table class="details" border="1" cellpadding="3"
       cellspacing="0" width="100%" bgcolor="white">
<tr><td>
  <table width="100%" cellpadding="0" cellspacing="0" border="0">
  <tr valign="top"><td>
  <h3 class="epydoc"><span class="sig"><span class="sig-name">find_pattern</span>(<span class="sig-arg">seq</span>,
        <span class="sig-arg">pattern</span>)</span>
  </h3>
  </td><td align="right" valign="top"
    >&nbsp;
    </td>
  </tr></table>
  
  <p>Find pattern matches in a specified Sequence object. Returns a list of
  matching positions.</p>
  <dl class="fields">
    <dt>Parameters:</dt>
    <dd><ul class="nomargin-top">
        <li><strong class="pname"><code>pattern</code></strong> (string) - Sequence pattern. The syntax is described in 
          find_generalized_pattern.</li>
    </ul></dd>
    <dt>Returns: list of lists of integer tuples or None</dt>
        <dd>None if the specified input pattern was incorrect. Otherwise, it 
          returns a list of lists of matches for each residue position in 
          the input structure. Each match is a (start, end) tuple where 
          start and end are matching sequence positions. If 'hotspot' is 
          specified then start = end.</dd>
  </dl>
</td></tr></table>
</div>
<br />
<!-- ==================== NAVIGATION BAR ==================== -->
<table class="navbar" border="0" width="100%" cellpadding="0"
       bgcolor="#a0c0ff" cellspacing="0">
  <tr valign="middle">
  <!-- Home link -->
      <th>&nbsp;&nbsp;&nbsp;<a
        href="schrodinger-module.html">Home</a>&nbsp;&nbsp;&nbsp;</th>

  <!-- Tree link -->
      <th>&nbsp;&nbsp;&nbsp;<a
        href="module-tree.html">Trees</a>&nbsp;&nbsp;&nbsp;</th>

  <!-- Index link -->
      <th>&nbsp;&nbsp;&nbsp;<a
        href="identifier-index.html">Indices</a>&nbsp;&nbsp;&nbsp;</th>

  <!-- Help link -->
      <th>&nbsp;&nbsp;&nbsp;<a
        href="help.html">Help</a>&nbsp;&nbsp;&nbsp;</th>

  <!-- Project homepage -->
      <th class="navbar" align="right" width="100%">
        <table border="0" cellpadding="0" cellspacing="0">
          <tr><th class="navbar" align="center"
            >Suite 2012 Schrodinger Python API</th>
          </tr></table></th>
  </tr>
</table>
<table border="0" cellpadding="0" cellspacing="0" width="100%%">
  <tr>
    <td align="left" class="footer">
    Generated by Epydoc 3.0.1 on Tue Sep 25 02:22:49 2012
    </td>
    <td align="right" class="footer">
      <a target="mainFrame" href="http://epydoc.sourceforge.net"
        >http://epydoc.sourceforge.net</a>
    </td>
  </tr>
</table>

<script type="text/javascript">
  <!--
  // Private objects are initially displayed (because if
  // javascript is turned off then we want them to be
  // visible); but by default, we want to hide them.  So hide
  // them unless we have a cookie that says to show them.
  checkCookie();
  // -->
</script>
</body>
</html>
