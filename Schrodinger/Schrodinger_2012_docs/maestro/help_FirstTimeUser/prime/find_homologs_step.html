<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html>
<head>
<meta http-equiv="content-type" content="text/html; charset=ISO-8859-1">
<meta name="categories" content="prime ">
<meta name="product" content="Prime">
<title>Prime Structure Prediction &mdash; Find Homologs Step</title>
<link rel="stylesheet" type="text/css" href="../support/help.css">
</head>
<script type="text/javascript">
function setTitle()
{
top.document.title = document.title + " - " + parent.parent.WINDOW_TITLE;
}
</script>
<body onload="setTitle();">
<table border=0 cellspacing=0 bgcolor=#dcdcdc width=100%>
<tr><td>
<p><img src="../support/schrodinger_logo.gif" border=0 alt="" align="left" vspace=5 hspace=5 /></p>
</td></tr>
<tr><td>
<h1 class=title><span class="prime">Prime Structure Prediction &mdash; Find
Homologs Step</span></h1>
</td></tr>
</table>

<ul>
<li><a href="#summary">Summary</a></li>
<li><a href="#PspFH2">Searching for Homologs</a></li>
<li><a href="#PspFH3">Find Homologs Search Options</a></li>
<li><a href="#PspFH4">Importing Homologs</a></li>
<li><a href="#PspFH4a">Selecting Templates</a></li>
<li><a href="#PspFH5">Aligning Structures (Multiple Templates)</a></li>
<li><a href="#PspFH5a">Extracting Single Chains</a></li>
<li><a href="#PspFHN">Proceeding to the Next Step</a></li>
<li><a href="#PspFH7">Saving Runs With Different Templates</a></li>
<li><a href="#PspFHE">Error Messages</a></li>
<li><a href="#PspFH9">Related Topics</a></li>
</ul>

<a name="summary"></a>
<h2>Summary</h2>

<p>This step is used to search for homologs of the query sequence. These
homologs can then be used as templates to build a model structure.</p>
<p>For details about the Find Homologs step, see Find Homologs in the 
<a href="../../../prime/prime_user_manual.pdf#nameddest=M6.8.newlink.top"
target="pdfmanuals"><i>Prime User Manual</i></a>.</p>


<a name="PspFH2"></a>
<h2>Searching for Homologs</h2>

<p>To search for homologs, click the <span class="GUI">Search</span> button near
the middle of the Prime panel. Depending on what is selected in the <span
class="GUI">Options</span> dialog box, BLAST or PSI-BLAST will be used to search
for templates.</p>

<p>
Optionally, run HMMER on the Pfam database by clicking the <span
class="GUI">Identify Globally Conserved Residues</span> button, to search for
globally conserved residues from a multiple sequence alignment of homologous
proteins. The conserved residues are shown in the sequence viewer, colored
according to the template color if both the template and the query have the
conserved residue. This allows you to easily identify conserved residues that
are not in the both the template and the query.
</p>

<p>When the homolog search is complete, select the template that you would like
to use to build a model by clicking the sequence in the <span
class="GUI">Homologs</span> table. The template structure is retrieved from the
PDB (either a local copy or the web site) and is displayed in the Workspace for
inspection. Clicking on another template in the table deselects the first
template and displays the new template structure.</p>

<a name="PspFH3"></a>
<h2>Find Homologs Search Options</h2>

<p>Click <span class="GUI">Options</span> to open the
<span class="GUI">Find Homologs - Options</span> dialog box.
Here you can choose the kind of search you want to run&mdash;BLAST or
PSI-BLAST&mdash;or change the settings for either type of search. You can also
choose whether to run the search on the BLAST web site or using a local
copy of the BLAST database. By default a local copy is used. </p> 

<p>For example, the default database for searching is
<span class="GUI">NCBI PDB (non-redundant)</span>.
Other options include:</p>
<ul>
<li><span class="GUI">NCBI PDB (all)</span>,
which shows all PDB hits, including PDB files
with identical sequences, and
</li>
<li><span class="GUI">NCBI NR</span>,
(recommended for PSI-BLAST runs.) If
<span class="GUI">NCBI NR</span> is selected,
only nonredundant PDB hits are displayed
in the <span class="GUI">Homologs</span> table.</li>
</ul>

<p>For more information on BLAST and its options, go to <a
href="http://www.ncbi.nlm.nih.gov/books/NBK21097/">http://www.ncbi.nlm.nih.gov/books/NBK21097/</a>. 
</p>


<a name="PspFH4"></a>
<h2>Importing Homologs</h2>

<p>If the homologs you want to use are not in the NCBI sequence database, or if
you have homologs that you want to use, you can import them using the <span
class="GUI">Import</span> buttons. Homologs are aligned quickly using ClustalW
on import.
</p>

<p>To import homologs from a file, click <span class="GUI">From File</span>. You
can import homologs in PDB and Maestro format.</p>

<p>To import homologs from Maestro, select them in the Project Table and click
<span class="GUI">From Project Table</span>. This allows you to import homologs
in any format recognized by Maestro.
</p>


<a name="PspFH4a"></a>
<h2>Selecting Templates</h2>

<p>If you want to build a homology model for a single chain, and have found a
satisfactory single template, you can simply select the desired template in the
table.
</p>

<p>If you want to use more than one template as a composite (chimera) model, in
which each template is used for a different region of the query, you can select
multiple templates in the table with shift-click or control-click. The template
structures must then be aligned before you use them.
</p>

<p>Likewise, if you want to build a consensus model, you can select multiple
templates in the table, but they do not need to be aligned. 
</p>

<p>If you want to build a homology model for a homomultimer, you should select a
single chain of a template that is also a homomultimer with the same number of
chains. The remaining chains are retrieved and used when the model is built.
</p>

<p>For heteromultimers, each chain should be built in a separate run before they
are combined to build the final multimer. You can use any of the above models to
build each chain, including a homomultimer model if the heteromultimer contains
a homomultimer.</p>


<a name="PspFH5"></a>
<h2>Aligning Structures</h2>

<p>Spatial alignment of multiple templates is only required if you want to
build a composite (or chimera) model. Otherwise, any alignment is done as
necessary; in particular, alignment should <i>not</i> be done if you want to
build a multimer model, because the templates must be in the correct spatial
relation to each other for building. 
</p>

<p>If you have already created a file with structurally aligned multiple
templates, you can use the <span class="GUI">Import</span> button to import
it. Otherwise, when you have selected your templates, click <span
class="GUI">Align Structures</span> to structurally align the templates.</p>

<p>Only templates with some degree of structural similarity can produce a
meaningful structural alignment.  If <span class="GUI">Align Structures</span>
fails, a warning message appears:</p>

<p><span class="GUI">WARNING The structural alignment did not produce
a suitable superimposition. The selected templates should not be used together
for structure building.</span></p>

<p>Templates with multiple chains may sometimes require special handling. In some
cases, <span class="GUI">Align Structures</span> fails to align multiple
templates with multiple chains. Furthermore, a chain from a given template file
cannot be structurally aligned to another chain from the same template file. It
can also happen that <span class="GUI">Align Structures</span> aligns a template
to chain B of another template, but you need an alignment with chain A.
In these cases, it is necessary to generate single-chain templates using the
<span class="GUI">getpdb</span> utility, as described in the next section,
<a href="#PspFH5a">Extracting Single Chains</a>.</p>

<a name="PspFH5a"></a>
<h2>Extracting Single Chains</h2>

<p>If Align Structures fails to align templates with
multiple chains correctly, use
the <span class="GUI">getpdb</span> utility
to extract single chain templates from the PDB database.
The <span class="GUI">getpdb</span> utility
can also be used to extract an entire protein.</p>

<p>To use <span class="GUI">getpdb</span>,
you must either have access to the web, to download the chain, or have one of
the following environment variables set:</p>
<ul>
<li><tt>SCHRODINGER_PDB</tt></li>
<li><tt>SCHRODINGER_THIRDPARTY</tt></li>
<li><tt>SCHRODINGER</tt></li>
</ul>
<p>If it is only the SCHRODINGER variable that has been set,
<span class="GUI">getpdb</span>
uses the default location of the database,
$SCHRODINGER/thirdparty.</p>

<p>To extract an entire protein from the PDB database, type:</p>

<p><tt>$SCHRODINGER/utilities/getpdb</tt> <i>4-letter_PDB_code</i></p>

<p>For example,<pre>
$SCHRODINGER/utilities/getpdb 1aaa
</pre>
retrieves the PDB file for the structure with PDB code 1AAA.</p>

<p>To extract a particular chain, type:</p>

<tt>$SCHRODINGER/utilities/getpdb</tt>
<i>4-letter_PDB_code</i><tt>:</tt><i>Chain_ID</i> <p>

<p>For example, if Align Structures
were to have difficulty aligning several multiple-chain
template structures, one of which was
the protein structure <b>1ems</b>, you would follow these steps
to correct the problem: </p>
<ol>
<li><p>Extract a single chain from the chosen multiple-chain template.</p>
<p>
For example, if the first multiple-chain template is
the protein 1ems, and the chain needed is chain A,
use the command:</p>
<pre>
$SCHRODINGER/utilities/getpdb 1ems:A </tt>
</pre>
<p>This command extracts all residues, including HETATMs, in chain A
(as well as any HETATMs with no chain name.)</p>

<p>Note: The <i>Chain_ID</i> variable is case sensitive, though the
<i>PDB_code</i> is not. In this example,
<tt>1EmS:A</tt> would also work, but
<tt>1ems:a</tt> would produce errors.</p>
<p>After the <span class="GUI">getpdb</span> utility
has extracted <tt>1ems:A</tt>, it returns the following message:</p>
<p><tt>saved data to file: 1ems_A.pdb</tt>
</p>
</li>
<li><p>Click <span class="GUI">Import</span> and import the single-chain file,
<code>1ems_A.pdb</code>. The new homolog appears in the
<span class="GUI">Homologs</span> table. </p>
</li>
<li><p>Select the single-chain version of each multiple-chain template, and
click <span class="GUI">Align Structures</span> again.</p></li>
</ol>

<a name="PspFHN"></a>
<h2>Proceeding to the next step</h2>

<p>When you are satisfied with the template or templates you have selected,
follow the <span class="GUI">Comparative Modeling</span> Path by proceeding to
the Edit Alignment step.</p>

<p>If no satisfactory templates can be identified by BLAST/PSI-BLAST and you
have not imported a template, you may wish to proceed to the Fold Recognition
step.</p>

<a name="PspFH7"></a>
<h2>Saving Runs With Different Templates</h2>

<p>If, after proceeding to further steps, you decide that you would like to try
a different template, you can avoid overwriting your existing workflow by
starting a new one before you navigate back to Find Homologs to choose a
different homolog. Select <span class="GUI">Save As</span> from the <span
class="GUI">File</span> menu. This will create a copy of the current run,
allowing you to select a new template and build on it. You will then be able to
compare results from each run. See the <a href="info_runs.html">Using Prime
Runs</a> help topic for more information.</p>

<a name="PspFHE"></a>
<h2>Error Messages</h2>

<p>If you select multiple templates and proceed to Edit Alignment, you will be
reminded of the requirements for use of multiple templates.</p>

<p>If one of these messages appears when you click <span class="GUI">Next</span>
to go to the Edit Alignment step, you will not be able to proceed along the
<span class="GUI">Comparative Modeling Path</span> until the problem is
resolved:</p>

<dl>
<dt><span class="GUI">No Homologs Found</span></dt>
<dd><p>You may change your search options and continue
searching, or else proceed to Fold Recognition.</p></dd>

<dt><span class="GUI">Invalid File</span>:</dt>
<dd><p>Check to be sure the homolog file exists (in either
<code>$SCHRODINGER/thirdparty/database/pdb/data/structures/divided/pdb/*/</code>
or
<code>$SCHRODINGER_THIRDPARTY/database/pdb/data/structures/divided/pdb/*/</code>)
and is in the right format (gzip compressed)
<span class="GUI">pdb</span>*<span class="GUI">.ent.gz</span>).</p></dd>
</dl>

<a name="PspFH9"></a>
<h2>Related Topics</h2>

<ul>
<li><a href="../tools_menu/protein_structure_alignment.html">Protein Structure Alignment Panel</a></li>
<li><a href="edit_alignment_step.html">Prime Edit Alignment Step</a></li>
<li><a href="input_sequence_step.html">Prime Input Sequence Step</a></li>
<li><a href="info_help.html">Prime General Help</a></li>
<li><a href="info_runs.html">Using Prime Runs</a></li>
<li><a href="info_layout.html">Prime Panel Layout and Use</a></li>
<li><a href="info_nav.html">Prime Navigation and the Guide</a></li>
<li><a href="info_jobs.html">Prime Job Options and Results</a></li>
<li><a href="toolbar.html">The Prime Toolbar</a></li>
<li><a href="info_third.html">Prime Third-Party Programs</a></li>
</ul>

<hr />
<table width="100%">
<td><p class="small"><a href="../support/legal_notice.html" target="LegalNoticeWindow">Legal Notice</a></p></td>
<td>
<table align="right">
<td><p class="small">
File: prime/find_homologs_step.html<br />
Last updated: 17 Apr 2012
</p></td>
</table>
</td>
</table>
</body>
</html>
