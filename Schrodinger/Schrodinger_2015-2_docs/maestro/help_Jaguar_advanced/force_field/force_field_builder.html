<!DOCTYPE HTML PUBLIC "-//IETF//DTD HTML//EN">
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=ISO-8859-1" />
<meta http-equiv="Content-Style-Type" content="text/css" />
<link rel="stylesheet" href="../support/help.css" charset="ISO-8859-1" type="text/css" />
<title>Force Field Builder Panel</title>
</head>
<body>
<table bgcolor="#dcdcdc" border="0" cellspacing="0" width="100%">
<tr><td>
<p><img src="../images/common/schrodinger_logo.png" align="left" alt=""
 border="0" hspace="5" vspace="5" /></p>
</td></tr>
<tr><td>
<h1 class="title">Force Field Builder Panel</h1>
</td></tr>
</table>

<ul>
<li><a href="#summary">Summary</a></li>
<li><a href="#opening">Opening the <span class="GUI">Force Field Builder</span> Panel</a></li>
<li><a href="#using">Using the <span class="GUI">Force Field Builder</span> Panel</a></li>
<li><a href="#features"><span class="GUI">Force Field Builder</span> Panel Features</a></li>
<li><a href="#links">Related Topics</a></li>
</ul>

<a name="summary"></a>
<h2>Summary</h2>

<p>Customize torsions that are not explicitly included in the OPLS3 force
field by fitting to quantum-mechanical calculations for a set of molecules.
</p>

<a name="opening"></a>
<h2>Opening the Force Field Builder Panel</h2>

<p>To open the <span class="GUI">Force Field Builder</span> panel, you can:</p>
<ul>
<li><p>Choose <span class="GUI">Tools &rarr; Force Field Builder</span> 
in the main window.
</p></li>
<li><p>Click the <span class="GUI">Customize</span> button next to the <span
class="GUI">Force field</span> option menu in any relevant panel.
</p></li>
</ul>


<a name="using"></a> 
<h2>Using the Force Field Builder Panel</h2> 


<p>This panel is designed to provide force-field parameters for torsions that
are not explicitly represented in the force field. The set of molecules that is
provided is analyzed to locate such torsions, and you can then run
quantum-mechanical calculations on these molecules, which are fitted to obtain
parameters for the torsions. By default, all torsions that are found are fitted
simultaneously, but you can exclude selected torsions from the fit and refit the
data.
</p>

<p>The torsional energies are calculated by performing coordinate scans with
Jaguar, then fitting the resulting energy curves to produce new force-field
parameters. These calculations can take a long time. They can be run on multiple
processors to decrease the turnaround time. 
</p>

<p><b>To generate custom force-field parameters:</b>
</p>

<ol>
<li><p>Specify a directory for the intermediate data in the <span
class="GUI">Directory</span> text box.
</p></li>
<li><p>Add molecules for analysis and generation of parameters.
</p></li>
<li><p>(Optional) Examine the torsions that have been selected for fitting.
</p></li>
<li><p>Click <span class="GUI">Calculate and Fit</span> to run the fitting job.
</p></li>
<li><p>Examine the resulting torsional energy curves, and decide whether to
exclude any torsional curves and refit.
</p></li>
<li><p>Save the parameters. 
</p></li>

</ol>

<p>The custom force field parameters can be used by selecting <span
class="GUI">Use customized version</span> in any application panel that supports
OPLS3. You can also set <a
href="../maestro_menu/preferences.html#jobs_forcefield">preferences</a> for the
use of OPLS3 and the customized version, so that they are selected by default
in the application panels.
</p>

<a name="features"></a> 
<h2>Force Field Builder Panel Features</h2> 


<ul>
<li><a href="#feature1"><span class="GUI">Directory</span> text box and buttons</a></li>
<li><a href="#feature2"><span class="GUI">Add molecules from</span> buttons</a></li>
<li><a href="#feature3"><span class="GUI">Molecules</span> table and display area</a></li>
<li><a href="#feature4"><span class="GUI">Fragments with missing torsions</span> table</a></li>
<li><a href="#advanced"><span class="GUI">Advanced</span> button</a></li>
<li><a href="#feature5"><span class="GUI">Calculate and Fit</span> button</a></li>
<li><a href="#feature6"><span class="GUI">Refit</span> button</a></li>
<li><a href="#feature7"><span class="GUI">Save Parameters</span> button</a></li>
<li><a href="#feature8">Status area</a></li>
<li><a href="#feature9"><span class="GUI">Reset Panel</span> button</a></li>
</ul>

<dl>

<a name="feature1"></a>
<dt><span class="GUI">Directory</span> text box and buttons</dt>
<dd><p>Specify the directory for storage of intermediate data, or for loading
existing data. You can type the directory name into the text box, click <span
class="GUI">Open</span> to locate a directory that contains existing data, or
click <span class="GUI">New</span> to specify a directory into which new
intermediate data will be written. Both buttons open file selectors, and the
directory name is displayed in the text box when you close the file selector. 
When you click <span class="GUI">New</span>, you must navigate to a location,
and then specify a name for the new directory in the <span class="GUI">File
name</span> text box. The directory is created with this name when you click
<span class="GUI">Save</span>. 
</p></dd>

<a name="feature2"></a>
<dt><span class="GUI">Add molecules from</span> buttons</dt>
<dd><p>Add the molecules for which you want to obtain custom force-field
parameters. You can add them from the <span class="GUI">Workspace</span>
(included entries), the <span class="GUI">Project Table</span> (selected
entries) or a file. Clicking <span class="GUI">File</span> opens a file
selector. 
</p>
<p>Once you have chosen a source for the molecules, they are analyzed in a job
that is run locally. When the job finishes, the tables below are filled in, and
the first molecule is selected in the <span class="GUI">Molecules</span> table.
If molecules cannot be analyzed, they are not added to the table, and a dialog
box opens with a report of the molecules that could not be analyzed.
</p>
<p>You can use these buttons multiple times to add molecules, which are analyzed
and added to the tables. 
</p>
<p>
</p>

</dd>

<a name="feature3"></a>
<dt><span class="GUI">Molecules</span> table and display area</dt>
<dd><p>This table lists the input structures, with their titles and the number
of torsions for which parameters are missing. You can select a single row in the
table. When the row is selected, a 2D structure is displayed in the display area
to the right, and the bonds for which torsions are not defined are marked with a
number in a colored circle. The number is the row index in the <span 
class="GUI">Fragments with missing torsions</span> table. When you select a
fragment in the <span class="GUI">Fragments with missing torsions</span> table,
the circle is highlighted with a yellow border. </p>
<p>To delete a molecule from the table, select it, then right-click and choose
<span class="GUI">Delete Selected</span>. To clear the table, right-click and
choose <span class="GUI">Delete All</span>. 
</p></dd>

<a name="feature4"></a>
<dt><span class="GUI">Fragments with missing torsions</span> table</dt>
<dd><p>This table displays the 2D structures for the fragments from the current
molecule that have missing torsions. When you select a fragment in this table,
it is highlighted in the display area for the molecule. </p>
<p>After parameters have been generated for a molecule, two columns are added to
the table: <span class="GUI">Fit RMSE</span>, which displays the RMSE
between the QM energy and the force-field energy from the fitting procedure at
the points on the torsional grid, and <span class="GUI">Refit</span>, which is a
column of check boxes that you can use to include or exclude a fragment from
refitting.</p> 
<p>The torsional energy of the selected fragment is displayed in a graph in the
display area to the right. Three curves are displayed: the energy from the
origianl force-field parameters, the QM energy, and the energy from the newly
fitted parameters.  You can click on a point in this plot to display the QM
structure for this point in the Workspace.
</p></dd>

<a name="advanced"></a>
<dt><span class="GUI">Advanced</span> button</dt>
<dd><p>Open the <span class="GUI">FFBuilder Fragment Options</span> dialog box,
in which you can set the following options for fragmenting the molecules:
</p>
<dl>
<dt><span class="GUI">Fragmentize</span> option</dt>
<dd><p>This option controls whether ligands are trimmed down into fragments for
fitting, or left as they are. If the ligands you supply are the actual molecules
you want to use for fitting, deselect this option. Otherwise, the molecules will
be trimmed (the default).
</p></dd>

<dt><span class="GUI">Keep atoms bonded to torsional atoms</span> option</dt>
<dd><p>When trimming down a ligand, keep all atoms that are bonded to any atoms
involved in the torsion that is being fitted. The torsional atoms are the two
central atoms of the torsion (&quot;central torsional atoms&quot;), and all
atoms that are bonded to these atoms (&quot;end torsional atoms&quot;), from
which a torsion around the central bond could be constructed. Selecting this
option means that any atoms that are two bonds away from the central two atoms
of the torsion are kept.  
</p></dd>

<dt><span class="GUI">Keep proximate rings if</span> options</dt>
<dd><p>Keep non-aromatic rings that have an atom in the torsional atom set. You
can choose one of two options for how close the ring is to the central bond:</p>
<ul>
<li><span class="GUI">a central torsional atom is part of the ring</span></li>
<li><span class="GUI">an end torsional atom is part of the ring</span></li>
</ul>
<p>Aromatic rings that have atoms in the torsional set are always kept.
</p></dd>

<dt><span class="GUI">Max ring size</span> text box</dt>
<dd><p>Set a limit on the size of non-aromatic rings that are kept if they have
atoms in the torsional atom set. This box is provided so that you can exclude
macrocycles from being kept, as it may be useful to trim macrocycles but not
smaller rings.
</p></dd>

</dl>

</dd>

<a name="feature5"></a>
<dt><span class="GUI">Calculate and Fit</span> button</dt>
<dd><p>Start the QM calculations to generate QM torsional scans and fit the
torsions. The calculations are done on all fragments for all molecules. The QM
torsional energies are then fitted to obtain new force-field parameters.
</p></dd>

<a name="feature6"></a>
<dt><span class="GUI">Refit</span> button</dt>
<dd><p>Refit the QM energies to obtain a new set of force-field parameters. This
allows you to exclude torsions from the fit and then refit the data. 
</p></dd>

<a name="feature7"></a>
<dt><span class="GUI">Save Parameters</span> button</dt>
<dd><p>Save the parameters as a custom force field. The custom force field is
written by default to the <code>opls_dir</code> folder in your Schr&ouml;dinger
user resources directory. You can change the location in the <span
class="GUI">Preferences</span> panel, under  <a
href="../maestro_menu/preferences.html#jobs_forcefield">Jobs - Force field</a>
</p></dd>

<a name="feature8"></a>
<dt>Status area</dt>
<dd><p>This area reports the status of the current operation or the requirement
for the next operation. 
</p></dd>

<a name="feature9"></a>
<dt><span class="GUI">Reset Panel</span> button</dt>
<dd><p>Clear all data from the panel and reset any values to their defaults.
</p></dd>

</dl>

<a name="links"></a>
<h2>Related Topics</h2>
<ul>

<li><a href="../maestro_menu/preferences.html">Preferences Panel</a></li>
<li><a href="opls2_1.html">OPLS3 Force Field</a></li>
</ul>
<hr />
<table width="100%">
<tr><td><p class="small"><a href="../support/legal_notice.html" target="LegalNoticeWindow">Legal Notice</a></p></td>
<td>
<table align="right">
<tr><td><p class="small">
File: force_field/force_field_builder.html<br />
Last updated: 20 Jun 2014
</p></td></tr>
</table>
</td></tr>
</table>
</body>
</html>
