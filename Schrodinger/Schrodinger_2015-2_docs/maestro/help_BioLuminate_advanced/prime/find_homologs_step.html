<!DOCTYPE HTML PUBLIC "-//IETF//DTD HTML//EN">
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=ISO-8859-1" />
<meta http-equiv="Content-Style-Type" content="text/css" />
<link rel="stylesheet" href="../support/help.css" charset="ISO-8859-1" type="text/css" />
<title>Prime Structure Prediction &mdash; Find Homologs Step</title>
</head>
<body>
<table bgcolor="#dcdcdc" border="0" cellspacing="0" width="100%">
<tr><td>
<p><img src="../images/common/schrodinger_logo.png" align="left" alt=""
 border="0" hspace="5" vspace="5" /></p>
</td></tr>
<tr><td>
<h1 class="title">Prime Structure Prediction &mdash; Find Homologs Step</h1>
</td></tr>
</table>

<ul>
<li><a href="#summary">Summary</a></li>
<li><a href="#working">Working in the <span class="GUI">Find Homologs</span> Step</a></li>
<li><a href="#features"><span class="GUI">Find Homologs</span> Step Features</a></li>
<li><a href="#links">Related Topics</a></li>
</ul>

<a name="summary"></a>
<h2>Summary</h2>

<p>This step is used to search for homologs of the query sequence. These
homologs can then be used as templates to build a model structure.</p>
<p>For details about the Find Homologs step, see Find Homologs in the 
<a href="../../../prime/prime_user_manual.pdf"
target="pdfmanuals"><i>Prime User Manual</i></a>.</p>


<a name="working"></a> 
<h2>Working in the Find Homologs Step</h2> 

<ul>
<li><a href="#PspFH2">Searching for Homologs</a></li>
<li><a href="#PspFH3">Find Homologs Search Options</a></li>
<li><a href="#PspFH4">Importing Homologs</a></li>
<li><a href="#PspFH4a">Selecting Templates</a></li>
<li><a href="#PspFH5">Aligning Structures (Multiple Templates)</a></li>
<li><a href="#PspFH5a">Extracting Single Chains</a></li>
<li><a href="#PspFHN">Proceeding to the Next Step</a></li>
<li><a href="#PspFH7">Saving Runs With Different Templates</a></li>
<li><a href="#PspFHE">Error Messages</a></li>
</ul>

<a name="PspFH2"></a>
<h4>Searching for Homologs</h4>

<p>To search for homologs, click the <span class="GUI">Search</span> button near
the middle of the Prime panel. Depending on what is selected in the <span
class="GUI">Options</span> dialog box, BLAST or PSI-BLAST will be used to search
for templates.</p>

<p>
Optionally, run HMMER on the Pfam database by clicking the <span
class="GUI">Identify Globally Conserved Residues</span> button, to search for
globally conserved residues from a multiple sequence alignment of homologous
proteins. The conserved residues are shown in the sequence viewer, colored
according to the template color if both the template and the query have the
conserved residue. This allows you to easily identify conserved residues that
are not in the both the template and the query.
</p>

<p>When the homolog search is complete, select the template that you would like
to use to build a model by clicking the sequence in the <span
class="GUI">Homologs</span> table. The template structure is retrieved from the
PDB (either a local copy or the web site) and is displayed in the Workspace for
inspection. Clicking on another template in the table deselects the first
template and displays the new template structure.</p>

<a name="PspFH3"></a>
<h4>Find Homologs Search Options</h4>

<p>Click <span class="GUI">Options</span> to open the
<span class="GUI">Find Homologs - Options</span> dialog box.
Here you can choose the kind of search you want to run&mdash;BLAST or
PSI-BLAST&mdash;or change the settings for either type of search. You can also
choose whether to run the search on the BLAST web site or using a local
copy of the BLAST database. By default a local copy is used. </p> 

<p>For example, the default database for searching is <span class="GUI">NCBI PDB
(non-redundant)</span>. Other options include:</p>
<ul>
<li><span class="GUI">NCBI PDB (all)</span>, which shows all PDB hits, including
PDB files with identical sequences, and
</li>
<li><span class="GUI">NCBI NR</span>, (recommended for PSI-BLAST runs.) If
<span class="GUI">NCBI NR</span> is selected, only nonredundant PDB hits are
displayed in the <span class="GUI">Homologs</span> table.</li>
</ul>

<p>For more information on BLAST and its options, go to <a
href="http://www.ncbi.nlm.nih.gov/books/NBK21097/">http://www.ncbi.nlm.nih.gov/books/NBK21097/</a>. 
</p>


<a name="PspFH4"></a>
<h4>Importing Homologs</h4>

<p>If the homologs you want to use are not in the NCBI sequence database, or if
you have homologs that you want to use, you can import them using the <span
class="GUI">Import</span> buttons. Homologs are aligned quickly using ClustalW
on import.
</p>

<p>To import homologs from a file, click <span class="GUI">From File</span>. You
can import homologs in PDB and Maestro format.</p>

<p>To import homologs from Maestro, select them in the Project Table and click
<span class="GUI">From Project Table</span>. This allows you to import homologs
in any format recognized by Maestro.
</p>


<a name="PspFH4a"></a>
<h4>Selecting Templates</h4>

<p>If you want to build a homology model for a single chain, and have found a
satisfactory single template, you can simply select the desired template in the
table.
</p>

<p>If you want to use more than one template as a composite (chimera) model, in
which each template is used for a different region of the query, you can select
multiple templates in the table with shift-click or control-click. The template
structures must then be aligned before you use them.
</p>

<p>Likewise, if you want to build a consensus model, you can select multiple
templates in the table, but they do not need to be aligned. 
</p>

<p>If you want to build a homology model for a homomultimer, you should select a
single chain of a template that is also a homomultimer with the same number of
chains. The remaining chains are retrieved and used when the model is built.
</p>

<p>For heteromultimers, each chain should be built in a separate run before they
are combined to build the final multimer. You can use any of the above models to
build each chain, including a homomultimer model if the heteromultimer contains
a homomultimer.</p>


<a name="PspFH5"></a>
<h4>Aligning Structures</h4>

<p>Spatial alignment of multiple templates is only required if you want to
build a composite (or chimera) model. Otherwise, any alignment is done as
necessary; in particular, alignment should <i>not</i> be done if you want to
build a multimer model, because the templates must be in the correct spatial
relation to each other for building. 
</p>

<p>If you have already created a file with structurally aligned multiple
templates, you can use the <span class="GUI">Import</span> button to import
it. Otherwise, when you have selected your templates, click <span
class="GUI">Align Structures</span> to structurally align the templates.</p>

<p>Only templates with some degree of structural similarity can produce a
meaningful structural alignment.  If <span class="GUI">Align Structures</span>
fails, a warning message appears:</p>

<p><span class="GUI">WARNING The structural alignment did not produce
a suitable superimposition. The selected templates should not be used together
for structure building.</span></p>

<p>Templates with multiple chains may sometimes require special handling. In some
cases, <span class="GUI">Align Structures</span> fails to align multiple
templates with multiple chains. Furthermore, a chain from a given template file
cannot be structurally aligned to another chain from the same template file. It
can also happen that <span class="GUI">Align Structures</span> aligns a template
to chain B of another template, but you need an alignment with chain A.
In these cases, it is necessary to generate single-chain templates, as described
in the next section, <a href="#PspFH5a">Extracting Single Chains</a>.</p>

<a name="PspFH5a"></a>
<h4>Extracting Single Chains</h4>

<p>If Align Structures fails to align templates with multiple chains correctly,
use the <a href="../project_menu/get_pdb_file_db.html"><span class="GUI">Get PDB
File</span> panel</a> to extract single chain templates from the PDB database,
either from a local installation or from the web. To open this panel, you can:
<ul>
<li><p>Choose <span class="GUI">File &rarr; Get PDB</span> 
in the main window.
</p></li>
<li><p>Click the <span class="GUI">Get PDB</span> button 
on the <span class="GUI">Project</span> toolbar in the main window.
</p></li>
<img src="../images/MaestroToolbarIcons/getpdb.png" />
</ul>
<p>To extract a particular chain:</p>
<ol>
<li>Enter the PDB ID in the <span class="GUI">PDB ID</span> text box.</li>
<li>Enter the single-letter chain name in the <span class="GUI">Chain name</span> text box. </li>
<li>(Optional) Choose the source for the structure.</li>
<li>Click <span class="GUI">Download</span>.</li>
</ol>
<p>The chain is downloaded into the working directory and imported into the
Maestro project. Once you have imported all the desired chains, you can select
them in the Project Table, then in the <span class="GUI">Find Homologs</span>
step, click <span class="GUI">From Project Table</span>. 
</p>

<p>For example, if Align Structures were to have difficulty aligning several
multiple-chain template structures, you would follow these steps to correct the
problem: </p> 
<ol>
<li><p>Extract the single chains from the chosen multiple-chain templates using
the instructions above.</p>
</li>
<li><p>Select the chains in the <span class="GUI">Project Table</span> panel.
</p></li>
<li><p>In the <span class="GUI">Find Homologs</span> step,
click <span class="GUI">From Project Table</span>. The new homologs appear in
the <span class="GUI">Homologs</span> table.</p>
</li>
<li><p>Select the single-chain version of each multiple-chain template, and
click <span class="GUI">Align Structures</span> again.</p></li>
</ol>

<p>You can also use the <code>getpdb</code> utility from the command line to
extract chains from the PDB database. To use <code>getpdb</code>, you must
either have access to the web to download the chain, or have a local
installation of the PDB, to which one of the following environment variables is
set:</p>
<ul>
<li><tt>SCHRODINGER_PDB</tt></li>
<li><tt>SCHRODINGER_THIRDPARTY</tt></li>
<li><tt>SCHRODINGER</tt></li>
</ul>
<p>If it is only the SCHRODINGER variable that has been set,
<code>getpdb</code> uses the default location of the database,
<code>$SCHRODINGER/thirdparty</code>.</p>

<p>To extract an entire protein from the PDB database, type:</p>

<p><tt>$SCHRODINGER/utilities/getpdb</tt> <i>4-letter_PDB_code</i></p>

<p>For example,</p>
<pre>
$SCHRODINGER/utilities/getpdb 1aaa
</pre>
<p>retrieves the PDB file for the structure with PDB code 1AAA.</p>

<p>To extract a particular chain, type:</p>

<p><tt>$SCHRODINGER/utilities/getpdb</tt> <i>4-letter_PDB_code</i><tt>:</tt><i>Chain_ID</i></p>

<p>For example, if the first multiple-chain template is
the protein 1ems, and the chain needed is chain A,
use the command:</p>
<pre>
$SCHRODINGER/utilities/getpdb 1ems:A 
</pre>
<p>This command extracts all residues, including HETATMs, in chain A
(as well as any HETATMs with no chain name.)</p>

<p>Note: The <i>Chain_ID</i> variable is case sensitive, though the
<i>PDB_code</i> is not. In this example, <tt>1EmS:A</tt> would also work, but
<tt>1ems:a</tt> would produce errors.</p>
<p>After the <span class="GUI">getpdb</span> utility
has extracted <tt>1ems:A</tt>, it returns the following message:</p>
<p><tt>saved data to file: 1ems_A.pdb</tt>
</p>

<p>You can then click <span class="GUI">From File</span> in
the <span class="GUI">Find Homologs</span> and import the single-chain file, 
<code>1ems_A.pdb</code>. The new homolog appears in the
<span class="GUI">Homologs</span> table. </p>

<a name="PspFHN"></a>
<h4>Proceeding to the next step</h4>

<p>When you are satisfied with the template or templates you have selected,
follow the <span class="GUI">Comparative Modeling</span> Path by proceeding to
the Edit Alignment step.</p>

<p>If no satisfactory templates can be identified by BLAST/PSI-BLAST and you
have not imported a template, you may wish to proceed to the Fold Recognition
step.</p>

<a name="PspFH7"></a>
<h4>Saving Runs With Different Templates</h4>

<p>If, after proceeding to further steps, you decide that you would like to try
a different template, you can avoid overwriting your existing workflow by
starting a new one before you navigate back to Find Homologs to choose a
different homolog. Select <span class="GUI">Save As</span> from the <span
class="GUI">File</span> menu. This will create a copy of the current run,
allowing you to select a new template and build on it. You will then be able to
compare results from each run. See the <a href="info_runs.html">Using Prime
Runs</a> help topic for more information.</p>

<a name="PspFHE"></a>
<h4>Error Messages</h4>

<p>If you select multiple templates and proceed to Edit Alignment, you will be
reminded of the requirements for use of multiple templates.</p>

<p>If one of these messages appears when you click <span class="GUI">Next</span>
to go to the Edit Alignment step, you will not be able to proceed along the
<span class="GUI">Comparative Modeling Path</span> until the problem is
resolved:</p>

<dl>
<dt><span class="GUI">No Homologs Found</span></dt>
<dd><p>You may change your search options and continue
searching, or else proceed to Fold Recognition.</p></dd>

<dt><span class="GUI">Invalid File</span>:</dt>
<dd><p>Check to be sure the homolog file exists (in either
<code>$SCHRODINGER/thirdparty/database/pdb/data/structures/divided/pdb/*/</code>
or
<code>$SCHRODINGER_THIRDPARTY/database/pdb/data/structures/divided/pdb/*/</code>)
and is in the right format (gzip compressed)
<span class="GUI">pdb</span>*<span class="GUI">.ent.gz</span>).</p></dd>
</dl>

<a name="features"></a> 
<h2>Find Homologs Step Features</h2> 

<ul>
<li><a href="#feature1"><span class="GUI">BLAST Homology Search</span> button</a></li>
<li><a href="#feature2"><span class="GUI">Options</span> button</a></li>
<li><a href="#feature3"><span class="GUI">Import</span> buttons</a>
<ul>
<li><a href="#feature3.1"><span class="GUI">From File</span> button</a></li>
<li><a href="#feature3.2"><span class="GUI">From Project Table</span> button</a></li>
</ul>
</li>
<li><a href="#feature4"><span class="GUI">Identify Globally Conserved Residues</span> button</a></li>
<li><a href="#feature5"><span class="GUI">Family name</span> text box</a></li>
<li><a href="#feature6"><span class="GUI">Homologs</span> table</a></li>
<li><a href="#feature7"><span class="GUI">Align Structures</span> button</a></li>
</ul>

<dl>

<a name="feature1"></a>
<dt><span class="GUI">BLAST Homology Search</span> button</dt>
<dd><p>Click this button to perform a search for homologs using BLAST. The
search is performed with the standard choice of database, similarity matrix, gap
costs, and so on, but you can change these options by
clicking <span class="GUI">Options</span>. The results of the search are
returned in the <span class="GUI">Homologs</span> table.
</p></dd>

<a name="feature2"></a>
<dt><span class="GUI">Options</span> button</dt>
<dd><p>Set BLAST options for the search, including whether to do a BLAST search
or a PSI-BLAST search. Opens the <span class="GUI">Find Homologs -
Options</span> dialog box.
</p></dd>

<a name="feature3"></a>
<dt><span class="GUI">Import</span> buttons</dt>
<dd><p>Import homologs into the <span class="GUI">Homologs</span> table. You can
import them from one of two sources:
</p>

<dl>
<a name="feature3.1"></a>
<dt><span class="GUI">From File</span> button</dt>
<dd><p>Import the homologs from a PDB file or a Maestro file. Opens a file
selector, in which you can navigate to and load a single homolog.
</p></dd>
<a name="feature3.2"></a>
<dt><span class="GUI">From Project Table</span> button</dt>
<dd><p>Import the selected entries in the Project Table into
the <span class="GUI">Homologs</span> table. The entries must be selected before
you click this button. 
</p></dd>
</dl>

</dd>

<a name="feature4"></a>
<dt><span class="GUI">Identify Globally Conserved Residues</span> button</dt>
<dd><p>Run a search with HMMER on the Pfam database, to identify the query
family and provide information about which residues are conserved in the
consensus sequence. The sequence viewer shows the match bewteen the query and
the consensus sequence of the family. 
</p></dd>

<a name="feature5"></a>
<dt><span class="GUI">Family name</span> text box</dt>
<dd><p>
</p></dd>

<a name="feature6"></a>
<dt><span class="GUI">Homologs</span> table</dt>
<dd><p>
</p></dd>

<a name="feature7"></a>
<dt><span class="GUI">Align Structures</span> button</dt>
<dd><p>
</p></dd>

</dl>


<a name="links"></a>
<h2>Related Topics</h2>
<ul>

<li><a href="../tools_menu/protein_structure_alignment.html">Protein Structure Alignment Panel</a></li>
<li><a href="edit_alignment_step.html">Prime Edit Alignment Step</a></li>
<li><a href="input_sequence_step.html">Prime Input Sequence Step</a></li>
<li><a href="info_help.html">Prime General Help</a></li>
<li><a href="info_runs.html">Using Prime Runs</a></li>
<li><a href="info_layout.html">Prime Panel Layout and Use</a></li>
<li><a href="info_nav.html">Prime Navigation and the Guide</a></li>
<li><a href="info_jobs.html">Prime Job Options and Results</a></li>
<li><a href="toolbar.html">The Prime Toolbar</a></li>
<li><a href="info_third.html">Prime Third-Party Programs</a></li>

</ul>
<hr />
<table width="100%">
<tr><td><p class="small"><a href="../support/legal_notice.html" target="LegalNoticeWindow">Legal Notice</a></p></td>
<td>
<table align="right">
<tr><td><p class="small">
File: prime/find_homologs_step.html<br />
Last updated: 16 Jun 2014
</p></td></tr>
</table>
</td></tr>
</table>
</body>
</html>
