<!DOCTYPE HTML PUBLIC "-//IETF//DTD HTML//EN">
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=ISO-8859-1" />
<meta http-equiv="Content-Style-Type" content="text/css" />
<link rel="stylesheet" href="../support/help.css" charset="ISO-8859-1" type="text/css" />
<title>Canvas Similarity and Clustering Panel</title>
</head>
<body>
<table bgcolor="#dcdcdc" border="0" cellspacing="0" width="100%">
<tr><td>
<p><img src="../images/common/schrodinger_logo.png" align="left" alt=""
 border="0" hspace="5" vspace="5" /></p>
</td></tr>
<tr><td>
<h1 class="title">Canvas Similarity and Clustering Panel</h1>
</td></tr>
</table>

<ul>
<li><a href="#summary">Summary</a></li>
<li><a href="#opening">Opening the <span class="GUI">Canvas Similarity and Clustering</span> Panel</a></li>
<li><a href="#features"><span class="GUI">Canvas Similarity and Clustering</span> Panel Features</a></li>
<li><a href="#links">Related Topics</a></li>
</ul>

<a name="summary"></a>
<h2>Summary</h2>

<p>In this panel, you can generate Canvas fingerprints for the selected entries
in the Project Table, calculate similarities based on these fingerprints, and
cluster the entries using the similarity metric. 
</p>

<a name="opening"></a>
<h2>Opening the Canvas Similarity and Clustering Panel</h2>

<p>To open the <span class="GUI">Canvas Similarity and Clustering</span> panel, you can:</p>
<ul>
<li><p>Choose <span class="GUI">Scripts &rarr; Cheminformatics &rarr; Canvas Similarity and Clustering</span> 
in the main window.
</p></li>
</ul>


<a name="features"></a> 
<h2>Canvas Similarity and Clustering Panel Features</h2> 


<ul>
<li><a href="#feature1"><span class="GUI">Fingerprints</span> tab</a></li>
<li><a href="#feature2"><span class="GUI">Similarity</span> tab</a></li>
<li><a href="#feature3"><span class="GUI">Cluster</span> tab</a></li>
</ul>

<a name="feature1"></a>
<h3>Fingerprints tab</h3>
<p>In this tab, you set up the fingerprint calculation. 
</p>

<ul>
<li><a href="#feature1.1"><span class="GUI">Precision</span> options</a></li>
<li><a href="#feature1.2"><span class="GUI">Fingerprint type</span> option menu</a></li>
<li><a href="#feature1.3"><span class="GUI">Atom typing scheme</span> list</a></li>
</ul>

<dl>

<a name="#feature1.1"></a>
<dt><span class="GUI">Precision</span> options</dt>
<dd><p>Choose the fingerprint precision. A higher number of bits reduces the
chance of collisions; with 64-bit fingerprints, collisions should be extremely
rare. A higher number of bits also means that the calculation takes longer to
run.
</p></dd>

<a name="feature1.2"></a>
<dt><span class="GUI">Fingerprint type</span> option menu</dt>
<dd><p>Choose the type of fingerprint to calculate. Radial, dendritic, or
MolPrint2D often give the best results.
</p></dd>

<a name="feature1.3"></a>
<dt><span class="GUI">Atom typing scheme</span> list</dt>
<dd><p>Choose an atom typing scheme for the fingerprint calculation. If you
choose a more specific atom typing scheme, the fingerprints for each
molecule will be more distinct, and the similarities between molecules will be
smaller.
</p></dd>

</dl>

<a name="feature2"></a>
<h3>Similarity tab</h3>
<p>In this tab you can calculate the similarity of one or more ligands to a set
of ligands. The ligands that you want to use as references must be included in
the Workspace, and the ligands for which you want to calculate similarities must
be selected in the Project Table. You must generate fingerprints for all of
these ligands before you calculate similarities: any ligands that don't have
fingerprints are silently ignored.</p>

<ul>
<li><a href="#feature2.2"><span class="GUI">Similarity metric</span> option menu</a></li>
<li><a href="#feature2.3"><span class="GUI">Tversky alpha</span> and <span
class="GUI">Tversky beta</span> text boxes</a></li>
<li><a href="#feature2.5"><span class="GUI">Calculate Similarity</span> button</a></li>
<li><a href="#feature2.6"><span class="GUI">Sort selected entries by similarity</span> option</a></li>
</ul>

<dl>


<a name="feature2.2"></a>
<dt><span class="GUI">Similarity metric</span> option menu</dt>
<dd><p>Choose the metric that is used for calculating similarities. The
definitions of the metrics are given in the <span
class="GUI">Similarity/Distance Matrix from Fingerprints</span> panel in
Canvas.
</p></dd>

<a name="feature2.3"></a>
<dt><span class="GUI">Tversky alpha</span> and <span class="GUI">Tversky
beta</span> text boxes</dt>
<dd><p>Specify the alpha and beta parameters if the Tversky metric is chosen
from the <span class="GUI">Similarity metric</span> option menu.
</p></dd>


<a name="feature2.5"></a>
<dt><span class="GUI">Calculate Similarity</span> button</dt>
<dd><p>Calculate the similarities. The similarities are reported as properties
in the Project Table for the selected entries. If only one entry is included in
the Workspace, the property name is Canvas <i>metric</i> Similarity. If more
than one entry is included in the Workspace, five properties are added:</p>
<ul>
<li><span class="GUI">Canvas Mean <i>metric</i> Similarity</span>&mdash;Average
of similarities to all included entries</li>
<li><span class="GUI">Canvas Max <i>metric</i>
Similarity</span>&mdash;Similarity of the most similar included entry</li>
<li><span class="GUI">Canvas Min <i>metric</i>
Similarity</span>&mdash;Similarity of the least similar included entry</li>
<li><span class="GUI">Canvas Max <i>metric</i> Similarity ID</span>&mdash;the
entry ID of the most similar included entry</li>
<li><span class="GUI">Canvas Min <i>metric</i> Similarity ID</span>&mdash;the
entry ID of the least similar included entry</li>
</ul>
</dd>

<a name="feature2.6"></a>
<dt><span class="GUI">Sort selected entries by similarity</span> option</dt>
<dd><p>Sort the selected entries in the Project Table by the similarity values,
from highest to lowest. If you have more than one ligand in the Workspace, the
maximum similarity is used for sorting. 
</p></dd>

</dl>

<a name="feature3"></a>
<h3>Cluster tab</h3>
<p>In this tab, you can cluster the selected entries by their similarity values,
using the fingerprints and the settings in the <span
class="GUI">Similarity</span> tab. Hierarchical agglomerative clustering is
used. Once clustering is done, you can examine the clustering statistics, a
dendrogram of the clustering, and the distance matrix, and you can apply the
clustering to the selected entries, to create groups or create index and size
properties. 
</p>

<ul>
<li><a href="#feature3.2"><span class="GUI">Linkage method</span> option menu</a></li>
<li><a href="#feature3.4"><span class="GUI">Calculate Clustering</span> button</a></li>
<li><a href="#feature3.5"><span class="GUI">Clustering Results</span> section</a></li>
<li><a href="#feature3.6"><span class="GUI">Clustering Statistics</span> button</a></li>
<li><a href="#feature3.7"><span class="GUI">Dendrogram</span> button</a></li>
<li><a href="#feature3.8"><span class="GUI">Distance matrix</span> button</a></li>
<li><a href="#feature3.10"><span class="GUI">Number of clusters</span> text box</a></li>
<li><a href="#feature3.11"><span class="GUI">Create</span> options</a></li>
<li><a href="#feature3.12"><span class="GUI">Apply Clustering</span> button</a></li>
</ul>

<dl>


<a name="feature3.2"></a>
<dt><span class="GUI">Linkage method</span> option menu</dt>
<dd><p>Specify the linkage method. These are the methods used by Canvas for
hierarchical clustering. 
</p></dd>


<a name="feature3.4"></a>
<dt><span class="GUI">Calculate Clustering</span> button</dt>
<dd><p>Perform the hierarchical clustering calculation.  
</p></dd>


<a name="feature3.6"></a>
<dt><span class="GUI">Clustering Statistics</span> button</dt>
<dd><p>Display a plot of various statistics of the clustering as a function of
the number of clusters, in the <span class="GUI">Clustering Statistics</span>
panel. The statistics are: Kelley penalty, R-squared, Semipartial R-squared,
Merge distance, Separation ratio. You can click in the plot to set the number of
clusters in the <span class="GUI">Number of clusters</span> text box.  
</p></dd>

<a name="feature3.7"></a>
<dt><span class="GUI">Dendrogram</span> button</dt>
<dd><p>Display a dendrogram of the hierarchy of clusters, in the <span
class="GUI">Dendrogram</span> panel. You can click in the plot to set the number
of clusters in the <span class="GUI">Number of clusters</span> text box.  
</p></dd>

<a name="feature3.8"></a>
<dt><span class="GUI">Distance matrix</span> button</dt>
<dd><p>Display the distance matrix used for clustering graphically, with values
represented by a color map, in the <span class="GUI">Distance Matrix</span>
panel. You can display the matrix in cluster order (as shown in the <span
class="GUI">Dendrogram</span> panel) or in the original (input) order. You can
click in the plot to display the 2D structures in the panel, and optionally in
the Workspace.
</p></dd>

<a name="feature3.9"></a>
<dt><span class="GUI">Apply clustering</span> section</dt>
<dd><p>In this section, you can apply the clustering to the selected entries in
the Project Table for a particular number of clusters.
</p></dd>

<a name="feature3.10"></a>
<dt><span class="GUI">Number of clusters</span> text box</dt>
<dd><p>Specify the number of clusters to use when applying the clustering
results to the selected entries.
</p></dd>

<a name="feature3.11"></a>
<dt><span class="GUI">Create</span> options</dt>
<dd><p>Specify the action to be taken when applying the clustering.</p>
<ul>
<li><span class="GUI">Duplicate entries to a new group for each
cluster</span>&mdash;Create new groups for each cluster, with titles set to
<span class="GUI">Cluster <i>N</i></span> (or <i>N_M</i> if clustering has been
applied <i>M</i> times), duplicate all the selected entries, and put the
duplicates into these new groups.</li>
<li><span class="GUI">Move entries to a new group for each
cluster</span>&mdash;Create new groups for each cluster with titles set to
<span class="GUI">Cluster <i>N</i></span> (or <i>N_M</i> if clustering has been
applied <i>M</i> times), and move the entries from their current location into
the new groups.</li>
<li><span class="GUI">A group containing the structures nearest the centroid in
each cluster</span>&mdash;Create a new group, entitled 
<span class="GUI">Representative Entries</span> (with a suffix <i>M</i> if
clustering has been applied <i>M</i> times) , and move the 
structure that is nearest the centroid in each cluster to this group.</li>
<li><span class="GUI">Cluster index and size properties for each
entry</span>&mdash;Create two new properties for each entry that record which
cluster the entry belongs to (the index) and how big the cluster is.</li>
</ul>

</dd>

<a name="feature3.12"></a>
<dt><span class="GUI">Apply Clustering</span> button</dt>
<dd><p>Apply the clustering to the selected entries in the Project Table using
the option chosen under <span class="GUI">Create</span>.
</p></dd>

</dl>

<a name="links"></a>
<h2>Related Topics</h2>
<ul>
<li><a href="spectral_cluster.html">Spectral Clustering Panel</a></li>
<li><a href="volume_cluster.html">Clustering Based on Volume Overlap Panel</a></li>
<li></li>
</ul>
<hr />
<table width="100%">
<tr><td><p class="small"><a href="../support/legal_notice.html" target="LegalNoticeWindow">Legal Notice</a></p></td>
<td>
<table align="right">
<tr><td><p class="small">
File: scripts/canvas_cluster.html<br />
Last updated: 24 Nov 2014
</p></td></tr>
</table>
</td></tr>
</table>
</body>
</html>
