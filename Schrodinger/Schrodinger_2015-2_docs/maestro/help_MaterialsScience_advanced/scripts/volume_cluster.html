<!DOCTYPE HTML PUBLIC "-//IETF//DTD HTML//EN">
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=ISO-8859-1" />
<meta http-equiv="Content-Style-Type" content="text/css" />
<link rel="stylesheet" href="../support/help.css" charset="ISO-8859-1" type="text/css" />
<title>Clustering Based on Volume Overlap Panel</title>
</head>
<body>
<table bgcolor="#dcdcdc" border="0" cellspacing="0" width="100%">
<tr><td>
<p><img src="../images/common/schrodinger_logo.png" align="left" alt=""
 border="0" hspace="5" vspace="5" /></p>
</td></tr>
<tr><td>
<h1 class="title">Clustering Based on Volume Overlap Panel</h1>
</td></tr>
</table>

<ul>
<li><a href="#summary">Summary</a></li>
<li><a href="#opening">Opening the <span class="GUI">Clustering Based on Volume Overlap</span> Panel</a></li>
<li><a href="#using">Using the <span class="GUI">Clustering Based on Volume Overlap</span> Panel</a></li>
<li><a href="#features"><span class="GUI">Clustering Based on Volume Overlap</span> Panel Features</a></li>
<li><a href="#links">Related Topics</a></li>
</ul>

<a name="summary"></a>
<h2>Summary</h2>

<p>In this panel, you can cluster structures based on their volume overlap, as
calculated by the Phase utility <code>phase_volCalc</code>. 
</p>

<a name="opening"></a>
<h2>Opening the Clustering Based on Volume Overlap Panel</h2>

<p>To open the <span class="GUI">Clustering Based on Volume Overlap</span> panel, you can:</p>
<ul>
<li><p>Choose <span class="GUI">Tools &rarr; Scripts &rarr; Cheminformatics &rarr; Clustering of Ligands</span> 
in the main window.
</p></li>
</ul>


<a name="using"></a> 
<h2>Using the Clustering Based on Volume Overlap Panel</h2> 


<p>This panel generates a matrix of volume scores for all input molecules. The
volume score is the overlap volume of two molecules divided by the total volume
occupied by the molecules. The use of the volume score rather than the volume
overlap normalizes the volume similarity, so that the diagonal elements of the
volume score matrix are 1, and the off-diagonal elements represent the
fractional overlap.  
</p>
<p>Once the matrix is generated, it is used to cluster the molecules using a
hierarchical agglomerative clustering method. The output is a set of files for a
chosen number of clusters or a specified merging cutoff distance, named
<i>jobname</i><code>_</code><i>n</i><code>.mae</code>, where <i>n</i> is the
cluster index.
</p>
<p>Volume overlaps are calculated by summing up the occupations of squares on a
cubic grid. A cube is occupied if the center of the cube lies inside an atomic
sphere. To be included in the volume overlap, each cube must be occupied by
atoms from both molecules. The calculated volume is an integer multiple of the
cube volume; as such it is not highly accurate (about 0.5% error) but is
sufficient for the evaluation of volume overlaps.
</p>
<p>The volume score is the fraction of the total volume that is common to both
molecules. The total volume is calculated by adding up the number of cubes that
are occupied by either of the molecules. The volue score can be expressed by (A
AND B)/(A OR B), where A and B represent the volume occupied by the two
molecules. It is in fact the Tanimoto similarity for the volume. 
</p>

<a name="features"></a> 
<h2>Clustering Based on Volume Overlap Panel Features</h2> 


<ul>
<li><a href="#feature1">Structure input controls</a></li>
<li><a href="#feature2"><span class="GUI">Overlapping volumes</span> section</a></li>
<li><a href="#feature3"><span class="GUI">Clustering</span> section</a></li>
</ul>

<a name="feature1"></a>
<h3>Structure input controls</h3>
<p>These controls allow you to select the source of the structures.
</p>

<ul>
<li><a href="#feature1.1"><span class="GUI">Use structures from</span> option menu</a></li>
<li><a href="#feature1.2"><span class="GUI">Input file</span> text box and <span class="GUI">Browse</span> button</a></li>
</ul>

<dl>

<a name="#feature1.1"></a>
<dt><span class="GUI">Use structures from</span> option menu</dt>
<dd><p>Choose the source of the structures to cluster from this option menu. The
available choices are the Workspace (included entries), the selected entries in
the Project Table, and a file. If you choose <span class="GUI">File</span>, the
<span class="GUI">Input file</span> option menu and <span
class="GUI">Browse</span> button are activated, so you can specify the file.
</p></dd>

<a name="feature1.2"></a>
<dt><span class="GUI">Input file</span> text box and <span
class="GUI">Browse</span> button</dt> 
<dd><p>Specify the input structure file in the text box, by typing in its path,
or click <span class="GUI">Browse</span> to navigate to and select the file.
</p></dd>

</dl>

<a name="feature2"></a>
<h3>Overlapping volumes section</h3>
<p>In this section, you specify the atoms for which you want to calculate the
volume overlap (which need not be all atoms), and make settings for how the
overlap is calculated.
</p>

<ul>
<li><a href="#feature2.1"><span class="GUI">Use ASL</span> controls</a></li>
<li><a href="#feature2.2"><span class="GUI">Include hydrogens</span> option</a></li>
<li><a href="#feature2.3"><span class="GUI">Only consider MacroModel atom types</span> option</a></li>
<li><a href="#feature2.4"><span class="GUI">Compute volume score</span> option</a></li>
<li><a href="#feature2.5"><span class="GUI">Fixed radius</span> option and text box</a></li>
<li><a href="#feature2.6"><span class="GUI">Grid spacing</span> text box</a></li>
</ul>

<dl>

<a name="#feature2.1"></a>
<dt><span class="GUI">Use ASL</span> controls</dt>
<dd><p>Specify the atoms to use when calculating the volume, by providing an ASL
expression. You can type it in the text box, or click <span
class="GUI">Select</span> to construct an ASL expression for the Workspace
structure in the <span class="GUI">Atom Selection</span> dialog box. If you want
to start over, click <span class="GUI">Clear</span> to clear the text box. 
</p></dd>

<a name="feature2.2"></a>
<dt><span class="GUI">Include hydrogens</span> option</dt>
<dd><p>Select this option to include hydrogens in the volume overlap. By
default, hydrogens are not included. This option overrides any hydrogen
specifications in the ASL expression. 
</p></dd>

<a name="feature2.3"></a>
<dt><span class="GUI">Only consider MacroModel atom types</span> option</dt>
<dd><p>Select this option to require that atoms have the same MacroModel atom
types when calculating the overlap. For a grid cube to be included in the 
overlap, at least one atom from each molecule with the same MacroModel atom type
must occupy the cube.
</p></dd>

<a name="feature2.4"></a>
<dt><span class="GUI">Compute volume score</span> option</dt>
<dd><p>Calculate the volume score for the overlap, which is the overlap divided
by the total volume. 
</p></dd>

<a name="feature2.5"></a>
<dt><span class="GUI">Fixed radius</span> option and text box</dt>
<dd><p>Select this option if you want to set the radii of all atoms to a fixed
value, and specify the value in the text box. If this option is not selected,
the van der Waals radii are used to define the radii of the atomic spheres.
</p></dd>

<a name="feature2.6"></a>
<dt><span class="GUI">Grid spacing</span> text box</dt>
<dd><p>Specify the grid spacing (the dimension of the cubes) for the calculation
of the volume. The volumes are calculated by summing up the occupied cubes. A
cube is occupied if its center is inside an atomic sphere. For the overlap
volume, a cube must be occupied by an atom from both molecules; for the total
volume, a cube must be occupied by an atom from either molecule.
</p></dd>

</dl>

<a name="feature3"></a>
<h3>Clustering section</h3>
<p>In this section you can make settings to control the clustering. 
</p>

<ul>
<li><a href="#feature3.1"><span class="GUI">Linkage method</span> option menu</a></li>
<li><a href="#feature3.2"><span class="GUI">Use N as</span> text box and options</a></li>
<li><a href="#feature3.3"><span class="GUI">Incorporate results</span> option</a></li>
</ul>

<dl>

<a name="#feature3.1"></a>
<dt><span class="GUI">Linkage method</span> option menu</dt>
<dd><p>Choose a linkage method for clustering from the following:</p>
<ul>
<li>Complete&mdash;The distance between clusters is the largest distance between
any pair of objects (one object from each cluster). This option produces
compact, spherical clusters.</li>
<li>Average&mdash;The distance between clusters is the average distance between
all pairs of objects in the two clusters.</li>
<li>Single&mdash;The distance between clusters is the smallest distance between
any pair of objects (one object from each cluster). This option produces diffuse,
elongated clusters.</li>
</ul>
</dd>

<a name="feature3.2"></a>
<dt><span class="GUI">Use N as</span> text box and options</dt>
<dd><p>Choose the method for determining how many clusters are reported. If you
choose <span class="GUI">Number of clusters</span>, the number of clusters for
which the output is written out is given by the value in the text box. If you
choose <span class="GUI">Merging distance cutoff</span>, the value in the text
box is the number of clusters that is formed at or below the merging distance
specified in the text box.
</p></dd>

<a name="feature3.3"></a>
<dt><span class="GUI">Incorporate results</span> option</dt>
<dd><p>Select this option to incorporate the results as a set of entry groups in
the Project Table. The entry groups are named
<i>jobname</i><code>_</code><i>n</i>, where <i>n</i> is the cluster index.
</p></dd>

</dl>

<a name="links"></a>
<h2>Related Topics</h2>
<ul>
<li><a href="canvas_cluster.html">Canvas Similarity and Clustering Panel</a></li>
<li><a href="spectral_cluster.html">Spectral Clustering Panel</a></li>
</ul>
<hr />
<table width="100%">
<tr><td><p class="small"><a href="../support/legal_notice.html" target="LegalNoticeWindow">Legal Notice</a></p></td>
<td>
<table align="right">
<tr><td><p class="small">
File: scripts/volume_cluster.html<br />
Last updated: 12 Nov 2014
</p></td></tr>
</table>
</td></tr>
</table>
</body>
</html>
