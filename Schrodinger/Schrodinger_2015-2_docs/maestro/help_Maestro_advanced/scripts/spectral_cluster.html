<!DOCTYPE HTML PUBLIC "-//IETF//DTD HTML//EN">
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=ISO-8859-1" />
<meta http-equiv="Content-Style-Type" content="text/css" />
<link rel="stylesheet" href="../support/help.css" charset="ISO-8859-1" type="text/css" />
<title>Spectral Clustering Panel</title>
</head>
<body>
<table bgcolor="#dcdcdc" border="0" cellspacing="0" width="100%">
<tr><td>
<p><img src="../images/common/schrodinger_logo.png" align="left" alt=""
 border="0" hspace="5" vspace="5" /></p>
</td></tr>
<tr><td>
<h1 class="title">Spectral Clustering Panel</h1>
</td></tr>
</table>

<ul>
<li><a href="#summary">Summary</a></li>
<li><a href="#opening">Opening the <span class="GUI">Spectral Clustering</span> Panel</a></li>
<li><a href="#using">Using the <span class="GUI">Spectral Clustering</span> Panel</a></li>
<li><a href="#features"><span class="GUI">Spectral Clustering</span> Panel Features</a></li>
<li><a href="#links">Related Topics</a></li>
</ul>

<a name="summary"></a>
<h2>Summary</h2>

<p>Cluster the selected entries in the Project Table panel by the spectral
method, in which a similarity matrix is diagonalized and cluster memberships are
determined from the weights of each molecule in each eigenvector. Results can be
reported as cluster memberships, or cluster contributions.
</p>

<a name="opening"></a>
<h2>Opening the Spectral Clustering Panel</h2>

<p>To open the <span class="GUI">Spectral Clustering</span> panel, you can:</p>
<ul>
<li><p>Choose <span class="GUI">Scripts &rarr; Cheminformatics &rarr; Spectral Clustering</span> 
in the main window.
</p></li>
</ul>


<a name="using"></a> 
<h2>Using the Spectral Clustering Panel</h2> 


<p>In the spectral clustering method, a similarity matrix based on a set of
fingerprints is set up and diagonalized. The similarity matrix can be filtered
beforehand with a Gaussian weight function, which reduces the similarity
values. The eigenvalues and eigenvectors are then used to determine the cluster
membership. 
</p>
<p>The eigenvectors of this matrix can be used to define clusters: if the
original similarity matrix is fairly well blocked, then the eigenvectors of the
similarity matrix will only have important contributions from molecules that are
in the same block. The cluster membership is determined by applying a threshold
to the squared eigenvector elements or weights (corresponding to molecules). If
this value is above the threshold, the molecule is regarded as belonging to the
cluster.
</p>
<p>The eigenvalues represent the cohesiveness of the cluster. If the similarity
matrix is block diagonal and all the molecules in a block are identical, there
is one nonzero eigenvalue for each block whose value is the size of the block
(cluster), and the rest of the eigenvalues are zero. The population of the block
is therefore equal to the eigenvalue. If the molecules in a block are not
identical, the largest eigenvalue is smaller than the maximum possible, and the
smallest eigenvalue is larger than zero. The closer are the largest and smallest
eigenvalue, the greater is the spread of similarities within the block. Each
eigenvector then contributes a fraction of the cluster members, proportional to
the eigenvalue. The difference between the largest eigenvalue and the number of
cluster members is a measure of how dissimilar the molecules in the cluster are.
</p>
<p>To assign the cluster memberships, the eigenvalues are taken in turn from the
highest to the lowest, and for each eigenvector, the unassigned molecules whose
weight is greater than the threshold are assigned to a cluster. Eigenvalues that
are less than a threshold are ignored, because their contributions should
already be included in a cluster. Any molecules that are unassigned at the end
of this procedure are assigned to a "leftover" cluster.
</p>

<a name="features"></a> 
<h2>Spectral Clustering Panel Features</h2> 


<ul>
<li><a href="#feature1"><span class="GUI">Fingerprints</span> tab</a></li>
<li><a href="#feature2"><span class="GUI">Similarity</span> tab</a></li>
<li><a href="#feature3"><span class="GUI">Cluster</span> tab</a></li>
</ul>

<a name="feature1"></a>
<h3>Fingerprints tab</h3>
<p>In this tab, you set up the fingerprint calculation. 
</p>

<ul>
<li><a href="#feature1.1"><span class="GUI">Precision</span> options</a></li>
<li><a href="#feature1.2"><span class="GUI">Fingerprint type</span> option menu</a></li>
<li><a href="#feature1.3"><span class="GUI">Atom typing scheme</span> list</a></li>
</ul>

<dl>

<a name="#feature1.1"></a>
<dt><span class="GUI">Precision</span> options</dt>
<dd><p>Choose the fingerprint precision. A higher number of bits reduces the
chance of collisions; with 64-bit fingerprints, collisions should be extremely
rare. A higher number of bits also means that the calculation takes longer to
run.
</p></dd>

<a name="feature1.2"></a>
<dt><span class="GUI">Fingerprint type</span> option menu</dt>
<dd><p>Choose the type of fingerprint to calculate. Radial, dendritic, or
MolPrint2D often give the best results.
</p></dd>

<a name="feature1.3"></a>
<dt><span class="GUI">Atom typing scheme</span> list</dt>
<dd><p>Choose an atom typing scheme for the fingerprint calculation. If you
choose a more specific atom typing scheme, the fingerprints for each
molecule will be more distinct, and the similarities between molecules will be
smaller.
</p></dd>

</dl>

<a name="feature2"></a>
<h3>Similarity tab</h3>
<p>In this tab you choose the metric to be used when calculating the similarity
matrix. You must generate fingerprints for all of the ligands before you
calculate similarities: any ligands that don't have fingerprints are silently
ignored.
</p>
<ul>
<li><a href="#feature2.2"><span class="GUI">Similarity metric</span> option menu</a></li>
<li><a href="#feature2.3"><span class="GUI">Tversky alpha</span> and <span
class="GUI">Tversky beta</span> text boxes</a></li>
</ul>

<dl>


<a name="feature2.2"></a>
<dt><span class="GUI">Similarity metric</span> option menu</dt>
<dd><p>Choose the metric that is used for calculating similarities. The
definitions of the metrics are given in the <span
class="GUI">Similarity/Distance Matrix from Fingerprints</span> panel in
Canvas.
</p></dd>

<a name="feature2.3"></a>
<dt><span class="GUI">Tversky alpha</span> and <span class="GUI">Tversky
beta</span> text boxes</dt>
<dd><p>Specify the alpha and beta parameters if the Tversky metric is chosen
from the <span class="GUI">Similarity metric</span> option menu.
</p></dd>

</dl>

<a name="feature3"></a>
<h3>Cluster tab</h3>
<p>
</p>

<ul>
<li><a href="#feature3.1"><span class="GUI">Similarity Matrix Filter Factor</span> text box</a></li>
<li><a href="#feature3.2"><span class="GUI">Calculate Clustering</span> button</a></li>
<li><a href="#feature3.3"><span class="GUI">Assign entries to clusters</span> option</a></li>
<li><a href="#feature3.4"><span class="GUI">All cluster data above thresholds</span> option</a></li>
<li><a href="#feature3.5"><span class="GUI">Lambda cutoff</span> text box</a></li>
<li><a href="#feature3.6"><span class="GUI">Minimum cluster contribution</span> text box</a></li>
</ul>

<dl>

<a name="#feature3.1"></a>
<dt><span class="GUI">Similarity Matrix Filter Factor</span> text box</dt>
<dd><p>Set the exponent of the Gaussian function that is used to filter the
similarity matrix. The filtered matrix elements are given by</p>
<p><i>S<sub>ij</sub></i>&nbsp; exp(-&alpha; (<i>S<sub>ij</sub></i>-1)<sup>2</sup>
</p></dd>

<a name="feature3.2"></a>
<dt><span class="GUI">Calculate Clustering</span> button</dt>
<dd><p>Run the clustering calculation, and add properties to the Project Table
according to the options and cutoffs selected below.
</p></dd>

<a name="feature3.3"></a>
<dt><span class="GUI">Assign entries to clusters</span> option</dt>
<dd><p>Assign entries to clusters by considering the weight of the entry in the
eigenvectors, as described above. The result is a <span class="GUI">Cluster
Index</span> property, which reports the index of the cluster that each entry is
assigned to, the weight of the entry in its assigned cluster (<span
class="GUI">Cluster Contribution</span>), and the cohesiveness (largest
eigenvalue) of the cluster (<span class="GUI">Cluster Cohesiveness</span>). 
</p></dd>

<a name="feature3.4"></a>
<dt><span class="GUI">All cluster data above thresholds</span> option</dt>
<dd><p>Report the weight of each cluster for each eigenvector that is above the
threshold specified in the <span class="GUI">Lambda cutoff</span> text box, as
<span class="GUI">Cluster Contribution[l=<i>eigenvalue</i>]</span>.
</p></dd>

<a name="feature3.5"></a>
<dt><span class="GUI">Lambda cutoff</span> text box</dt>
<dd><p>Specify the eigenvalue cutoff for discarding unimportant eigenvectors. 
</p></dd>

<a name="feature3.6"></a>
<dt><span class="GUI">Minimum cluster contribution</span> text box</dt>
<dd><p>Specify the minimum weight that an entry must have to be considered part
of a cluster. 
</p></dd>

</dl>

<a name="links"></a>
<h2>Related Topics</h2>
<ul>
<li><a href="canvas_cluster.html">Canvas Similarity and Clustering Panel</a></li>
<li><a href="volume_cluster.html">Clustering Based on Volume Overlap Panel</a></li>
</ul>
<hr />
<table width="100%">
<tr><td><p class="small"><a href="../support/legal_notice.html" target="LegalNoticeWindow">Legal Notice</a></p></td>
<td>
<table align="right">
<tr><td><p class="small">
File: scripts/spectral_cluster.html<br />
Last updated: 12 Nov 2014
</p></td></tr>
</table>
</td></tr>
</table>
</body>
</html>
