<!DOCTYPE HTML PUBLIC "-//IETF//DTD HTML//EN">
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=ISO-8859-1" />
<meta http-equiv="Content-Style-Type" content="text/css" />
<link rel="stylesheet" href="../support/help.css" charset="ISO-8859-1" type="text/css" />
<title>LigPrep Panel</title>
</head>
<body>
<table bgcolor="#dcdcdc" border="0" cellspacing="0" width="100%">
<tr><td>
<p><img src="../images/common/schrodinger_logo.png" align="left" alt=""
 border="0" hspace="5" vspace="5" /></p>
</td></tr>
<tr><td>
<h1 class="title">LigPrep Panel</h1>
</td></tr>
</table>

<ul>
<li><a href="#summary">Summary</a></li>
<li><a href="#opening">Opening the <span class="GUI">LigPrep</span> Panel</a></li>
<li><a href="#using">Using the <span class="GUI">LigPrep</span> Panel</a></li>
<li><a href="#features"><span class="GUI">LigPrep</span> Panel Features</a></li>
<li><a href="#links">Related Topics</a></li>
</ul>

<a name="summary"></a>
<h2>Summary</h2>

<p>The <span class="GUI">LigPrep</span> panel is used to to set up and
start ligand preparation calculations. The main objective of
LigPrep is to take 2D or 3D structures and produce the corresponding low-energy
3D structures for use by programs such as Glide and QikProp. The input and
output can be in SD or Maestro format. LigPrep can produce multiple output
structures for each input structure by generating different protonation
states, stereochemistry, tautomers, and ring conformations.</p>

<a name="opening"></a>
<h2>Opening the LigPrep Panel</h2>

<p>To open the <span class="GUI">LigPrep</span> panel, you can:</p>
<ul>
<li><p>Choose <span class="GUI">Applications &rarr; LigPrep</span> 
in the main window.
</p></li>
<li><p>Choose <span class="GUI">Tasks &rarr; Small Molecule Tasks &rarr; Ligand Preparation</span> 
in the main window.
</p></li>
</ul>


<a name="using"></a> 
<h2>Using the LigPrep Panel</h2> 


<p>To run a LigPrep job, choose a structure source, make settings in the panel,
then click <span class="GUI">Run</span> to run the job with the current job
settings. If you want to change the job settings, click the <span
class="GUI">Settings</span> button and choose <span class="GUI">Job
Settings</span>. In the <span class="GUI">Job Settings</span> dialog box, you
can choose a job name and one or more hosts to run the job on, and click
<span class="GUI">Run</span> to run the job. If you choose to run on
multiple hosts, you can select the hosts from the <span class="GUI">Hosts</span>
table, and set the number of subjobs in the <span class="GUI">Separate job into
<i>N</i> subjobs</span> text box. By default the number of subjobs is set to the
number of processors used.
</p>

<p>If you obtain the structures from a file, the file can be in Maestro, SD, or
SMILES format. The SMILES file can be in one of two formats:</p>
<ul>
<li><code>.smi</code> file&mdash;Text file with one SMILES string and an
optional title per line</li> 
<li><code>.csv</code> file&mdash;Comma-separated file with SMILES string as the
first field, title as the second, followed by optional properties.</li>
</ul>

<p>If you want to run the job later from the command line, you can write an
input file by clicking <span class="GUI">Write</span>. This file can then be
used with the <span class="GUI">ligprep</span> command to run the job. 
</p>

<p>The number of structures produced can vary a great deal, depending on the
ligands being processed. The factors affecting the number of structures produced
are described below: </p>

<ul>
<li><p>In the <span class="GUI">Stereoisomers</span> section, only <span class="GUI">Generate all combinations</span> should result in many more
structures. For individual ligands the increase can be as large as
2<sup><i>n</i></sup>, where <i>n</i>
is the number of chiral centers. For large data sets the increase is typically
around 1.5, but is very dependent on the classes of molecules being processed.
You can reduce the number of structures produced by entering a smaller value in
<span class="GUI">Generate stereoisomers (maximum)</span>, however
this does increase the risk of missing important stereoisomers.</p></li>

<li><p>In the <span class="GUI">Ionization</span> section, only
<span class="GUI">Generate possible states at target pH</span> should
increase the number of structures. The increase is typically a factor of
approximately 1.4 for a pH range of 2.0. Reducing the pH range significantly
reduces this factor. </p></li>

<li><p>The <span class="GUI">Generate tautomers</span> option typically increases
the number of structures by less than 20%. </p></li>

<li><p>The number of structures is roughly proportional to, but less than, the
number of low energy ring conformations per ligand.</p></li>
</ul>

<p>The structures that are produced can be filtered on the basis of various
predefined descriptors. These descriptors are counts of various kinds of
structural components, including a range of functional groups. You can filter the
structures generated by LigPrep using a file that defines conditions on these
descriptors. The descriptors are:</p>
<table cellpadding=1>
<tr>
<td>Num rings</td>
<td>&nbsp;</td>
<td>Num heteroaromatic rings</td>
</tr>
<tr>
<td>Num aromatic rings</td>
<td>&nbsp;</td>
<td>Num aliphatic rings</td>
</tr>
<tr>
<td>Num rotatable bonds</td>
<td>&nbsp;</td>
<td>Num atoms</td>
</tr>
<tr>
<td>Molecular weight</td>
<td>&nbsp;</td>
<td>Num chiral centers</td>
</tr>
<tr>
<td>Num neutral amines</td>
<td>&nbsp;</td>
<td>Num amide hydrogens</td>
</tr>
<tr>
<td>Num divalent oxygen atoms</td>
<td>&nbsp;</td>
<td>Num neutral donor groups</td>
</tr>
<tr>
<td>Num charged donor groups</td>
<td>&nbsp;</td>
<td>Num neutral acceptor groups</td>
</tr>
<tr>
<td>Num charged acceptor groups</td>
<td>&nbsp;</td>
<td>Num reactive groups</td>
</tr>
<tr>
<td>Num acidic hydrogens</td>
<td>&nbsp;</td>
<td>Num donor groups</td>
</tr>
<tr>
<td>Num acceptor groups</td>
<td>&nbsp;</td>
<td>&nbsp;</td>
</tr>
</table>

<p>This file can be created by clicking <span class="GUI">Create</span>, and
constructing the list of criteria in the
<a href="../tools_menu/ligfilter.html"><span class="GUI">Ligand Filtering
</span> dialog box</a>.
An example input file is given below. Comment lines start with ##.</p>
<pre>
##Remove molecules that have a molecular weight of greater than 650
Molecular weight &gt;650.0
## Remove molecules with too many H-bond acceptor and donor atoms
Num acceptor groups &gt;3
Num donor groups &gt;3
##Remove molecules with fewer than 10 atoms
Num atoms &lt;10
</pre>
<p>For more information, see the
<a href="../../../ligprep/ligprep_user_manual.pdf"
target="pdfmanuals">chapter on <code>ligfilter</code></a> in the
<a href="../../../ligprep/ligprep_user_manual.pdf"
target="pdfmanuals"><i>LigPrep User Manual</i></a>.</p>

<p>Generating large numbers of output structures (&gt;150,000) in a single run
can be very time consuming. If you want to generate large numbers of structures,
you can distribute the LigPrep job across multiple processors on a multiprocessor
host, by selecting the host and entering the number of processors in the
<span class="GUI">Job Settings</span> dialog box. </p>

<p>If structures cannot be processed for some reason, the input structures
are copied to a file named <i>jobname</i><code>-failed.</code><i>ext</i>, which
is in the same format as the input file. The structure numbers from the input
file are reported at the end of a log file, along with the stage in which the
failure occurred. 
</p>

<a name="features"></a> 
<h2>LigPrep Panel Features</h2> 


<ul>
<li><a href="#structures"><span class="GUI">Use structures from</span> option menu</a></li>
<li><a href="#file"><span class="GUI">File name</span> text box and <span class="GUI">Browse</span> button</a></li>
<li><a href="#feature3"><span class="GUI">Filter criteria file</span> text box and
buttons</a></li>
<li><a href="#feature4"><span class="GUI">Force field</span> option menu</a></li>

<li><a href="#feature5"><span class="GUI">Ionization</span> section</a></li>
<li><a href="#feature8"><span class="GUI">Desalt</span> option</a></li>
<li><a href="#feature9"><span class="GUI">Generate tautomers</span> option</a></li>
<li><a href="#feature6"><span class="GUI">Stereoisomers</span> section</a></li>
<li><a href="#feature7"><span class="GUI">Generate low energy ring
conformations</span> text box</a></li>
<li><a href="#feature10"><span class="GUI">Output format</span> options</a></li>
<li><a href="#job_toolbar">Job toolbar</a></li>
<li><a href="#status_bar">Status bar</a></li>
</ul>

<dl>

<a name="structures"></a>
<dt><span class="GUI">Use structures from</span> option menu</dt>
<dd>
<p>Choose the source of the structures for the current task.
</p>
<ul>
<li><span class="GUI">Project Table (selected entries)</span>&mdash;Use the
entries that are currently selected in the Project Table.
</li>
<li><span class="GUI">Workspace (included entries)</span>&mdash;Use the entries
that are currently included in the Workspace, treated as separate structures.  
The Workspace should not contain a scratch entry.
</li>
<li><span class="GUI">File</span>&mdash;Use the structures from the specified
file. When this option is selected, the <span class="GUI">File name</span> text 
box and <span class="GUI">Browse</span> button are activated.  Click
<span class="GUI">Browse</span> and navigate to the file you want to
use. The file name is displayed in the text box when you click <span
class="GUI">Open</span> in the file selector.
You can also enter the file name in the text box.
</li>
</ul>
</dd>

<a name="file"></a>
<dt><span class="GUI">File name</span> text box and <span
class="GUI">Browse</span> button</dt>
<dd><p>If you chose <span class="GUI">File</span> from the <span class="GUI">Use
structures from</span> option menu, enter the file name in this text box, or click <span class="GUI">Browse</span> and navigate to the structure file. 
The name of the file you selected is displayed in the text box.

</p></dd>

<a name="feature3"></a>
<dt><span class="GUI">Filter criteria file</span> text box and
buttons</dt>
<dd><p>
Enter the name of a file that contains criteria on molecular descriptors for
filtering, click <span class="GUI">Browse</span> to select an existing filter
criteria file, or click <span class="GUI">Create</span> to create a new filter
criteria file in the <a href="../tools_menu/ligfilter.html"><span
class="GUI">Ligand Filtering</span> dialog box</a>.</p></dd>

<a name="feature4"></a>
<dt><span class="GUI">Force field</span> option menu</dt>
<dd><p>Select the force field to use for minimization of structures. 
Three choices are available: <span class="GUI">OPLS_2005</span>, <span
class="GUI">MMFFs</span>, and <span class="GUI">OPLS3</span>. 
The default is <span class="GUI">OPLS_2005</span>, unless you set the default
in the <a href="../maestro_menu/preferences.html#jobs_forcefield"><span
class="GUI">Preferences</span> panel</a>.
</p></dd>



<a name="feature5"></a>
<dt><span class="GUI">Ionization</span> section</dt>
<dd>
<p>Select a strategy for determining the ionization state of the ligand. The
ionization states are generated by adding or removing protons from the
ligand.</p>
<ul>
<li><p>
<span class="GUI">Do not change</span>: Do not change the ionization state of
the ligand.</p></li>
<li><p>
<span class="GUI">Neutralize</span>: Ensure that the ligand is neutral by
adding or removing protons, according to the pK<sub>a</sub> values of the acidic
or basic sites.</p></li>
<li><p>
<span class="GUI">Generate possible states at target pH</span>: Generate
ionization states that are significantly populated in the pH range specified by
the values in the two text boxes. There are two programs available for
generating the states, listed next to <span class="GUI">Using</span>: </p>
<ul>
<li><p><span class="GUI">Ionizer</span>&mdash;use the Ionizer (the default)
</p></li>
<li><p><span class="GUI">Epik</span>&mdash;use Epik. Epik has two options that
can be used:
</p>
<p><span class="GUI">Add metal binding states</span>&mdash;Generate states that
are appropriate for binding to metals in addition to the normal ionization
states.</p>
<p><span class="GUI">Include original state</span>&mdash;Include the original
ionization state in addition to the generated states. 
</p></li>
</ul>
<p>To use Epik, you must have an Epik license, as Epik is a separate
product. Ionizer is included with LigPrep. Epik is more comprehensive in its
treatment than Ionizer. 
</p></li>
</ul>
</dd>

<a name="feature8"></a>
<dt><span class="GUI">Desalt</span> option</dt>
<dd><p>
Structures from some databases can consist of multiple molecules, one of
which is the ligand. In many cases, the extra molecules are counter ions or
water molecules. Select this option to remove
all but the molecule with the largest number of atoms.
</p></dd>

<a name="feature9"></a>
<dt><span class="GUI">Generate tautomers</span> option</dt>
<dd><p>
Tautomers are thermally accessible and interchangeable isomers of molecules
in which the non-hydrogen topology of the molecule remains unmodified while
hydrogen atoms are relocated and bond orders change. Select this option to generate
tautomers with significant populations for each input structure.
This option is recommended for preparing ligands for both Glide and QikProp
calculations. If you selected <span class="GUI">Epik</span> for ionization, it
will also be used for generating tautomers.
</p></dd>

<a name="feature6"></a>
<dt><span class="GUI">Stereoisomers</span> section</dt>
<dd>
<p>Select the treatment of stereochemical information in the
input and the generation of stereoisomers in the output. There are three options
under the <span class="GUI">Computation</span> heading that control the source
of stereoisomers:</p>
<ul>
<li><p><span class="GUI">Retain specified chiralities (vary other chiral
centers)</span>&mdash; Keep the information on chiralities from the input file,
and fix these chiralities for the entire calculation. Chirality information
includes parities and bond directions from SD files, and the chirality property
from Maestro files. Maestro chiralities are only written by the
<code>stereoizer</code> utility. If the configuration or chirality of a chiral
center is not specified, the two possible chiralities are generated in the
output.</p></li>
<li><p>
<span class="GUI">Determine chiralities from 3D structure</span>&mdash;
Discard all chirality information in the input file, and determine the chirality
from the 3D geometry.  These chiralities are held fixed. For centers whose
chirality is indeterminate, structures for the two possible chiralities for each
center are generated. (Sets the <code>-g</code> option of the <span
class="GUI">ligprep</span> command.)</p></li>
<li><p>
<span class="GUI">Generate all combinations</span>&mdash; Discard all
chirality information, both from input file properties and from the 3D geometry,
and generate all possible configurations that result from the combination of
chiralities on each chiral center. (Sets the <code>-ac</code> option of the
<span class="GUI">ligprep</span> command.) </p></li>
</ul>

<p>You can limit the number of stereoisomers to generate in the
<span class="GUI">Generate at most <i>N</i> per ligand</span> text box. </p>

<p>Select <span class="GUI">For SD V2000 input, generate enantiomers if the
chiral flag is 0</span>, if you have SD input and want both enantiomers to be
generated if the chiral flag is set to zero. The default is to generate only
the enantiomer represented by the specified chiralities. This setting is stored
as a preference, so it is preserved across Maestro sessions.
</p>


<p>When stereoisomers are generated for fused ring systems, the correlation
between chiralities on chiral centers in the rings is taken into account, and
invalid combinations are not generated.</p>
</dd>

<a name="feature7"></a>
<dt><span class="GUI">Generate low energy ring conformations</span> text
box</dt>
<dd><p>
LigPrep can generate ring conformations and evaluate an approximate
conformational energy to determine which conformations are likely to be
lowest in energy. Specify how many conformations are kept,
counting from the lowest in energy.</p></dd>

<a name="feature10"></a>
<dt><span class="GUI">Output format</span> options</dt>
<dd><p>
Specify the file format for the output file. If you want to incorporate the
structures into the current project, you must select <span
class="GUI">Maestro</span> for the format.  In Maestro format, the structures
are written to the file <i>jobname</i><code>.maegz</code>. In SDF format, the
structures are written to the file <i>jobname</i><code>.sdf</code>.
</p></dd>

<a name="job_toolbar"></a>
<dt>Job toolbar</dt>
<dd><p>The Job toolbar is used to make settings for a job and to start it. </p>

<dl>
<dt><span class="GUI">Job name</span> text box</dt>
<dd><p>Enter a name for the job in this text box.
</p></dd>
<dt><span class="GUI">Settings</span> button menu</dt>
<dd><p>This button opens the <a href="../misc/job_settings.html"><span
class="GUI">Job Settings</span> dialog box</a>. The arrow to the right opens
a menu, from which you can make settings or perform actions that are related to
the job. </p>
<img src="../images/MaestroToolbarIcons/settings.png" />
<p>The menu items are described below.</p>
<ul>
<li><span class="GUI">Job Settings</span>&mdash;Make and save settings for the
incorporation of the job into the Maestro project, the job name, the host,
the distribution of subjobs, and any other application-specific job settings.
Opens the <span class="GUI">Job Settings</span> dialog box.</li>
<li><span class="GUI">Preferences</span>&mdash;Set general preferences for
running jobs. Opens the <span class="GUI">Preferences</span> panel at the <a
href="../maestro_menu/preferences.html#jobs_starting"><span class="GUI">Jobs - 
Starting</span> section</a>.</li>
<li><span class="GUI">Read</span>&mdash;Read an inputfile and apply the settings in the file to the panel controls.
Opens a file selector in which you can navigate to the desired input file.</li>
<li><span class="GUI">Write</span>&mdash;Write the input files for the job but do not start it. 
The file names are based on the current job name, and the files are written to
a subdirectory of the current working directory that is named with the job
name.</li>
</ul>
</dd>

<dt><span class="GUI">Job status</span> button</dt>
<dd><p>This icon indicates when there are jobs running for the application that
belong to the current project. It starts spinning when the first job starts, and
stops when there are no more jobs running. If a job fails to start, it changes
to an exclamation point. 
</p>
<img src="../images/MaestroToolbarIcons/job_status.png" />
<p>
Clicking the button shows a small job status window that lists the job name and
status for all active jobs submitted from the current panel (for Jaguar and
MacroModel this means all jobs from any of the application panels). You can
double-click on a row to open the <a href="../misc/monitor_panel.html"><span
class="GUI">Monitor</span> panel</a> and monitor the job, or click the <span
class="GUI">Monitor</span> button to open the <span class="GUI">Monitor</span>
panel and close the job status window. The job status is updated while the
window is open. If a job finishes while the window is open, the job remains
displayed but with the new status.  The rows are colored according to the
status: yellow for submitted, green for launched, running, or finished, red for
incorporated, died, or killed.  Click anywhere outside the window to close it.
</p></dd>

<dt><span class="GUI">Run</span> button</dt>
<dd><p>Run the job with the current job settings.
</p></dd>
</dl>
</dd>


<a name="status_bar"></a>
<dt>Status bar</dt>
<dd><p>The status bar displays information about the current job settings for the
panel. This includes the job name, task name and task settings (if any), number
of subjobs (if any) and the host name and job incorporation setting. It also
displays a message for a short time when you start a new job.</p>
<p>The status bar also contains the <span class="GUI">Help</span> button, which
opens the help topic for the panel.</p>
<img src="../images/MaestroToolbarIcons/help.png" />
</dd>

</dl>

<a name="links"></a>
<h2>Related Topics</h2>
<ul>
<li><a href="../project_facility/project_overview.html">Project Facility</a></li>
<li><a href="../project_facility/project_table.html">Project Table Panel</a></li>
<li><a href="../tools_menu/ligfilter.html">Ligand Filtering Panel</a></li>
<li><a href="../misc/job_settings.html">Job Settings Dialog Box</a></li>
<li><a href="../misc/monitor_panel.html">Monitor Panel</a></li>
</ul>
<hr />
<table width="100%">
<tr><td><p class="small"><a href="../support/legal_notice.html" target="LegalNoticeWindow">Legal Notice</a></p></td>
<td>
<table align="right">
<tr><td><p class="small">
File: ligprep/ligprep.html<br />
Last updated: 06 May 2015
</p></td></tr>
</table>
</td></tr>
</table>
</body>
</html>
