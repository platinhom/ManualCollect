<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>Interacting with Maestro &mdash; Schrödinger Python Suite 2015-2 Documentation</title>
    
    <link rel="stylesheet" href="_static/default.css" type="text/css" />
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    './',
        VERSION:     '4.9',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="_static/jquery.js"></script>
    <script type="text/javascript" src="_static/underscore.js"></script>
    <script type="text/javascript" src="_static/doctools.js"></script>
    <link rel="top" title="Schrödinger Python Suite 2015-2 Documentation" href="index.html" />
    <link rel="next" title="Product Specific Modules" href="product_specific.html" />
    <link rel="prev" title="Structures" href="structure_overview.html" /> 
  </head>
  <body>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="product_specific.html" title="Product Specific Modules"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="structure_overview.html" title="Structures"
             accesskey="P">previous</a> |</li>
        <li><a href="overview.html">Schrödinger Python Suite 2015-2 Documentation</a> &raquo;</li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body">
            
  <div class="section" id="interacting-with-maestro">
<span id="maestro-overview"></span><span id="index-0"></span><h1>Interacting with Maestro<a class="headerlink" href="#interacting-with-maestro" title="Permalink to this headline">¶</a></h1>
<div class="section" id="basic-concepts">
<h2>Basic Concepts<a class="headerlink" href="#basic-concepts" title="Permalink to this headline">¶</a></h2>
<p>In order to effectively write scripts that control Maestro a basic
understanding of Maestro concepts is needed. The two most important concepts
are the Project Table and the Workspace.</p>
<p id="index-1">A Maestro project is a collection of Structures and associated data, and the
Project Table is the way in which this data is viewed and modified. The
Project Table contains zero or more rows. Each row is referred to as an
entry and consists of a Structure (a collection of atoms) and zero or more
properties that appear as columns in the table. Each column in the Project
Table corresponds to a different property. Acceptable property types are:
Boolean, integer, floating point, and string. Properties are most commonly
produced from computational jobs but can also be generated by Maestro or
added manually by users.</p>
<p id="index-2">The Workspace is the 3D molecular display area in the main Maestro window.
The 3D items displayed in this area include the molecular structure, labels,
measurements, ribbons, markers, and surfaces. You can include multiple
Project Table entries simultaneously into the Workspace for viewing,
analysis or modification. Note that Project Table entries loaded into the
Workspace contain only their structural information, and so Structures
retrieved via the Workspace do not have properties available.</p>
<p>It is important to understand that entries (Structures) that have been
modified in the Workspace are not immediately updated in the Project Table.
By default, updates happen when the entry is implicitly or explicitly
excluded from the Workspace. Thus, when writing Python scripts in which you
manipulate an entry in the Workspace, you need to synchronize the Workspace
changes with the Project Table before using a Structure entry from the
Project Table. For safety, you should also synchronize the Workspace and
Project Table for cases where you simply want to get the structural
information for an entry in the Project Table. You can also register a
&#8220;Workspace changed&#8221; <a class="reference internal" href="#workspace-changed-callback"><em>callback function</em></a>
to know when synchronization with the project is required.</p>
<p>In contrast with structural changes, entry properties are immediately
updated in the project when they are edited in the Project Table.</p>
</div>
<div class="section" id="running-scripts-from-maestro">
<span id="index-3"></span><h2>Running Scripts from Maestro<a class="headerlink" href="#running-scripts-from-maestro" title="Permalink to this headline">¶</a></h2>
<p>From the Maestro Command Input Area, you can run individual functions from
modules, but you can&#8217;t run scripts as a whole. The following Maestro command
will run function <tt class="docutils literal"><span class="pre">func</span></tt> from script <tt class="file docutils literal"><span class="pre">script.py</span></tt>:</p>
<div class="highlight-python"><div class="highlight"><pre>pythonrun script.func
</pre></div>
</div>
<p>The <tt class="file docutils literal"><span class="pre">script.py</span></tt> file must be in the directory Maestro was launched
from.</p>
<p>Arguments can also be passed to the functions. For example, if <tt class="docutils literal"><span class="pre">function1</span></tt>
takes one argument and <tt class="docutils literal"><span class="pre">function2</span></tt> takes two arguments:</p>
<div class="highlight-python"><div class="highlight"><pre>pythonrun script.function1 5
pythonrun script.function2 3 5
</pre></div>
</div>
<p>The pythonrun can only interpret its arguments as integers, floats, and
strings. Numbers with decimal points or in scientific notation are converted
to floats, other numbers are converted to integers, and everything else is a
string. (To pass numbers as strings, enclose them in single quotes.) This
means that there is no support for use of <tt class="docutils literal"><span class="pre">None</span></tt>, <tt class="docutils literal"><span class="pre">True</span></tt> or <tt class="docutils literal"><span class="pre">False</span></tt>,
lists, tuples, etc. — they are all converted to strings. Use <tt class="docutils literal"><span class="pre">pythoneval</span></tt>
for situations where this limitation is not acceptable.</p>
<p>The <tt class="docutils literal"><span class="pre">pythonrun</span></tt> command works by first importing the module, then running
the specified function. So, if you make changes to your module
<tt class="file docutils literal"><span class="pre">script.py</span></tt>, you need to force Maestro to import it again to see the
changes. This can be done via:</p>
<div class="highlight-python"><div class="highlight"><pre>pythonimport script
</pre></div>
</div>
<p>In addition to <tt class="docutils literal"><span class="pre">pythonrun</span></tt> and <tt class="docutils literal"><span class="pre">pythonimport</span></tt>, the Maestro command
<tt class="docutils literal"><span class="pre">pythoneval</span></tt> is available and can take python commands in standard
syntax. For example:</p>
<div class="highlight-python"><div class="highlight"><pre>pythoneval import script
pythoneval script.function(5, True, [&#39;a&#39;, 4])
</pre></div>
</div>
<p>Use of <tt class="docutils literal"><span class="pre">pythoneval</span></tt> is roughly equivalent to typing commands on the
interactive prompt. Use the Python builtin function <tt class="xref py py-obj docutils literal"><span class="pre">reload</span></tt> to re-import a
modified module.</p>
<p>Note that you can define aliases in the Maestro Command Input Area. For
example, to make <tt class="docutils literal"><span class="pre">py</span></tt> an alias for <tt class="docutils literal"><span class="pre">pythoneval</span></tt>, run:</p>
<div class="highlight-python"><div class="highlight"><pre>alias py pythoneval
</pre></div>
</div>
</div>
<div class="section" id="adding-your-script-to-the-maestro-scripts-menu">
<span id="index-4"></span><h2>Adding Your Script to the Maestro Scripts Menu<a class="headerlink" href="#adding-your-script-to-the-maestro-scripts-menu" title="Permalink to this headline">¶</a></h2>
<p>You can choose to install or manage your scripts from the the
<em class="menuselection">Scripts ‣ Install</em> and <em class="menuselection">Scripts ‣ Manage</em>
menus in Maestro.  However, you need to include some additional information
in your script so that you can view and manage your scripts in these menus.
This info consists of a module-level docstring with an explicit assignment
to <tt class="docutils literal"><span class="pre">__doc__</span></tt>, followed by a comment that begins with <tt class="docutils literal"><span class="pre">#Name:</span></tt> and a
second comment that begins with <tt class="docutils literal"><span class="pre">#Command:</span></tt>. For example:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">__doc__</span> <span class="o">=</span> <span class="s">&quot;&quot;&quot;</span>
<span class="s">The docstring should contain a description of the script. It is</span>
<span class="s">displayed as a summary in the script installation panel.</span>

<span class="s">The docstring is not strictly required but is a good practice.</span>

<span class="s">&quot;&quot;&quot;</span>
<span class="c">#Name: Compute Distances</span>
<span class="c">#Command: pythonrun myscript.compute_distances</span>
</pre></div>
</div>
<p>The <tt class="docutils literal"><span class="pre">#Name</span></tt> comment determines the label that will appear in the
<em class="menuselection">Scripts</em> menu. The <tt class="docutils literal"><span class="pre">#Command</span></tt> comment provides a command
that will be run when the item is selected in the <em class="menuselection">Scripts</em>
menu. A script may have multiple <tt class="docutils literal"><span class="pre">#Name</span></tt> and <tt class="docutils literal"><span class="pre">#Command</span></tt> pairs, in which
case there will be multiple entries in the <em class="menuselection">Scripts</em> menu.</p>
<p>It&#8217;s also possible to create hierarchical menus by using a <tt class="docutils literal"><span class="pre">#Name</span></tt> value
of the form <tt class="docutils literal"><span class="pre">submenu:menu_item</span></tt>. For example,</p>
<div class="highlight-python"><div class="highlight"><pre><span class="c">#Name: My Scripts:Plot All Data</span>
</pre></div>
</div>
<p>will result in a cascading menu <em class="menuselection">My Scripts</em> that can be used
by multiple scripts. This is a powerful organization mechanism.</p>
</div>
<div class="section" id="the-maestro-module">
<h2>The Maestro Module<a class="headerlink" href="#the-maestro-module" title="Permalink to this headline">¶</a></h2>
<p>The <a class="reference external" href="api/schrodinger.maestro.maestro-module.html">Maestro module</a> contains functions for interacting with Maestro. Note
that the Maestro module may only be used for scripts that are running inside
Maestro scripts. Trying to import <tt class="xref py py-obj docutils literal"><span class="pre">schrodinger.maestro</span></tt> outside of Maestro
will result in an <tt class="xref py py-obj docutils literal"><span class="pre">ImportError</span></tt>.</p>
<div class="section" id="executing-maestro-commands-from-a-script">
<span id="index-5"></span><h3>Executing Maestro Commands from a Script<a class="headerlink" href="#executing-maestro-commands-from-a-script" title="Permalink to this headline">¶</a></h3>
<p>You can use the same commands you would type in the Maestro Command Input
Area from within Python:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="kn">from</span> <span class="nn">schrodinger.maestro</span> <span class="kn">import</span> <span class="n">maestro</span>
<span class="k">def</span> <span class="nf">rotate_by</span><span class="p">(</span><span class="n">by</span> <span class="o">=</span> <span class="mi">90</span><span class="p">):</span>
    <span class="n">maestro</span><span class="o">.</span><span class="n">command</span><span class="p">(</span><span class="s">&quot;rotate y=</span><span class="si">%d</span><span class="s">&quot;</span> <span class="o">%</span> <span class="n">by</span><span class="p">)</span>
</pre></div>
</div>
<p>The hundreds of available commands and their options are documented in the
Maestro Command Reference Manual.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">You can review the commands that have been issued in the normal
operation of Maestro by choosing Command Script Editor from the Edit
menu.</p>
</div>
<p>There are several different ways the maestro.command function may be called,
see the <a class="reference external" href="api/schrodinger.maestro.maestro-module.html#command">command</a> function for more details.</p>
<p>One useful group of Maestro commands is <tt class="docutils literal"><span class="pre">markers</span></tt>, <tt class="docutils literal"><span class="pre">showmarkers</span></tt> and
<tt class="docutils literal"><span class="pre">hidemarkers</span></tt>. These can be used to define a marker group, and then to
show or hide them. Syntax is as follows:</p>
<div class="highlight-python"><div class="highlight"><pre>markers &lt;marker name&gt; &lt;ASL&gt; red=&lt;value&gt; blue=&lt;value&gt; green=&lt;value&gt;
showmarkers &lt;marker name&gt;
hidemarkers &lt;marker name&gt;
</pre></div>
</div>
</div>
<div class="section" id="interacting-with-the-workspace">
<span id="maestro-workspace"></span><span id="index-6"></span><h3>Interacting with the Workspace<a class="headerlink" href="#interacting-with-the-workspace" title="Permalink to this headline">¶</a></h3>
<p>The <a class="reference external" href="api/schrodinger.maestro.maestro-module.html#workspace_get">workspace_get</a> and <a class="reference external" href="api/schrodinger.maestro.maestro-module.html#workspace_set">workspace_set</a> functions let a script get a
<tt class="xref py py-obj docutils literal"><span class="pre">Structure</span></tt> from and send a <tt class="xref py py-obj docutils literal"><span class="pre">Structure</span></tt> to the Maestro workspace.</p>
<div class="highlight-python"><div class="highlight"><pre><span class="kn">from</span> <span class="nn">schrodinger.maestro</span> <span class="kn">import</span> <span class="n">maestro</span>
<span class="kn">from</span> <span class="nn">schrodinger</span> <span class="kn">import</span> <span class="n">structure</span>
<span class="n">st</span> <span class="o">=</span> <span class="n">maestro</span><span class="o">.</span><span class="n">workspace_get</span><span class="p">()</span>
<span class="c"># ... manipulate structure here ...</span>
<span class="n">maestro</span><span class="o">.</span><span class="n">workspace_set</span><span class="p">(</span><span class="n">st</span><span class="p">)</span>
</pre></div>
</div>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">The <tt class="xref py py-obj docutils literal"><span class="pre">workspace_get</span></tt> function does not preserve the properties of entries
in the workspace that are included from the Project Table. To obtain
included project table entries and their properties, use the
<tt class="xref py py-obj docutils literal"><span class="pre">included_rows</span></tt> iterator described in the next section.</p>
</div>
</div>
</div>
<div class="section" id="interacting-with-the-project-table">
<span id="maestro-project-table"></span><span id="index-7"></span><h2>Interacting with the Project Table<a class="headerlink" href="#interacting-with-the-project-table" title="Permalink to this headline">¶</a></h2>
<p>The <a class="reference external" href="api/schrodinger.project-module.html">project module</a> allows Python scripts to interact with the Project
Table.</p>
<div class="highlight-python"><div class="highlight"><pre><span class="kn">from</span> <span class="nn">schrodinger</span> <span class="kn">import</span> <span class="n">maestro</span>
<span class="kn">from</span> <span class="nn">schrodinger</span> <span class="kn">import</span> <span class="n">project</span>

<span class="n">pt</span> <span class="o">=</span> <span class="n">maestro</span><span class="o">.</span><span class="n">project_table_get</span><span class="p">()</span>

<span class="k">for</span> <span class="n">row</span> <span class="ow">in</span> <span class="n">pt</span><span class="o">.</span><span class="n">selected_rows</span><span class="p">:</span>
    <span class="n">st</span> <span class="o">=</span> <span class="n">row</span><span class="o">.</span><span class="n">getStructure</span><span class="p">()</span>
    <span class="c"># .. compute new value &#39;new_value&#39; for this structure here ...</span>
    <span class="n">row</span><span class="p">[</span><span class="s">&#39;r_user_New_Property&#39;</span><span class="p">]</span> <span class="o">=</span>  <span class="n">new_value</span>

<span class="n">pt</span><span class="o">.</span><span class="n">update</span><span class="p">()</span>
</pre></div>
</div>
<p>There are three ways to iterate over entries in the Project Table:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="kn">from</span> <span class="nn">schrodinger</span> <span class="kn">import</span> <span class="n">maestro</span>
<span class="kn">from</span> <span class="nn">schrodinger</span> <span class="kn">import</span> <span class="n">project</span>
<span class="n">pt</span> <span class="o">=</span> <span class="n">maestro</span><span class="o">.</span><span class="n">project_table_get</span><span class="p">()</span>

<span class="c"># To iterate over all selected rows, use:</span>
<span class="k">for</span> <span class="n">row</span> <span class="ow">in</span> <span class="n">pt</span><span class="o">.</span><span class="n">selected_rows</span><span class="p">:</span>
    <span class="k">pass</span>

<span class="c"># To iterate over all entries included in the workspace, use:</span>
<span class="k">for</span> <span class="n">row</span> <span class="ow">in</span> <span class="n">pt</span><span class="o">.</span><span class="n">included_rows</span><span class="p">:</span>
    <span class="k">pass</span>

<span class="c"># To iterate over all rows:</span>
<span class="k">for</span> <span class="n">row</span> <span class="ow">in</span> <span class="n">pt</span><span class="o">.</span><span class="n">all_rows</span><span class="p">:</span>
    <span class="k">pass</span>

<span class="c"># To get a list of Structure objects (with properties) for Project Table</span>
<span class="c"># entries included in the workspace:</span>
<span class="n">included_structures</span> <span class="o">=</span> <span class="p">[]</span>
<span class="k">for</span> <span class="n">row</span> <span class="ow">in</span> <span class="n">pt</span><span class="o">.</span><span class="n">included_rows</span><span class="p">:</span>
    <span class="n">included_structures</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">row</span><span class="o">.</span><span class="n">getStructure</span><span class="p">())</span>
</pre></div>
</div>
<p>Selecting entries in the project table may be performed by a number of
different mechanisms. Maestro has built-in support for selecting entries with
<tt class="docutils literal"><span class="pre">entryselectonly</span></tt> and similar commands. This support is provided by both the
Entry Selection dialog box and the ability to define filters (see the
Maestro online help and the Maestro User Manual for complete descriptions
of these features).</p>
<p>However, there are limits to what type of selections can be generated with
these features. They all rely on Maestro&#8217;s Entry Selection Language (ESL).
The ESL was designed to work on the properties associated with entries.
While it is possible to create expressions of arbitrary complexity with the
ESL, it is not possible to make selections based on calculations performed
on the actual structure (number of atoms etc.) nor to make selections based
on functions of the entry properties (such as the difference between two
properties). To set the selected state of a given entry the is_selected
property can be used:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="kn">from</span> <span class="nn">schrodinger</span> <span class="kn">import</span> <span class="n">maestro</span>
<span class="kn">from</span> <span class="nn">schrodinger</span> <span class="kn">import</span> <span class="n">project</span>
<span class="n">pt</span> <span class="o">=</span> <span class="n">maestro</span><span class="o">.</span><span class="n">project_table_get</span><span class="p">()</span>

<span class="k">for</span> <span class="n">row</span> <span class="ow">in</span> <span class="n">pt</span><span class="o">.</span><span class="n">all_rows</span><span class="p">:</span>
    <span class="k">if</span> <span class="n">row</span><span class="p">[</span><span class="s">&#39;r_some_prop&#39;</span><span class="p">]</span> <span class="o">-</span> <span class="n">row</span><span class="p">[</span><span class="s">&#39;r_some_other_prop&#39;</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mf">0.001</span><span class="p">:</span>
       <span class="n">row</span><span class="o">.</span><span class="n">is_selected</span> <span class="o">=</span> <span class="bp">True</span>
    <span class="k">else</span><span class="p">:</span>
       <span class="n">row</span><span class="o">.</span><span class="n">is_selected</span> <span class="o">=</span> <span class="bp">False</span>
</pre></div>
</div>
<p>It&#8217;s also possible to add any number of new columns to the project table from
a Python script. Simply reference new properties of any row:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="kn">from</span> <span class="nn">schrodinger.maestro</span> <span class="kn">import</span> <span class="n">maestro</span>
<span class="kn">from</span> <span class="nn">schrodinger</span> <span class="kn">import</span> <span class="n">project</span>


 <span class="n">pt</span> <span class="o">=</span> <span class="n">maestro</span><span class="o">.</span><span class="n">project_table_get</span><span class="p">()</span>

 <span class="k">for</span> <span class="n">row</span> <span class="ow">in</span> <span class="n">pt</span><span class="o">.</span><span class="n">all_rows</span><span class="p">:</span>

     <span class="n">st</span> <span class="o">=</span> <span class="n">row</span><span class="o">.</span><span class="n">structure</span>

     <span class="n">num_h_atoms</span> <span class="o">=</span> <span class="mi">0</span>
     <span class="n">num_c_atoms</span> <span class="o">=</span> <span class="mi">0</span>
     <span class="k">for</span> <span class="n">a</span> <span class="ow">in</span> <span class="n">st</span><span class="o">.</span><span class="n">atom</span><span class="p">:</span>
         <span class="k">if</span> <span class="n">a</span><span class="o">.</span><span class="n">atomic_number</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
             <span class="n">num_h_atoms</span> <span class="o">+=</span> <span class="mi">1</span>
         <span class="k">elif</span> <span class="n">a</span><span class="o">.</span><span class="n">atomic_number</span> <span class="o">==</span> <span class="mi">6</span><span class="p">:</span>
             <span class="n">num_c_atoms</span> <span class="o">+=</span> <span class="mi">1</span>

     <span class="c"># Add or overwrite if already present</span>
     <span class="c"># Format for name is: &lt;type&gt;_&lt;author&gt;_&lt;property_name&gt;</span>
     <span class="c"># type can be i (integer), r (real), b (boolean), s (string)</span>
     <span class="c"># author is &quot;m&quot; for maestro, &quot;user&quot; for user, etc.</span>
     <span class="c"># property_name is any text. Underscores are allowed.</span>
     <span class="n">row</span><span class="p">[</span><span class="s">&#39;i_user_Num_Carbons&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">num_c_atoms</span>
     <span class="n">row</span><span class="p">[</span><span class="s">&#39;i_user_Num_Hydrogens&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">num_h_atoms</span>

 <span class="n">pt</span><span class="o">.</span><span class="n">refreshTable</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="section" id="registering-functions-to-be-called-by-maestro">
<span id="index-8"></span><h2>Registering Functions to be Called By Maestro<a class="headerlink" href="#registering-functions-to-be-called-by-maestro" title="Permalink to this headline">¶</a></h2>
<p>Normally, the Python functions you write for use in Maestro will be called
explicitly with the <tt class="docutils literal"><span class="pre">pythonrun</span></tt> command. However, there are some
situations in which you may want to supply a Python function that will be
called when particular events occur during the normal operation of Maestro.
These callback functions are a powerful way to extend and modify the default
behavior of Maestro.</p>
<p>To support atom picking in the Workspace use <a class="reference external" href="api/schrodinger.maestro.maestro-module.html#picking_atom_start">maestro.picking_atom_start()</a> and pass
a function to be called when an atom is picked in the
Workspace. The function you pass should be expecting a single parameter that
is the atom number of the atom picked in the Workspace.</p>
<p>If you need to perform an action periodically, you can use
<a class="reference external" href="api/schrodinger.maestro.maestro-module.html#periodic_callback_add">maestro.periodic_callback_add()</a>:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">maestro</span><span class="o">.</span><span class="n">periodic_callback_add</span><span class="p">(</span><span class="n">your_callback_function</span><span class="p">)</span>
</pre></div>
</div>
<p>to register a Python function that will be called approximately 20 times a
second. If you would like to perform the action less frequently, maintain a
counter in your function and only take action every nth time.</p>
<p>You can also register a hover callback function, using <a class="reference external" href="api/schrodinger.maestro.maestro-module.html#hover_callback_add">maestro.hover_callback_add()</a>:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">maestro</span><span class="o">.</span><span class="n">hover_callback_add</span><span class="p">(</span><span class="n">your_callback_function</span><span class="p">)</span>
</pre></div>
</div>
<p>The callback will be called by Maestro whenever the pointer is paused
(&#8220;hovers&#8221;) over an atom in the Workspace.  When you no longer need the mouse
hover callback, unregister your function using:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">maestro</span><span class="o">.</span><span class="n">hover_callback_remove</span><span class="p">(</span><span class="n">your_callback_function_name</span><span class="p">)</span>
</pre></div>
</div>
<p id="workspace-changed-callback">You can add a Python function that will be called each time the Workspace is
drawn using <a class="reference external" href="api/schrodinger.maestro.maestro-module.html#workspace_draw_function_add">maestro.workspace_draw_function_add()</a>.
With this callback, just about anything that can be rendered with OpenGL can
be drawn in the Workspace.</p>
<p>It is also possible to register a callback that will be called when the
contents of the Workspace are modified with
<a class="reference external" href="api/schrodinger.maestro.maestro-module.html#workspace_changed_function_add">maestro.workspace_changed_function_add()</a>:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">maestro</span><span class="o">.</span><span class="n">workspace_changed_function_add</span><span class="p">(</span><span class="n">your_callback_function</span><span class="p">)</span>
</pre></div>
</div>
<p>The callback function in this case is called with a string parameter
that indicates exactly what has been modified in the workspace. It will be
one of:</p>
<blockquote>
<div><ul class="simple">
<li><tt class="docutils literal"><span class="pre">everything</span></tt></li>
<li><tt class="docutils literal"><span class="pre">color</span></tt></li>
<li><tt class="docutils literal"><span class="pre">geometry</span></tt></li>
<li><tt class="docutils literal"><span class="pre">visibility</span></tt></li>
<li><tt class="docutils literal"><span class="pre">representation</span></tt></li>
<li><tt class="docutils literal"><span class="pre">properties</span></tt></li>
<li><tt class="docutils literal"><span class="pre">coordinates</span></tt></li>
<li><tt class="docutils literal"><span class="pre">connectivity</span></tt></li>
<li><tt class="docutils literal"><span class="pre">unknown</span></tt></li>
</ul>
</div></blockquote>
<p>In this way a script that does not care about, say, changes in the
representation of the structure in the Workspace can choose to take no
action in these cases. It is often useful to use this callback in
conjunction with <tt class="xref py py-obj docutils literal"><span class="pre">workspace_draw_function_add</span></tt>.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">The state of the Project table is not well-defined during the &#8220;workspace
changed&#8221; callback, and so you can&#8217;t reliably check on the inclusion
state of an entry.  Please use the <a class="reference external" href="api/schrodinger.maestro.maestro-module.html#project_update_callback_add">project_update_callback_add</a> function
for this purpose.  Also note that you should avoid calling maestro
commands during these callbacks in order to maintain consistent Maestro
internal state.</p>
</div>
</div>
<div class="section" id="displaying-a-gui-within-maestro-using-python">
<h2>Displaying a GUI Within Maestro Using Python<a class="headerlink" href="#displaying-a-gui-within-maestro-using-python" title="Permalink to this headline">¶</a></h2>
<p>We support the Tkinter GUI toolkit for Linux and 32-bit Windows
applications, along with the <a class="reference external" href="http://pmw.sourceforge.net/">Python megawidgets</a> (Pmw).</p>
<p>The following example, if placed in a file <tt class="file docutils literal"><span class="pre">tkexample.py</span></tt>, can be run
from the Maestro Command Input Area using:</p>
<div class="highlight-python"><div class="highlight"><pre>pythonrun tkexample.panel
</pre></div>
</div>
<p>This script is a simple example that posts a window with two buttons - one
to quit and the other to rotate the Workspace by 90 degrees around the Z
axis.</p>
<div class="highlight-python"><div class="highlight"><pre><span class="kn">from</span> <span class="nn">schrodinger</span> <span class="kn">import</span> <span class="n">maestro</span>
<span class="c"># schrodinger.ui.widget is a Schrodinger wrapper for Tkinter that should</span>
<span class="c"># be used for all scripts intended to run in Maestro.</span>
<span class="kn">import</span> <span class="nn">schrodinger.ui.widget</span> <span class="kn">as</span> <span class="nn">stk</span>

<span class="k">class</span> <span class="nc">RotateZ90</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    A class encapsulating a simple Tkinter panel.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="c"># Create a top-level Tkinter window and set the title:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">top</span> <span class="o">=</span> <span class="n">stk</span><span class="o">.</span><span class="n">Tk</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">top</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s">&quot;Rotate&quot;</span><span class="p">)</span>
        <span class="c"># Catch window close events and quit gracefully:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">top</span><span class="o">.</span><span class="n">protocol</span><span class="p">(</span><span class="s">&#39;WM_DELETE_WINDOW&#39;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">quit</span><span class="p">)</span>

        <span class="c"># Create two buttons and pack them side-by-side:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">rotatebutton</span> <span class="o">=</span> <span class="n">stk</span><span class="o">.</span><span class="n">Button</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">top</span><span class="p">,</span> <span class="n">text</span><span class="o">=</span><span class="s">&quot;Rotate Z 90&quot;</span><span class="p">,</span>
                                       <span class="n">command</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">rotate</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">rotatebutton</span><span class="o">.</span><span class="n">pack</span><span class="p">(</span><span class="n">side</span><span class="o">=</span><span class="s">&#39;left&#39;</span><span class="p">,</span> <span class="n">expand</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">anchor</span><span class="o">=</span><span class="s">&#39;w&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">quitbutton</span> <span class="o">=</span> <span class="n">stk</span><span class="o">.</span><span class="n">Button</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">top</span><span class="p">,</span> <span class="n">text</span><span class="o">=</span><span class="s">&quot;Quit&quot;</span><span class="p">,</span>
                                    <span class="n">command</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">quit</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">quitbutton</span><span class="o">.</span><span class="n">pack</span><span class="p">(</span><span class="n">side</span><span class="o">=</span><span class="s">&#39;left&#39;</span><span class="p">,</span> <span class="n">expand</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">anchor</span><span class="o">=</span><span class="s">&#39;w&#39;</span><span class="p">)</span>

        <span class="c"># Tell Maestro about our script so it knows to share events with it.</span>
        <span class="n">maestro</span><span class="o">.</span><span class="n">tk_toplevel_add</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">top</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">show</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">top</span><span class="o">.</span><span class="n">deiconify</span><span class="p">()</span>

    <span class="k">def</span> <span class="nf">quit</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="c"># Hide the window instead of destroying it. This allows additional</span>
        <span class="c"># calls to restore the original window, and thus preserve state</span>
        <span class="c"># between invocations.</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">top</span><span class="o">.</span><span class="n">withdraw</span><span class="p">()</span>

    <span class="k">def</span> <span class="nf">rotate</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="c"># Issue a Maestro command when the &#39;Rotate&#39; button is pressed.</span>
        <span class="n">maestro</span><span class="o">.</span><span class="n">command</span><span class="p">(</span><span class="s">&quot;rotate z=90&quot;</span><span class="p">)</span>

<span class="n">instance</span> <span class="o">=</span> <span class="bp">None</span>
<span class="k">def</span> <span class="nf">panel</span><span class="p">():</span>
    <span class="k">global</span> <span class="n">instance</span>
    <span class="k">if</span> <span class="n">instance</span><span class="p">:</span>
        <span class="c"># If we already have created the panel we just redisplay it:</span>
        <span class="n">instance</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">instance</span> <span class="o">=</span> <span class="n">RotateZ90</span><span class="p">()</span>
</pre></div>
</div>
<p>A full reference for Tkinter is available <a class="reference external" href="http://www.pythonware.com/library/tkinter/introduction/">here</a>.</p>
<p>We also support (and use) the PyQt framework, a Python wrapping for the
<a class="reference external" href="http://qt.nokia.com/">Qt GUI library</a>. There are some licensing
considerations you need to be aware of before undertaking Python scripting
using PyQt. The Qt software provided with this application is licensed to
you under the Lesser General Public License (LGPL). You are permitted to
develop software using the Qt software under the terms of the LGPL.
However, you may not make use of the PyQt software to develop software
unless you have a commercial license for PyQt from Riverbank Computing, the
licensor of PyQt. See <a class="reference external" href="http://www.riverbankcomputing.com">Riverbank&#8217;s website</a> for more information.</p>
</div>
<div class="section" id="other-maestro-interactions">
<h2>Other Maestro Interactions<a class="headerlink" href="#other-maestro-interactions" title="Permalink to this headline">¶</a></h2>
<p>There are a number of other useful functions in the maestro.py module.</p>
<blockquote>
<div><ul class="simple">
<li><a class="reference external" href="api/schrodinger.maestro.maestro-module.html#selected_atoms_get_asl">Getting selected atoms from the Workspace</a></li>
<li><a class="reference external" href="api/schrodinger.maestro.maestro-module.html#redraw">Redrawing the 3D Workspace</a></li>
<li><a class="reference external" href="api/schrodinger.maestro.maestro-module.html#job_incorporation_function_add">Handling custom job incorporation</a></li>
<li><a class="reference external" href="api/schrodinger.maestro.maestro-module.html#project_table_update">Updating the project table</a></li>
<li><a class="reference external" href="api/schrodinger.maestro.maestro-module.html#project_table_synchronize">Synchronizing the Workspace with the project table</a></li>
<li><a class="reference external" href="api/schrodinger.maestro.maestro-module.html#project_close_callback_add">Being notified when projects close</a></li>
</ul>
</div></blockquote>
</div>
</div>


          </div>
        </div>
      </div>
      <div class="sphinxsidebar">
        <div class="sphinxsidebarwrapper">
  <h3><a href="overview.html">Table Of Contents</a></h3>
  <ul>
<li><a class="reference internal" href="#">Interacting with Maestro</a><ul>
<li><a class="reference internal" href="#basic-concepts">Basic Concepts</a></li>
<li><a class="reference internal" href="#running-scripts-from-maestro">Running Scripts from Maestro</a></li>
<li><a class="reference internal" href="#adding-your-script-to-the-maestro-scripts-menu">Adding Your Script to the Maestro Scripts Menu</a></li>
<li><a class="reference internal" href="#the-maestro-module">The Maestro Module</a><ul>
<li><a class="reference internal" href="#executing-maestro-commands-from-a-script">Executing Maestro Commands from a Script</a></li>
<li><a class="reference internal" href="#interacting-with-the-workspace">Interacting with the Workspace</a></li>
</ul>
</li>
<li><a class="reference internal" href="#interacting-with-the-project-table">Interacting with the Project Table</a></li>
<li><a class="reference internal" href="#registering-functions-to-be-called-by-maestro">Registering Functions to be Called By Maestro</a></li>
<li><a class="reference internal" href="#displaying-a-gui-within-maestro-using-python">Displaying a GUI Within Maestro Using Python</a></li>
<li><a class="reference internal" href="#other-maestro-interactions">Other Maestro Interactions</a></li>
</ul>
</li>
</ul>

  <h4>Previous topic</h4>
  <p class="topless"><a href="structure_overview.html"
                        title="previous chapter">Structures</a></p>
  <h4>Next topic</h4>
  <p class="topless"><a href="product_specific.html"
                        title="next chapter">Product Specific Modules</a></p>
<div id="searchbox" style="display: none">
  <h3>Quick search</h3>
    <form class="search" action="search.html" method="get">
      <input type="text" name="q" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    <p class="searchtip" style="font-size: 90%">
    Enter search terms or a module, class or function name.
    </p>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="product_specific.html" title="Product Specific Modules"
             >next</a> |</li>
        <li class="right" >
          <a href="structure_overview.html" title="Structures"
             >previous</a> |</li>
        <li><a href="overview.html">Schrödinger Python Suite 2015-2 Documentation</a> &raquo;</li> 
      </ul>
    </div>
    <div class="footer">
        &copy; Copyright 2009-2011 Schrödinger, LLC.
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 1.2.1.
    </div>
  </body>
</html>