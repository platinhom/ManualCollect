<?xml version="1.0" encoding="ascii"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
          "DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head>
  <title>schrodinger.structutils.rmsd.ConformerRmsdX</title>
  <link rel="stylesheet" href="epydoc.css" type="text/css" />
  <script type="text/javascript" src="epydoc.js"></script>
</head>

<body bgcolor="white" text="black" link="blue" vlink="#204080"
      alink="#204080">
<!-- ==================== NAVIGATION BAR ==================== -->
<table class="navbar" border="0" width="100%" cellpadding="0"
       bgcolor="#a0c0ff" cellspacing="0">
  <tr valign="middle">

  <!-- Tree link -->
      <th>&nbsp;&nbsp;&nbsp;<a
        href="module-tree.html">Trees</a>&nbsp;&nbsp;&nbsp;</th>

  <!-- Index link -->
      <th>&nbsp;&nbsp;&nbsp;<a
        href="identifier-index.html">Indices</a>&nbsp;&nbsp;&nbsp;</th>

  <!-- Help link -->
      <th>&nbsp;&nbsp;&nbsp;<a
        href="help.html">Help</a>&nbsp;&nbsp;&nbsp;</th>

  <!-- Project homepage -->
      <th class="navbar" align="right" width="100%">
        <table border="0" cellpadding="0" cellspacing="0">
          <tr><th class="navbar" align="center"
            >2015-2Schrodinger Python API</th>
          </tr></table></th>
  </tr>
</table>
<table width="100%" cellpadding="0" cellspacing="0">
  <tr valign="top">
    <td width="100%">
      <span class="breadcrumbs">
        <a href="schrodinger-module.html">Package&nbsp;schrodinger</a> ::
        <a href="schrodinger.structutils-module.html">Package&nbsp;structutils</a> ::
        <a href="schrodinger.structutils.rmsd-module.html">Module&nbsp;rmsd</a> ::
        Class&nbsp;ConformerRmsdX
      </span>
    </td>
    <td>
      <table cellpadding="0" cellspacing="0">
        <!-- hide/show private -->
        <tr><td align="right"><span class="options">[<a href="javascript:void(0);" class="privatelink"
    onclick="toggle_private();">hide&nbsp;private</a>]</span></td></tr>
        <tr><td align="right"><span class="options"
            >[<a href="frames.html" target="_top">frames</a
            >]&nbsp;|&nbsp;<a href="schrodinger.structutils.rmsd.ConformerRmsdX-class.html"
            target="_top">no&nbsp;frames</a>]</span></td></tr>
      </table>
    </td>
  </tr>
</table>
<!-- ==================== CLASS DESCRIPTION ==================== -->
<h1 class="epydoc">Class ConformerRmsdX</h1><p class="nomargin-top"></p>
<dl><dt>Known Subclasses:</dt>
<dd>
      <ul class="subclass-list">
<li><a href="schrodinger.application.jaguar.rmsd.ConformerRmsdX-class.html">application.jaguar.rmsd.ConformerRmsdX</a></li>  </ul>
</dd></dl>

<hr />
<p>A class to calculate the root mean square deviatation between the 
  atomic coordinates of two conformer structure.Structure objects. The 
  inputs are expected to be conformers in the traditional sense.</p>
  <p>This is an enhanced version of ConformerRmsd where working copies of 
  the input structures are modified instead the original.  The superimpose 
  transformation is applied to the entire test_structure. The translation 
  and rotation matrixes are instance attributes. Debugging/verbosity is 
  controlled by log level instead of an instance attribute.</p>
  <p>Renumbering is achieved by creating a list of SMARTS patterns, one for
  each molecule in the reference structure, evaluating the SMARTS pattern 
  with both the reference and test structures to get a standard order of 
  atom indexes, then passing that atom order to mm.mmct_ct_reorder.  
  Renumbering can be slow with protein-sized molecules so you may want to 
  disable that feature when working with large molecules.</p>
  <p>API Example:</p>
<pre class="literalblock">
   # Calculate in place, heavy atom RMSD.
   st1 = structure.StructureReader('file1.mae').next()
   st2 = structure.StructureReader('file2.mae').next()
   conf_rmsd = ConformerRmsdX(st1, st2) # in place, heavy atom RMSD calc.
   if conf_rmsd.calculate() &lt; 2.00:
       print &quot;Good pose&quot;

   # Loop over structures in test.mae, comparing to ref.mae
   st1 = structure.StructureReader('ref.mae').next()
   conf_rmsd = ConformerRmsdX(st1, st1) # in place, heavy atom RMSD calc.
   for st in structure.StructureReader('test.mae'):
       conf_rmsd.test_structure = st
       print conf_rmsd.calculate()
</pre>
  <p>Instance Attributes</p>

<hr />
<div class="fields">      <p><strong>Note:</strong>
        The following attributes are available after calculate()
      </p>
</div><!-- ==================== INSTANCE METHODS ==================== -->
<a name="section-InstanceMethods"></a>
<table class="summary" border="1" cellpadding="3"
       cellspacing="0" width="100%" bgcolor="white">
<tr bgcolor="#70b0f0" class="table-header">
  <td colspan="2" class="table-header">
    <table border="0" cellpadding="0" cellspacing="0" width="100%">
      <tr valign="top">
        <td align="left"><span class="table-header">Instance Methods</span></td>
        <td align="right" valign="top"
         ><span class="options">[<a href="#section-InstanceMethods"
         class="privatelink" onclick="toggle_private();"
         >hide private</a>]</span></td>
      </tr>
    </table>
  </td>
</tr>
<tr>
    <td width="15%" align="right" valign="top" class="summary">
      <span class="summary-type">&nbsp;</span>
    </td><td class="summary">
      <table width="100%" cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td><span class="summary-sig"><a href="schrodinger.structutils.rmsd.ConformerRmsdX-class.html#__init__" class="summary-sig-name">__init__</a>(<span class="summary-sig-arg">self</span>,
        <span class="summary-sig-arg">reference_structure</span>,
        <span class="summary-sig-arg">test_structure</span>=<span class="summary-sig-default">None</span>,
        <span class="summary-sig-arg">asl_expr</span>=<span class="summary-sig-default"><code class="variable-quote">'</code><code class="variable-string">all AND NOT atom.element H</code><code class="variable-quote">'</code></span>,
        <span class="summary-sig-arg">in_place</span>=<span class="summary-sig-default">True</span>)</span></td>
          <td align="right" valign="top">
            
            
          </td>
        </tr>
      </table>
      
    </td>
  </tr>
<tr>
    <td width="15%" align="right" valign="top" class="summary">
      <span class="summary-type">&nbsp;</span>
    </td><td class="summary">
      <table width="100%" cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td><span class="summary-sig"><a href="schrodinger.structutils.rmsd.ConformerRmsdX-class.html#__str__" class="summary-sig-name">__str__</a>(<span class="summary-sig-arg">self</span>)</span><br />
      Returns:
      a user friendly string representation of the instance.</td>
          <td align="right" valign="top">
            
            
          </td>
        </tr>
      </table>
      
    </td>
  </tr>
<tr class="private">
    <td width="15%" align="right" valign="top" class="summary">
      <span class="summary-type">&nbsp;</span>
    </td><td class="summary">
      <table width="100%" cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td><span class="summary-sig"><a href="schrodinger.structutils.rmsd.ConformerRmsdX-class.html#_encodeOriginalAtomNumbers" class="summary-sig-name" onclick="show_private();">_encodeOriginalAtomNumbers</a>(<span class="summary-sig-arg">self</span>,
        <span class="summary-sig-arg">st</span>)</span></td>
          <td align="right" valign="top">
            
            
          </td>
        </tr>
      </table>
      
    </td>
  </tr>
<tr class="private">
    <td width="15%" align="right" valign="top" class="summary">
      <span class="summary-type">&nbsp;</span>
    </td><td class="summary">
      <table width="100%" cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td><span class="summary-sig"><a href="schrodinger.structutils.rmsd.ConformerRmsdX-class.html#_extractSuperimposeAslStructure" class="summary-sig-name" onclick="show_private();">_extractSuperimposeAslStructure</a>(<span class="summary-sig-arg">self</span>,
        <span class="summary-sig-arg">st</span>)</span></td>
          <td align="right" valign="top">
            
            
          </td>
        </tr>
      </table>
      
    </td>
  </tr>
<tr>
    <td width="15%" align="right" valign="top" class="summary">
      <span class="summary-type">&nbsp;</span>
    </td><td class="summary">
      <table width="100%" cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td><span class="summary-sig"><a href="schrodinger.structutils.rmsd.ConformerRmsdX-class.html#calculate" class="summary-sig-name">calculate</a>(<span class="summary-sig-arg">self</span>)</span><br />
      @return:
    Root-mean-squared difference of atom coordinates.</td>
          <td align="right" valign="top">
            
            
          </td>
        </tr>
      </table>
      
    </td>
  </tr>
<tr class="private">
    <td width="15%" align="right" valign="top" class="summary">
      <span class="summary-type">&nbsp;</span>
    </td><td class="summary">
      <table width="100%" cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td><span class="summary-sig"><a href="schrodinger.structutils.rmsd.ConformerRmsdX-class.html#_prepareStructures" class="summary-sig-name" onclick="show_private();">_prepareStructures</a>(<span class="summary-sig-arg">self</span>)</span><br />
      Returns:
      a working copy of the reference and test structures, renumbered 
      and/or reduced as needed.</td>
          <td align="right" valign="top">
            
            
          </td>
        </tr>
      </table>
      
    </td>
  </tr>
<tr class="private">
    <td width="15%" align="right" valign="top" class="summary">
      <span class="summary-type">&nbsp;</span>
    </td><td class="summary">
      <table width="100%" cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td><span class="summary-sig"><a href="schrodinger.structutils.rmsd.ConformerRmsdX-class.html#_getReducedStructure" class="summary-sig-name" onclick="show_private();">_getReducedStructure</a>(<span class="summary-sig-arg">self</span>,
        <span class="summary-sig-arg">st</span>)</span><br />
      Returns:
      a Structure that is a simplified copy of the input: a neutral, single
      bond connected, heavy atom only frame.</td>
          <td align="right" valign="top">
            
            
          </td>
        </tr>
      </table>
      
    </td>
  </tr>
<tr class="private">
    <td width="15%" align="right" valign="top" class="summary">
      <span class="summary-type">&nbsp;</span>
    </td><td class="summary">
      <table width="100%" cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td><span class="summary-sig"><a href="schrodinger.structutils.rmsd.ConformerRmsdX-class.html#_getRenumberedStructure" class="summary-sig-name" onclick="show_private();">_getRenumberedStructure</a>(<span class="summary-sig-arg">self</span>,
        <span class="summary-sig-arg">st</span>)</span><br />
      Returns:
      a new structure with a normalized atom order, based upon the 
      reference set of SMARTS patterns in self._mol_pattern_dict.</td>
          <td align="right" valign="top">
            
            
          </td>
        </tr>
      </table>
      
    </td>
  </tr>
<tr class="private">
    <td width="15%" align="right" valign="top" class="summary">
      <span class="summary-type">tuple</span>
    </td><td class="summary">
      <table width="100%" cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td><span class="summary-sig"><a href="schrodinger.structutils.rmsd.ConformerRmsdX-class.html#_superimpose" class="summary-sig-name" onclick="show_private();">_superimpose</a>(<span class="summary-sig-arg">self</span>,
        <span class="summary-sig-arg">ref_st_selection</span>,
        <span class="summary-sig-arg">test_st_selection</span>)</span><br />
      Calculate optimal rotation-translation transform of test_st_selection
      of atoms in working_test_st onto ref_st_selection of atoms in 
      working_ref_st, and apply to test_structure.</td>
          <td align="right" valign="top">
            
            
          </td>
        </tr>
      </table>
      
    </td>
  </tr>
<tr>
    <td width="15%" align="right" valign="top" class="summary">
      <span class="summary-type">string</span>
    </td><td class="summary">
      <table width="100%" cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td><span class="summary-sig"><a href="schrodinger.structutils.rmsd.ConformerRmsdX-class.html#getRmsdDataname" class="summary-sig-name">getRmsdDataname</a>(<span class="summary-sig-arg">self</span>)</span><br />
      Returns:
      m2io property dataname string.</td>
          <td align="right" valign="top">
            
            
          </td>
        </tr>
      </table>
      
    </td>
  </tr>
<tr>
    <td width="15%" align="right" valign="top" class="summary">
      <span class="summary-type">&nbsp;</span>
    </td><td class="summary">
      <table width="100%" cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td><span class="summary-sig"><a href="schrodinger.structutils.rmsd.ConformerRmsdX-class.html#writeStructures" class="summary-sig-name">writeStructures</a>(<span class="summary-sig-arg">self</span>,
        <span class="summary-sig-arg">file_name</span>=<span class="summary-sig-default"><code class="variable-quote">'</code><code class="variable-string">rmsd.mae</code><code class="variable-quote">'</code></span>,
        <span class="summary-sig-arg">mode</span>=<span class="summary-sig-default"><code class="variable-quote">'</code><code class="variable-string">w</code><code class="variable-quote">'</code></span>)</span><br />
      Writes the reference and test structures to file.</td>
          <td align="right" valign="top">
            
            
          </td>
        </tr>
      </table>
      
    </td>
  </tr>
<tr>
    <td width="15%" align="right" valign="top" class="summary">
      <span class="summary-type">&nbsp;</span>
    </td><td class="summary">
      <table width="100%" cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td><span class="summary-sig"><a href="schrodinger.structutils.rmsd.ConformerRmsdX-class.html#writeCommand" class="summary-sig-name">writeCommand</a>(<span class="summary-sig-arg">self</span>,
        <span class="summary-sig-arg">file_name</span>=<span class="summary-sig-default"><code class="variable-quote">'</code><code class="variable-string">rmsd.cmd</code><code class="variable-quote">'</code></span>)</span><br />
      Writes a Maestro command file and structures with the pair wise atom 
      mapping in command file mode.</td>
          <td align="right" valign="top">
            
            
          </td>
        </tr>
      </table>
      
    </td>
  </tr>
</table>
<!-- ==================== INSTANCE VARIABLES ==================== -->
<a name="section-InstanceVariables"></a>
<table class="summary" border="1" cellpadding="3"
       cellspacing="0" width="100%" bgcolor="white">
<tr bgcolor="#70b0f0" class="table-header">
  <td colspan="2" class="table-header">
    <table border="0" cellpadding="0" cellspacing="0" width="100%">
      <tr valign="top">
        <td align="left"><span class="table-header">Instance Variables</span></td>
        <td align="right" valign="top"
         ><span class="options">[<a href="#section-InstanceVariables"
         class="privatelink" onclick="toggle_private();"
         >hide private</a>]</span></td>
      </tr>
    </table>
  </td>
</tr>
<tr>
    <td width="15%" align="right" valign="top" class="summary">
      <span class="summary-type">float</span>
    </td><td class="summary">
        <a name="max_distance"></a><span class="summary-name">max_distance</span><br />
      Greatest displacement between the atom pairs
    </td>
  </tr>
<tr>
    <td width="15%" align="right" valign="top" class="summary">
      <span class="summary-type">integer</span>
    </td><td class="summary">
        <a name="max_distance_atom_1"></a><span class="summary-name">max_distance_atom_1</span><br />
      Reference atom index (in original atom scheme)
    </td>
  </tr>
<tr>
    <td width="15%" align="right" valign="top" class="summary">
      <span class="summary-type">integer</span>
    </td><td class="summary">
        <a name="max_distance_atom_2"></a><span class="summary-name">max_distance_atom_2</span><br />
      Test atom index (in the original atom scheme)
    </td>
  </tr>
<tr>
    <td width="15%" align="right" valign="top" class="summary">
      <span class="summary-type">&nbsp;</span>
    </td><td class="summary">
        <a name="max_permutations"></a><span class="summary-name">max_permutations</span><br />
      Maximum number of permutations to search defaults to 10000000
    </td>
  </tr>
<tr>
    <td width="15%" align="right" valign="top" class="summary">
      <span class="summary-type">&nbsp;</span>
    </td><td class="summary">
        <a href="schrodinger.structutils.rmsd.ConformerRmsdX-class.html#orig_index_prop" class="summary-name">orig_index_prop</a><br />
      m2io dataname for atomic property that stores the original atom index
      of the input structures.
    </td>
  </tr>
<tr>
    <td width="15%" align="right" valign="top" class="summary">
      <span class="summary-type">&nbsp;</span>
    </td><td class="summary">
        <a name="precision"></a><span class="summary-name">precision</span><br />
      Precision of rmsd stored to find minimum if search_permutations=True 
      defaults to 6 (meaning a precision of 10^-6)
    </td>
  </tr>
<tr>
    <td width="15%" align="right" valign="top" class="summary">
      <span class="summary-type">&nbsp;</span>
    </td><td class="summary">
        <a href="schrodinger.structutils.rmsd.ConformerRmsdX-class.html#renumber_structures" class="summary-name">renumber_structures</a><br />
      Boolean to control whether the reference and test structures should 
      be renumbered by a SMARTS pattern before calculating the rmsd.
    </td>
  </tr>
<tr>
    <td width="15%" align="right" valign="top" class="summary">
      <span class="summary-type">float</span>
    </td><td class="summary">
        <a name="rmsd"></a><span class="summary-name">rmsd</span><br />
      Root mean square deviation of atomic coordintates
    </td>
  </tr>
<tr>
    <td width="15%" align="right" valign="top" class="summary">
      <span class="summary-type">&nbsp;</span>
    </td><td class="summary">
        <a name="rmsd_str"></a><span class="summary-name">rmsd_str</span><br />
      String of basic rmsd info == str(self)
    </td>
  </tr>
<tr>
    <td width="15%" align="right" valign="top" class="summary">
      <span class="summary-type">&nbsp;</span>
    </td><td class="summary">
        <a href="schrodinger.structutils.rmsd.ConformerRmsdX-class.html#use_heavy_atom_graph" class="summary-name">use_heavy_atom_graph</a><br />
      Boolean to control whether the reference and test structures should 
      be treated as heavy-atom only, graph topologies.
    </td>
  </tr>
<tr>
    <td width="15%" align="right" valign="top" class="summary">
      <span class="summary-type">&nbsp;</span>
    </td><td class="summary">
        <a href="schrodinger.structutils.rmsd.ConformerRmsdX-class.html#use_symmetry" class="summary-name">use_symmetry</a><br />
      Boolean to control whether the test structure atom list should be 
      determined by with the mmsym library.
    </td>
  </tr>
</table>
<!-- ==================== METHOD DETAILS ==================== -->
<a name="section-MethodDetails"></a>
<table class="details" border="1" cellpadding="3"
       cellspacing="0" width="100%" bgcolor="white">
<tr bgcolor="#70b0f0" class="table-header">
  <td colspan="2" class="table-header">
    <table border="0" cellpadding="0" cellspacing="0" width="100%">
      <tr valign="top">
        <td align="left"><span class="table-header">Method Details</span></td>
        <td align="right" valign="top"
         ><span class="options">[<a href="#section-MethodDetails"
         class="privatelink" onclick="toggle_private();"
         >hide private</a>]</span></td>
      </tr>
    </table>
  </td>
</tr>
</table>
<a name="__init__"></a>
<div>
<table class="details" border="1" cellpadding="3"
       cellspacing="0" width="100%" bgcolor="white">
<tr><td>
  <table width="100%" cellpadding="0" cellspacing="0" border="0">
  <tr valign="top"><td>
  <h3 class="epydoc"><span class="sig"><span class="sig-name">__init__</span>(<span class="sig-arg">self</span>,
        <span class="sig-arg">reference_structure</span>,
        <span class="sig-arg">test_structure</span>=<span class="sig-default">None</span>,
        <span class="sig-arg">asl_expr</span>=<span class="sig-default"><code class="variable-quote">'</code><code class="variable-string">all AND NOT atom.element H</code><code class="variable-quote">'</code></span>,
        <span class="sig-arg">in_place</span>=<span class="sig-default">True</span>)</span>
    <br /><em class="fname">(Constructor)</em>
  </h3>
  </td><td align="right" valign="top"
    >&nbsp;
    </td>
  </tr></table>
  
  
  <dl class="fields">
    <dt>Parameters:</dt>
    <dd><ul class="nomargin-top">
        <li><strong class="pname"><code>reference_structure</code></strong> (structure.Structure) - Template structure</li>
        <li><strong class="pname"><code>test_structure</code></strong> (structure.Structure) - The mobile structure.</li>
        <li><strong class="pname"><code>asl_expr</code></strong> (string) - Atom Language Expression to identify the the atoms used to 
          calculate the RMSD and base the superimpose alignment.</li>
        <li><strong class="pname"><code>in_place</code></strong> (Boolean) - If True, calculate the RMSD without moving the test_structure. 
          Otherwise, perform the optimal alignment then calculate the RMSD.</li>
    </ul></dd>
  </dl>
</td></tr></table>
</div>
<a name="__str__"></a>
<div>
<table class="details" border="1" cellpadding="3"
       cellspacing="0" width="100%" bgcolor="white">
<tr><td>
  <table width="100%" cellpadding="0" cellspacing="0" border="0">
  <tr valign="top"><td>
  <h3 class="epydoc"><span class="sig"><span class="sig-name">__str__</span>(<span class="sig-arg">self</span>)</span>
    <br /><em class="fname">(Informal representation operator)</em>
  </h3>
  </td><td align="right" valign="top"
    >&nbsp;
    </td>
  </tr></table>
  
  
  <dl class="fields">
    <dt>Returns:</dt>
        <dd>a user friendly string representation of the instance. e.g.:
          <p>In place RMSD = 1.01; atoms = &quot;a.e C&quot;</p></dd>
  </dl>
</td></tr></table>
</div>
<a name="_encodeOriginalAtomNumbers"></a>
<div class="private">
<table class="details" border="1" cellpadding="3"
       cellspacing="0" width="100%" bgcolor="white">
<tr><td>
  <table width="100%" cellpadding="0" cellspacing="0" border="0">
  <tr valign="top"><td>
  <h3 class="epydoc"><span class="sig"><span class="sig-name">_encodeOriginalAtomNumbers</span>(<span class="sig-arg">self</span>,
        <span class="sig-arg">st</span>)</span>
  </h3>
  </td><td align="right" valign="top"
    >&nbsp;
    </td>
  </tr></table>
  
  
  <dl class="fields">
    <dt>Parameters:</dt>
    <dd><ul class="nomargin-top">
        <li><strong class="pname"><code>st</code></strong> (structure.Structure) - Structure to store original atom indexes as atom-level 
          properties.</li>
    </ul></dd>
  </dl>
</td></tr></table>
</div>
<a name="_extractSuperimposeAslStructure"></a>
<div class="private">
<table class="details" border="1" cellpadding="3"
       cellspacing="0" width="100%" bgcolor="white">
<tr><td>
  <table width="100%" cellpadding="0" cellspacing="0" border="0">
  <tr valign="top"><td>
  <h3 class="epydoc"><span class="sig"><span class="sig-name">_extractSuperimposeAslStructure</span>(<span class="sig-arg">self</span>,
        <span class="sig-arg">st</span>)</span>
  </h3>
  </td><td align="right" valign="top"
    >&nbsp;
    </td>
  </tr></table>
  
  
  <dl class="fields">
    <dt>Parameters:</dt>
    <dd><ul class="nomargin-top">
        <li><strong class="pname"><code>st</code></strong> (structure.Structure) - Structure from which to extract the ASL matching atoms.</li>
    </ul></dd>
  </dl>
</td></tr></table>
</div>
<a name="calculate"></a>
<div>
<table class="details" border="1" cellpadding="3"
       cellspacing="0" width="100%" bgcolor="white">
<tr><td>
  <table width="100%" cellpadding="0" cellspacing="0" border="0">
  <tr valign="top"><td>
  <h3 class="epydoc"><span class="sig"><span class="sig-name">calculate</span>(<span class="sig-arg">self</span>)</span>
  </h3>
  </td><td align="right" valign="top"
    >&nbsp;
    </td>
  </tr></table>
  
  <pre class="literalblock">

@return:
    Root-mean-squared difference of atom coordinates.
@type:
    float

@raise:
    ValueError if working versions of the reference and test
    structures don't have the same shape (non-confs).

The order of operations:
    * prepare working copies of the reference and test structures.
        ** copy the structures.
        ** encode the original atom indexes as atom properties.
        ** extract substructure of the atoms matching the ASL.
        ** reduce to heavy atom graph (instance option, non-default).
        ** normalize numbering scheme (instance option, default).
    * determine molecular symmetry mapping (optional, default).
    * create a numpy coordinate array for the working structures.
    * numpy linear algebra SVD to superimpose (instance option).
        ** transform test_structure
    * numpy array used to calculate RMSD, and max_dist.
    * decode original indexes to identify atoms involve in max dist.

</pre>
  <dl class="fields">
  </dl>
</td></tr></table>
</div>
<a name="_prepareStructures"></a>
<div class="private">
<table class="details" border="1" cellpadding="3"
       cellspacing="0" width="100%" bgcolor="white">
<tr><td>
  <table width="100%" cellpadding="0" cellspacing="0" border="0">
  <tr valign="top"><td>
  <h3 class="epydoc"><span class="sig"><span class="sig-name">_prepareStructures</span>(<span class="sig-arg">self</span>)</span>
  </h3>
  </td><td align="right" valign="top"
    >&nbsp;
    </td>
  </tr></table>
  
  
  <dl class="fields">
    <dt>Parameters:</dt>
    <dd><ul class="nomargin-top">
        <li><strong class="pname"><code>reference</code></strong> (boolean) - If true, seed the renumbering pattern dictionary.</li>
    </ul></dd>
    <dt>Returns:</dt>
        <dd>a working copy of the reference and test structures, renumbered 
          and/or reduced as needed.  The original atom index is saved as 
          atom level properties in the working structure. A substructure of
          just the atoms specified for superposition via ASL.</dd>
  </dl>
</td></tr></table>
</div>
<a name="_getReducedStructure"></a>
<div class="private">
<table class="details" border="1" cellpadding="3"
       cellspacing="0" width="100%" bgcolor="white">
<tr><td>
  <table width="100%" cellpadding="0" cellspacing="0" border="0">
  <tr valign="top"><td>
  <h3 class="epydoc"><span class="sig"><span class="sig-name">_getReducedStructure</span>(<span class="sig-arg">self</span>,
        <span class="sig-arg">st</span>)</span>
  </h3>
  </td><td align="right" valign="top"
    >&nbsp;
    </td>
  </tr></table>
  
  
  <dl class="fields">
    <dt>Parameters:</dt>
    <dd><ul class="nomargin-top">
        <li><strong class="pname"><code>st</code></strong> (structure.Structure) - Structure to reduce.</li>
    </ul></dd>
    <dt>Returns:</dt>
        <dd>a Structure that is a simplified copy of the input: a neutral, 
          single bond connected, heavy atom only frame. The returned 
          structure is handy for making RMSD comparisons between pseudo 
          conformers that differ by ionization state or tautomerism.</dd>
  </dl>
</td></tr></table>
</div>
<a name="_getRenumberedStructure"></a>
<div class="private">
<table class="details" border="1" cellpadding="3"
       cellspacing="0" width="100%" bgcolor="white">
<tr><td>
  <table width="100%" cellpadding="0" cellspacing="0" border="0">
  <tr valign="top"><td>
  <h3 class="epydoc"><span class="sig"><span class="sig-name">_getRenumberedStructure</span>(<span class="sig-arg">self</span>,
        <span class="sig-arg">st</span>)</span>
  </h3>
  </td><td align="right" valign="top"
    >&nbsp;
    </td>
  </tr></table>
  
  
  <dl class="fields">
    <dt>Parameters:</dt>
    <dd><ul class="nomargin-top">
        <li><strong class="pname"><code>st</code></strong> (structure.Structure) - The structure to renumber.</li>
    </ul></dd>
    <dt>Returns:</dt>
        <dd>a new structure with a normalized atom order, based upon the 
          reference set of SMARTS patterns in self._mol_pattern_dict.</dd>
  </dl>
</td></tr></table>
</div>
<a name="_superimpose"></a>
<div class="private">
<table class="details" border="1" cellpadding="3"
       cellspacing="0" width="100%" bgcolor="white">
<tr><td>
  <table width="100%" cellpadding="0" cellspacing="0" border="0">
  <tr valign="top"><td>
  <h3 class="epydoc"><span class="sig"><span class="sig-name">_superimpose</span>(<span class="sig-arg">self</span>,
        <span class="sig-arg">ref_st_selection</span>,
        <span class="sig-arg">test_st_selection</span>)</span>
  </h3>
  </td><td align="right" valign="top"
    >&nbsp;
    </td>
  </tr></table>
  
  <p>Calculate optimal rotation-translation transform of test_st_selection 
  of atoms in working_test_st onto ref_st_selection of atoms in 
  working_ref_st, and apply to test_structure.</p>
  <dl class="fields">
    <dt>Parameters:</dt>
    <dd><ul class="nomargin-top">
        <li><strong class="pname"><code>ref_st_selection</code></strong> (list) - A list of 1-based atom indices to consider from reference 
          structure.</li>
        <li><strong class="pname"><code>test_st_selection</code></strong> (list) - A list of 1-based atom indices to consider from test structure.</li>
    </ul></dd>
    <dt>Returns: tuple</dt>
        <dd>(coordinate arrays in reference structure, coordinate arrays in 
          test structure)</dd>
  </dl>
</td></tr></table>
</div>
<a name="getRmsdDataname"></a>
<div>
<table class="details" border="1" cellpadding="3"
       cellspacing="0" width="100%" bgcolor="white">
<tr><td>
  <table width="100%" cellpadding="0" cellspacing="0" border="0">
  <tr valign="top"><td>
  <h3 class="epydoc"><span class="sig"><span class="sig-name">getRmsdDataname</span>(<span class="sig-arg">self</span>)</span>
  </h3>
  </td><td align="right" valign="top"
    >&nbsp;
    </td>
  </tr></table>
  
  
  <dl class="fields">
    <dt>Returns: string</dt>
        <dd>m2io property dataname string.  The property name indicates the 
          reference structure, the title, the ASL used to identify 
          comparison atoms and if the structure is in-place or mobile.</dd>
  </dl>
</td></tr></table>
</div>
<a name="writeStructures"></a>
<div>
<table class="details" border="1" cellpadding="3"
       cellspacing="0" width="100%" bgcolor="white">
<tr><td>
  <table width="100%" cellpadding="0" cellspacing="0" border="0">
  <tr valign="top"><td>
  <h3 class="epydoc"><span class="sig"><span class="sig-name">writeStructures</span>(<span class="sig-arg">self</span>,
        <span class="sig-arg">file_name</span>=<span class="sig-default"><code class="variable-quote">'</code><code class="variable-string">rmsd.mae</code><code class="variable-quote">'</code></span>,
        <span class="sig-arg">mode</span>=<span class="sig-default"><code class="variable-quote">'</code><code class="variable-string">w</code><code class="variable-quote">'</code></span>)</span>
  </h3>
  </td><td align="right" valign="top"
    >&nbsp;
    </td>
  </tr></table>
  
  <p>Writes the reference and test structures to file.</p>
  <dl class="fields">
    <dt>Parameters:</dt>
    <dd><ul class="nomargin-top">
        <li><strong class="pname"><code>file_name</code></strong> (string) - Path of the structure file to write.</li>
        <li><strong class="pname"><code>mode</code></strong> (string) - 'w' =&gt; write, clobber as needed 'a' =&gt; append</li>
    </ul></dd>
  </dl>
</td></tr></table>
</div>
<a name="writeCommand"></a>
<div>
<table class="details" border="1" cellpadding="3"
       cellspacing="0" width="100%" bgcolor="white">
<tr><td>
  <table width="100%" cellpadding="0" cellspacing="0" border="0">
  <tr valign="top"><td>
  <h3 class="epydoc"><span class="sig"><span class="sig-name">writeCommand</span>(<span class="sig-arg">self</span>,
        <span class="sig-arg">file_name</span>=<span class="sig-default"><code class="variable-quote">'</code><code class="variable-string">rmsd.cmd</code><code class="variable-quote">'</code></span>)</span>
  </h3>
  </td><td align="right" valign="top"
    >&nbsp;
    </td>
  </tr></table>
  
  <p>Writes a Maestro command file and structures with the pair wise atom 
  mapping in command file mode.  The Maestro file has the same basename as 
  the command file.  Clobbers existing files.</p>
  <dl class="fields">
    <dt>Parameters:</dt>
    <dd><ul class="nomargin-top">
        <li><strong class="pname"><code>file_name</code></strong> (string) - Path to the maestro command file with the atom pairings.</li>
    </ul></dd>
  </dl>
</td></tr></table>
</div>
<br />
<!-- ==================== INSTANCE VARIABLE DETAILS ==================== -->
<a name="section-InstanceVariableDetails"></a>
<table class="details" border="1" cellpadding="3"
       cellspacing="0" width="100%" bgcolor="white">
<tr bgcolor="#70b0f0" class="table-header">
  <td colspan="2" class="table-header">
    <table border="0" cellpadding="0" cellspacing="0" width="100%">
      <tr valign="top">
        <td align="left"><span class="table-header">Instance Variable Details</span></td>
        <td align="right" valign="top"
         ><span class="options">[<a href="#section-InstanceVariableDetails"
         class="privatelink" onclick="toggle_private();"
         >hide private</a>]</span></td>
      </tr>
    </table>
  </td>
</tr>
</table>
<a name="orig_index_prop"></a>
<div>
<table class="details" border="1" cellpadding="3"
       cellspacing="0" width="100%" bgcolor="white">
<tr><td>
  <h3 class="epydoc">orig_index_prop</h3>
  m2io dataname for atomic property that stores the original atom index of 
  the input structures.  Default is 'i_confrmsd_original_index'.  This is 
  needed to we can extract/reduce/renumber and present information about 
  the original index which the end-user perceives.
  <dl class="fields">
  </dl>
</td></tr></table>
</div>
<a name="renumber_structures"></a>
<div>
<table class="details" border="1" cellpadding="3"
       cellspacing="0" width="100%" bgcolor="white">
<tr><td>
  <h3 class="epydoc">renumber_structures</h3>
  Boolean to control whether the reference and test structures should be 
  renumbered by a SMARTS pattern before calculating the rmsd.  For better 
  performance, set to False when the inputs are sure to have the same 
  atomic numbering schemes.
  <dl class="fields">
  </dl>
</td></tr></table>
</div>
<a name="use_heavy_atom_graph"></a>
<div>
<table class="details" border="1" cellpadding="3"
       cellspacing="0" width="100%" bgcolor="white">
<tr><td>
  <h3 class="epydoc">use_heavy_atom_graph</h3>
  Boolean to control whether the reference and test structures should be 
  treated as heavy-atom only, graph topologies.  Default is False.  
  Tautomers, and different ionization states are not true conformers, but 
  often require RMSD analysis.  If True, the test_structure and 
  reference_structure are treated by deleting all hydrogens, setting all 
  bond orders to 1, setting all formal charges to 0, then adjusting the 
  atom types.
  <dl class="fields">
  </dl>
</td></tr></table>
</div>
<a name="use_symmetry"></a>
<div>
<table class="details" border="1" cellpadding="3"
       cellspacing="0" width="100%" bgcolor="white">
<tr><td>
  <h3 class="epydoc">use_symmetry</h3>
  Boolean to control whether the test structure atom list should be 
  determined by with the mmsym library.  Mmsym accounts for molecular 
  symmetry and is recommended.  This boolean just allows for more detailed 
  testing.
  <dl class="fields">
  </dl>
</td></tr></table>
</div>
<br />
<!-- ==================== NAVIGATION BAR ==================== -->
<table class="navbar" border="0" width="100%" cellpadding="0"
       bgcolor="#a0c0ff" cellspacing="0">
  <tr valign="middle">

  <!-- Tree link -->
      <th>&nbsp;&nbsp;&nbsp;<a
        href="module-tree.html">Trees</a>&nbsp;&nbsp;&nbsp;</th>

  <!-- Index link -->
      <th>&nbsp;&nbsp;&nbsp;<a
        href="identifier-index.html">Indices</a>&nbsp;&nbsp;&nbsp;</th>

  <!-- Help link -->
      <th>&nbsp;&nbsp;&nbsp;<a
        href="help.html">Help</a>&nbsp;&nbsp;&nbsp;</th>

  <!-- Project homepage -->
      <th class="navbar" align="right" width="100%">
        <table border="0" cellpadding="0" cellspacing="0">
          <tr><th class="navbar" align="center"
            >2015-2Schrodinger Python API</th>
          </tr></table></th>
  </tr>
</table>
<table border="0" cellpadding="0" cellspacing="0" width="100%%">
  <tr>
    <td align="left" class="footer">
    Generated by Epydoc 3.0.1 on Sat May  9 06:31:26 2015
    </td>
    <td align="right" class="footer">
      <a target="mainFrame" href="http://epydoc.sourceforge.net"
        >http://epydoc.sourceforge.net</a>
    </td>
  </tr>
</table>

<script type="text/javascript">
  <!--
  // Private objects are initially displayed (because if
  // javascript is turned off then we want them to be
  // visible); but by default, we want to hide them.  So hide
  // them unless we have a cookie that says to show them.
  checkCookie();
  // -->
</script>
</body>
</html>
