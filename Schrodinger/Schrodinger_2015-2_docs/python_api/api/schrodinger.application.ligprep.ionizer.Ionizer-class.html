<?xml version="1.0" encoding="ascii"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
          "DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head>
  <title>schrodinger.application.ligprep.ionizer.Ionizer</title>
  <link rel="stylesheet" href="epydoc.css" type="text/css" />
  <script type="text/javascript" src="epydoc.js"></script>
</head>

<body bgcolor="white" text="black" link="blue" vlink="#204080"
      alink="#204080">
<!-- ==================== NAVIGATION BAR ==================== -->
<table class="navbar" border="0" width="100%" cellpadding="0"
       bgcolor="#a0c0ff" cellspacing="0">
  <tr valign="middle">

  <!-- Tree link -->
      <th>&nbsp;&nbsp;&nbsp;<a
        href="module-tree.html">Trees</a>&nbsp;&nbsp;&nbsp;</th>

  <!-- Index link -->
      <th>&nbsp;&nbsp;&nbsp;<a
        href="identifier-index.html">Indices</a>&nbsp;&nbsp;&nbsp;</th>

  <!-- Help link -->
      <th>&nbsp;&nbsp;&nbsp;<a
        href="help.html">Help</a>&nbsp;&nbsp;&nbsp;</th>

  <!-- Project homepage -->
      <th class="navbar" align="right" width="100%">
        <table border="0" cellpadding="0" cellspacing="0">
          <tr><th class="navbar" align="center"
            >2015-2Schrodinger Python API</th>
          </tr></table></th>
  </tr>
</table>
<table width="100%" cellpadding="0" cellspacing="0">
  <tr valign="top">
    <td width="100%">
      <span class="breadcrumbs">
        <a href="schrodinger-module.html">Package&nbsp;schrodinger</a> ::
        <a href="schrodinger.application-module.html">Package&nbsp;application</a> ::
        <a href="schrodinger.application.ligprep-module.html">Package&nbsp;ligprep</a> ::
        <a href="schrodinger.application.ligprep.ionizer-module.html">Module&nbsp;ionizer</a> ::
        Class&nbsp;Ionizer
      </span>
    </td>
    <td>
      <table cellpadding="0" cellspacing="0">
        <!-- hide/show private -->
        <tr><td align="right"><span class="options">[<a href="javascript:void(0);" class="privatelink"
    onclick="toggle_private();">hide&nbsp;private</a>]</span></td></tr>
        <tr><td align="right"><span class="options"
            >[<a href="frames.html" target="_top">frames</a
            >]&nbsp;|&nbsp;<a href="schrodinger.application.ligprep.ionizer.Ionizer-class.html"
            target="_top">no&nbsp;frames</a>]</span></td></tr>
      </table>
    </td>
  </tr>
</table>
<!-- ==================== CLASS DESCRIPTION ==================== -->
<h1 class="epydoc">Class Ionizer</h1><p class="nomargin-top"></p>
<pre class="base-tree">
<a href="object-class.html">object</a> --+
         |
        <strong class="uidshort">Ionizer</strong>
</pre>

<hr />
<p>Class for ionizing structures (part of LigPrep).</p>
  <p>To ionize a structure, do:</p>
  <p>i = Ionizer() out_sts = i.ionizeStructure(st)</p>
  <p>These options can be adjusted after instantiating the class:</p>

<!-- ==================== INSTANCE METHODS ==================== -->
<a name="section-InstanceMethods"></a>
<table class="summary" border="1" cellpadding="3"
       cellspacing="0" width="100%" bgcolor="white">
<tr bgcolor="#70b0f0" class="table-header">
  <td colspan="2" class="table-header">
    <table border="0" cellpadding="0" cellspacing="0" width="100%">
      <tr valign="top">
        <td align="left"><span class="table-header">Instance Methods</span></td>
        <td align="right" valign="top"
         ><span class="options">[<a href="#section-InstanceMethods"
         class="privatelink" onclick="toggle_private();"
         >hide private</a>]</span></td>
      </tr>
    </table>
  </td>
</tr>
<tr>
    <td width="15%" align="right" valign="top" class="summary">
      <span class="summary-type">&nbsp;</span>
    </td><td class="summary">
      <table width="100%" cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td><span class="summary-sig"><a href="schrodinger.application.ligprep.ionizer.Ionizer-class.html#__init__" class="summary-sig-name">__init__</a>(<span class="summary-sig-arg">self</span>,
        <span class="summary-sig-arg">loglevel</span>=<span class="summary-sig-default">0</span>,
        <span class="summary-sig-arg">specfile</span>=<span class="summary-sig-default">None</span>,
        <span class="summary-sig-arg">ph</span>=<span class="summary-sig-default">None</span>,
        <span class="summary-sig-arg">ph_thresh</span>=<span class="summary-sig-default">None</span>,
        <span class="summary-sig-arg">pk_thresh</span>=<span class="summary-sig-default">None</span>)</span><br />
      x.__init__(...) initializes x; see help(type(x)) for signature</td>
          <td align="right" valign="top">
            
            
          </td>
        </tr>
      </table>
      
    </td>
  </tr>
<tr>
    <td width="15%" align="right" valign="top" class="summary">
      <span class="summary-type">&nbsp;</span>
    </td><td class="summary">
      <table width="100%" cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td><span class="summary-sig"><a name="__del__"></a><span class="summary-sig-name">__del__</span>(<span class="summary-sig-arg">self</span>)</span></td>
          <td align="right" valign="top">
            
            
          </td>
        </tr>
      </table>
      
    </td>
  </tr>
<tr>
    <td width="15%" align="right" valign="top" class="summary">
      <span class="summary-type">&nbsp;</span>
    </td><td class="summary">
      <table width="100%" cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td><span class="summary-sig"><a name="initializeMmlibs"></a><span class="summary-sig-name">initializeMmlibs</span>(<span class="summary-sig-arg">self</span>)</span><br />
      Initialize the mmlibs libraries.</td>
          <td align="right" valign="top">
            
            
          </td>
        </tr>
      </table>
      
    </td>
  </tr>
<tr>
    <td width="15%" align="right" valign="top" class="summary">
      <span class="summary-type">&nbsp;</span>
    </td><td class="summary">
      <table width="100%" cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td><span class="summary-sig"><a href="schrodinger.application.ligprep.ionizer.Ionizer-class.html#readFragmentLibrary" class="summary-sig-name">readFragmentLibrary</a>(<span class="summary-sig-arg">self</span>,
        <span class="summary-sig-arg">flib_name</span>)</span><br />
      Read the ionized frag library and populate self.frags dictionary.</td>
          <td align="right" valign="top">
            
            
          </td>
        </tr>
      </table>
      
    </td>
  </tr>
<tr>
    <td width="15%" align="right" valign="top" class="summary">
      <span class="summary-type">&nbsp;</span>
    </td><td class="summary">
      <table width="100%" cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td><span class="summary-sig"><a href="schrodinger.application.ligprep.ionizer.Ionizer-class.html#readSpecFile" class="summary-sig-name">readSpecFile</a>(<span class="summary-sig-arg">self</span>)</span><br />
      Put cwd and $HOME/.schrodinger/mmshare at the front of the mmfile 
      search path, to allow user &quot;ionizer.ini&quot; in either of those
      dirs to override installed data file in the mmshare data dir.</td>
          <td align="right" valign="top">
            
            
          </td>
        </tr>
      </table>
      
    </td>
  </tr>
<tr>
    <td width="15%" align="right" valign="top" class="summary">
      <span class="summary-type"><a href="schrodinger.application.ligprep.ionizer.Spec-class.html" 
      class="link">Spec</a></span>
    </td><td class="summary">
      <table width="100%" cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td><span class="summary-sig"><a href="schrodinger.application.ligprep.ionizer.Ionizer-class.html#ionizeCommandParser" class="summary-sig-name">ionizeCommandParser</a>(<span class="summary-sig-arg">self</span>,
        <span class="summary-sig-arg">linenum</span>,
        <span class="summary-sig-arg">cmd</span>,
        <span class="summary-sig-arg">subs_patt</span>,
        <span class="summary-sig-arg">frag_name</span>,
        <span class="summary-sig-arg">pka</span>)</span><br />
      Validate mmsubs pattern spec; if all goes well, will store compiled 
      pattern matcher below</td>
          <td align="right" valign="top">
            
            
          </td>
        </tr>
      </table>
      
    </td>
  </tr>
<tr>
    <td width="15%" align="right" valign="top" class="summary">
      <span class="summary-type">&nbsp;</span>
    </td><td class="summary">
      <table width="100%" cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td><span class="summary-sig"><a href="schrodinger.application.ligprep.ionizer.Ionizer-class.html#excludeCommandParser" class="summary-sig-name">excludeCommandParser</a>(<span class="summary-sig-arg">self</span>,
        <span class="summary-sig-arg">linenum</span>,
        <span class="summary-sig-arg">subs_patt</span>)</span><br />
      Validate an &quot;exclude&quot; mmsubs pattern spec.</td>
          <td align="right" valign="top">
            
            
          </td>
        </tr>
      </table>
      
    </td>
  </tr>
<tr class="private">
    <td width="15%" align="right" valign="top" class="summary">
      <span class="summary-type">&nbsp;</span>
    </td><td class="summary">
      <table width="100%" cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td><span class="summary-sig"><a href="schrodinger.application.ligprep.ionizer.Ionizer-class.html#_treatStructure" class="summary-sig-name" onclick="show_private();">_treatStructure</a>(<span class="summary-sig-arg">self</span>,
        <span class="summary-sig-arg">st</span>)</span><br />
      This method generates the ionization states for the specified 
      structure, and appends them to the self.output_structures list.</td>
          <td align="right" valign="top">
            
            
          </td>
        </tr>
      </table>
      
    </td>
  </tr>
<tr>
    <td width="15%" align="right" valign="top" class="summary">
      <span class="summary-type">&nbsp;</span>
    </td><td class="summary">
      <table width="100%" cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td><span class="summary-sig"><a name="collectIonCandidates"></a><span class="summary-sig-name">collectIonCandidates</span>(<span class="summary-sig-arg">self</span>,
        <span class="summary-sig-arg">st</span>)</span><br />
      Check CT for matches to Acid/Base/Exclude patterns, in same order as 
      supplied in control spec file; for non-Excluded, final Acid/Base 
      matches, store specs in hash indexed on ion center atom number; also 
      get ordered list of candidate atom numbers.</td>
          <td align="right" valign="top">
            
            
          </td>
        </tr>
      </table>
      
    </td>
  </tr>
<tr class="private">
    <td width="15%" align="right" valign="top" class="summary">
      <span class="summary-type">&nbsp;</span>
    </td><td class="summary">
      <table width="100%" cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td><span class="summary-sig"><a name="_expandCT"></a><span class="summary-sig-name">_expandCT</span>(<span class="summary-sig-arg">self</span>,
        <span class="summary-sig-arg">st</span>,
        <span class="summary-sig-arg">input_ct_chargef_tot</span>,
        <span class="summary-sig-arg">ion_cand_atoms</span>,
        <span class="summary-sig-arg">ion_candidates</span>)</span><br />
      Basically a continuation of _treatStructure().</td>
          <td align="right" valign="top">
            
            
          </td>
        </tr>
      </table>
      
    </td>
  </tr>
<tr>
    <td width="15%" align="right" valign="top" class="summary">
      <span class="summary-type">&nbsp;</span>
    </td><td class="summary">
      <table width="100%" cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td><span class="summary-sig"><a href="schrodinger.application.ligprep.ionizer.Ionizer-class.html#generateStateCT" class="summary-sig-name">generateStateCT</a>(<span class="summary-sig-arg">self</span>,
        <span class="summary-sig-arg">st</span>,
        <span class="summary-sig-arg">total_charge</span>,
        <span class="summary-sig-arg">state_num</span>,
        <span class="summary-sig-arg">state_fuse_atoms</span>,
        <span class="summary-sig-arg">ion_candidates</span>,
        <span class="summary-sig-arg">ycost_total</span>,
        <span class="summary-sig-arg">zcost_total</span>)</span><br />
      Generate the CT for the specificed ionization state.</td>
          <td align="right" valign="top">
            
            
          </td>
        </tr>
      </table>
      
    </td>
  </tr>
<tr>
    <td width="15%" align="right" valign="top" class="summary">
      <span class="summary-type">&nbsp;</span>
    </td><td class="summary">
      <table width="100%" cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td><span class="summary-sig"><a name="fuseIonFragment"></a><span class="summary-sig-name">fuseIonFragment</span>(<span class="summary-sig-arg">self</span>,
        <span class="summary-sig-arg">output_st</span>,
        <span class="summary-sig-arg">fuse_atom_orig</span>,
        <span class="summary-sig-arg">pre_fuse_center</span>,
        <span class="summary-sig-arg">renumbered_fuse_atoms</span>,
        <span class="summary-sig-arg">cand</span>)</span><br />
      This function coordinates the ionization of one ionizable group, via 
      mmbuild_fuse() of the appropriate ionizing fragment onto the group's 
      ionization center atom (same method as Maestro builder uses for Place
      onto non-terminal atom); function also takes care of various property
      adjustments in the modified CT.</td>
          <td align="right" valign="top">
            
            
          </td>
        </tr>
      </table>
      
    </td>
  </tr>
<tr>
    <td width="15%" align="right" valign="top" class="summary">
      <span class="summary-type">&nbsp;</span>
    </td><td class="summary">
      <table width="100%" cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td><span class="summary-sig"><a name="saveIonCenterProps"></a><span class="summary-sig-name">saveIonCenterProps</span>(<span class="summary-sig-arg">self</span>,
        <span class="summary-sig-arg">st</span>,
        <span class="summary-sig-arg">center_anum</span>)</span><br />
      Save certain properties of an ion center atom before the ionizing 
      fuse.</td>
          <td align="right" valign="top">
            
            
          </td>
        </tr>
      </table>
      
    </td>
  </tr>
<tr>
    <td width="15%" align="right" valign="top" class="summary">
      <span class="summary-type">&nbsp;</span>
    </td><td class="summary">
      <table width="100%" cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td><span class="summary-sig"><a href="schrodinger.application.ligprep.ionizer.Ionizer-class.html#restoreIonCenterProps" class="summary-sig-name">restoreIonCenterProps</a>(<span class="summary-sig-arg">self</span>,
        <span class="summary-sig-arg">st</span>,
        <span class="summary-sig-arg">iatom</span>)</span><br />
      Restores the atom properties saved by the method above.</td>
          <td align="right" valign="top">
            
            
          </td>
        </tr>
      </table>
      
    </td>
  </tr>
<tr>
    <td width="15%" align="right" valign="top" class="summary">
      <span class="summary-type">&nbsp;</span>
    </td><td class="summary">
      <table width="100%" cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td><span class="summary-sig"><a href="schrodinger.application.ligprep.ionizer.Ionizer-class.html#reviseIonizedGroup" class="summary-sig-name">reviseIonizedGroup</a>(<span class="summary-sig-arg">self</span>,
        <span class="summary-sig-arg">st</span>,
        <span class="summary-sig-arg">center_atom</span>)</span><br />
      Function to apply above reset function to all atoms of newly ionized 
      group.</td>
          <td align="right" valign="top">
            
            
          </td>
        </tr>
      </table>
      
    </td>
  </tr>
<tr>
    <td width="15%" align="right" valign="top" class="summary">
      <span class="summary-type">&nbsp;</span>
    </td><td class="summary">
      <table width="100%" cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td><span class="summary-sig"><a name="addIonProperties"></a><span class="summary-sig-name">addIonProperties</span>(<span class="summary-sig-arg">self</span>,
        <span class="summary-sig-arg">st</span>,
        <span class="summary-sig-arg">state_num</span>,
        <span class="summary-sig-arg">total_charge</span>,
        <span class="summary-sig-arg">center_atoms_string</span>,
        <span class="summary-sig-arg">center_types_string</span>,
        <span class="summary-sig-arg">center_atoms_orig_string</span>)</span><br />
      This function writes CT-level properties recording several details of
      a particular ionization state; it's intended to be used on CTs 
      generated for output; the values expressed in the properties must be 
      calculated beforehand; all of these properties get marked as 
      dependent on CONNECTIVITY.</td>
          <td align="right" valign="top">
            
            
          </td>
        </tr>
      </table>
      
    </td>
  </tr>
<tr>
    <td width="15%" align="right" valign="top" class="summary">
      <span class="summary-type">&nbsp;</span>
    </td><td class="summary">
      <table width="100%" cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td><span class="summary-sig"><a name="addCostProperties"></a><span class="summary-sig-name">addCostProperties</span>(<span class="summary-sig-arg">self</span>,
        <span class="summary-sig-arg">st</span>,
        <span class="summary-sig-arg">ycost_total</span>,
        <span class="summary-sig-arg">zcost_total</span>)</span><br />
      For use in pH mode only, this function adds CT-level properties 
      recording the free energy costs associated with this particular 
      ionization state.</td>
          <td align="right" valign="top">
            
            
          </td>
        </tr>
      </table>
      
    </td>
  </tr>
<tr>
    <td width="15%" align="right" valign="top" class="summary">
      <span class="summary-type">List of structures.</span>
    </td><td class="summary">
      <table width="100%" cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td><span class="summary-sig"><a href="schrodinger.application.ligprep.ionizer.Ionizer-class.html#ionizeStructure" class="summary-sig-name">ionizeStructure</a>(<span class="summary-sig-arg">self</span>,
        <span class="summary-sig-arg">st</span>)</span><br />
      This is the public interface method.</td>
          <td align="right" valign="top">
            
            
          </td>
        </tr>
      </table>
      
    </td>
  </tr>
  <tr>
    <td colspan="2" class="summary">
    <p class="indent-wrapped-lines"><b>Inherited from <code><a href="object-class.html">object</a></code></b>:
      <code><a href="object-class.html#__delattr__">__delattr__</a></code>,
      <code><a href="object-class.html#__format__">__format__</a></code>,
      <code><a href="object-class.html#__getattribute__">__getattribute__</a></code>,
      <code><a href="object-class.html#__hash__">__hash__</a></code>,
      <code><a href="object-class.html#__new__">__new__</a></code>,
      <code><a href="object-class.html#__reduce__">__reduce__</a></code>,
      <code><a href="object-class.html#__reduce_ex__">__reduce_ex__</a></code>,
      <code><a href="object-class.html#__repr__">__repr__</a></code>,
      <code><a href="object-class.html#__setattr__">__setattr__</a></code>,
      <code><a href="object-class.html#__sizeof__">__sizeof__</a></code>,
      <code><a href="object-class.html#__str__">__str__</a></code>,
      <code><a href="object-class.html#__subclasshook__">__subclasshook__</a></code>
      </p>
    </td>
  </tr>
</table>
<!-- ==================== INSTANCE VARIABLES ==================== -->
<a name="section-InstanceVariables"></a>
<table class="summary" border="1" cellpadding="3"
       cellspacing="0" width="100%" bgcolor="white">
<tr bgcolor="#70b0f0" class="table-header">
  <td colspan="2" class="table-header">
    <table border="0" cellpadding="0" cellspacing="0" width="100%">
      <tr valign="top">
        <td align="left"><span class="table-header">Instance Variables</span></td>
        <td align="right" valign="top"
         ><span class="options">[<a href="#section-InstanceVariables"
         class="privatelink" onclick="toggle_private();"
         >hide private</a>]</span></td>
      </tr>
    </table>
  </td>
</tr>
<tr>
    <td width="15%" align="right" valign="top" class="summary">
      <span class="summary-type">&nbsp;</span>
    </td><td class="summary">
        <a name="keep_props"></a><span class="summary-name">keep_props</span><br />
      Whether to keep any structure-based properties from the input CT in 
      the output CTs.
    </td>
  </tr>
<tr>
    <td width="15%" align="right" valign="top" class="summary">
      <span class="summary-type">&nbsp;</span>
    </td><td class="summary">
        <a href="schrodinger.application.ligprep.ionizer.Ionizer-class.html#logger" class="summary-name">logger</a><br />
      Logger instance.
    </td>
  </tr>
<tr>
    <td width="15%" align="right" valign="top" class="summary">
      <span class="summary-type">&nbsp;</span>
    </td><td class="summary">
        <a name="max_abstotq"></a><span class="summary-name">max_abstotq</span><br />
      Maximum absolute value of total charge.
    </td>
  </tr>
<tr>
    <td width="15%" align="right" valign="top" class="summary">
      <span class="summary-type">&nbsp;</span>
    </td><td class="summary">
        <a name="max_groups"></a><span class="summary-name">max_groups</span><br />
      Maximum ionizational groups to handle (up to MAX_GROUPS_MAX).
    </td>
  </tr>
<tr>
    <td width="15%" align="right" valign="top" class="summary">
      <span class="summary-type">&nbsp;</span>
    </td><td class="summary">
        <a name="max_ions"></a><span class="summary-name">max_ions</span><br />
      Maximum number of ionizations.
    </td>
  </tr>
<tr>
    <td width="15%" align="right" valign="top" class="summary">
      <span class="summary-type">&nbsp;</span>
    </td><td class="summary">
        <a name="max_outcts"></a><span class="summary-name">max_outcts</span><br />
      Maximum output CTs per input CT.
    </td>
  </tr>
<tr>
    <td width="15%" align="right" valign="top" class="summary">
      <span class="summary-type">&nbsp;</span>
    </td><td class="summary">
        <a name="retain"></a><span class="summary-name">retain</span><br />
      Whether to retain the input structure in the output.
    </td>
  </tr>
<tr>
    <td width="15%" align="right" valign="top" class="summary">
      <span class="summary-type">&nbsp;</span>
    </td><td class="summary">
        <a name="retain_lab"></a><span class="summary-name">retain_lab</span><br />
      Retain the input structure that has &quot;i_lp_orig_ion_str&quot; 
      property set.
    </td>
  </tr>
<tr>
    <td width="15%" align="right" valign="top" class="summary">
      <span class="summary-type">&nbsp;</span>
    </td><td class="summary">
        <a name="retitle_with"></a><span class="summary-name">retitle_with</span><br />
      Prefix for adding ion state numbers to output CT titles.
    </td>
  </tr>
<tr>
    <td width="15%" align="right" valign="top" class="summary">
      <span class="summary-type">&nbsp;</span>
    </td><td class="summary">
        <a name="show_final_list"></a><span class="summary-name">show_final_list</span><br />
      Report final ionization candidate list to logger.
    </td>
  </tr>
<tr>
    <td width="15%" align="right" valign="top" class="summary">
      <span class="summary-type">&nbsp;</span>
    </td><td class="summary">
        <a name="show_match_atoms"></a><span class="summary-name">show_match_atoms</span><br />
      Whether to report substructure pattern matches to the logger (log 
      file).
    </td>
  </tr>
<tr>
    <td width="15%" align="right" valign="top" class="summary">
      <span class="summary-type">&nbsp;</span>
    </td><td class="summary">
        <a href="schrodinger.application.ligprep.ionizer.Ionizer-class.html#show_skips" class="summary-name">show_skips</a><br />
      Whether to show skipped state generations.
    </td>
  </tr>
</table>
<!-- ==================== PROPERTIES ==================== -->
<a name="section-Properties"></a>
<table class="summary" border="1" cellpadding="3"
       cellspacing="0" width="100%" bgcolor="white">
<tr bgcolor="#70b0f0" class="table-header">
  <td colspan="2" class="table-header">
    <table border="0" cellpadding="0" cellspacing="0" width="100%">
      <tr valign="top">
        <td align="left"><span class="table-header">Properties</span></td>
        <td align="right" valign="top"
         ><span class="options">[<a href="#section-Properties"
         class="privatelink" onclick="toggle_private();"
         >hide private</a>]</span></td>
      </tr>
    </table>
  </td>
</tr>
  <tr>
    <td colspan="2" class="summary">
    <p class="indent-wrapped-lines"><b>Inherited from <code><a href="object-class.html">object</a></code></b>:
      <code><a href="object-class.html#__class__">__class__</a></code>
      </p>
    </td>
  </tr>
</table>
<!-- ==================== METHOD DETAILS ==================== -->
<a name="section-MethodDetails"></a>
<table class="details" border="1" cellpadding="3"
       cellspacing="0" width="100%" bgcolor="white">
<tr bgcolor="#70b0f0" class="table-header">
  <td colspan="2" class="table-header">
    <table border="0" cellpadding="0" cellspacing="0" width="100%">
      <tr valign="top">
        <td align="left"><span class="table-header">Method Details</span></td>
        <td align="right" valign="top"
         ><span class="options">[<a href="#section-MethodDetails"
         class="privatelink" onclick="toggle_private();"
         >hide private</a>]</span></td>
      </tr>
    </table>
  </td>
</tr>
</table>
<a name="__init__"></a>
<div>
<table class="details" border="1" cellpadding="3"
       cellspacing="0" width="100%" bgcolor="white">
<tr><td>
  <table width="100%" cellpadding="0" cellspacing="0" border="0">
  <tr valign="top"><td>
  <h3 class="epydoc"><span class="sig"><span class="sig-name">__init__</span>(<span class="sig-arg">self</span>,
        <span class="sig-arg">loglevel</span>=<span class="sig-default">0</span>,
        <span class="sig-arg">specfile</span>=<span class="sig-default">None</span>,
        <span class="sig-arg">ph</span>=<span class="sig-default">None</span>,
        <span class="sig-arg">ph_thresh</span>=<span class="sig-default">None</span>,
        <span class="sig-arg">pk_thresh</span>=<span class="sig-default">None</span>)</span>
    <br /><em class="fname">(Constructor)</em>
  </h3>
  </td><td align="right" valign="top"
    >&nbsp;
    </td>
  </tr></table>
  
  <p>x.__init__(...) initializes x; see help(type(x)) for signature</p>
  <dl class="fields">
    <dt>Parameters:</dt>
    <dd><ul class="nomargin-top">
        <li><strong class="pname"><code>logleve</code></strong> - Reporting log level. Use 0 for quietest (default); use 1 to log 
          state generations; use 2 to log ion frag fusions also.</li>
        <li><strong class="pname"><code>specfile</code></strong> (str or None) - Path to the non-standard patterns spec file to use.</li>
        <li><strong class="pname"><code>ph</code></strong> (float or None) - Effective pH of active site. Does not apply to pK-only mode.</li>
        <li><strong class="pname"><code>ph_thresh</code></strong> (float or None) - De-protonated |pKa-pH| difference limit. Does not apply to 
          pK-only mode.</li>
        <li><strong class="pname"><code>pk_thresh</code></strong> (float or None) - Strong/weak pK threshold (no default). Overrides pH-based 
          rejection mode and activates pK-only mode. Reject on pKa values 
          only (no pH).</li>
        <li><strong class="pname"><code>loglevel</code></strong> (int)</li>
    </ul></dd>
    <dt>Overrides:
        object.__init__
    </dt>
  </dl>
</td></tr></table>
</div>
<a name="readFragmentLibrary"></a>
<div>
<table class="details" border="1" cellpadding="3"
       cellspacing="0" width="100%" bgcolor="white">
<tr><td>
  <table width="100%" cellpadding="0" cellspacing="0" border="0">
  <tr valign="top"><td>
  <h3 class="epydoc"><span class="sig"><span class="sig-name">readFragmentLibrary</span>(<span class="sig-arg">self</span>,
        <span class="sig-arg">flib_name</span>)</span>
  </h3>
  </td><td align="right" valign="top"
    >&nbsp;
    </td>
  </tr></table>
  
  <p>Read the ionized frag library and populate self.frags dictionary.</p>
  <p>The ionized frag lib contains a fairly small number of fragments, all 
  or most of which will be fused in a typical run; therefore we just 
  collect information on all of them now.</p>
  <dl class="fields">
  </dl>
</td></tr></table>
</div>
<a name="readSpecFile"></a>
<div>
<table class="details" border="1" cellpadding="3"
       cellspacing="0" width="100%" bgcolor="white">
<tr><td>
  <table width="100%" cellpadding="0" cellspacing="0" border="0">
  <tr valign="top"><td>
  <h3 class="epydoc"><span class="sig"><span class="sig-name">readSpecFile</span>(<span class="sig-arg">self</span>)</span>
  </h3>
  </td><td align="right" valign="top"
    >&nbsp;
    </td>
  </tr></table>
  
  <p>Put cwd and $HOME/.schrodinger/mmshare at the front of the mmfile 
  search path, to allow user &quot;ionizer.ini&quot; in either of those 
  dirs to override installed data file in the mmshare data dir.</p>
  <p>Note: We wait as late as possible to do this, to prevent any similar 
  override of the mmfrag data files, which we currently consider to be 
  inviolate, that is, the user must not be allowed to override them, even 
  accidentally.</p>
  <dl class="fields">
  </dl>
</td></tr></table>
</div>
<a name="ionizeCommandParser"></a>
<div>
<table class="details" border="1" cellpadding="3"
       cellspacing="0" width="100%" bgcolor="white">
<tr><td>
  <table width="100%" cellpadding="0" cellspacing="0" border="0">
  <tr valign="top"><td>
  <h3 class="epydoc"><span class="sig"><span class="sig-name">ionizeCommandParser</span>(<span class="sig-arg">self</span>,
        <span class="sig-arg">linenum</span>,
        <span class="sig-arg">cmd</span>,
        <span class="sig-arg">subs_patt</span>,
        <span class="sig-arg">frag_name</span>,
        <span class="sig-arg">pka</span>)</span>
  </h3>
  </td><td align="right" valign="top"
    >&nbsp;
    </td>
  </tr></table>
  
  <p>Validate mmsubs pattern spec; if all goes well, will store compiled 
  pattern matcher below</p>
  <p>Parses both Acid and Base specs.</p>
  <dl class="fields">
    <dt>Parameters:</dt>
    <dd><ul class="nomargin-top">
        <li><strong class="pname"><code>linenum</code></strong> (int) - Line number that is being parsed</li>
        <li><strong class="pname"><code>cmd</code></strong> (str) - Spec command that is being parsed. Either &quot;acid&quot; or 
          &quot;base&quot;.</li>
        <li><strong class="pname"><code>subs_patt</code></strong> (str) - Substructure pattern for this specification.</li>
        <li><strong class="pname"><code>frag_name</code></strong> (str) - Name of the fragment to use (from the &quot;ionized&quot; 
          fragment library).</li>
        <li><strong class="pname"><code>pka</code></strong> (str) - String representation of the pKa for this ionizable group.</li>
    </ul></dd>
    <dt>Returns: <a href="schrodinger.application.ligprep.ionizer.Spec-class.html" 
      class="link">Spec</a></dt>
        <dd>The Spec instance representing this ionizable group.</dd>
  </dl>
</td></tr></table>
</div>
<a name="excludeCommandParser"></a>
<div>
<table class="details" border="1" cellpadding="3"
       cellspacing="0" width="100%" bgcolor="white">
<tr><td>
  <table width="100%" cellpadding="0" cellspacing="0" border="0">
  <tr valign="top"><td>
  <h3 class="epydoc"><span class="sig"><span class="sig-name">excludeCommandParser</span>(<span class="sig-arg">self</span>,
        <span class="sig-arg">linenum</span>,
        <span class="sig-arg">subs_patt</span>)</span>
  </h3>
  </td><td align="right" valign="top"
    >&nbsp;
    </td>
  </tr></table>
  
  <p>Validate an &quot;exclude&quot; mmsubs pattern spec.</p>
  <dl class="fields">
    <dt>Parameters:</dt>
    <dd><ul class="nomargin-top">
        <li><strong class="pname"><code>linenum</code></strong> (int) - Line number that is being parsed</li>
        <li><strong class="pname"><code>subs_patt</code></strong> (str) - Substructure pattern for this specification.</li>
    </ul></dd>
  </dl>
</td></tr></table>
</div>
<a name="_treatStructure"></a>
<div class="private">
<table class="details" border="1" cellpadding="3"
       cellspacing="0" width="100%" bgcolor="white">
<tr><td>
  <table width="100%" cellpadding="0" cellspacing="0" border="0">
  <tr valign="top"><td>
  <h3 class="epydoc"><span class="sig"><span class="sig-name">_treatStructure</span>(<span class="sig-arg">self</span>,
        <span class="sig-arg">st</span>)</span>
  </h3>
  </td><td align="right" valign="top"
    >&nbsp;
    </td>
  </tr></table>
  
  <p>This method generates the ionization states for the specified 
  structure, and appends them to the self.output_structures list.</p>
  <dl class="fields">
    <dt>Parameters:</dt>
    <dd><ul class="nomargin-top">
        <li><strong class="pname"><code>st</code></strong> (<a href="schrodinger.structure.Structure-class.html" 
          class="link">structure.Structure</a>) - Structure to process.</li>
    </ul></dd>
    <dt>Raises:</dt>
    <dd><ul class="nomargin-top">
        <li><code><strong class='fraise'><a href="schrodinger.application.ligprep.ionizer.TooManyGroupsError-class.html">TooManyGroupsError</a></strong></code> - if the number of ionizable groups exceeds the limit.</li>
        <li><code><strong class='fraise'><a href="schrodinger.application.ligprep.ionizer.TolerableError-class.html">TolerableError</a></strong></code> - on a non-fatal error.</li>
    </ul></dd>
  </dl>
</td></tr></table>
</div>
<a name="generateStateCT"></a>
<div>
<table class="details" border="1" cellpadding="3"
       cellspacing="0" width="100%" bgcolor="white">
<tr><td>
  <table width="100%" cellpadding="0" cellspacing="0" border="0">
  <tr valign="top"><td>
  <h3 class="epydoc"><span class="sig"><span class="sig-name">generateStateCT</span>(<span class="sig-arg">self</span>,
        <span class="sig-arg">st</span>,
        <span class="sig-arg">total_charge</span>,
        <span class="sig-arg">state_num</span>,
        <span class="sig-arg">state_fuse_atoms</span>,
        <span class="sig-arg">ion_candidates</span>,
        <span class="sig-arg">ycost_total</span>,
        <span class="sig-arg">zcost_total</span>)</span>
  </h3>
  </td><td align="right" valign="top"
    >&nbsp;
    </td>
  </tr></table>
  
  <p>Generate the CT for the specificed ionization state.</p>
  <dl class="fields">
    <dt>Parameters:</dt>
    <dd><ul class="nomargin-top">
        <li><strong class="pname"><code>st</code></strong> (<a href="schrodinger.structure.Structure-class.html" 
          class="link">structure.Structure</a>) - Input structure.</li>
        <li><strong class="pname"><code>total_charge</code></strong> (int) - Total charge of this ionization state.</li>
        <li><strong class="pname"><code>state_num</code></strong> (int) - The number of this state (0-indexed)</li>
        <li><strong class="pname"><code>state_fuse_atoms</code></strong> (list of ints) - List of atoms to which the new fragment will be attached to.</li>
        <li><strong class="pname"><code>ion_candidates</code></strong> (dict; key: atom index; value: <a 
          href="schrodinger.application.ligprep.ionizer.Spec-class.html" 
          class="link">Spec</a>) - Specifications for this state change.</li>
        <li><strong class="pname"><code>ycost_total</code></strong> (float) - Charging ionization penalty for this state</li>
        <li><strong class="pname"><code>zcost_total</code></strong> (float) - Neutral ionization penalty for this state</li>
    </ul></dd>
  </dl>
</td></tr></table>
</div>
<a name="restoreIonCenterProps"></a>
<div>
<table class="details" border="1" cellpadding="3"
       cellspacing="0" width="100%" bgcolor="white">
<tr><td>
  <table width="100%" cellpadding="0" cellspacing="0" border="0">
  <tr valign="top"><td>
  <h3 class="epydoc"><span class="sig"><span class="sig-name">restoreIonCenterProps</span>(<span class="sig-arg">self</span>,
        <span class="sig-arg">st</span>,
        <span class="sig-arg">iatom</span>)</span>
  </h3>
  </td><td align="right" valign="top"
    >&nbsp;
    </td>
  </tr></table>
  
  <p>Restores the atom properties saved by the method above. Also sets the 
  default display color property based on the atom's new (i.e., post-fuse) 
  atom type. Pass in post-fuse atom number (new ionized group center or 
  bonded H).</p>
  <dl class="fields">
  </dl>
</td></tr></table>
</div>
<a name="reviseIonizedGroup"></a>
<div>
<table class="details" border="1" cellpadding="3"
       cellspacing="0" width="100%" bgcolor="white">
<tr><td>
  <table width="100%" cellpadding="0" cellspacing="0" border="0">
  <tr valign="top"><td>
  <h3 class="epydoc"><span class="sig"><span class="sig-name">reviseIonizedGroup</span>(<span class="sig-arg">self</span>,
        <span class="sig-arg">st</span>,
        <span class="sig-arg">center_atom</span>)</span>
  </h3>
  </td><td align="right" valign="top"
    >&nbsp;
    </td>
  </tr></table>
  
  <p>Function to apply above reset function to all atoms of newly ionized 
  group. Pass in post-fuse ionized group center atom number Collect list of
  newly ionized group's atoms (new ionized center + all Hydrogens bonded to
  it); revise certain atom properties to match original ion center</p>
  <dl class="fields">
  </dl>
</td></tr></table>
</div>
<a name="ionizeStructure"></a>
<div>
<table class="details" border="1" cellpadding="3"
       cellspacing="0" width="100%" bgcolor="white">
<tr><td>
  <table width="100%" cellpadding="0" cellspacing="0" border="0">
  <tr valign="top"><td>
  <h3 class="epydoc"><span class="sig"><span class="sig-name">ionizeStructure</span>(<span class="sig-arg">self</span>,
        <span class="sig-arg">st</span>)</span>
  </h3>
  </td><td align="right" valign="top"
    >&nbsp;
    </td>
  </tr></table>
  
  <p>This is the public interface method. The specified CT will be ionized,
  and the output structures will be returned as a list.</p>
  <dl class="fields">
    <dt>Parameters:</dt>
    <dd><ul class="nomargin-top">
        <li><strong class="pname"><code>st</code></strong> (<a href="schrodinger.structure.Structure-class.html" 
          class="link">structure.Structure</a> object) - Structure to ionize.</li>
    </ul></dd>
    <dt>Returns: List of structures.</dt>
        <dd>Returns a list of ionized output structures.</dd>
    <dt>Raises:</dt>
    <dd><ul class="nomargin-top">
        <li><code><strong class='fraise'><a href="schrodinger.application.ligprep.ionizer.TooManyGroupsError-class.html">TooManyGroupsError</a></strong></code> - if the CT had too many ionizable groups.</li>
        <li><code><strong class='fraise'><a href="schrodinger.application.ligprep.ionizer.TolerableError-class.html">TolerableError</a></strong></code> - if there was a non-fatal error</li>
        <li><code><strong class='fraise'>RuntimeError</strong></code> - on unexpected error</li>
    </ul></dd>
  </dl>
</td></tr></table>
</div>
<br />
<!-- ==================== INSTANCE VARIABLE DETAILS ==================== -->
<a name="section-InstanceVariableDetails"></a>
<table class="details" border="1" cellpadding="3"
       cellspacing="0" width="100%" bgcolor="white">
<tr bgcolor="#70b0f0" class="table-header">
  <td colspan="2" class="table-header">
    <table border="0" cellpadding="0" cellspacing="0" width="100%">
      <tr valign="top">
        <td align="left"><span class="table-header">Instance Variable Details</span></td>
        <td align="right" valign="top"
         ><span class="options">[<a href="#section-InstanceVariableDetails"
         class="privatelink" onclick="toggle_private();"
         >hide private</a>]</span></td>
      </tr>
    </table>
  </td>
</tr>
</table>
<a name="logger"></a>
<div>
<table class="details" border="1" cellpadding="3"
       cellspacing="0" width="100%" bgcolor="white">
<tr><td>
  <h3 class="epydoc">logger</h3>
  Logger instance. When processing CTs, any info, warning, and error 
  messages will be redirected here.
  <dl class="fields">
  </dl>
</td></tr></table>
</div>
<a name="show_skips"></a>
<div>
<table class="details" border="1" cellpadding="3"
       cellspacing="0" width="100%" bgcolor="white">
<tr><td>
  <h3 class="epydoc">show_skips</h3>
  Whether to show skipped state generations. Applies only to log levels 1 
  and up.
  <dl class="fields">
  </dl>
</td></tr></table>
</div>
<br />
<!-- ==================== NAVIGATION BAR ==================== -->
<table class="navbar" border="0" width="100%" cellpadding="0"
       bgcolor="#a0c0ff" cellspacing="0">
  <tr valign="middle">

  <!-- Tree link -->
      <th>&nbsp;&nbsp;&nbsp;<a
        href="module-tree.html">Trees</a>&nbsp;&nbsp;&nbsp;</th>

  <!-- Index link -->
      <th>&nbsp;&nbsp;&nbsp;<a
        href="identifier-index.html">Indices</a>&nbsp;&nbsp;&nbsp;</th>

  <!-- Help link -->
      <th>&nbsp;&nbsp;&nbsp;<a
        href="help.html">Help</a>&nbsp;&nbsp;&nbsp;</th>

  <!-- Project homepage -->
      <th class="navbar" align="right" width="100%">
        <table border="0" cellpadding="0" cellspacing="0">
          <tr><th class="navbar" align="center"
            >2015-2Schrodinger Python API</th>
          </tr></table></th>
  </tr>
</table>
<table border="0" cellpadding="0" cellspacing="0" width="100%%">
  <tr>
    <td align="left" class="footer">
    Generated by Epydoc 3.0.1 on Sat May  9 06:31:17 2015
    </td>
    <td align="right" class="footer">
      <a target="mainFrame" href="http://epydoc.sourceforge.net"
        >http://epydoc.sourceforge.net</a>
    </td>
  </tr>
</table>

<script type="text/javascript">
  <!--
  // Private objects are initially displayed (because if
  // javascript is turned off then we want them to be
  // visible); but by default, we want to hide them.  So hide
  // them unless we have a cookie that says to show them.
  checkCookie();
  // -->
</script>
</body>
</html>
