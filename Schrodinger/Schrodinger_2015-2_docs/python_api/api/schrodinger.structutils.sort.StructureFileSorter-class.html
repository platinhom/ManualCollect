<?xml version="1.0" encoding="ascii"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
          "DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head>
  <title>schrodinger.structutils.sort.StructureFileSorter</title>
  <link rel="stylesheet" href="epydoc.css" type="text/css" />
  <script type="text/javascript" src="epydoc.js"></script>
</head>

<body bgcolor="white" text="black" link="blue" vlink="#204080"
      alink="#204080">
<!-- ==================== NAVIGATION BAR ==================== -->
<table class="navbar" border="0" width="100%" cellpadding="0"
       bgcolor="#a0c0ff" cellspacing="0">
  <tr valign="middle">

  <!-- Tree link -->
      <th>&nbsp;&nbsp;&nbsp;<a
        href="module-tree.html">Trees</a>&nbsp;&nbsp;&nbsp;</th>

  <!-- Index link -->
      <th>&nbsp;&nbsp;&nbsp;<a
        href="identifier-index.html">Indices</a>&nbsp;&nbsp;&nbsp;</th>

  <!-- Help link -->
      <th>&nbsp;&nbsp;&nbsp;<a
        href="help.html">Help</a>&nbsp;&nbsp;&nbsp;</th>

  <!-- Project homepage -->
      <th class="navbar" align="right" width="100%">
        <table border="0" cellpadding="0" cellspacing="0">
          <tr><th class="navbar" align="center"
            >2015-2Schrodinger Python API</th>
          </tr></table></th>
  </tr>
</table>
<table width="100%" cellpadding="0" cellspacing="0">
  <tr valign="top">
    <td width="100%">
      <span class="breadcrumbs">
        <a href="schrodinger-module.html">Package&nbsp;schrodinger</a> ::
        <a href="schrodinger.structutils-module.html">Package&nbsp;structutils</a> ::
        <a href="schrodinger.structutils.sort-module.html">Module&nbsp;sort</a> ::
        Class&nbsp;StructureFileSorter
      </span>
    </td>
    <td>
      <table cellpadding="0" cellspacing="0">
        <!-- hide/show private -->
        <tr><td align="right"><span class="options">[<a href="javascript:void(0);" class="privatelink"
    onclick="toggle_private();">hide&nbsp;private</a>]</span></td></tr>
        <tr><td align="right"><span class="options"
            >[<a href="frames.html" target="_top">frames</a
            >]&nbsp;|&nbsp;<a href="schrodinger.structutils.sort.StructureFileSorter-class.html"
            target="_top">no&nbsp;frames</a>]</span></td></tr>
      </table>
    </td>
  </tr>
</table>
<!-- ==================== CLASS DESCRIPTION ==================== -->
<h1 class="epydoc">Class StructureFileSorter</h1><p class="nomargin-top"></p>
<pre class="literalblock">

A class to sort structure files by ct-level property values.

API Example
___________

glide_sp_pv_sorter = sort.StructureFileSorter(
    file_name = 'foo_pv.mae', 
    file_index = 2
)
glide_sp_pv_sorter.sort()
glide_sp_pv_sorter.writeTopNFromBlock('bar_lib.mae', 2)

st_sorter = sort.StructureFileSorter(
    file_name = &quot;baz.mae&quot;,
    sort_criteria = [
        ('r_prop_one', sort.ASCENDING),
        ('i_prop_two', sort.DESCENDING)
    ]
)
st_sorter.sort()
st_sorter.write('baz-sorted.mae')


Class Attributes
----------------

None


Instance Attributes
-------------------
structure_index_order (list) 
    Sorted structure index order.  A list of the original file
    indexes, in the order they appear when sorted by sort_criteria
    and intra_block_sort_criteria.

structure_dict (dict)
    File index keys for ct-level property dictionary.

structure_block_order (list)
    Block_ids sorted by 'sort_criteria' keys. 

structure_count (int)
    The number of structures in the file.

read_forward_quota (int)
    Sort in batches, with this chunk size, instead of with
    random-access.  If the value evaluate as True, the input file is
    read, forward-only, in small chunks that are sorted in memory.
    Default is 0, use random-access. 


An instance is primarily a data structure where the original file
positions are keys for the dictionary of properties.  It has auxiliary
data structures for tracking the sorted order of the original
file positions, and methods to write output files with that order.

Using random-access to re-read the structures in the proper
order is typically faster than re-reading in batches.  However,
read_forward_quota attribute can be set to a positive integer to
force batch re-read/writing.

</pre>

<!-- ==================== INSTANCE METHODS ==================== -->
<a name="section-InstanceMethods"></a>
<table class="summary" border="1" cellpadding="3"
       cellspacing="0" width="100%" bgcolor="white">
<tr bgcolor="#70b0f0" class="table-header">
  <td colspan="2" class="table-header">
    <table border="0" cellpadding="0" cellspacing="0" width="100%">
      <tr valign="top">
        <td align="left"><span class="table-header">Instance Methods</span></td>
        <td align="right" valign="top"
         ><span class="options">[<a href="#section-InstanceMethods"
         class="privatelink" onclick="toggle_private();"
         >hide private</a>]</span></td>
      </tr>
    </table>
  </td>
</tr>
<tr>
    <td width="15%" align="right" valign="top" class="summary">
      <span class="summary-type">&nbsp;</span>
    </td><td class="summary">
      <table width="100%" cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td><span class="summary-sig"><a href="schrodinger.structutils.sort.StructureFileSorter-class.html#__init__" class="summary-sig-name">__init__</a>(<span class="summary-sig-arg">self</span>,
        <span class="summary-sig-arg">file_name</span>=<span class="summary-sig-default">None</span>,
        <span class="summary-sig-arg">file_index</span>=<span class="summary-sig-default">1</span>,
        <span class="summary-sig-arg">sort_criteria</span>=<span class="summary-sig-default"><code class="variable-group">[</code><code class="variable-group">(</code><code class="variable-quote">'</code><code class="variable-string">b_glide_receptor</code><code class="variable-quote">'</code><code class="variable-op">, </code>1<code class="variable-group">)</code><code class="variable-op">, </code><code class="variable-group">(</code><code class="variable-quote">'</code><code class="variable-string">r_i_docking_score</code><code class="variable-quote">'</code><code class="variable-op">, </code>1<code class="variable-group">)</code><code class="variable-group">]</code></span>,
        <span class="summary-sig-arg">intra_block_sort_criteria</span>=<span class="summary-sig-default"><code class="variable-group">[</code><code class="variable-group">(</code><code class="variable-quote">'</code><code class="variable-string">s_m_title</code><code class="variable-quote">'</code><code class="variable-op">, </code>1<code class="variable-group">)</code><code class="variable-op">, </code><code class="variable-group">(</code><code class="variable-quote">'</code><code class="variable-string">r_i_glide_emodel</code><code class="variable-quote">'</code><code class="variable-op">, </code>1<code class="variable-group">)</code><code class="variable-group">]</code></span>,
        <span class="summary-sig-arg">keep_structures</span>=<span class="summary-sig-default">False</span>)</span><br />
      Loads only the structure properties used to sort the file into
a dictionary (keyed by file index), but does not do any sorting.</td>
          <td align="right" valign="top">
            
            
          </td>
        </tr>
      </table>
      
    </td>
  </tr>
<tr>
    <td width="15%" align="right" valign="top" class="summary">
      <span class="summary-type">&nbsp;</span>
    </td><td class="summary">
      <table width="100%" cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td><span class="summary-sig"><a href="schrodinger.structutils.sort.StructureFileSorter-class.html#sort" class="summary-sig-name">sort</a>(<span class="summary-sig-arg">self</span>)</span><br />
      Organizes the data structure by self.sort_criteria, and 
      self.intra_block_sort_criteria if it is not None.</td>
          <td align="right" valign="top">
            
            
          </td>
        </tr>
      </table>
      
    </td>
  </tr>
<tr>
    <td width="15%" align="right" valign="top" class="summary">
      <span class="summary-type">&nbsp;</span>
    </td><td class="summary">
      <table width="100%" cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td><span class="summary-sig"><a href="schrodinger.structutils.sort.StructureFileSorter-class.html#write" class="summary-sig-name">write</a>(<span class="summary-sig-arg">self</span>,
        <span class="summary-sig-arg">out_file_name</span>,
        <span class="summary-sig-arg">index_list</span>=<span class="summary-sig-default">None</span>,
        <span class="summary-sig-arg">dir</span>=<span class="summary-sig-default">None</span>)</span><br />
      Writes structures to disk, no return value.</td>
          <td align="right" valign="top">
            
            
          </td>
        </tr>
      </table>
      
    </td>
  </tr>
<tr>
    <td width="15%" align="right" valign="top" class="summary">
      <span class="summary-type">&nbsp;</span>
    </td><td class="summary">
      <table width="100%" cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td><span class="summary-sig"><a href="schrodinger.structutils.sort.StructureFileSorter-class.html#writeTopNFromBlock" class="summary-sig-name">writeTopNFromBlock</a>(<span class="summary-sig-arg">self</span>,
        <span class="summary-sig-arg">out_file_name</span>=<span class="summary-sig-default"><code class="variable-quote">'</code><code class="variable-string"></code><code class="variable-quote">'</code></span>,
        <span class="summary-sig-arg">max_per_block</span>=<span class="summary-sig-default">1</span>,
        <span class="summary-sig-arg">max_num_block</span>=<span class="summary-sig-default">None</span>)</span><br />
      Write the first max_per_block structures from each block to the
output file.</td>
          <td align="right" valign="top">
            
            
          </td>
        </tr>
      </table>
      
    </td>
  </tr>
</table>
<!-- ==================== METHOD DETAILS ==================== -->
<a name="section-MethodDetails"></a>
<table class="details" border="1" cellpadding="3"
       cellspacing="0" width="100%" bgcolor="white">
<tr bgcolor="#70b0f0" class="table-header">
  <td colspan="2" class="table-header">
    <table border="0" cellpadding="0" cellspacing="0" width="100%">
      <tr valign="top">
        <td align="left"><span class="table-header">Method Details</span></td>
        <td align="right" valign="top"
         ><span class="options">[<a href="#section-MethodDetails"
         class="privatelink" onclick="toggle_private();"
         >hide private</a>]</span></td>
      </tr>
    </table>
  </td>
</tr>
</table>
<a name="__init__"></a>
<div>
<table class="details" border="1" cellpadding="3"
       cellspacing="0" width="100%" bgcolor="white">
<tr><td>
  <table width="100%" cellpadding="0" cellspacing="0" border="0">
  <tr valign="top"><td>
  <h3 class="epydoc"><span class="sig"><span class="sig-name">__init__</span>(<span class="sig-arg">self</span>,
        <span class="sig-arg">file_name</span>=<span class="sig-default">None</span>,
        <span class="sig-arg">file_index</span>=<span class="sig-default">1</span>,
        <span class="sig-arg">sort_criteria</span>=<span class="sig-default"><code class="variable-group">[</code><code class="variable-group">(</code><code class="variable-quote">'</code><code class="variable-string">b_glide_receptor</code><code class="variable-quote">'</code><code class="variable-op">, </code>1<code class="variable-group">)</code><code class="variable-op">, </code><code class="variable-group">(</code><code class="variable-quote">'</code><code class="variable-string">r_i_docking_score</code><code class="variable-quote">'</code><code class="variable-op">, </code>1<code class="variable-group">)</code><code class="variable-group">]</code></span>,
        <span class="sig-arg">intra_block_sort_criteria</span>=<span class="sig-default"><code class="variable-group">[</code><code class="variable-group">(</code><code class="variable-quote">'</code><code class="variable-string">s_m_title</code><code class="variable-quote">'</code><code class="variable-op">, </code>1<code class="variable-group">)</code><code class="variable-op">, </code><code class="variable-group">(</code><code class="variable-quote">'</code><code class="variable-string">r_i_glide_emodel</code><code class="variable-quote">'</code><code class="variable-op">, </code>1<code class="variable-group">)</code><code class="variable-group">]</code></span>,
        <span class="sig-arg">keep_structures</span>=<span class="sig-default">False</span>)</span>
    <br /><em class="fname">(Constructor)</em>
  </h3>
  </td><td align="right" valign="top"
    >&nbsp;
    </td>
  </tr></table>
  
  <pre class="literalblock">

Loads only the structure properties used to sort the file into
a dictionary (keyed by file index), but does not do any sorting.

file_name (string)
    Path to the structure file upon with to operate.  Default is
    None.

file_index (integer)
    File position at which to start reading file_name.
    Default is 1.

sort_criteria (list of tuples)
    List of m2io datanames and module constant tuples that
    identify the values for sorting and the sort order.
    Default is GLIDE_SP_KEY_1.

intra_block_sort_criteria (list of tuples)
    List of m2io datanames and module constant tuples that
    identify the values for group sorting, and the sort order.
    Default is GLIDE_SP_KEY_2.  If 'intra_block_sort_criteria' is None,
    then a simple multi-key sort is performed using the 'sort_criteria'.

keep_structures (bool)
    If true then a reference to each structure is kept, keyed by
    '_structure'.  The default is False, don't keep references
    to the structures.

</pre>
  <dl class="fields">
  </dl>
</td></tr></table>
</div>
<a name="sort"></a>
<div>
<table class="details" border="1" cellpadding="3"
       cellspacing="0" width="100%" bgcolor="white">
<tr><td>
  <table width="100%" cellpadding="0" cellspacing="0" border="0">
  <tr valign="top"><td>
  <h3 class="epydoc"><span class="sig"><span class="sig-name">sort</span>(<span class="sig-arg">self</span>)</span>
  </h3>
  </td><td align="right" valign="top"
    >&nbsp;
    </td>
  </tr></table>
  
  <p>Organizes the data structure by self.sort_criteria, and 
  self.intra_block_sort_criteria if it is not None.  Assigns attributes for
  the correct sorted order of the original file positions.</p>
  <dl class="fields">
  </dl>
</td></tr></table>
</div>
<a name="write"></a>
<div>
<table class="details" border="1" cellpadding="3"
       cellspacing="0" width="100%" bgcolor="white">
<tr><td>
  <table width="100%" cellpadding="0" cellspacing="0" border="0">
  <tr valign="top"><td>
  <h3 class="epydoc"><span class="sig"><span class="sig-name">write</span>(<span class="sig-arg">self</span>,
        <span class="sig-arg">out_file_name</span>,
        <span class="sig-arg">index_list</span>=<span class="sig-default">None</span>,
        <span class="sig-arg">dir</span>=<span class="sig-default">None</span>)</span>
  </h3>
  </td><td align="right" valign="top"
    >&nbsp;
    </td>
  </tr></table>
  
  <pre class="literalblock">

Writes structures to disk, no return value.

out_file_name (str)
    Path to the output structure file.

index_list (list)
    List of file indexes to write, in the order that they
    should appear in the output file (typically a slice
    of self.structure_index_order).  If None, then all of
    self.structure_index_order is written.

dir (string)
    Path to the directory where the intermediate file is written.
    The default is the runtime current working directory.
    There needs to be enough space to store effectively a copy
    of file_name.  For really large files, /tmp is not a good
    location for most hosts.

</pre>
  <dl class="fields">
  </dl>
</td></tr></table>
</div>
<a name="writeTopNFromBlock"></a>
<div>
<table class="details" border="1" cellpadding="3"
       cellspacing="0" width="100%" bgcolor="white">
<tr><td>
  <table width="100%" cellpadding="0" cellspacing="0" border="0">
  <tr valign="top"><td>
  <h3 class="epydoc"><span class="sig"><span class="sig-name">writeTopNFromBlock</span>(<span class="sig-arg">self</span>,
        <span class="sig-arg">out_file_name</span>=<span class="sig-default"><code class="variable-quote">'</code><code class="variable-string"></code><code class="variable-quote">'</code></span>,
        <span class="sig-arg">max_per_block</span>=<span class="sig-default">1</span>,
        <span class="sig-arg">max_num_block</span>=<span class="sig-default">None</span>)</span>
  </h3>
  </td><td align="right" valign="top"
    >&nbsp;
    </td>
  </tr></table>
  
  <pre class="literalblock">

Write the first max_per_block structures from each block to the
output file.

out_file_name (string)
    Name of structure file to write.

max_per_block (int)
    Number of leading members, from each block, to write to
    out_file_name.  Default is 1.

max_num_block (int)
    Number of blocks from which to draw leading members.  If the
    value is None then N max_per_block structure are pulled from
    each block.  Otherwise, the top N max_per_block strucutures
    from just the top M max_num_blocks blocks are written.

</pre>
  <dl class="fields">
  </dl>
</td></tr></table>
</div>
<br />
<!-- ==================== NAVIGATION BAR ==================== -->
<table class="navbar" border="0" width="100%" cellpadding="0"
       bgcolor="#a0c0ff" cellspacing="0">
  <tr valign="middle">

  <!-- Tree link -->
      <th>&nbsp;&nbsp;&nbsp;<a
        href="module-tree.html">Trees</a>&nbsp;&nbsp;&nbsp;</th>

  <!-- Index link -->
      <th>&nbsp;&nbsp;&nbsp;<a
        href="identifier-index.html">Indices</a>&nbsp;&nbsp;&nbsp;</th>

  <!-- Help link -->
      <th>&nbsp;&nbsp;&nbsp;<a
        href="help.html">Help</a>&nbsp;&nbsp;&nbsp;</th>

  <!-- Project homepage -->
      <th class="navbar" align="right" width="100%">
        <table border="0" cellpadding="0" cellspacing="0">
          <tr><th class="navbar" align="center"
            >2015-2Schrodinger Python API</th>
          </tr></table></th>
  </tr>
</table>
<table border="0" cellpadding="0" cellspacing="0" width="100%%">
  <tr>
    <td align="left" class="footer">
    Generated by Epydoc 3.0.1 on Sat May  9 06:31:26 2015
    </td>
    <td align="right" class="footer">
      <a target="mainFrame" href="http://epydoc.sourceforge.net"
        >http://epydoc.sourceforge.net</a>
    </td>
  </tr>
</table>

<script type="text/javascript">
  <!--
  // Private objects are initially displayed (because if
  // javascript is turned off then we want them to be
  // visible); but by default, we want to hide them.  So hide
  // them unless we have a cookie that says to show them.
  checkCookie();
  // -->
</script>
</body>
</html>
