<?xml version="1.0" encoding="ascii"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
          "DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head>
  <title>schrodinger.structutils.ringspear.SpearRing</title>
  <link rel="stylesheet" href="epydoc.css" type="text/css" />
  <script type="text/javascript" src="epydoc.js"></script>
</head>

<body bgcolor="white" text="black" link="blue" vlink="#204080"
      alink="#204080">
<!-- ==================== NAVIGATION BAR ==================== -->
<table class="navbar" border="0" width="100%" cellpadding="0"
       bgcolor="#a0c0ff" cellspacing="0">
  <tr valign="middle">

  <!-- Tree link -->
      <th>&nbsp;&nbsp;&nbsp;<a
        href="module-tree.html">Trees</a>&nbsp;&nbsp;&nbsp;</th>

  <!-- Index link -->
      <th>&nbsp;&nbsp;&nbsp;<a
        href="identifier-index.html">Indices</a>&nbsp;&nbsp;&nbsp;</th>

  <!-- Help link -->
      <th>&nbsp;&nbsp;&nbsp;<a
        href="help.html">Help</a>&nbsp;&nbsp;&nbsp;</th>

  <!-- Project homepage -->
      <th class="navbar" align="right" width="100%">
        <table border="0" cellpadding="0" cellspacing="0">
          <tr><th class="navbar" align="center"
            >2015-2Schrodinger Python API</th>
          </tr></table></th>
  </tr>
</table>
<table width="100%" cellpadding="0" cellspacing="0">
  <tr valign="top">
    <td width="100%">
      <span class="breadcrumbs">
        <a href="schrodinger-module.html">Package&nbsp;schrodinger</a> ::
        <a href="schrodinger.structutils-module.html">Package&nbsp;structutils</a> ::
        <a href="schrodinger.structutils.ringspear-module.html" onclick="show_private();">Module&nbsp;ringspear</a> ::
        Class&nbsp;SpearRing
      </span>
    </td>
    <td>
      <table cellpadding="0" cellspacing="0">
        <!-- hide/show private -->
        <tr><td align="right"><span class="options">[<a href="javascript:void(0);" class="privatelink"
    onclick="toggle_private();">hide&nbsp;private</a>]</span></td></tr>
        <tr><td align="right"><span class="options"
            >[<a href="frames.html" target="_top">frames</a
            >]&nbsp;|&nbsp;<a href="schrodinger.structutils.ringspear.SpearRing-class.html"
            target="_top">no&nbsp;frames</a>]</span></td></tr>
      </table>
    </td>
  </tr>
</table>
<!-- ==================== CLASS DESCRIPTION ==================== -->
<h1 class="epydoc">Class SpearRing</h1><p class="nomargin-top"></p>
<pre class="base-tree">
<a href="object-class.html">object</a> --+
         |
        <strong class="uidshort">SpearRing</strong>
</pre>

<hr />
<p>Computes and holds information about a ring, and finds bonds that 
  spear that ring.</p>
  <p>Note: Objects of this class do not maintain pointers to either the 
  Structure object or the _Ring object that were used to create them.</p>

<!-- ==================== INSTANCE METHODS ==================== -->
<a name="section-InstanceMethods"></a>
<table class="summary" border="1" cellpadding="3"
       cellspacing="0" width="100%" bgcolor="white">
<tr bgcolor="#70b0f0" class="table-header">
  <td colspan="2" class="table-header">
    <table border="0" cellpadding="0" cellspacing="0" width="100%">
      <tr valign="top">
        <td align="left"><span class="table-header">Instance Methods</span></td>
        <td align="right" valign="top"
         ><span class="options">[<a href="#section-InstanceMethods"
         class="privatelink" onclick="toggle_private();"
         >hide private</a>]</span></td>
      </tr>
    </table>
  </td>
</tr>
<tr>
    <td width="15%" align="right" valign="top" class="summary">
      <span class="summary-type">&nbsp;</span>
    </td><td class="summary">
      <table width="100%" cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td><span class="summary-sig"><a href="schrodinger.structutils.ringspear.SpearRing-class.html#__init__" class="summary-sig-name">__init__</a>(<span class="summary-sig-arg">self</span>,
        <span class="summary-sig-arg">struct</span>,
        <span class="summary-sig-arg">ring</span>)</span><br />
      Create a SpearRing object</td>
          <td align="right" valign="top">
            
            
          </td>
        </tr>
      </table>
      
    </td>
  </tr>
<tr>
    <td width="15%" align="right" valign="top" class="summary">
      <span class="summary-type">numpy.array, numpy.array, float</span>
    </td><td class="summary">
      <table width="100%" cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td><span class="summary-sig"><a href="schrodinger.structutils.ringspear.SpearRing-class.html#getNormalsAndRadius" class="summary-sig-name">getNormalsAndRadius</a>(<span class="summary-sig-arg">self</span>,
        <span class="summary-sig-arg">struct</span>)</span><br />
      Find the average normal vector to the ring plane and compute the 
      radius of the ring.</td>
          <td align="right" valign="top">
            
            
          </td>
        </tr>
      </table>
      
    </td>
  </tr>
<tr>
    <td width="15%" align="right" valign="top" class="summary">
      <span class="summary-type">numpy.array</span>
    </td><td class="summary">
      <table width="100%" cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td><span class="summary-sig"><a href="schrodinger.structutils.ringspear.SpearRing-class.html#getRotationMatrix" class="summary-sig-name">getRotationMatrix</a>(<span class="summary-sig-arg">self</span>)</span><br />
      Get a rotation matrix that rotates the ring to be aligned with the 
      positive Z-axis when the ring centroid is at the origin.</td>
          <td align="right" valign="top">
            
            
          </td>
        </tr>
      </table>
      
    </td>
  </tr>
<tr>
    <td width="15%" align="right" valign="top" class="summary">
      <span class="summary-type">list</span>
    </td><td class="summary">
      <table width="100%" cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td><span class="summary-sig"><a href="schrodinger.structutils.ringspear.SpearRing-class.html#findSpears" class="summary-sig-name">findSpears</a>(<span class="summary-sig-arg">self</span>,
        <span class="summary-sig-arg">orig_struct</span>,
        <span class="summary-sig-arg">atoms</span>=<span class="summary-sig-default">None</span>,
        <span class="summary-sig-arg">is_ring_struct</span>=<span class="summary-sig-default">True</span>,
        <span class="summary-sig-arg">distorted</span>=<span class="summary-sig-default">False</span>,
        <span class="summary-sig-arg">first_only</span>=<span class="summary-sig-default">True</span>,
        <span class="summary-sig-arg">cell</span>=<span class="summary-sig-default">None</span>,
        <span class="summary-sig-arg">dist</span>=<span class="summary-sig-default">4.0</span>,
        <span class="summary-sig-arg">pbcsize</span>=<span class="summary-sig-default">None</span>)</span><br />
      Check for ring spears - bonds that pass through the face of the ring.</td>
          <td align="right" valign="top">
            
            
          </td>
        </tr>
      </table>
      
    </td>
  </tr>
<tr class="private">
    <td width="15%" align="right" valign="top" class="summary">
      <span class="summary-type"><a href="schrodinger.structure.Structure-class.html" 
      class="link">schrodinger.structure.Structure</a> or None</span>
    </td><td class="summary">
      <table width="100%" cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td><span class="summary-sig"><a href="schrodinger.structutils.ringspear.SpearRing-class.html#_roughCutAtoms" class="summary-sig-name" onclick="show_private();">_roughCutAtoms</a>(<span class="summary-sig-arg">self</span>,
        <span class="summary-sig-arg">struct</span>,
        <span class="summary-sig-arg">cell</span>=<span class="summary-sig-default">None</span>,
        <span class="summary-sig-arg">dist</span>=<span class="summary-sig-default">4.0</span>,
        <span class="summary-sig-arg">ignore</span>=<span class="summary-sig-default">None</span>)</span><br />
      A quick method for eliminating atoms that are so far from this ring 
      that they cannot possible spear it.</td>
          <td align="right" valign="top">
            
            
          </td>
        </tr>
      </table>
      
    </td>
  </tr>
<tr class="private">
    <td width="15%" align="right" valign="top" class="summary">
      <span class="summary-type"><a href="schrodinger.structure.Structure-class.html" 
      class="link">schrodinger.structure.Structure</a> or None</span>
    </td><td class="summary">
      <table width="100%" cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td><span class="summary-sig"><a href="schrodinger.structutils.ringspear.SpearRing-class.html#_roughCutAtomsPBC" class="summary-sig-name" onclick="show_private();">_roughCutAtomsPBC</a>(<span class="summary-sig-arg">self</span>,
        <span class="summary-sig-arg">struct</span>,
        <span class="summary-sig-arg">cell</span>=<span class="summary-sig-default">None</span>,
        <span class="summary-sig-arg">dist</span>=<span class="summary-sig-default">4.0</span>,
        <span class="summary-sig-arg">ignore</span>=<span class="summary-sig-default">None</span>,
        <span class="summary-sig-arg">pbcsize</span>=<span class="summary-sig-default">None</span>)</span><br />
      A quick method for eliminating atoms that are so far from this ring 
      that they cannot possible spear it.</td>
          <td align="right" valign="top">
            
            
          </td>
        </tr>
      </table>
      
    </td>
  </tr>
<tr>
    <td width="15%" align="right" valign="top" class="summary">
      <span class="summary-type">None</span>
    </td><td class="summary">
      <table width="100%" cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td><span class="summary-sig"><a href="schrodinger.structutils.ringspear.SpearRing-class.html#centerAndRotate" class="summary-sig-name">centerAndRotate</a>(<span class="summary-sig-arg">self</span>,
        <span class="summary-sig-arg">struct</span>)</span><br />
      Apply the same translation and rotation to the structure as would be 
      required to place the ring centroid at the origin with the ring in 
      the XY plane.</td>
          <td align="right" valign="top">
            
            
          </td>
        </tr>
      </table>
      
    </td>
  </tr>
<tr>
    <td width="15%" align="right" valign="top" class="summary">
      <span class="summary-type">None</span>
    </td><td class="summary">
      <table width="100%" cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td><span class="summary-sig"><a href="schrodinger.structutils.ringspear.SpearRing-class.html#quickWeedAtoms" class="summary-sig-name">quickWeedAtoms</a>(<span class="summary-sig-arg">self</span>,
        <span class="summary-sig-arg">struct</span>)</span><br />
      Quickly weed out any atoms that are too far away from the ring 
      centroid to spear the ring.</td>
          <td align="right" valign="top">
            
            
          </td>
        </tr>
      </table>
      
    </td>
  </tr>
<tr class="private">
    <td width="15%" align="right" valign="top" class="summary">
      <span class="summary-type">list</span>
    </td><td class="summary">
      <table width="100%" cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td><span class="summary-sig"><a href="schrodinger.structutils.ringspear.SpearRing-class.html#_findSpearingPairs" class="summary-sig-name" onclick="show_private();">_findSpearingPairs</a>(<span class="summary-sig-arg">self</span>,
        <span class="summary-sig-arg">struct</span>,
        <span class="summary-sig-arg">first_only</span>)</span><br />
      Find atoms that spear this ring.</td>
          <td align="right" valign="top">
            
            
          </td>
        </tr>
      </table>
      
    </td>
  </tr>
<tr>
    <td width="15%" align="right" valign="top" class="summary">
      <span class="summary-type">(float, float) or None</span>
    </td><td class="summary">
      <table width="100%" cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td><span class="summary-sig"><a href="schrodinger.structutils.ringspear.SpearRing-class.html#getBondXYIntersection" class="summary-sig-name">getBondXYIntersection</a>(<span class="summary-sig-arg">self</span>,
        <span class="summary-sig-arg">atom1</span>,
        <span class="summary-sig-arg">atom2</span>)</span><br />
      Find where the bond from atom1 to atom2 intersects the XY (z=0) 
      plane.</td>
          <td align="right" valign="top">
            
            
          </td>
        </tr>
      </table>
      
    </td>
  </tr>
  <tr>
    <td colspan="2" class="summary">
    <p class="indent-wrapped-lines"><b>Inherited from <code><a href="object-class.html">object</a></code></b>:
      <code><a href="object-class.html#__delattr__">__delattr__</a></code>,
      <code><a href="object-class.html#__format__">__format__</a></code>,
      <code><a href="object-class.html#__getattribute__">__getattribute__</a></code>,
      <code><a href="object-class.html#__hash__">__hash__</a></code>,
      <code><a href="object-class.html#__new__">__new__</a></code>,
      <code><a href="object-class.html#__reduce__">__reduce__</a></code>,
      <code><a href="object-class.html#__reduce_ex__">__reduce_ex__</a></code>,
      <code><a href="object-class.html#__repr__">__repr__</a></code>,
      <code><a href="object-class.html#__setattr__">__setattr__</a></code>,
      <code><a href="object-class.html#__sizeof__">__sizeof__</a></code>,
      <code><a href="object-class.html#__str__">__str__</a></code>,
      <code><a href="object-class.html#__subclasshook__">__subclasshook__</a></code>
      </p>
    </td>
  </tr>
</table>
<!-- ==================== STATIC METHODS ==================== -->
<a name="section-StaticMethods"></a>
<table class="summary" border="1" cellpadding="3"
       cellspacing="0" width="100%" bgcolor="white">
<tr bgcolor="#70b0f0" class="table-header">
  <td colspan="2" class="table-header">
    <table border="0" cellpadding="0" cellspacing="0" width="100%">
      <tr valign="top">
        <td align="left"><span class="table-header">Static Methods</span></td>
        <td align="right" valign="top"
         ><span class="options">[<a href="#section-StaticMethods"
         class="privatelink" onclick="toggle_private();"
         >hide private</a>]</span></td>
      </tr>
    </table>
  </td>
</tr>
<tr>
    <td width="15%" align="right" valign="top" class="summary">
      <span class="summary-type">&nbsp;</span>
    </td><td class="summary">
      <table width="100%" cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td><span class="summary-sig"><a href="schrodinger.structutils.ringspear.SpearRing-class.html#markAtomsBeforeSpearCheck" class="summary-sig-name">markAtomsBeforeSpearCheck</a>(<span class="summary-sig-arg">struct</span>)</span><br />
      Add an atom property to all atoms with the atom's current index.</td>
          <td align="right" valign="top">
            
            
          </td>
        </tr>
      </table>
      
    </td>
  </tr>
</table>
<!-- ==================== CLASS VARIABLES ==================== -->
<a name="section-ClassVariables"></a>
<table class="summary" border="1" cellpadding="3"
       cellspacing="0" width="100%" bgcolor="white">
<tr bgcolor="#70b0f0" class="table-header">
  <td colspan="2" class="table-header">
    <table border="0" cellpadding="0" cellspacing="0" width="100%">
      <tr valign="top">
        <td align="left"><span class="table-header">Class Variables</span></td>
        <td align="right" valign="top"
         ><span class="options">[<a href="#section-ClassVariables"
         class="privatelink" onclick="toggle_private();"
         >hide private</a>]</span></td>
      </tr>
    </table>
  </td>
</tr>
<tr>
    <td width="15%" align="right" valign="top" class="summary">
      <span class="summary-type">&nbsp;</span>
    </td><td class="summary">
        <a name="ORIG_ATOM_INDEX"></a><span class="summary-name">ORIG_ATOM_INDEX</span> = <code title="'i_matsci_orig_atom_index'"><code class="variable-quote">'</code><code class="variable-string">i_matsci_orig_atom_index</code><code class="variable-quote">'</code></code>
    </td>
  </tr>
</table>
<!-- ==================== INSTANCE VARIABLES ==================== -->
<a name="section-InstanceVariables"></a>
<table class="summary" border="1" cellpadding="3"
       cellspacing="0" width="100%" bgcolor="white">
<tr bgcolor="#70b0f0" class="table-header">
  <td colspan="2" class="table-header">
    <table border="0" cellpadding="0" cellspacing="0" width="100%">
      <tr valign="top">
        <td align="left"><span class="table-header">Instance Variables</span></td>
        <td align="right" valign="top"
         ><span class="options">[<a href="#section-InstanceVariables"
         class="privatelink" onclick="toggle_private();"
         >hide private</a>]</span></td>
      </tr>
    </table>
  </td>
</tr>
<tr>
    <td width="15%" align="right" valign="top" class="summary">
      <span class="summary-type">&nbsp;</span>
    </td><td class="summary">
        <a name="ring_indexes"></a><span class="summary-name">ring_indexes</span><br />
      The atom indexes of the ring atoms
    </td>
  </tr>
<tr>
    <td width="15%" align="right" valign="top" class="summary">
      <span class="summary-type">&nbsp;</span>
    </td><td class="summary">
        <a name="centroid"></a><span class="summary-name">centroid</span><br />
      The ring centroid
    </td>
  </tr>
<tr>
    <td width="15%" align="right" valign="top" class="summary">
      <span class="summary-type">&nbsp;</span>
    </td><td class="summary">
        <a name="origin_normal"></a><span class="summary-name">origin_normal</span><br />
      The normal translated to the origin
    </td>
  </tr>
<tr>
    <td width="15%" align="right" valign="top" class="summary">
      <span class="summary-type">&nbsp;</span>
    </td><td class="summary">
        <a name="normal"></a><span class="summary-name">normal</span><br />
      The normal based at the ring centroid
    </td>
  </tr>
<tr>
    <td width="15%" align="right" valign="top" class="summary">
      <span class="summary-type">&nbsp;</span>
    </td><td class="summary">
        <a name="radius"></a><span class="summary-name">radius</span><br />
      The largest centroid-ring atom distance
    </td>
  </tr>
<tr>
    <td width="15%" align="right" valign="top" class="summary">
      <span class="summary-type">&nbsp;</span>
    </td><td class="summary">
        <a name="rotation_matrix"></a><span class="summary-name">rotation_matrix</span><br />
      The rotation matrix that rotates the ring into the XY plane when the 
      centroid is at the origin
    </td>
  </tr>
</table>
<!-- ==================== PROPERTIES ==================== -->
<a name="section-Properties"></a>
<table class="summary" border="1" cellpadding="3"
       cellspacing="0" width="100%" bgcolor="white">
<tr bgcolor="#70b0f0" class="table-header">
  <td colspan="2" class="table-header">
    <table border="0" cellpadding="0" cellspacing="0" width="100%">
      <tr valign="top">
        <td align="left"><span class="table-header">Properties</span></td>
        <td align="right" valign="top"
         ><span class="options">[<a href="#section-Properties"
         class="privatelink" onclick="toggle_private();"
         >hide private</a>]</span></td>
      </tr>
    </table>
  </td>
</tr>
  <tr>
    <td colspan="2" class="summary">
    <p class="indent-wrapped-lines"><b>Inherited from <code><a href="object-class.html">object</a></code></b>:
      <code><a href="object-class.html#__class__">__class__</a></code>
      </p>
    </td>
  </tr>
</table>
<!-- ==================== METHOD DETAILS ==================== -->
<a name="section-MethodDetails"></a>
<table class="details" border="1" cellpadding="3"
       cellspacing="0" width="100%" bgcolor="white">
<tr bgcolor="#70b0f0" class="table-header">
  <td colspan="2" class="table-header">
    <table border="0" cellpadding="0" cellspacing="0" width="100%">
      <tr valign="top">
        <td align="left"><span class="table-header">Method Details</span></td>
        <td align="right" valign="top"
         ><span class="options">[<a href="#section-MethodDetails"
         class="privatelink" onclick="toggle_private();"
         >hide private</a>]</span></td>
      </tr>
    </table>
  </td>
</tr>
</table>
<a name="__init__"></a>
<div>
<table class="details" border="1" cellpadding="3"
       cellspacing="0" width="100%" bgcolor="white">
<tr><td>
  <table width="100%" cellpadding="0" cellspacing="0" border="0">
  <tr valign="top"><td>
  <h3 class="epydoc"><span class="sig"><span class="sig-name">__init__</span>(<span class="sig-arg">self</span>,
        <span class="sig-arg">struct</span>,
        <span class="sig-arg">ring</span>)</span>
    <br /><em class="fname">(Constructor)</em>
  </h3>
  </td><td align="right" valign="top"
    >&nbsp;
    </td>
  </tr></table>
  
  <p>Create a SpearRing object</p>
  <dl class="fields">
    <dt>Parameters:</dt>
    <dd><ul class="nomargin-top">
        <li><strong class="pname"><code>struct</code></strong> (<a href="schrodinger.structure.Structure-class.html" 
          class="link">schrodinger.structure.Structure</a>) - The structure that contains this ring</li>
        <li><strong class="pname"><code>ring</code></strong> (<a href="schrodinger.structure._Ring-class.html" class="link" 
          onclick="show_private();">schrodinger.structure._Ring</a>) - The _Ring object that represents this ring</li>
    </ul></dd>
    <dt>Overrides:
        object.__init__
    </dt>
  </dl>
</td></tr></table>
</div>
<a name="getNormalsAndRadius"></a>
<div>
<table class="details" border="1" cellpadding="3"
       cellspacing="0" width="100%" bgcolor="white">
<tr><td>
  <table width="100%" cellpadding="0" cellspacing="0" border="0">
  <tr valign="top"><td>
  <h3 class="epydoc"><span class="sig"><span class="sig-name">getNormalsAndRadius</span>(<span class="sig-arg">self</span>,
        <span class="sig-arg">struct</span>)</span>
  </h3>
  </td><td align="right" valign="top"
    >&nbsp;
    </td>
  </tr></table>
  
  <p>Find the average normal vector to the ring plane and compute the 
  radius of the ring.</p>
  <p>The average normal vector is the average of the normal vectors 
  computed for each pair of adjacent ring atoms and the ring centroid.</p>
  <p>The radius is defined as the largest centroid-ring atom distance</p>
  <dl class="fields">
    <dt>Parameters:</dt>
    <dd><ul class="nomargin-top">
        <li><strong class="pname"><code>struct</code></strong> (<a href="schrodinger.structure.Structure-class.html" 
          class="link">schrodinger.structure.Structure</a>) - The structure that contains this ring</li>
    </ul></dd>
    <dt>Returns: numpy.array, numpy.array, float</dt>
        <dd>The average normal vector to the plane of the ring translated so 
          its base is at the origin, the average normal vector to the plane
          of the ring translated so its base is at the ring centroid, the 
          radius of the ring.</dd>
  </dl>
</td></tr></table>
</div>
<a name="getRotationMatrix"></a>
<div>
<table class="details" border="1" cellpadding="3"
       cellspacing="0" width="100%" bgcolor="white">
<tr><td>
  <table width="100%" cellpadding="0" cellspacing="0" border="0">
  <tr valign="top"><td>
  <h3 class="epydoc"><span class="sig"><span class="sig-name">getRotationMatrix</span>(<span class="sig-arg">self</span>)</span>
  </h3>
  </td><td align="right" valign="top"
    >&nbsp;
    </td>
  </tr></table>
  
  <p>Get a rotation matrix that rotates the ring to be aligned with the 
  positive Z-axis when the ring centroid is at the origin.</p>
  <dl class="fields">
    <dt>Returns: numpy.array</dt>
        <dd>A 4x4 numpy array containing the rotation matrix that aligns the 
          ring normal vector to the positive Z-axis</dd>
  </dl>
</td></tr></table>
</div>
<a name="findSpears"></a>
<div>
<table class="details" border="1" cellpadding="3"
       cellspacing="0" width="100%" bgcolor="white">
<tr><td>
  <table width="100%" cellpadding="0" cellspacing="0" border="0">
  <tr valign="top"><td>
  <h3 class="epydoc"><span class="sig"><span class="sig-name">findSpears</span>(<span class="sig-arg">self</span>,
        <span class="sig-arg">orig_struct</span>,
        <span class="sig-arg">atoms</span>=<span class="sig-default">None</span>,
        <span class="sig-arg">is_ring_struct</span>=<span class="sig-default">True</span>,
        <span class="sig-arg">distorted</span>=<span class="sig-default">False</span>,
        <span class="sig-arg">first_only</span>=<span class="sig-default">True</span>,
        <span class="sig-arg">cell</span>=<span class="sig-default">None</span>,
        <span class="sig-arg">dist</span>=<span class="sig-default">4.0</span>,
        <span class="sig-arg">pbcsize</span>=<span class="sig-default">None</span>)</span>
  </h3>
  </td><td align="right" valign="top"
    >&nbsp;
    </td>
  </tr></table>
  
  <p>Check for ring spears - bonds that pass through the face of the ring. 
  It does not matter if the spearing bond is a single or multiple bond, or 
  if it is part of another ring.</p>
  <dl class="fields">
    <dt>Parameters:</dt>
    <dd><ul class="nomargin-top">
        <li><strong class="pname"><code>orig_struct</code></strong> (<a href="schrodinger.structure.Structure-class.html" 
          class="link">schrodinger.structure.Structure</a>) - The structure to check if any bonds spear this ring in 
          ring_struct.</li>
        <li><strong class="pname"><code>atoms</code></strong> (list) - List of atom indexes to check to see if they spear this ring.</li>
        <li><strong class="pname"><code>is_ring_struct</code></strong> (bool) - Whether orig_struct contains this ring. If True, the atoms with 
          the same index as the indexes of this ring will not be considered
          for spearing calculations.</li>
        <li><strong class="pname"><code>distorted</code></strong> (bool) - If False (default), the structure will be assumed to have 
          reasonable bond lengths, and optimizations will be used to 
          dramatically speed up spear-finding in large structures by 
          eliminating atoms that cannot possibly spear this ring. If True, 
          atom distances will not be used to optimize spear-finding - 
          significantly increasing the time required.</li>
        <li><strong class="pname"><code>first_only</code></strong> (bool) - Whether to return after finding the first ring spear, or whether 
          all ring spears should be found.</li>
        <li><strong class="pname"><code>cell</code></strong> (int or <a 
          href="schrodinger.infra.structure.DistanceCell-class.html" 
          class="link">schrodinger.infra.structure.DistanceCell</a>) - If pbcsize is None, the handle to a mmct distance cell that has 
          been created. If pbcsize is not None, then cell should be a <a 
          href="schrodinger.infra.structure.DistanceCell-class.html" 
          class="link">schrodinger.infra.structure.DistanceCell</a> object 
          created using pbcsize. cell is used for rough-cutting atoms too 
          far away from the ring. If not provided, a cell will be created 
          based on the value (or lack of value) of pbcsize. Pre-creating 
          the cell for a structure and passing it to this method for all 
          rings saves significant time. See also the pbc parameter.</li>
        <li><strong class="pname"><code>dist</code></strong> (float) - The distance from the ring centroid at which atoms will be rough 
          cut and eliminated from spearing consideration. This is only used
          if cell is not provided.</li>
        <li><strong class="pname"><code>pbcsize</code></strong> (list) - The periodic boundary condition for a cubic PBC. The list must be
          six float values that designate the minimum and maximum values of
          x, y and z for the periodic box. The values are in the order: 
          xmin, ymin, zmin, xmax, ymax, zmax. See also the cell parameter.</li>
    </ul></dd>
    <dt>Returns: list</dt>
        <dd>A list of found ring-spears, each item is a <a 
          href="schrodinger.structutils.ringspear.Spear-class.html" 
          class="link">Spear</a> object. An empty list is returned if no 
          spears are found, and if first_only is True the list will be at 
          most 1 item long.</dd>
  </dl>
</td></tr></table>
</div>
<a name="_roughCutAtoms"></a>
<div class="private">
<table class="details" border="1" cellpadding="3"
       cellspacing="0" width="100%" bgcolor="white">
<tr><td>
  <table width="100%" cellpadding="0" cellspacing="0" border="0">
  <tr valign="top"><td>
  <h3 class="epydoc"><span class="sig"><span class="sig-name">_roughCutAtoms</span>(<span class="sig-arg">self</span>,
        <span class="sig-arg">struct</span>,
        <span class="sig-arg">cell</span>=<span class="sig-default">None</span>,
        <span class="sig-arg">dist</span>=<span class="sig-default">4.0</span>,
        <span class="sig-arg">ignore</span>=<span class="sig-default">None</span>)</span>
  </h3>
  </td><td align="right" valign="top"
    >&nbsp;
    </td>
  </tr></table>
  
  <p>A quick method for eliminating atoms that are so far from this ring 
  that they cannot possible spear it.</p>
  <dl class="fields">
    <dt>Parameters:</dt>
    <dd><ul class="nomargin-top">
        <li><strong class="pname"><code>struct</code></strong> (<a href="schrodinger.structure.Structure-class.html" 
          class="link">schrodinger.structure.Structure</a>) - The structure to copy and cut atoms from</li>
        <li><strong class="pname"><code>cell</code></strong> (int) - The handle to a mmct distance cell that has been created for use 
          in rough-cutting atoms too far away from the ring. If not 
          provided, a cell will be created. Pre-creating the cell for a 
          structure and using it for all rings saves significant time.</li>
        <li><strong class="pname"><code>dist</code></strong> (float) - The distance from the ring centroid at which atoms will be rough 
          cut and eliminated from spearing consideration. This is only used
          if cell is not provided.</li>
        <li><strong class="pname"><code>ignore</code></strong> (set) - A set of atom indexes to ignore even if they fall within the 
          rough cut distance</li>
    </ul></dd>
    <dt>Returns: <a href="schrodinger.structure.Structure-class.html" 
      class="link">schrodinger.structure.Structure</a> or None</dt>
        <dd>A copy of the input structure with all atoms eliminated that are 
          beyond the rough cut distance or are in the ignore list.</dd>
  </dl>
</td></tr></table>
</div>
<a name="_roughCutAtomsPBC"></a>
<div class="private">
<table class="details" border="1" cellpadding="3"
       cellspacing="0" width="100%" bgcolor="white">
<tr><td>
  <table width="100%" cellpadding="0" cellspacing="0" border="0">
  <tr valign="top"><td>
  <h3 class="epydoc"><span class="sig"><span class="sig-name">_roughCutAtomsPBC</span>(<span class="sig-arg">self</span>,
        <span class="sig-arg">struct</span>,
        <span class="sig-arg">cell</span>=<span class="sig-default">None</span>,
        <span class="sig-arg">dist</span>=<span class="sig-default">4.0</span>,
        <span class="sig-arg">ignore</span>=<span class="sig-default">None</span>,
        <span class="sig-arg">pbcsize</span>=<span class="sig-default">None</span>)</span>
  </h3>
  </td><td align="right" valign="top"
    >&nbsp;
    </td>
  </tr></table>
  
  <p>A quick method for eliminating atoms that are so far from this ring 
  that they cannot possible spear it.</p>
  <dl class="fields">
    <dt>Parameters:</dt>
    <dd><ul class="nomargin-top">
        <li><strong class="pname"><code>struct</code></strong> (<a href="schrodinger.structure.Structure-class.html" 
          class="link">schrodinger.structure.Structure</a>) - The structure to copy and cut atoms from</li>
        <li><strong class="pname"><code>cell</code></strong> (<a href="schrodinger.infra.structure.DistanceCell-class.html" 
          class="link">schrodinger.infra.structure.DistanceCell</a>) - A distance cell that has been created using pbcsize. If not 
          provided, a cell will be created. Pre-creating the cell for a 
          structure and using it for all rings saves significant time.</li>
        <li><strong class="pname"><code>dist</code></strong> (float) - The distance from the ring centroid at which atoms will be rough 
          cut and eliminated from spearing consideration. This is only used
          if cell is not provided.</li>
        <li><strong class="pname"><code>ignore</code></strong> (set) - A set of atom indexes to ignore even if they fall within the 
          rough cut distance</li>
        <li><strong class="pname"><code>pbcsize</code></strong> (list) - The periodic boundary condition for a cubic PBC. The list must be
          six float values that designate the minimum and maximum values of
          x, y and z for the periodic box. The values are in the order: 
          xmin, ymin, zmin, xmax, ymax, zmax. See also the cell parameter.</li>
    </ul></dd>
    <dt>Returns: <a href="schrodinger.structure.Structure-class.html" 
      class="link">schrodinger.structure.Structure</a> or None</dt>
        <dd>A copy of the input structure with all atoms eliminated that are 
          beyond the rough cut distance or are in the ignore list. The 
          coordinates of the atoms will be modified by the periodic 
          boundary condition so that they are within the rough cut distance
          of the ring centroid.</dd>
  </dl>
</td></tr></table>
</div>
<a name="centerAndRotate"></a>
<div>
<table class="details" border="1" cellpadding="3"
       cellspacing="0" width="100%" bgcolor="white">
<tr><td>
  <table width="100%" cellpadding="0" cellspacing="0" border="0">
  <tr valign="top"><td>
  <h3 class="epydoc"><span class="sig"><span class="sig-name">centerAndRotate</span>(<span class="sig-arg">self</span>,
        <span class="sig-arg">struct</span>)</span>
  </h3>
  </td><td align="right" valign="top"
    >&nbsp;
    </td>
  </tr></table>
  
  <p>Apply the same translation and rotation to the structure as would be 
  required to place the ring centroid at the origin with the ring in the XY
  plane.</p>
  <dl class="fields">
    <dt>Parameters:</dt>
    <dd><ul class="nomargin-top">
        <li><strong class="pname"><code>struct</code></strong> (<a href="schrodinger.structure.Structure-class.html" 
          class="link">schrodinger.structure.Structure</a>) - The structure to be centered and rotated. It does not matter if 
          this structure does not contain the ring.</li>
    </ul></dd>
    <dt>Returns: None</dt>
        <dd>Returns nothing - the input structure is modified directly</dd>
  </dl>
</td></tr></table>
</div>
<a name="quickWeedAtoms"></a>
<div>
<table class="details" border="1" cellpadding="3"
       cellspacing="0" width="100%" bgcolor="white">
<tr><td>
  <table width="100%" cellpadding="0" cellspacing="0" border="0">
  <tr valign="top"><td>
  <h3 class="epydoc"><span class="sig"><span class="sig-name">quickWeedAtoms</span>(<span class="sig-arg">self</span>,
        <span class="sig-arg">struct</span>)</span>
  </h3>
  </td><td align="right" valign="top"
    >&nbsp;
    </td>
  </tr></table>
  
  <p>Quickly weed out any atoms that are too far away from the ring 
  centroid to spear the ring.</p>
  <p>This method differs from the rough cut method, which uses a larger 
  spherical cutoff based on the centroid. This uses a cubic cutoff, which 
  allows the dimensions to be smaller since the sphere has to large enough 
  to maintain sufficient distance near the edges of the ring.</p>
  <p>This method also uses smaller distances for smaller atoms</p>
  <dl class="fields">
    <dt>Parameters:</dt>
    <dd><ul class="nomargin-top">
        <li><strong class="pname"><code>struct</code></strong> (<a href="schrodinger.structure.Structure-class.html" 
          class="link">schrodinger.structure.Structure</a>) - The structure to modify directly be deleting atoms that are 
          weeded out</li>
    </ul></dd>
    <dt>Returns: None</dt>
        <dd>Nothing is returned, the input structure is modified directly</dd>
  </dl>
</td></tr></table>
</div>
<a name="markAtomsBeforeSpearCheck"></a>
<div>
<table class="details" border="1" cellpadding="3"
       cellspacing="0" width="100%" bgcolor="white">
<tr><td>
  <table width="100%" cellpadding="0" cellspacing="0" border="0">
  <tr valign="top"><td>
  <h3 class="epydoc"><span class="sig"><span class="sig-name">markAtomsBeforeSpearCheck</span>(<span class="sig-arg">struct</span>)</span>
    <br /><em class="fname">Static Method</em>
  </h3>
  </td><td align="right" valign="top"
    >&nbsp;
    </td>
  </tr></table>
  
  <p>Add an atom property to all atoms with the atom's current index. This 
  allows the original index to be retrieved even after atom indexes have 
  been modified via atom extraction or deletion.</p>
  <dl class="fields">
  </dl>
<div class="fields">      <p><strong>Note:</strong>
        This is a static method
      </p>
</div></td></tr></table>
</div>
<a name="_findSpearingPairs"></a>
<div class="private">
<table class="details" border="1" cellpadding="3"
       cellspacing="0" width="100%" bgcolor="white">
<tr><td>
  <table width="100%" cellpadding="0" cellspacing="0" border="0">
  <tr valign="top"><td>
  <h3 class="epydoc"><span class="sig"><span class="sig-name">_findSpearingPairs</span>(<span class="sig-arg">self</span>,
        <span class="sig-arg">struct</span>,
        <span class="sig-arg">first_only</span>)</span>
  </h3>
  </td><td align="right" valign="top"
    >&nbsp;
    </td>
  </tr></table>
  
  <p>Find atoms that spear this ring.</p>
  <dl class="fields">
    <dt>Parameters:</dt>
    <dd><ul class="nomargin-top">
        <li><strong class="pname"><code>struct</code></strong> (<a href="schrodinger.structure.Structure-class.html" 
          class="link">schrodinger.structure.Structure</a>) - The structure to search for atoms that spear</li>
        <li><strong class="pname"><code>first_only</code></strong> (bool) - Whether to find only the first set of spearing atoms or all sets 
          of spearing atoms</li>
    </ul></dd>
    <dt>Returns: list</dt>
        <dd>Each item of the list is a Spear object for a set of atoms that 
          spear this ring</dd>
  </dl>
</td></tr></table>
</div>
<a name="getBondXYIntersection"></a>
<div>
<table class="details" border="1" cellpadding="3"
       cellspacing="0" width="100%" bgcolor="white">
<tr><td>
  <table width="100%" cellpadding="0" cellspacing="0" border="0">
  <tr valign="top"><td>
  <h3 class="epydoc"><span class="sig"><span class="sig-name">getBondXYIntersection</span>(<span class="sig-arg">self</span>,
        <span class="sig-arg">atom1</span>,
        <span class="sig-arg">atom2</span>)</span>
  </h3>
  </td><td align="right" valign="top"
    >&nbsp;
    </td>
  </tr></table>
  
  <p>Find where the bond from atom1 to atom2 intersects the XY (z=0) 
  plane.</p>
  <p>The equation for a 3d line that passes through points p0=(x0, y0, z0) 
  and p1=(x1, y1, z1) can be written:</p>
<pre class="literalblock">
   x-x0   y-y0   z-z0
   ---- = ---- = ----
    a       b     c
</pre>
  <p>where (a, b, c) is the vector from p0 - p1.</p>
  <p>if z = 0, then x = x0 - a(z0/c) and y = y0 - b(z0/c)</p>
  <dl class="fields">
    <dt>Parameters:</dt>
    <dd><ul class="nomargin-top">
        <li><strong class="pname"><code>atom1</code></strong> (<a href="schrodinger.structure._StructureAtom-class.html" 
          class="link" 
          onclick="show_private();">schrodinger.structure._StructureAtom</a>) - The first atom in the bond to check</li>
        <li><strong class="pname"><code>atom2</code></strong> (<a href="schrodinger.structure._StructureAtom-class.html" 
          class="link" 
          onclick="show_private();">schrodinger.structure._StructureAtom</a>) - The second atom in the bond to check</li>
    </ul></dd>
    <dt>Returns: (float, float) or None</dt>
        <dd>The (x,y) location where the bond intersects the ring plane, or 
          None if there is no intersection (the bond is parallel or nearly 
          parallel to the ring plane).</dd>
  </dl>
</td></tr></table>
</div>
<br />
<!-- ==================== NAVIGATION BAR ==================== -->
<table class="navbar" border="0" width="100%" cellpadding="0"
       bgcolor="#a0c0ff" cellspacing="0">
  <tr valign="middle">

  <!-- Tree link -->
      <th>&nbsp;&nbsp;&nbsp;<a
        href="module-tree.html">Trees</a>&nbsp;&nbsp;&nbsp;</th>

  <!-- Index link -->
      <th>&nbsp;&nbsp;&nbsp;<a
        href="identifier-index.html">Indices</a>&nbsp;&nbsp;&nbsp;</th>

  <!-- Help link -->
      <th>&nbsp;&nbsp;&nbsp;<a
        href="help.html">Help</a>&nbsp;&nbsp;&nbsp;</th>

  <!-- Project homepage -->
      <th class="navbar" align="right" width="100%">
        <table border="0" cellpadding="0" cellspacing="0">
          <tr><th class="navbar" align="center"
            >2015-2Schrodinger Python API</th>
          </tr></table></th>
  </tr>
</table>
<table border="0" cellpadding="0" cellspacing="0" width="100%%">
  <tr>
    <td align="left" class="footer">
    Generated by Epydoc 3.0.1 on Sat May  9 06:31:26 2015
    </td>
    <td align="right" class="footer">
      <a target="mainFrame" href="http://epydoc.sourceforge.net"
        >http://epydoc.sourceforge.net</a>
    </td>
  </tr>
</table>

<script type="text/javascript">
  <!--
  // Private objects are initially displayed (because if
  // javascript is turned off then we want them to be
  // visible); but by default, we want to hide them.  So hide
  // them unless we have a cookie that says to show them.
  checkCookie();
  // -->
</script>
</body>
</html>
