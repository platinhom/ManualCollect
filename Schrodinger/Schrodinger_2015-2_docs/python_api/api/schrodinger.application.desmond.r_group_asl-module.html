<?xml version="1.0" encoding="ascii"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
          "DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head>
  <title>schrodinger.application.desmond.r_group_asl</title>
  <link rel="stylesheet" href="epydoc.css" type="text/css" />
  <script type="text/javascript" src="epydoc.js"></script>
</head>

<body bgcolor="white" text="black" link="blue" vlink="#204080"
      alink="#204080">
<!-- ==================== NAVIGATION BAR ==================== -->
<table class="navbar" border="0" width="100%" cellpadding="0"
       bgcolor="#a0c0ff" cellspacing="0">
  <tr valign="middle">

  <!-- Tree link -->
      <th>&nbsp;&nbsp;&nbsp;<a
        href="module-tree.html">Trees</a>&nbsp;&nbsp;&nbsp;</th>

  <!-- Index link -->
      <th>&nbsp;&nbsp;&nbsp;<a
        href="identifier-index.html">Indices</a>&nbsp;&nbsp;&nbsp;</th>

  <!-- Help link -->
      <th>&nbsp;&nbsp;&nbsp;<a
        href="help.html">Help</a>&nbsp;&nbsp;&nbsp;</th>

  <!-- Project homepage -->
      <th class="navbar" align="right" width="100%">
        <table border="0" cellpadding="0" cellspacing="0">
          <tr><th class="navbar" align="center"
            >2015-2Schrodinger Python API</th>
          </tr></table></th>
  </tr>
</table>
<table width="100%" cellpadding="0" cellspacing="0">
  <tr valign="top">
    <td width="100%">
      <span class="breadcrumbs">
        <a href="schrodinger-module.html">Package&nbsp;schrodinger</a> ::
        <a href="schrodinger.application-module.html">Package&nbsp;application</a> ::
        <a href="schrodinger.application.desmond-module.html">Package&nbsp;desmond</a> ::
        Module&nbsp;r_group_asl
      </span>
    </td>
    <td>
      <table cellpadding="0" cellspacing="0">
        <!-- hide/show private -->
        <tr><td align="right"><span class="options">[<a href="javascript:void(0);" class="privatelink"
    onclick="toggle_private();">hide&nbsp;private</a>]</span></td></tr>
        <tr><td align="right"><span class="options"
            >[<a href="frames.html" target="_top">frames</a
            >]&nbsp;|&nbsp;<a href="schrodinger.application.desmond.r_group_asl-module.html"
            target="_top">no&nbsp;frames</a>]</span></td></tr>
      </table>
    </td>
  </tr>
</table>
<!-- ==================== MODULE DESCRIPTION ==================== -->
<h1 class="epydoc">Module r_group_asl</h1><p class="nomargin-top"></p>
<!-- ==================== FUNCTIONS ==================== -->
<a name="section-Functions"></a>
<table class="summary" border="1" cellpadding="3"
       cellspacing="0" width="100%" bgcolor="white">
<tr bgcolor="#70b0f0" class="table-header">
  <td colspan="2" class="table-header">
    <table border="0" cellpadding="0" cellspacing="0" width="100%">
      <tr valign="top">
        <td align="left"><span class="table-header">Functions</span></td>
        <td align="right" valign="top"
         ><span class="options">[<a href="#section-Functions"
         class="privatelink" onclick="toggle_private();"
         >hide private</a>]</span></td>
      </tr>
    </table>
  </td>
</tr>
<tr>
    <td width="15%" align="right" valign="top" class="summary">
      <span class="summary-type"><code>int</code></span>
    </td><td class="summary">
      <table width="100%" cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td><span class="summary-sig"><a href="schrodinger.application.desmond.r_group_asl-module.html#countHeavyAtoms" class="summary-sig-name">countHeavyAtoms</a>(<span class="summary-sig-arg">st</span>)</span><br />
      This function counts the number of heavy atoms in the structure.</td>
          <td align="right" valign="top">
            
            
          </td>
        </tr>
      </table>
      
    </td>
  </tr>
<tr>
    <td width="15%" align="right" valign="top" class="summary">
      <span class="summary-type">&nbsp;</span>
    </td><td class="summary">
      <table width="100%" cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td><span class="summary-sig"><a href="schrodinger.application.desmond.r_group_asl-module.html#getImportantRotatableBonds" class="summary-sig-name">getImportantRotatableBonds</a>(<span class="summary-sig-arg">st</span>,
        <span class="summary-sig-arg">atom_cutoff</span>=<span class="summary-sig-default">6</span>)</span><br />
      This function returns important rotatable bonds.</td>
          <td align="right" valign="top">
            
            
          </td>
        </tr>
      </table>
      
    </td>
  </tr>
<tr>
    <td width="15%" align="right" valign="top" class="summary">
      <span class="summary-type">&nbsp;</span>
    </td><td class="summary">
      <table width="100%" cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td><span class="summary-sig"><a href="schrodinger.application.desmond.r_group_asl-module.html#get_fep_cts" class="summary-sig-name">get_fep_cts</a>(<span class="summary-sig-arg">cts</span>)</span><br />
      Find reactant and product ct from the input, and return touple of 
      full system, environment, reference ligand and mutated ligand 
      structures</td>
          <td align="right" valign="top">
            
            
          </td>
        </tr>
      </table>
      
    </td>
  </tr>
<tr>
    <td width="15%" align="right" valign="top" class="summary">
      <span class="summary-type">&nbsp;</span>
    </td><td class="summary">
      <table width="100%" cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td><span class="summary-sig"><a name="count_heavy_atoms"></a><span class="summary-sig-name">count_heavy_atoms</span>(<span class="summary-sig-arg">ct</span>,
        <span class="summary-sig-arg">atom_index_list</span>)</span></td>
          <td align="right" valign="top">
            
            
          </td>
        </tr>
      </table>
      
    </td>
  </tr>
<tr>
    <td width="15%" align="right" valign="top" class="summary">
      <span class="summary-type">&nbsp;</span>
    </td><td class="summary">
      <table width="100%" cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td><span class="summary-sig"><a name="get_heavy_atoms"></a><span class="summary-sig-name">get_heavy_atoms</span>(<span class="summary-sig-arg">ct</span>,
        <span class="summary-sig-arg">atom_index_list</span>)</span></td>
          <td align="right" valign="top">
            
            
          </td>
        </tr>
      </table>
      
    </td>
  </tr>
<tr>
    <td width="15%" align="right" valign="top" class="summary">
      <span class="summary-type">&nbsp;</span>
    </td><td class="summary">
      <table width="100%" cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td><span class="summary-sig"><a name="convert_ct2graph"></a><span class="summary-sig-name">convert_ct2graph</span>(<span class="summary-sig-arg">ct</span>)</span></td>
          <td align="right" valign="top">
            
            
          </td>
        </tr>
      </table>
      
    </td>
  </tr>
<tr>
    <td width="15%" align="right" valign="top" class="summary">
      <span class="summary-type">&nbsp;</span>
    </td><td class="summary">
      <table width="100%" cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td><span class="summary-sig"><a href="schrodinger.application.desmond.r_group_asl-module.html#get_fragment" class="summary-sig-name">get_fragment</a>(<span class="summary-sig-arg">b0</span>,
        <span class="summary-sig-arg">b1</span>,
        <span class="summary-sig-arg">ct</span>)</span><br />
      Returns:
      list of atom indice for all atom connected to b1 when bond b0-b1 is 
      removed</td>
          <td align="right" valign="top">
            
            
          </td>
        </tr>
      </table>
      
    </td>
  </tr>
<tr>
    <td width="15%" align="right" valign="top" class="summary">
      <span class="summary-type">&nbsp;</span>
    </td><td class="summary">
      <table width="100%" cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td><span class="summary-sig"><a href="schrodinger.application.desmond.r_group_asl-module.html#get_attachment_bonds" class="summary-sig-name">get_attachment_bonds</a>(<span class="summary-sig-arg">source_ct</span>,
        <span class="summary-sig-arg">dest_ct</span>)</span><br />
      Returns:
      list of attachment bond pairs</td>
          <td align="right" valign="top">
            
            
          </td>
        </tr>
      </table>
      
    </td>
  </tr>
<tr>
    <td width="15%" align="right" valign="top" class="summary">
      <span class="summary-type">&nbsp;</span>
    </td><td class="summary">
      <table width="100%" cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td><span class="summary-sig"><a href="schrodinger.application.desmond.r_group_asl-module.html#get_anchor_atoms" class="summary-sig-name">get_anchor_atoms</a>(<span class="summary-sig-arg">ct</span>)</span><br />
      Returns:
      list of atom indices Find the core atoms from which a mutation is 
      attached</td>
          <td align="right" valign="top">
            
            
          </td>
        </tr>
      </table>
      
    </td>
  </tr>
<tr>
    <td width="15%" align="right" valign="top" class="summary">
      <span class="summary-type">&nbsp;</span>
    </td><td class="summary">
      <table width="100%" cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td><span class="summary-sig"><a href="schrodinger.application.desmond.r_group_asl-module.html#get_dummy_atoms" class="summary-sig-name">get_dummy_atoms</a>(<span class="summary-sig-arg">ct</span>)</span><br />
      dummy atoms here includes mutated ring atoms and linker atoms</td>
          <td align="right" valign="top">
            
            
          </td>
        </tr>
      </table>
      
    </td>
  </tr>
<tr>
    <td width="15%" align="right" valign="top" class="summary">
      <span class="summary-type">&nbsp;</span>
    </td><td class="summary">
      <table width="100%" cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td><span class="summary-sig"><a name="get_big_fused_rings"></a><span class="summary-sig-name">get_big_fused_rings</span>(<span class="summary-sig-arg">ct</span>)</span><br />
      return heavy atoms of fused rings from SSSR set</td>
          <td align="right" valign="top">
            
            
          </td>
        </tr>
      </table>
      
    </td>
  </tr>
<tr>
    <td width="15%" align="right" valign="top" class="summary">
      <span class="summary-type">&nbsp;</span>
    </td><td class="summary">
      <table width="100%" cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td><span class="summary-sig"><a href="schrodinger.application.desmond.r_group_asl-module.html#combine_rings" class="summary-sig-name">combine_rings</a>(<span class="summary-sig-arg">rings</span>)</span><br />
      combine fused rings from SSSR set</td>
          <td align="right" valign="top">
            
            
          </td>
        </tr>
      </table>
      
    </td>
  </tr>
<tr>
    <td width="15%" align="right" valign="top" class="summary">
      <span class="summary-type">&nbsp;</span>
    </td><td class="summary">
      <table width="100%" cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td><span class="summary-sig"><a name="is_ring_atom"></a><span class="summary-sig-name">is_ring_atom</span>(<span class="summary-sig-arg">ct</span>,
        <span class="summary-sig-arg">atom</span>)</span></td>
          <td align="right" valign="top">
            
            
          </td>
        </tr>
      </table>
      
    </td>
  </tr>
<tr>
    <td width="15%" align="right" valign="top" class="summary">
      <span class="summary-type">&nbsp;</span>
    </td><td class="summary">
      <table width="100%" cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td><span class="summary-sig"><a name="whole_ring_test"></a><span class="summary-sig-name">whole_ring_test</span>(<span class="summary-sig-arg">ct</span>,
        <span class="summary-sig-arg">atom_list</span>)</span><br />
      test if atom list contains entire rings</td>
          <td align="right" valign="top">
            
            
          </td>
        </tr>
      </table>
      
    </td>
  </tr>
<tr>
    <td width="15%" align="right" valign="top" class="summary">
      <span class="summary-type">&nbsp;</span>
    </td><td class="summary">
      <table width="100%" cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td><span class="summary-sig"><a href="schrodinger.application.desmond.r_group_asl-module.html#find_closest_rotbond" class="summary-sig-name">find_closest_rotbond</a>(<span class="summary-sig-arg">graph</span>,
        <span class="summary-sig-arg">anchor_index</span>,
        <span class="summary-sig-arg">rotable_bonds</span>)</span><br />
      given anchor atom and connection graph of a molecule, find the 
      rotable bonds that is cloest (in terms of number of bonds to the 
      anchor atom)</td>
          <td align="right" valign="top">
            
            
          </td>
        </tr>
      </table>
      
    </td>
  </tr>
<tr>
    <td width="15%" align="right" valign="top" class="summary">
      <span class="summary-type">&nbsp;</span>
    </td><td class="summary">
      <table width="100%" cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td><span class="summary-sig"><a href="schrodinger.application.desmond.r_group_asl-module.html#remove_extra_rotable_atoms" class="summary-sig-name">remove_extra_rotable_atoms</a>(<span class="summary-sig-arg">ct</span>,
        <span class="summary-sig-arg">graph</span>,
        <span class="summary-sig-arg">anchor_index</span>,
        <span class="summary-sig-arg">hot_r</span>,
        <span class="summary-sig-arg">rotable_bonds</span>)</span><br />
      remove the extra fragments connected to the current hot region.</td>
          <td align="right" valign="top">
            
            
          </td>
        </tr>
      </table>
      
    </td>
  </tr>
<tr>
    <td width="15%" align="right" valign="top" class="summary">
      <span class="summary-type">&nbsp;</span>
    </td><td class="summary">
      <table width="100%" cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td><span class="summary-sig"><a href="schrodinger.application.desmond.r_group_asl-module.html#find_frag_from_closest_rotbond" class="summary-sig-name">find_frag_from_closest_rotbond</a>(<span class="summary-sig-arg">ct</span>,
        <span class="summary-sig-arg">anchor_index</span>,
        <span class="summary-sig-arg">rotable_bonds</span>)</span><br />
      find rotable bond that is closest to the anchor atom in terms of number of bonds
return the fragment, original rotable bond, bond used to find the fragment,
and list of rotable bonds from which large fragment is cut off (extra_rot).</td>
          <td align="right" valign="top">
            
            
          </td>
        </tr>
      </table>
      
    </td>
  </tr>
<tr>
    <td width="15%" align="right" valign="top" class="summary">
      <span class="summary-type">&nbsp;</span>
    </td><td class="summary">
      <table width="100%" cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td><span class="summary-sig"><a href="schrodinger.application.desmond.r_group_asl-module.html#get_fragments_from_att_points" class="summary-sig-name">get_fragments_from_att_points</a>(<span class="summary-sig-arg">source_ct</span>,
        <span class="summary-sig-arg">dest_ct</span>,
        <span class="summary-sig-arg">source_att</span>,
        <span class="summary-sig-arg">dest_att</span>,
        <span class="summary-sig-arg">source_rotable_bonds</span>,
        <span class="summary-sig-arg">dest_rotable_bonds</span>)</span><br />
      given attachment pairs, find the rotable fragments containing the 
      attachment bond return fragments and the rotable bond associated The 
      bigger one of the fragment pair is used to determine which rotabond 
      to use.</td>
          <td align="right" valign="top">
            
            
          </td>
        </tr>
      </table>
      
    </td>
  </tr>
<tr>
    <td width="15%" align="right" valign="top" class="summary">
      <span class="summary-type">&nbsp;</span>
    </td><td class="summary">
      <table width="100%" cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td><span class="summary-sig"><a name="is_rotabond"></a><span class="summary-sig-name">is_rotabond</span>(<span class="summary-sig-arg">bond</span>,
        <span class="summary-sig-arg">rota_bond_list</span>)</span></td>
          <td align="right" valign="top">
            
            
          </td>
        </tr>
      </table>
      
    </td>
  </tr>
<tr>
    <td width="15%" align="right" valign="top" class="summary">
      <span class="summary-type">&nbsp;</span>
    </td><td class="summary">
      <table width="100%" cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td><span class="summary-sig"><a name="apply_exclusion"></a><span class="summary-sig-name">apply_exclusion</span>(<span class="summary-sig-arg">source_hot_frag</span>,
        <span class="summary-sig-arg">source_excl</span>,
        <span class="summary-sig-arg">dest_hot_frag</span>,
        <span class="summary-sig-arg">dest_excl</span>)</span></td>
          <td align="right" valign="top">
            
            
          </td>
        </tr>
      </table>
      
    </td>
  </tr>
<tr>
    <td width="15%" align="right" valign="top" class="summary">
      <span class="summary-type">&nbsp;</span>
    </td><td class="summary">
      <table width="100%" cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td><span class="summary-sig"><a href="schrodinger.application.desmond.r_group_asl-module.html#extend_hotregion" class="summary-sig-name">extend_hotregion</a>(<span class="summary-sig-arg">total_heavy</span>,
        <span class="summary-sig-arg">source_ct</span>,
        <span class="summary-sig-arg">dest_ct</span>,
        <span class="summary-sig-arg">att_bonds</span>,
        <span class="summary-sig-arg">hotregion_source</span>,
        <span class="summary-sig-arg">hotregion_dest</span>,
        <span class="summary-sig-arg">source_rot_bonds</span>,
        <span class="summary-sig-arg">dest_rot_bonds</span>,
        <span class="summary-sig-arg">source_frag_rot_bonds_visited</span>,
        <span class="summary-sig-arg">dest_frag_rot_bonds_visited</span>,
        <span class="summary-sig-arg">max_rest_atoms</span>,
        <span class="summary-sig-arg">source_excl</span>,
        <span class="summary-sig-arg">dest_excl</span>)</span><br />
      extend the hot region by moving to the next rotable bond</td>
          <td align="right" valign="top">
            
            
          </td>
        </tr>
      </table>
      
    </td>
  </tr>
<tr>
    <td width="15%" align="right" valign="top" class="summary">
      <span class="summary-type">&nbsp;</span>
    </td><td class="summary">
      <table width="100%" cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td><span class="summary-sig"><a name="get_rotable_bonds"></a><span class="summary-sig-name">get_rotable_bonds</span>(<span class="summary-sig-arg">source_ct</span>,
        <span class="summary-sig-arg">dest_ct</span>,
        <span class="summary-sig-arg">min_h_atom</span>)</span><br />
      Find rotable bonds paired for source and dest cts return paired 
      rotable bonds in core, and all possible rotable bonds for each ct</td>
          <td align="right" valign="top">
            
            
          </td>
        </tr>
      </table>
      
    </td>
  </tr>
<tr>
    <td width="15%" align="right" valign="top" class="summary">
      <span class="summary-type">&nbsp;</span>
    </td><td class="summary">
      <table width="100%" cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td><span class="summary-sig"><a href="schrodinger.application.desmond.r_group_asl-module.html#set_hotregion_gui" class="summary-sig-name">set_hotregion_gui</a>(<span class="summary-sig-arg">cts</span>)</span><br />
      This is called whenever the i_fep_mapping is not defined.</td>
          <td align="right" valign="top">
            
            
          </td>
        </tr>
      </table>
      
    </td>
  </tr>
<tr>
    <td width="15%" align="right" valign="top" class="summary">
      <span class="summary-type">&nbsp;</span>
    </td><td class="summary">
      <table width="100%" cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td><span class="summary-sig"><a href="schrodinger.application.desmond.r_group_asl-module.html#set_hotregion" class="summary-sig-name">set_hotregion</a>(<span class="summary-sig-arg">cts</span>,
        <span class="summary-sig-arg">max_rest_atoms</span>=<span class="summary-sig-default">25</span>,
        <span class="summary-sig-arg">min_h_atom</span>=<span class="summary-sig-default">1</span>,
        <span class="summary-sig-arg">exclusion_lists</span>=<span class="summary-sig-default"><code class="variable-group">(</code><code class="variable-group">set([</code><code class="variable-group">])</code><code class="variable-op">, </code><code class="variable-group">set([</code><code class="variable-group">])</code><code class="variable-group">)</code></span>)</span><br />
      @param cts: input structures, s_fep_fragname should be defined for sourec and dest cts
@type cts: Lists of structure
@param max_rest_atoms: maximum allowed number of heavy atoms in hot region, soft limit
@param min_h_atom: minimum heavy atom moved by a rotable bond
@param exclusion_lists: touple of sets of core atoms (hydrogen included)
@retrun: number of heavy atoms assigned</td>
          <td align="right" valign="top">
            
            
          </td>
        </tr>
      </table>
      
    </td>
  </tr>
</table>
<!-- ==================== VARIABLES ==================== -->
<a name="section-Variables"></a>
<table class="summary" border="1" cellpadding="3"
       cellspacing="0" width="100%" bgcolor="white">
<tr bgcolor="#70b0f0" class="table-header">
  <td colspan="2" class="table-header">
    <table border="0" cellpadding="0" cellspacing="0" width="100%">
      <tr valign="top">
        <td align="left"><span class="table-header">Variables</span></td>
        <td align="right" valign="top"
         ><span class="options">[<a href="#section-Variables"
         class="privatelink" onclick="toggle_private();"
         >hide private</a>]</span></td>
      </tr>
    </table>
  </td>
</tr>
<tr>
    <td width="15%" align="right" valign="top" class="summary">
      <span class="summary-type">&nbsp;</span>
    </td><td class="summary">
        <a name="N_HATOM"></a><span class="summary-name">N_HATOM</span> = <code title="1">1</code>
    </td>
  </tr>
<tr>
    <td width="15%" align="right" valign="top" class="summary">
      <span class="summary-type">&nbsp;</span>
    </td><td class="summary">
        <a name="MAX_NUM_REST_ATOM"></a><span class="summary-name">MAX_NUM_REST_ATOM</span> = <code title="25">25</code>
    </td>
  </tr>
<tr>
    <td width="15%" align="right" valign="top" class="summary">
      <span class="summary-type">&nbsp;</span>
    </td><td class="summary">
        <a name="MIN_FUSED_RING"></a><span class="summary-name">MIN_FUSED_RING</span> = <code title="7">7</code>
    </td>
  </tr>
<tr>
    <td width="15%" align="right" valign="top" class="summary">
      <span class="summary-type">&nbsp;</span>
    </td><td class="summary">
        <a name="LARGE_FRAG_ON_RING"></a><span class="summary-name">LARGE_FRAG_ON_RING</span> = <code title="3">3</code><br />
      hash(x)
    </td>
  </tr>
<tr>
    <td width="15%" align="right" valign="top" class="summary">
      <span class="summary-type">&nbsp;</span>
    </td><td class="summary">
        <a name="logger"></a><span class="summary-name">logger</span> = <code title="log.get_output_logger(name= &quot;r_group_asl&quot;)">log.get_output_logger(name= &quot;r_group_asl&quot;)</code>
    </td>
  </tr>
<tr>
    <td width="15%" align="right" valign="top" class="summary">
      <span class="summary-type">&nbsp;</span>
    </td><td class="summary">
        <a name="mae_fname"></a><span class="summary-name">mae_fname</span> = <code title="sys.argv [1]">sys.argv [1]</code>
    </td>
  </tr>
<tr>
    <td width="15%" align="right" valign="top" class="summary">
      <span class="summary-type">&nbsp;</span>
    </td><td class="summary">
        <a name="cts"></a><span class="summary-name">cts</span> = <code title="[]">[]</code>
    </td>
  </tr>
<tr>
    <td width="15%" align="right" valign="top" class="summary">
      <span class="summary-type">&nbsp;</span>
    </td><td class="summary">
        <a href="schrodinger.application.desmond.r_group_asl-module.html#n_set" class="summary-name">n_set</a> = <code title="set_hotregion(cts, max_rest_atoms= MAX_NUM_REST_ATOM, min_h_atom= N_HA\
TOM)">set_hotregion(cts, max_rest_atoms= MAX_NUM_REST_ATOM, <code class="variable-ellipsis">...</code></code>
    </td>
  </tr>
<tr>
    <td width="15%" align="right" valign="top" class="summary">
      <span class="summary-type">&nbsp;</span>
    </td><td class="summary">
        <a name="out_fname"></a><span class="summary-name">out_fname</span> = <code title="sys.argv [2]">sys.argv [2]</code>
    </td>
  </tr>
<tr>
    <td width="15%" align="right" valign="top" class="summary">
      <span class="summary-type">&nbsp;</span>
    </td><td class="summary">
        <a name="__package__"></a><span class="summary-name">__package__</span> = <code title="'schrodinger.application.desmond'"><code class="variable-quote">'</code><code class="variable-string">schrodinger.application.desmond</code><code class="variable-quote">'</code></code>
    </td>
  </tr>
</table>
<!-- ==================== FUNCTION DETAILS ==================== -->
<a name="section-FunctionDetails"></a>
<table class="details" border="1" cellpadding="3"
       cellspacing="0" width="100%" bgcolor="white">
<tr bgcolor="#70b0f0" class="table-header">
  <td colspan="2" class="table-header">
    <table border="0" cellpadding="0" cellspacing="0" width="100%">
      <tr valign="top">
        <td align="left"><span class="table-header">Function Details</span></td>
        <td align="right" valign="top"
         ><span class="options">[<a href="#section-FunctionDetails"
         class="privatelink" onclick="toggle_private();"
         >hide private</a>]</span></td>
      </tr>
    </table>
  </td>
</tr>
</table>
<a name="countHeavyAtoms"></a>
<div>
<table class="details" border="1" cellpadding="3"
       cellspacing="0" width="100%" bgcolor="white">
<tr><td>
  <table width="100%" cellpadding="0" cellspacing="0" border="0">
  <tr valign="top"><td>
  <h3 class="epydoc"><span class="sig"><span class="sig-name">countHeavyAtoms</span>(<span class="sig-arg">st</span>)</span>
  </h3>
  </td><td align="right" valign="top"
    >&nbsp;
    </td>
  </tr></table>
  
  <p>This function counts the number of heavy atoms in the structure.</p>
  <dl class="fields">
    <dt>Parameters:</dt>
    <dd><ul class="nomargin-top">
        <li><strong class="pname"><code>st</code></strong> (<a href="schrodinger.structure.Structure-class.html" 
          class="link">structure.Structure</a>) - Structure</li>
    </ul></dd>
    <dt>Returns: <code>int</code></dt>
        <dd>number of heavy atoms</dd>
  </dl>
</td></tr></table>
</div>
<a name="getImportantRotatableBonds"></a>
<div>
<table class="details" border="1" cellpadding="3"
       cellspacing="0" width="100%" bgcolor="white">
<tr><td>
  <table width="100%" cellpadding="0" cellspacing="0" border="0">
  <tr valign="top"><td>
  <h3 class="epydoc"><span class="sig"><span class="sig-name">getImportantRotatableBonds</span>(<span class="sig-arg">st</span>,
        <span class="sig-arg">atom_cutoff</span>=<span class="sig-default">6</span>)</span>
  </h3>
  </td><td align="right" valign="top"
    >&nbsp;
    </td>
  </tr></table>
  
  <pre class="literalblock">

   This function returns important rotatable bonds. Important rotatable bonds are defined when both sides of the
bond have
   either rings or heavy atoms greater than atom_cutoff.

   @type            st: L{structure.Structure}
   @param           st: Structure
   @type   atom_cutoff: C{int}
   @param  atom_cutoff: # of heavy atoms
   @return            : generator for atom pairs in important rotatable bonds
   

</pre>
  <dl class="fields">
  </dl>
</td></tr></table>
</div>
<a name="get_fep_cts"></a>
<div>
<table class="details" border="1" cellpadding="3"
       cellspacing="0" width="100%" bgcolor="white">
<tr><td>
  <table width="100%" cellpadding="0" cellspacing="0" border="0">
  <tr valign="top"><td>
  <h3 class="epydoc"><span class="sig"><span class="sig-name">get_fep_cts</span>(<span class="sig-arg">cts</span>)</span>
  </h3>
  </td><td align="right" valign="top"
    >&nbsp;
    </td>
  </tr></table>
  
  <p>Find reactant and product ct from the input, and return touple of full
  system, environment, reference ligand and mutated ligand structures</p>
  <dl class="fields">
    <dt>Parameters:</dt>
    <dd><ul class="nomargin-top">
        <li><strong class="pname"><code>cts</code></strong> - input structures</li>
    </ul></dd>
    <dt>Returns:</dt>
        <dd>fsys_ct, env_ct, ref_ct, mut_ct</dd>
  </dl>
</td></tr></table>
</div>
<a name="get_fragment"></a>
<div>
<table class="details" border="1" cellpadding="3"
       cellspacing="0" width="100%" bgcolor="white">
<tr><td>
  <table width="100%" cellpadding="0" cellspacing="0" border="0">
  <tr valign="top"><td>
  <h3 class="epydoc"><span class="sig"><span class="sig-name">get_fragment</span>(<span class="sig-arg">b0</span>,
        <span class="sig-arg">b1</span>,
        <span class="sig-arg">ct</span>)</span>
  </h3>
  </td><td align="right" valign="top"
    >&nbsp;
    </td>
  </tr></table>
  
  
  <dl class="fields">
    <dt>Parameters:</dt>
    <dd><ul class="nomargin-top">
        <li><strong class="pname"><code>b0</code></strong> - first atom index for bond</li>
        <li><strong class="pname"><code>b1</code></strong> - second atom index for bond, this connects to the fragment 
          returned</li>
    </ul></dd>
    <dt>Returns:</dt>
        <dd>list of atom indice for all atom connected to b1 when bond b0-b1 
          is removed</dd>
  </dl>
</td></tr></table>
</div>
<a name="get_attachment_bonds"></a>
<div>
<table class="details" border="1" cellpadding="3"
       cellspacing="0" width="100%" bgcolor="white">
<tr><td>
  <table width="100%" cellpadding="0" cellspacing="0" border="0">
  <tr valign="top"><td>
  <h3 class="epydoc"><span class="sig"><span class="sig-name">get_attachment_bonds</span>(<span class="sig-arg">source_ct</span>,
        <span class="sig-arg">dest_ct</span>)</span>
  </h3>
  </td><td align="right" valign="top"
    >&nbsp;
    </td>
  </tr></table>
  
  
  <dl class="fields">
    <dt>Returns:</dt>
        <dd>list of attachment bond pairs
          <p>two cts need to have i_fep_subst codes defined ?99-?98 if one 
          of the fragment the linker atom connects contains less than 6 
          heavy atoms, treat this fragment as functional group</p></dd>
  </dl>
</td></tr></table>
</div>
<a name="get_anchor_atoms"></a>
<div>
<table class="details" border="1" cellpadding="3"
       cellspacing="0" width="100%" bgcolor="white">
<tr><td>
  <table width="100%" cellpadding="0" cellspacing="0" border="0">
  <tr valign="top"><td>
  <h3 class="epydoc"><span class="sig"><span class="sig-name">get_anchor_atoms</span>(<span class="sig-arg">ct</span>)</span>
  </h3>
  </td><td align="right" valign="top"
    >&nbsp;
    </td>
  </tr></table>
  
  
  <dl class="fields">
    <dt>Returns:</dt>
        <dd>list of atom indices Find the core atoms from which a mutation is
          attached</dd>
  </dl>
</td></tr></table>
</div>
<a name="get_dummy_atoms"></a>
<div>
<table class="details" border="1" cellpadding="3"
       cellspacing="0" width="100%" bgcolor="white">
<tr><td>
  <table width="100%" cellpadding="0" cellspacing="0" border="0">
  <tr valign="top"><td>
  <h3 class="epydoc"><span class="sig"><span class="sig-name">get_dummy_atoms</span>(<span class="sig-arg">ct</span>)</span>
  </h3>
  </td><td align="right" valign="top"
    >&nbsp;
    </td>
  </tr></table>
  
  <p>dummy atoms here includes mutated ring atoms and linker atoms</p>
  <dl class="fields">
    <dt>Returns:</dt>
        <dd>list of dummpy atom indices</dd>
  </dl>
</td></tr></table>
</div>
<a name="combine_rings"></a>
<div>
<table class="details" border="1" cellpadding="3"
       cellspacing="0" width="100%" bgcolor="white">
<tr><td>
  <table width="100%" cellpadding="0" cellspacing="0" border="0">
  <tr valign="top"><td>
  <h3 class="epydoc"><span class="sig"><span class="sig-name">combine_rings</span>(<span class="sig-arg">rings</span>)</span>
  </h3>
  </td><td align="right" valign="top"
    >&nbsp;
    </td>
  </tr></table>
  
  <p>combine fused rings from SSSR set</p>
  <dl class="fields">
    <dt>Returns:</dt>
        <dd>list of lists of atoms</dd>
  </dl>
</td></tr></table>
</div>
<a name="find_closest_rotbond"></a>
<div>
<table class="details" border="1" cellpadding="3"
       cellspacing="0" width="100%" bgcolor="white">
<tr><td>
  <table width="100%" cellpadding="0" cellspacing="0" border="0">
  <tr valign="top"><td>
  <h3 class="epydoc"><span class="sig"><span class="sig-name">find_closest_rotbond</span>(<span class="sig-arg">graph</span>,
        <span class="sig-arg">anchor_index</span>,
        <span class="sig-arg">rotable_bonds</span>)</span>
  </h3>
  </td><td align="right" valign="top"
    >&nbsp;
    </td>
  </tr></table>
  
  <p>given anchor atom and connection graph of a molecule, find the rotable
  bonds that is cloest (in terms of number of bonds to the anchor atom)</p>
  <dl class="fields">
    <dt>Parameters:</dt>
    <dd><ul class="nomargin-top">
        <li><strong class="pname"><code>graph</code></strong> (networkx graph) - molecular graph</li>
        <li><strong class="pname"><code>anchor_index</code></strong> - anchor atom index</li>
        <li><strong class="pname"><code>rotable_bonds</code></strong> (list of touples) - list of rotable bonds</li>
    </ul></dd>
  </dl>
</td></tr></table>
</div>
<a name="remove_extra_rotable_atoms"></a>
<div>
<table class="details" border="1" cellpadding="3"
       cellspacing="0" width="100%" bgcolor="white">
<tr><td>
  <table width="100%" cellpadding="0" cellspacing="0" border="0">
  <tr valign="top"><td>
  <h3 class="epydoc"><span class="sig"><span class="sig-name">remove_extra_rotable_atoms</span>(<span class="sig-arg">ct</span>,
        <span class="sig-arg">graph</span>,
        <span class="sig-arg">anchor_index</span>,
        <span class="sig-arg">hot_r</span>,
        <span class="sig-arg">rotable_bonds</span>)</span>
  </h3>
  </td><td align="right" valign="top"
    >&nbsp;
    </td>
  </tr></table>
  
  <p>remove the extra fragments connected to the current hot region.</p>
  <dl class="fields">
    <dt>Parameters:</dt>
    <dd><ul class="nomargin-top">
        <li><strong class="pname"><code>ct</code></strong> - structure</li>
        <li><strong class="pname"><code>graph</code></strong> (networkx graph) - molecular graph</li>
        <li><strong class="pname"><code>anchor_index</code></strong> - anchor atom index</li>
        <li><strong class="pname"><code>hot_r</code></strong> (list of integers) - hot region found by finding closes rotable bonds from anchor atom</li>
        <li><strong class="pname"><code>rotable_bonds</code></strong> (list of touples) - list of rotable bonds</li>
    </ul></dd>
  </dl>
</td></tr></table>
</div>
<a name="find_frag_from_closest_rotbond"></a>
<div>
<table class="details" border="1" cellpadding="3"
       cellspacing="0" width="100%" bgcolor="white">
<tr><td>
  <table width="100%" cellpadding="0" cellspacing="0" border="0">
  <tr valign="top"><td>
  <h3 class="epydoc"><span class="sig"><span class="sig-name">find_frag_from_closest_rotbond</span>(<span class="sig-arg">ct</span>,
        <span class="sig-arg">anchor_index</span>,
        <span class="sig-arg">rotable_bonds</span>)</span>
  </h3>
  </td><td align="right" valign="top"
    >&nbsp;
    </td>
  </tr></table>
  
  <pre class="literalblock">
find rotable bond that is closest to the anchor atom in terms of number of bonds
return the fragment, original rotable bond, bond used to find the fragment,
and list of rotable bonds from which large fragment is cut off (extra_rot).
The last to items are used to find the matching fragment in the other molecule
@return: (hot_r, save_rot_bond, (rot_atom0, rot_atom1), extra_rot)
     hor_r: hot region found
     save_rot_bond: original rotable bond used to find the fragment
     (rot_atom0, rot_atom1): rotable bond in the same atom order passed to get_fragment
     extra_rot: list of extra_rotable bond directly connected to the fragment;
                the fragments attached by these bonds are removed already

</pre>
  <dl class="fields">
  </dl>
</td></tr></table>
</div>
<a name="get_fragments_from_att_points"></a>
<div>
<table class="details" border="1" cellpadding="3"
       cellspacing="0" width="100%" bgcolor="white">
<tr><td>
  <table width="100%" cellpadding="0" cellspacing="0" border="0">
  <tr valign="top"><td>
  <h3 class="epydoc"><span class="sig"><span class="sig-name">get_fragments_from_att_points</span>(<span class="sig-arg">source_ct</span>,
        <span class="sig-arg">dest_ct</span>,
        <span class="sig-arg">source_att</span>,
        <span class="sig-arg">dest_att</span>,
        <span class="sig-arg">source_rotable_bonds</span>,
        <span class="sig-arg">dest_rotable_bonds</span>)</span>
  </h3>
  </td><td align="right" valign="top"
    >&nbsp;
    </td>
  </tr></table>
  
  <p>given attachment pairs, find the rotable fragments containing the 
  attachment bond return fragments and the rotable bond associated The 
  bigger one of the fragment pair is used to determine which rotabond to 
  use.</p>
  <dl class="fields">
    <dt>Parameters:</dt>
    <dd><ul class="nomargin-top">
        <li><strong class="pname"><code>source_ct</code></strong> - source structure</li>
        <li><strong class="pname"><code>dest_ct</code></strong> - dest structure</li>
        <li><strong class="pname"><code>source_att</code></strong> (touple of integers) - source attachment point</li>
        <li><strong class="pname"><code>dest_att</code></strong> (touple of integers) - dest attachment point</li>
        <li><strong class="pname"><code>source_rotable_bonds</code></strong> - source rotable bond list</li>
        <li><strong class="pname"><code>dest_rotable_bonds</code></strong> - dest rotable bond list</li>
    </ul></dd>
    <dt>Returns:</dt>
        <dd>(source_hot_frag, dest_hot_frag, (s_rot0, s_rot1), (d_rot0, 
          d_rot1)).  The order of atoms in the rotable bonds returned is in
          accord to the way the fragments are generated.</dd>
  </dl>
</td></tr></table>
</div>
<a name="extend_hotregion"></a>
<div>
<table class="details" border="1" cellpadding="3"
       cellspacing="0" width="100%" bgcolor="white">
<tr><td>
  <table width="100%" cellpadding="0" cellspacing="0" border="0">
  <tr valign="top"><td>
  <h3 class="epydoc"><span class="sig"><span class="sig-name">extend_hotregion</span>(<span class="sig-arg">total_heavy</span>,
        <span class="sig-arg">source_ct</span>,
        <span class="sig-arg">dest_ct</span>,
        <span class="sig-arg">att_bonds</span>,
        <span class="sig-arg">hotregion_source</span>,
        <span class="sig-arg">hotregion_dest</span>,
        <span class="sig-arg">source_rot_bonds</span>,
        <span class="sig-arg">dest_rot_bonds</span>,
        <span class="sig-arg">source_frag_rot_bonds_visited</span>,
        <span class="sig-arg">dest_frag_rot_bonds_visited</span>,
        <span class="sig-arg">max_rest_atoms</span>,
        <span class="sig-arg">source_excl</span>,
        <span class="sig-arg">dest_excl</span>)</span>
  </h3>
  </td><td align="right" valign="top"
    >&nbsp;
    </td>
  </tr></table>
  
  <p>extend the hot region by moving to the next rotable bond</p>
  <dl class="fields">
    <dt>Parameters:</dt>
    <dd><ul class="nomargin-top">
        <li><strong class="pname"><code>total_heavy</code></strong> - total heavy atoms in the hot region so far</li>
        <li><strong class="pname"><code>source_ct</code></strong> - source structure</li>
        <li><strong class="pname"><code>dest_ct</code></strong> - dest structure</li>
        <li><strong class="pname"><code>att_bonds</code></strong> - all attachment bonds for mutations</li>
        <li><strong class="pname"><code>source_rot_bonds</code></strong> - rotable bond list of reactant</li>
        <li><strong class="pname"><code>dest_rot_bonds</code></strong> - rotable bond list of product</li>
        <li><strong class="pname"><code>source_frag_rot_bonds_visite</code></strong> - dictionary of rotable bonds already visited for attchment bonds 
          in  reactant</li>
        <li><strong class="pname"><code>dest_frag_rot_bonds_visite</code></strong> - dictionary of rotable bonds already visited for attchment bonds 
          in  product</li>
    </ul></dd>
  </dl>
</td></tr></table>
</div>
<a name="set_hotregion_gui"></a>
<div>
<table class="details" border="1" cellpadding="3"
       cellspacing="0" width="100%" bgcolor="white">
<tr><td>
  <table width="100%" cellpadding="0" cellspacing="0" border="0">
  <tr valign="top"><td>
  <h3 class="epydoc"><span class="sig"><span class="sig-name">set_hotregion_gui</span>(<span class="sig-arg">cts</span>)</span>
  </h3>
  </td><td align="right" valign="top"
    >&nbsp;
    </td>
  </tr></table>
  
  <p>This is called whenever the i_fep_mapping is not defined.</p>
  <dl class="fields">
    <dt>Parameters:</dt>
    <dd><ul class="nomargin-top">
        <li><strong class="pname"><code>cts</code></strong> - input cts</li>
    </ul></dd>
    <dt>Returns:</dt>
        <dd>none</dd>
  </dl>
</td></tr></table>
</div>
<a name="set_hotregion"></a>
<div>
<table class="details" border="1" cellpadding="3"
       cellspacing="0" width="100%" bgcolor="white">
<tr><td>
  <table width="100%" cellpadding="0" cellspacing="0" border="0">
  <tr valign="top"><td>
  <h3 class="epydoc"><span class="sig"><span class="sig-name">set_hotregion</span>(<span class="sig-arg">cts</span>,
        <span class="sig-arg">max_rest_atoms</span>=<span class="sig-default">25</span>,
        <span class="sig-arg">min_h_atom</span>=<span class="sig-default">1</span>,
        <span class="sig-arg">exclusion_lists</span>=<span class="sig-default"><code class="variable-group">(</code><code class="variable-group">set([</code><code class="variable-group">])</code><code class="variable-op">, </code><code class="variable-group">set([</code><code class="variable-group">])</code><code class="variable-group">)</code></span>)</span>
  </h3>
  </td><td align="right" valign="top"
    >&nbsp;
    </td>
  </tr></table>
  
  <pre class="literalblock">

@param cts: input structures, s_fep_fragname should be defined for sourec and dest cts
@type cts: Lists of structure
@param max_rest_atoms: maximum allowed number of heavy atoms in hot region, soft limit
@param min_h_atom: minimum heavy atom moved by a rotable bond
@param exclusion_lists: touple of sets of core atoms (hydrogen included)
@retrun: number of heavy atoms assigned

Set the hotregions in the cts according to mutated fragments and maximum allowed number
of atoms.  Core atoms can be exclude via exclusion_lists.

Steps to set REST region
1.  Include all the changed atoms (?99, ?97, ?98)
    If there are too many atoms, stop.  Linker atoms are ignored
    (linker connects two fragments with more than 6 heavy atoms in each of the fragments)
2.  If a rotable bond is also an attachment point, include all atoms in the fragment.
3.  For each changed fragment pair (attachment point), try to include all the atoms up
    to the closest rotatble bond.  How far away the rotable bond is is measure by
    the minimum number of bonds separating the fragment and the rotable bonds.
    Fused rings are excluded.  If the fragment is a ring, the maximum allowed atoms may
    be six more than the allowed number.
4.  Repeat 3, if maximum number of atoms are not reached and it is still possible to add
    more atoms.

</pre>
  <dl class="fields">
  </dl>
</td></tr></table>
</div>
<br />
<!-- ==================== VARIABLES DETAILS ==================== -->
<a name="section-VariablesDetails"></a>
<table class="details" border="1" cellpadding="3"
       cellspacing="0" width="100%" bgcolor="white">
<tr bgcolor="#70b0f0" class="table-header">
  <td colspan="2" class="table-header">
    <table border="0" cellpadding="0" cellspacing="0" width="100%">
      <tr valign="top">
        <td align="left"><span class="table-header">Variables Details</span></td>
        <td align="right" valign="top"
         ><span class="options">[<a href="#section-VariablesDetails"
         class="privatelink" onclick="toggle_private();"
         >hide private</a>]</span></td>
      </tr>
    </table>
  </td>
</tr>
</table>
<a name="n_set"></a>
<div>
<table class="details" border="1" cellpadding="3"
       cellspacing="0" width="100%" bgcolor="white">
<tr><td>
  <h3 class="epydoc">n_set</h3>
  
  <dl class="fields">
  </dl>
  <dl class="fields">
    <dt>Value:</dt>
      <dd><table><tr><td><pre class="variable">
set_hotregion(cts, max_rest_atoms= MAX_NUM_REST_ATOM, min_h_atom= N_HA<span class="variable-linewrap"><img src="crarr.png" alt="\" /></span>
TOM)
</pre></td></tr></table>
</dd>
  </dl>
</td></tr></table>
</div>
<br />
<!-- ==================== NAVIGATION BAR ==================== -->
<table class="navbar" border="0" width="100%" cellpadding="0"
       bgcolor="#a0c0ff" cellspacing="0">
  <tr valign="middle">

  <!-- Tree link -->
      <th>&nbsp;&nbsp;&nbsp;<a
        href="module-tree.html">Trees</a>&nbsp;&nbsp;&nbsp;</th>

  <!-- Index link -->
      <th>&nbsp;&nbsp;&nbsp;<a
        href="identifier-index.html">Indices</a>&nbsp;&nbsp;&nbsp;</th>

  <!-- Help link -->
      <th>&nbsp;&nbsp;&nbsp;<a
        href="help.html">Help</a>&nbsp;&nbsp;&nbsp;</th>

  <!-- Project homepage -->
      <th class="navbar" align="right" width="100%">
        <table border="0" cellpadding="0" cellspacing="0">
          <tr><th class="navbar" align="center"
            >2015-2Schrodinger Python API</th>
          </tr></table></th>
  </tr>
</table>
<table border="0" cellpadding="0" cellspacing="0" width="100%%">
  <tr>
    <td align="left" class="footer">
    Generated by Epydoc 3.0.1 on Sat May  9 06:30:41 2015
    </td>
    <td align="right" class="footer">
      <a target="mainFrame" href="http://epydoc.sourceforge.net"
        >http://epydoc.sourceforge.net</a>
    </td>
  </tr>
</table>

<script type="text/javascript">
  <!--
  // Private objects are initially displayed (because if
  // javascript is turned off then we want them to be
  // visible); but by default, we want to hide them.  So hide
  // them unless we have a cookie that says to show them.
  checkCookie();
  // -->
</script>
</body>
</html>
