<?xml version="1.0" encoding="ascii"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
          "DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head>
  <title>schrodinger.application.glide.ensemble_selection.EnsembleSelection</title>
  <link rel="stylesheet" href="epydoc.css" type="text/css" />
  <script type="text/javascript" src="epydoc.js"></script>
</head>

<body bgcolor="white" text="black" link="blue" vlink="#204080"
      alink="#204080">
<!-- ==================== NAVIGATION BAR ==================== -->
<table class="navbar" border="0" width="100%" cellpadding="0"
       bgcolor="#a0c0ff" cellspacing="0">
  <tr valign="middle">

  <!-- Tree link -->
      <th>&nbsp;&nbsp;&nbsp;<a
        href="module-tree.html">Trees</a>&nbsp;&nbsp;&nbsp;</th>

  <!-- Index link -->
      <th>&nbsp;&nbsp;&nbsp;<a
        href="identifier-index.html">Indices</a>&nbsp;&nbsp;&nbsp;</th>

  <!-- Help link -->
      <th>&nbsp;&nbsp;&nbsp;<a
        href="help.html">Help</a>&nbsp;&nbsp;&nbsp;</th>

  <!-- Project homepage -->
      <th class="navbar" align="right" width="100%">
        <table border="0" cellpadding="0" cellspacing="0">
          <tr><th class="navbar" align="center"
            >2015-2Schrodinger Python API</th>
          </tr></table></th>
  </tr>
</table>
<table width="100%" cellpadding="0" cellspacing="0">
  <tr valign="top">
    <td width="100%">
      <span class="breadcrumbs">
        <a href="schrodinger-module.html">Package&nbsp;schrodinger</a> ::
        <a href="schrodinger.application-module.html">Package&nbsp;application</a> ::
        <a href="schrodinger.application.glide-module.html">Package&nbsp;glide</a> ::
        <a href="schrodinger.application.glide.ensemble_selection-module.html">Module&nbsp;ensemble_selection</a> ::
        Class&nbsp;EnsembleSelection
      </span>
    </td>
    <td>
      <table cellpadding="0" cellspacing="0">
        <!-- hide/show private -->
        <tr><td align="right"><span class="options">[<a href="javascript:void(0);" class="privatelink"
    onclick="toggle_private();">hide&nbsp;private</a>]</span></td></tr>
        <tr><td align="right"><span class="options"
            >[<a href="frames.html" target="_top">frames</a
            >]&nbsp;|&nbsp;<a href="schrodinger.application.glide.ensemble_selection.EnsembleSelection-class.html"
            target="_top">no&nbsp;frames</a>]</span></td></tr>
      </table>
    </td>
  </tr>
</table>
<!-- ==================== CLASS DESCRIPTION ==================== -->
<h1 class="epydoc">Class EnsembleSelection</h1><p class="nomargin-top"></p>
<pre class="base-tree">
<a href="object-class.html">object</a> --+
         |
        <strong class="uidshort">EnsembleSelection</strong>
</pre>

<hr />
<pre class="literalblock">
Objects of this class select the &quot;best&quot;(*) ensembles of a specified size
when given as input the results from an exhaustive cross-docking
calculation on a set of N complexes (i.e., the NxN matrix of GlideScores).

The input can come from a CSV file or can be provided as a dict. The file
reading methods are provided as a convenience and are useful for testing, but
they have their limitations. Hence it is recommended that the data be
provided as dicts when possible.

(*) Two definitions of &quot;best&quot; are available: 1) RMSD vs experimental
DeltaG (see the 'best_ensembles_by_rmsd' method; 2) number of ligands that
can be docked &quot;properly&quot; by at least one receptor in the ensemble ( see
'best_ensembles_by_count'). &quot;Properly&quot; means that that the score is
lower than 'tol' plus the self-docking score for the ligand.

A couple of object attributes are available (should be considered read-only
outside this class):
    * titles
    * N = len(titles)

</pre>

<!-- ==================== INSTANCE METHODS ==================== -->
<a name="section-InstanceMethods"></a>
<table class="summary" border="1" cellpadding="3"
       cellspacing="0" width="100%" bgcolor="white">
<tr bgcolor="#70b0f0" class="table-header">
  <td colspan="2" class="table-header">
    <table border="0" cellpadding="0" cellspacing="0" width="100%">
      <tr valign="top">
        <td align="left"><span class="table-header">Instance Methods</span></td>
        <td align="right" valign="top"
         ><span class="options">[<a href="#section-InstanceMethods"
         class="privatelink" onclick="toggle_private();"
         >hide private</a>]</span></td>
      </tr>
    </table>
  </td>
</tr>
<tr>
    <td width="15%" align="right" valign="top" class="summary">
      <span class="summary-type">&nbsp;</span>
    </td><td class="summary">
      <table width="100%" cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td><span class="summary-sig"><a href="schrodinger.application.glide.ensemble_selection.EnsembleSelection-class.html#__init__" class="summary-sig-name">__init__</a>(<span class="summary-sig-arg">self</span>,
        <span class="summary-sig-arg">gscores</span>=<span class="summary-sig-default">None</span>,
        <span class="summary-sig-arg">exp_dg</span>=<span class="summary-sig-default">None</span>,
        <span class="summary-sig-arg">fname</span>=<span class="summary-sig-default">None</span>,
        <span class="summary-sig-arg">exp_dg_fname</span>=<span class="summary-sig-default">None</span>,
        <span class="summary-sig-arg">structures</span>=<span class="summary-sig-default">None</span>,
        <span class="summary-sig-arg">initial_seed</span>=<span class="summary-sig-default">42</span>,
        <span class="summary-sig-arg">max_exhaustive</span>=<span class="summary-sig-default">1000000</span>,
        <span class="summary-sig-arg">n_random_comb</span>=<span class="summary-sig-default">100000</span>,
        <span class="summary-sig-arg">tol</span>=<span class="summary-sig-default">0.5</span>,
        <span class="summary-sig-arg">docking_failure_penalty</span>=<span class="summary-sig-default">10.0</span>,
        <span class="summary-sig-arg">bad_self_docking_penalty</span>=<span class="summary-sig-default">0.1</span>,
        <span class="summary-sig-arg">self_docking_tolerance</span>=<span class="summary-sig-default">2.0</span>,
        <span class="summary-sig-arg">fixed_titles</span>=<span class="summary-sig-default">None</span>,
        <span class="summary-sig-arg">score_property</span>=<span class="summary-sig-default"><code class="variable-quote">'</code><code class="variable-string">r_i_docking_score</code><code class="variable-quote">'</code></span>)</span><br />
      Constructor optionally takes a few parameters that determine the
behavior of the selection algorithm or that provide the input data.</td>
          <td align="right" valign="top">
            
            
          </td>
        </tr>
      </table>
      
    </td>
  </tr>
<tr>
    <td width="15%" align="right" valign="top" class="summary">
      <span class="summary-type">&nbsp;</span>
    </td><td class="summary">
      <table width="100%" cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td><span class="summary-sig"><a href="schrodinger.application.glide.ensemble_selection.EnsembleSelection-class.html#self_docking_penalty" class="summary-sig-name">self_docking_penalty</a>(<span class="summary-sig-arg">self</span>,
        <span class="summary-sig-arg">comb</span>)</span><br />
      Return the total penalty due to bad self-docking scores in the 
      present combination 'comb'.</td>
          <td align="right" valign="top">
            
            
          </td>
        </tr>
      </table>
      
    </td>
  </tr>
<tr>
    <td width="15%" align="right" valign="top" class="summary">
      <span class="summary-type">&nbsp;</span>
    </td><td class="summary">
      <table width="100%" cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td><span class="summary-sig"><a href="schrodinger.application.glide.ensemble_selection.EnsembleSelection-class.html#rmsd_comb" class="summary-sig-name">rmsd_comb</a>(<span class="summary-sig-arg">self</span>,
        <span class="summary-sig-arg">comb</span>)</span><br />
      Calculate the RMS deviation between experimental DeltaG and the 
      lowest GScore obtained for each ligand using a given combination 
      'comb' of receptors.</td>
          <td align="right" valign="top">
            
            
          </td>
        </tr>
      </table>
      
    </td>
  </tr>
<tr>
    <td width="15%" align="right" valign="top" class="summary">
      <span class="summary-type">&nbsp;</span>
    </td><td class="summary">
      <table width="100%" cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td><span class="summary-sig"><a href="schrodinger.application.glide.ensemble_selection.EnsembleSelection-class.html#score" class="summary-sig-name">score</a>(<span class="summary-sig-arg">self</span>,
        <span class="summary-sig-arg">lig</span>,
        <span class="summary-sig-arg">comb</span>)</span><br />
      Return the score for ligand 'lig' within ensemble 'comb'.</td>
          <td align="right" valign="top">
            
            
          </td>
        </tr>
      </table>
      
    </td>
  </tr>
<tr>
    <td width="15%" align="right" valign="top" class="summary">
      <span class="summary-type">&nbsp;</span>
    </td><td class="summary">
      <table width="100%" cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td><span class="summary-sig"><a href="schrodinger.application.glide.ensemble_selection.EnsembleSelection-class.html#count_good_ligs" class="summary-sig-name">count_good_ligs</a>(<span class="summary-sig-arg">self</span>,
        <span class="summary-sig-arg">comb</span>)</span><br />
      Return the count of ligands that can be docked &quot;properly&quot; 
      by at least one receptor in the given combination 'comb' of 
      receptors.</td>
          <td align="right" valign="top">
            
            
          </td>
        </tr>
      </table>
      
    </td>
  </tr>
<tr>
    <td width="15%" align="right" valign="top" class="summary">
      <span class="summary-type">&nbsp;</span>
    </td><td class="summary">
      <table width="100%" cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td><span class="summary-sig"><a href="schrodinger.application.glide.ensemble_selection.EnsembleSelection-class.html#sample_combinations" class="summary-sig-name">sample_combinations</a>(<span class="summary-sig-arg">self</span>,
        <span class="summary-sig-arg">n</span>)</span><br />
      Return an iterator that produces a random sample of n-element 
      combinations from the list of receptors contained in self.</td>
          <td align="right" valign="top">
            
            
          </td>
        </tr>
      </table>
      
    </td>
  </tr>
<tr>
    <td width="15%" align="right" valign="top" class="summary">
      <span class="summary-type">&nbsp;</span>
    </td><td class="summary">
      <table width="100%" cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td><span class="summary-sig"><a name="check_ensemble_size"></a><span class="summary-sig-name">check_ensemble_size</span>(<span class="summary-sig-arg">self</span>,
        <span class="summary-sig-arg">n</span>)</span></td>
          <td align="right" valign="top">
            
            
          </td>
        </tr>
      </table>
      
    </td>
  </tr>
<tr>
    <td width="15%" align="right" valign="top" class="summary">
      <span class="summary-type">&nbsp;</span>
    </td><td class="summary">
      <table width="100%" cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td><span class="summary-sig"><a href="schrodinger.application.glide.ensemble_selection.EnsembleSelection-class.html#combinations_range" class="summary-sig-name">combinations_range</a>(<span class="summary-sig-arg">self</span>,
        <span class="summary-sig-arg">n1</span>,
        <span class="summary-sig-arg">n2</span>)</span><br />
      Return an iterator that produces combinations containing between n1 
      and n2 elements (both inclusive) from the list of receptors.</td>
          <td align="right" valign="top">
            
            
          </td>
        </tr>
      </table>
      
    </td>
  </tr>
<tr>
    <td width="15%" align="right" valign="top" class="summary">
      <span class="summary-type">&nbsp;</span>
    </td><td class="summary">
      <table width="100%" cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td><span class="summary-sig"><a href="schrodinger.application.glide.ensemble_selection.EnsembleSelection-class.html#combinations" class="summary-sig-name">combinations</a>(<span class="summary-sig-arg">self</span>,
        <span class="summary-sig-arg">n</span>)</span><br />
      Return an iterator that produces n-element combinations from the list
      of receptors contained in self.</td>
          <td align="right" valign="top">
            
            
          </td>
        </tr>
      </table>
      
    </td>
  </tr>
<tr>
    <td width="15%" align="right" valign="top" class="summary">
      <span class="summary-type">&nbsp;</span>
    </td><td class="summary">
      <table width="100%" cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td><span class="summary-sig"><a href="schrodinger.application.glide.ensemble_selection.EnsembleSelection-class.html#best_ensembles" class="summary-sig-name">best_ensembles</a>(<span class="summary-sig-arg">self</span>,
        <span class="summary-sig-arg">n</span>,
        <span class="summary-sig-arg">n2</span>=<span class="summary-sig-default">None</span>,
        <span class="summary-sig-arg">nmax</span>=<span class="summary-sig-default">15</span>,
        <span class="summary-sig-arg">func</span>=<span class="summary-sig-default">None</span>)</span><br />
      Return the 'nmax' best n-member ensembles by the return value of a 
      caller-specified scoring function 'func', which takes a tuple of 
      ensemble members (title strings) and returns a sortable value.</td>
          <td align="right" valign="top">
            
            
          </td>
        </tr>
      </table>
      
    </td>
  </tr>
<tr>
    <td width="15%" align="right" valign="top" class="summary">
      <span class="summary-type">&nbsp;</span>
    </td><td class="summary">
      <table width="100%" cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td><span class="summary-sig"><a href="schrodinger.application.glide.ensemble_selection.EnsembleSelection-class.html#best_ensembles_by_count" class="summary-sig-name">best_ensembles_by_count</a>(<span class="summary-sig-arg">self</span>,
        <span class="summary-sig-arg">n</span>,
        <span class="summary-sig-arg">n2</span>=<span class="summary-sig-default">None</span>,
        <span class="summary-sig-arg">nmax</span>=<span class="summary-sig-default">15</span>)</span><br />
      Return the 'nmax' best n-member ensembles by count of &quot;properly 
      docked ligands&quot; as a list of Ensemble objects.</td>
          <td align="right" valign="top">
            
            
          </td>
        </tr>
      </table>
      
    </td>
  </tr>
<tr>
    <td width="15%" align="right" valign="top" class="summary">
      <span class="summary-type">&nbsp;</span>
    </td><td class="summary">
      <table width="100%" cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td><span class="summary-sig"><a href="schrodinger.application.glide.ensemble_selection.EnsembleSelection-class.html#best_ensembles_by_rmsd" class="summary-sig-name">best_ensembles_by_rmsd</a>(<span class="summary-sig-arg">self</span>,
        <span class="summary-sig-arg">n</span>,
        <span class="summary-sig-arg">n2</span>=<span class="summary-sig-default">None</span>,
        <span class="summary-sig-arg">nmax</span>=<span class="summary-sig-default">15</span>,
        <span class="summary-sig-arg">rmsd_size_penalty</span>=<span class="summary-sig-default">0.1</span>)</span><br />
      Return the 'nmax' best n-member ensembles by RMSD of computed gscore 
      vs exp DeltaG as a list of Ensemble objects.</td>
          <td align="right" valign="top">
            
            
          </td>
        </tr>
      </table>
      
    </td>
  </tr>
<tr>
    <td width="15%" align="right" valign="top" class="summary">
      <span class="summary-type">&nbsp;</span>
    </td><td class="summary">
      <table width="100%" cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td><span class="summary-sig"><a name="self_docking_rmsd"></a><span class="summary-sig-name">self_docking_rmsd</span>(<span class="summary-sig-arg">self</span>)</span><br />
      Return, well, the self-docking rms deviation of GScore vs exp DeltaG.</td>
          <td align="right" valign="top">
            
            
          </td>
        </tr>
      </table>
      
    </td>
  </tr>
<tr>
    <td width="15%" align="right" valign="top" class="summary">
      <span class="summary-type">&nbsp;</span>
    </td><td class="summary">
      <table width="100%" cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td><span class="summary-sig"><a name="count_combinations"></a><span class="summary-sig-name">count_combinations</span>(<span class="summary-sig-arg">self</span>,
        <span class="summary-sig-arg">n</span>)</span><br />
      Return the number of n-member combinations out of the list of N 
      receptors held by the object (i.e., N!/(n! * (N-n)!)).</td>
          <td align="right" valign="top">
            
            
          </td>
        </tr>
      </table>
      
    </td>
  </tr>
<tr>
    <td width="15%" align="right" valign="top" class="summary">
      <span class="summary-type">&nbsp;</span>
    </td><td class="summary">
      <table width="100%" cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td><span class="summary-sig"><a name="count_singletons"></a><span class="summary-sig-name">count_singletons</span>(<span class="summary-sig-arg">self</span>)</span><br />
      Return the number of ligands that get a &quot;good&quot; score with 
      only one receptor.</td>
          <td align="right" valign="top">
            
            
          </td>
        </tr>
      </table>
      
    </td>
  </tr>
<tr>
    <td width="15%" align="right" valign="top" class="summary">
      <span class="summary-type">&nbsp;</span>
    </td><td class="summary">
      <table width="100%" cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td><span class="summary-sig"><a name="set_tol"></a><span class="summary-sig-name">set_tol</span>(<span class="summary-sig-arg">self</span>,
        <span class="summary-sig-arg">tol</span>)</span><br />
      Set the tolerance used for determining whether a ligand is docked 
      &quot;properly&quot; into a receptor.</td>
          <td align="right" valign="top">
            
            
          </td>
        </tr>
      </table>
      
    </td>
  </tr>
<tr class="private">
    <td width="15%" align="right" valign="top" class="summary">
      <span class="summary-type">&nbsp;</span>
    </td><td class="summary">
      <table width="100%" cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td><span class="summary-sig"><a name="_compute_ssets"></a><span class="summary-sig-name">_compute_ssets</span>(<span class="summary-sig-arg">self</span>)</span></td>
          <td align="right" valign="top">
            
            
          </td>
        </tr>
      </table>
      
    </td>
  </tr>
<tr>
    <td width="15%" align="right" valign="top" class="summary">
      <span class="summary-type">&nbsp;</span>
    </td><td class="summary">
      <table width="100%" cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td><span class="summary-sig"><a href="schrodinger.application.glide.ensemble_selection.EnsembleSelection-class.html#set_gscores" class="summary-sig-name">set_gscores</a>(<span class="summary-sig-arg">self</span>,
        <span class="summary-sig-arg">gscores</span>,
        <span class="summary-sig-arg">nocopy</span>=<span class="summary-sig-default">False</span>,
        <span class="summary-sig-arg">fixed_titles</span>=<span class="summary-sig-default">None</span>)</span><br />
      Set the GlideScore matrix.</td>
          <td align="right" valign="top">
            
            
          </td>
        </tr>
      </table>
      
    </td>
  </tr>
<tr>
    <td width="15%" align="right" valign="top" class="summary">
      <span class="summary-type">&nbsp;</span>
    </td><td class="summary">
      <table width="100%" cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td><span class="summary-sig"><a name="set_structures"></a><span class="summary-sig-name">set_structures</span>(<span class="summary-sig-arg">self</span>,
        <span class="summary-sig-arg">structures</span>,
        <span class="summary-sig-arg">score_property</span>=<span class="summary-sig-default"><code class="variable-quote">'</code><code class="variable-string">r_i_docking_score</code><code class="variable-quote">'</code></span>,
        <span class="summary-sig-arg">fixed_titles</span>=<span class="summary-sig-default">None</span>)</span><br />
      Set the self.structures property and use it to update other 
      properties such as gscore, titles, and N.</td>
          <td align="right" valign="top">
            
            
          </td>
        </tr>
      </table>
      
    </td>
  </tr>
<tr>
    <td width="15%" align="right" valign="top" class="summary">
      <span class="summary-type">&nbsp;</span>
    </td><td class="summary">
      <table width="100%" cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td><span class="summary-sig"><a href="schrodinger.application.glide.ensemble_selection.EnsembleSelection-class.html#set_exp_dg" class="summary-sig-name">set_exp_dg</a>(<span class="summary-sig-arg">self</span>,
        <span class="summary-sig-arg">exp_dg</span>)</span><br />
      Set the experimental data used for computing RMSDs.</td>
          <td align="right" valign="top">
            
            
          </td>
        </tr>
      </table>
      
    </td>
  </tr>
<tr>
    <td width="15%" align="right" valign="top" class="summary">
      <span class="summary-type">&nbsp;</span>
    </td><td class="summary">
      <table width="100%" cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td><span class="summary-sig"><a href="schrodinger.application.glide.ensemble_selection.EnsembleSelection-class.html#read_csv" class="summary-sig-name">read_csv</a>(<span class="summary-sig-arg">self</span>,
        <span class="summary-sig-arg">fname</span>,
        <span class="summary-sig-arg">fixed_titles</span>=<span class="summary-sig-default">None</span>)</span><br />
      Import data from a CSV file, which is expected to contain an N*N 
      matrix of GlideScores, plus the titles on the header and on the first
      column.</td>
          <td align="right" valign="top">
            
            
          </td>
        </tr>
      </table>
      
    </td>
  </tr>
<tr>
    <td width="15%" align="right" valign="top" class="summary">
      <span class="summary-type">&nbsp;</span>
    </td><td class="summary">
      <table width="100%" cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td><span class="summary-sig"><a href="schrodinger.application.glide.ensemble_selection.EnsembleSelection-class.html#read_exp_dg" class="summary-sig-name">read_exp_dg</a>(<span class="summary-sig-arg">self</span>,
        <span class="summary-sig-arg">fname</span>)</span><br />
      Read a file with the experimental data.</td>
          <td align="right" valign="top">
            
            
          </td>
        </tr>
      </table>
      
    </td>
  </tr>
  <tr>
    <td colspan="2" class="summary">
    <p class="indent-wrapped-lines"><b>Inherited from <code><a href="object-class.html">object</a></code></b>:
      <code><a href="object-class.html#__delattr__">__delattr__</a></code>,
      <code><a href="object-class.html#__format__">__format__</a></code>,
      <code><a href="object-class.html#__getattribute__">__getattribute__</a></code>,
      <code><a href="object-class.html#__hash__">__hash__</a></code>,
      <code><a href="object-class.html#__new__">__new__</a></code>,
      <code><a href="object-class.html#__reduce__">__reduce__</a></code>,
      <code><a href="object-class.html#__reduce_ex__">__reduce_ex__</a></code>,
      <code><a href="object-class.html#__repr__">__repr__</a></code>,
      <code><a href="object-class.html#__setattr__">__setattr__</a></code>,
      <code><a href="object-class.html#__sizeof__">__sizeof__</a></code>,
      <code><a href="object-class.html#__str__">__str__</a></code>,
      <code><a href="object-class.html#__subclasshook__">__subclasshook__</a></code>
      </p>
    </td>
  </tr>
</table>
<!-- ==================== PROPERTIES ==================== -->
<a name="section-Properties"></a>
<table class="summary" border="1" cellpadding="3"
       cellspacing="0" width="100%" bgcolor="white">
<tr bgcolor="#70b0f0" class="table-header">
  <td colspan="2" class="table-header">
    <table border="0" cellpadding="0" cellspacing="0" width="100%">
      <tr valign="top">
        <td align="left"><span class="table-header">Properties</span></td>
        <td align="right" valign="top"
         ><span class="options">[<a href="#section-Properties"
         class="privatelink" onclick="toggle_private();"
         >hide private</a>]</span></td>
      </tr>
    </table>
  </td>
</tr>
  <tr>
    <td colspan="2" class="summary">
    <p class="indent-wrapped-lines"><b>Inherited from <code><a href="object-class.html">object</a></code></b>:
      <code><a href="object-class.html#__class__">__class__</a></code>
      </p>
    </td>
  </tr>
</table>
<!-- ==================== METHOD DETAILS ==================== -->
<a name="section-MethodDetails"></a>
<table class="details" border="1" cellpadding="3"
       cellspacing="0" width="100%" bgcolor="white">
<tr bgcolor="#70b0f0" class="table-header">
  <td colspan="2" class="table-header">
    <table border="0" cellpadding="0" cellspacing="0" width="100%">
      <tr valign="top">
        <td align="left"><span class="table-header">Method Details</span></td>
        <td align="right" valign="top"
         ><span class="options">[<a href="#section-MethodDetails"
         class="privatelink" onclick="toggle_private();"
         >hide private</a>]</span></td>
      </tr>
    </table>
  </td>
</tr>
</table>
<a name="__init__"></a>
<div>
<table class="details" border="1" cellpadding="3"
       cellspacing="0" width="100%" bgcolor="white">
<tr><td>
  <table width="100%" cellpadding="0" cellspacing="0" border="0">
  <tr valign="top"><td>
  <h3 class="epydoc"><span class="sig"><span class="sig-name">__init__</span>(<span class="sig-arg">self</span>,
        <span class="sig-arg">gscores</span>=<span class="sig-default">None</span>,
        <span class="sig-arg">exp_dg</span>=<span class="sig-default">None</span>,
        <span class="sig-arg">fname</span>=<span class="sig-default">None</span>,
        <span class="sig-arg">exp_dg_fname</span>=<span class="sig-default">None</span>,
        <span class="sig-arg">structures</span>=<span class="sig-default">None</span>,
        <span class="sig-arg">initial_seed</span>=<span class="sig-default">42</span>,
        <span class="sig-arg">max_exhaustive</span>=<span class="sig-default">1000000</span>,
        <span class="sig-arg">n_random_comb</span>=<span class="sig-default">100000</span>,
        <span class="sig-arg">tol</span>=<span class="sig-default">0.5</span>,
        <span class="sig-arg">docking_failure_penalty</span>=<span class="sig-default">10.0</span>,
        <span class="sig-arg">bad_self_docking_penalty</span>=<span class="sig-default">0.1</span>,
        <span class="sig-arg">self_docking_tolerance</span>=<span class="sig-default">2.0</span>,
        <span class="sig-arg">fixed_titles</span>=<span class="sig-default">None</span>,
        <span class="sig-arg">score_property</span>=<span class="sig-default"><code class="variable-quote">'</code><code class="variable-string">r_i_docking_score</code><code class="variable-quote">'</code></span>)</span>
    <br /><em class="fname">(Constructor)</em>
  </h3>
  </td><td align="right" valign="top"
    >&nbsp;
    </td>
  </tr></table>
  
  <pre class="literalblock">
Constructor optionally takes a few parameters that determine the
behavior of the selection algorithm or that provide the input data.
The input data may be provided either as a dict or as a filename to
be parsed.
    * initial_seed: random seed used whenever the random sampling
        method is used. It may be set to None if non-reproducible
        results are desired.
    * max_exhaustive: the maximum number of combinations for a
        systmatic (exhaustive) search of the available combinations.
        When the number of combinations exceeds this number, random
        sampling is used instead.
    * n_random_comb: the number of iterations for random sampling.
    * tol: the tolerance used to determine if a ligand is docked
      &quot;properly&quot;
    * structures: a dict of Structure object to be passed on to the
        set_structures method.
    * gscores: a dict of GlideScores to be passed on to the
        set_gscores method.
    * fname: a filename for a csv file to be passed to the read_csv
        method.
    * exp_dg: a dict of experimental DeltaGs to be passed on to the
        set_exp_dg method.
    * exp_dg_fname: a filename to be passed on to the read_exp method.
    * docking_failure_penalty: the assumed deviation between
        experimental DeltaG and GlideScore when the ligand fails to
        dock into the ensemble under consideration. Used by the
        rmsd_comb method.
    * bad_self_docking_penalty: added to the RMSD of a receptor
        combination for each receptor that self-docks &quot;badly&quot;.
    * self_docking_tolerance: a self-docking is considered bad if
        it has score &gt; exp_dg + self_docking_tolerance.
    * score_property: only used when 'structures' is provided. It is
        the property used as the score for ensemble selection.
    * fixed_titles: titles of receptors that must always be included
        in the ensemble.

</pre>
  <dl class="fields">
    <dt>Overrides:
        object.__init__
    </dt>
  </dl>
</td></tr></table>
</div>
<a name="self_docking_penalty"></a>
<div>
<table class="details" border="1" cellpadding="3"
       cellspacing="0" width="100%" bgcolor="white">
<tr><td>
  <table width="100%" cellpadding="0" cellspacing="0" border="0">
  <tr valign="top"><td>
  <h3 class="epydoc"><span class="sig"><span class="sig-name">self_docking_penalty</span>(<span class="sig-arg">self</span>,
        <span class="sig-arg">comb</span>)</span>
  </h3>
  </td><td align="right" valign="top"
    >&nbsp;
    </td>
  </tr></table>
  
  <p>Return the total penalty due to bad self-docking scores in the present
  combination 'comb'. See __init__ for details.</p>
  <dl class="fields">
  </dl>
</td></tr></table>
</div>
<a name="rmsd_comb"></a>
<div>
<table class="details" border="1" cellpadding="3"
       cellspacing="0" width="100%" bgcolor="white">
<tr><td>
  <table width="100%" cellpadding="0" cellspacing="0" border="0">
  <tr valign="top"><td>
  <h3 class="epydoc"><span class="sig"><span class="sig-name">rmsd_comb</span>(<span class="sig-arg">self</span>,
        <span class="sig-arg">comb</span>)</span>
  </h3>
  </td><td align="right" valign="top"
    >&nbsp;
    </td>
  </tr></table>
  
  <p>Calculate the RMS deviation between experimental DeltaG and the lowest
  GScore obtained for each ligand using a given combination 'comb' of 
  receptors. 'comb' is a tuple of titles. NOTE: ligands that failed to dock
  into all of the receptors in 'comb' count as a deviation of 
  'docking_failure_penalty', as given to the constructor (10.0 kcal/mol by 
  default).</p>
  <dl class="fields">
  </dl>
</td></tr></table>
</div>
<a name="score"></a>
<div>
<table class="details" border="1" cellpadding="3"
       cellspacing="0" width="100%" bgcolor="white">
<tr><td>
  <table width="100%" cellpadding="0" cellspacing="0" border="0">
  <tr valign="top"><td>
  <h3 class="epydoc"><span class="sig"><span class="sig-name">score</span>(<span class="sig-arg">self</span>,
        <span class="sig-arg">lig</span>,
        <span class="sig-arg">comb</span>)</span>
  </h3>
  </td><td align="right" valign="top"
    >&nbsp;
    </td>
  </tr></table>
  
  <p>Return the score for ligand 'lig' within ensemble 'comb'. The default 
  implementation is to return the lowest docking score for lig over all the
  receptors in the ensemble. If the ligand failed to dock or a score can't 
  be computed for some reason, returns None.</p>
  <dl class="fields">
  </dl>
</td></tr></table>
</div>
<a name="count_good_ligs"></a>
<div>
<table class="details" border="1" cellpadding="3"
       cellspacing="0" width="100%" bgcolor="white">
<tr><td>
  <table width="100%" cellpadding="0" cellspacing="0" border="0">
  <tr valign="top"><td>
  <h3 class="epydoc"><span class="sig"><span class="sig-name">count_good_ligs</span>(<span class="sig-arg">self</span>,
        <span class="sig-arg">comb</span>)</span>
  </h3>
  </td><td align="right" valign="top"
    >&nbsp;
    </td>
  </tr></table>
  
  <p>Return the count of ligands that can be docked &quot;properly&quot; by
  at least one receptor in the given combination 'comb' of receptors. 
  'comb' is a tuple of titles.</p>
  <dl class="fields">
  </dl>
</td></tr></table>
</div>
<a name="sample_combinations"></a>
<div>
<table class="details" border="1" cellpadding="3"
       cellspacing="0" width="100%" bgcolor="white">
<tr><td>
  <table width="100%" cellpadding="0" cellspacing="0" border="0">
  <tr valign="top"><td>
  <h3 class="epydoc"><span class="sig"><span class="sig-name">sample_combinations</span>(<span class="sig-arg">self</span>,
        <span class="sig-arg">n</span>)</span>
  </h3>
  </td><td align="right" valign="top"
    >&nbsp;
    </td>
  </tr></table>
  
  <p>Return an iterator that produces a random sample of n-element 
  combinations from the list of receptors contained in self. The iterator 
  will try to produce self.n_random_comb combinations, but it will skip 
  duplicates so the actual number of combinations returned is likely to be 
  smaller.</p>
  <dl class="fields">
  </dl>
</td></tr></table>
</div>
<a name="combinations_range"></a>
<div>
<table class="details" border="1" cellpadding="3"
       cellspacing="0" width="100%" bgcolor="white">
<tr><td>
  <table width="100%" cellpadding="0" cellspacing="0" border="0">
  <tr valign="top"><td>
  <h3 class="epydoc"><span class="sig"><span class="sig-name">combinations_range</span>(<span class="sig-arg">self</span>,
        <span class="sig-arg">n1</span>,
        <span class="sig-arg">n2</span>)</span>
  </h3>
  </td><td align="right" valign="top"
    >&nbsp;
    </td>
  </tr></table>
  
  <p>Return an iterator that produces combinations containing between n1 
  and n2 elements (both inclusive) from the list of receptors. This This is
  basically a loop over self.combinations() from n1 to n2.</p>
  <dl class="fields">
  </dl>
</td></tr></table>
</div>
<a name="combinations"></a>
<div>
<table class="details" border="1" cellpadding="3"
       cellspacing="0" width="100%" bgcolor="white">
<tr><td>
  <table width="100%" cellpadding="0" cellspacing="0" border="0">
  <tr valign="top"><td>
  <h3 class="epydoc"><span class="sig"><span class="sig-name">combinations</span>(<span class="sig-arg">self</span>,
        <span class="sig-arg">n</span>)</span>
  </h3>
  </td><td align="right" valign="top"
    >&nbsp;
    </td>
  </tr></table>
  
  <p>Return an iterator that produces n-element combinations from the list 
  of receptors contained in self. If the number of combinations is less 
  than self.max_exhaustive, a complete list of combinations is produced. If
  it is larger, a random sample is produced by deferring to the 
  sample_combinations method.</p>
  <dl class="fields">
  </dl>
</td></tr></table>
</div>
<a name="best_ensembles"></a>
<div>
<table class="details" border="1" cellpadding="3"
       cellspacing="0" width="100%" bgcolor="white">
<tr><td>
  <table width="100%" cellpadding="0" cellspacing="0" border="0">
  <tr valign="top"><td>
  <h3 class="epydoc"><span class="sig"><span class="sig-name">best_ensembles</span>(<span class="sig-arg">self</span>,
        <span class="sig-arg">n</span>,
        <span class="sig-arg">n2</span>=<span class="sig-default">None</span>,
        <span class="sig-arg">nmax</span>=<span class="sig-default">15</span>,
        <span class="sig-arg">func</span>=<span class="sig-default">None</span>)</span>
  </h3>
  </td><td align="right" valign="top"
    >&nbsp;
    </td>
  </tr></table>
  
  <p>Return the 'nmax' best n-member ensembles by the return value of a 
  caller-specified scoring function 'func', which takes a tuple of ensemble
  members (title strings) and returns a sortable value. If 'n2' is defined,
  then ensembles with sizes ranging from n to n2 are returned. The return 
  value for the function is stored as the 'score' property of each Ensemble
  object returned.</p>
  <dl class="fields">
  </dl>
</td></tr></table>
</div>
<a name="best_ensembles_by_count"></a>
<div>
<table class="details" border="1" cellpadding="3"
       cellspacing="0" width="100%" bgcolor="white">
<tr><td>
  <table width="100%" cellpadding="0" cellspacing="0" border="0">
  <tr valign="top"><td>
  <h3 class="epydoc"><span class="sig"><span class="sig-name">best_ensembles_by_count</span>(<span class="sig-arg">self</span>,
        <span class="sig-arg">n</span>,
        <span class="sig-arg">n2</span>=<span class="sig-default">None</span>,
        <span class="sig-arg">nmax</span>=<span class="sig-default">15</span>)</span>
  </h3>
  </td><td align="right" valign="top"
    >&nbsp;
    </td>
  </tr></table>
  
  <p>Return the 'nmax' best n-member ensembles by count of &quot;properly 
  docked ligands&quot; as a list of Ensemble objects. If 'n2' is defined, 
  then ensembles with sizes ranging from n to n2 are returned.</p>
  <dl class="fields">
  </dl>
</td></tr></table>
</div>
<a name="best_ensembles_by_rmsd"></a>
<div>
<table class="details" border="1" cellpadding="3"
       cellspacing="0" width="100%" bgcolor="white">
<tr><td>
  <table width="100%" cellpadding="0" cellspacing="0" border="0">
  <tr valign="top"><td>
  <h3 class="epydoc"><span class="sig"><span class="sig-name">best_ensembles_by_rmsd</span>(<span class="sig-arg">self</span>,
        <span class="sig-arg">n</span>,
        <span class="sig-arg">n2</span>=<span class="sig-default">None</span>,
        <span class="sig-arg">nmax</span>=<span class="sig-default">15</span>,
        <span class="sig-arg">rmsd_size_penalty</span>=<span class="sig-default">0.1</span>)</span>
  </h3>
  </td><td align="right" valign="top"
    >&nbsp;
    </td>
  </tr></table>
  
  <p>Return the 'nmax' best n-member ensembles by RMSD of computed gscore 
  vs exp DeltaG as a list of Ensemble objects. If 'n2' is defined, then 
  ensembles with sizes ranging from n to n2 are returned. When sorting 
  ensembles, a penalty of rmsd_size_penalty*n is added in order to favor 
  smaller ensembles when possible.</p>
  <dl class="fields">
  </dl>
</td></tr></table>
</div>
<a name="set_gscores"></a>
<div>
<table class="details" border="1" cellpadding="3"
       cellspacing="0" width="100%" bgcolor="white">
<tr><td>
  <table width="100%" cellpadding="0" cellspacing="0" border="0">
  <tr valign="top"><td>
  <h3 class="epydoc"><span class="sig"><span class="sig-name">set_gscores</span>(<span class="sig-arg">self</span>,
        <span class="sig-arg">gscores</span>,
        <span class="sig-arg">nocopy</span>=<span class="sig-default">False</span>,
        <span class="sig-arg">fixed_titles</span>=<span class="sig-default">None</span>)</span>
  </h3>
  </td><td align="right" valign="top"
    >&nbsp;
    </td>
  </tr></table>
  
  <p>Set the GlideScore matrix. 'gscores' must be a dict of dicts, where 
  each value gscores[prot][lig] = gs is the GlideScore from docking lig 
  into prot. Both lig and prot are titles.</p>
  <p>Sets the following public attributes: * titles * N = len(titles)</p>
  <dl class="fields">
  </dl>
</td></tr></table>
</div>
<a name="set_exp_dg"></a>
<div>
<table class="details" border="1" cellpadding="3"
       cellspacing="0" width="100%" bgcolor="white">
<tr><td>
  <table width="100%" cellpadding="0" cellspacing="0" border="0">
  <tr valign="top"><td>
  <h3 class="epydoc"><span class="sig"><span class="sig-name">set_exp_dg</span>(<span class="sig-arg">self</span>,
        <span class="sig-arg">exp_dg</span>)</span>
  </h3>
  </td><td align="right" valign="top"
    >&nbsp;
    </td>
  </tr></table>
  
  <p>Set the experimental data used for computing RMSDs. 'exp_dg' should be
  a dict where the key is a ligand title and the value is the DeltaG.</p>
  <dl class="fields">
  </dl>
</td></tr></table>
</div>
<a name="read_csv"></a>
<div>
<table class="details" border="1" cellpadding="3"
       cellspacing="0" width="100%" bgcolor="white">
<tr><td>
  <table width="100%" cellpadding="0" cellspacing="0" border="0">
  <tr valign="top"><td>
  <h3 class="epydoc"><span class="sig"><span class="sig-name">read_csv</span>(<span class="sig-arg">self</span>,
        <span class="sig-arg">fname</span>,
        <span class="sig-arg">fixed_titles</span>=<span class="sig-default">None</span>)</span>
  </h3>
  </td><td align="right" valign="top"
    >&nbsp;
    </td>
  </tr></table>
  
  <p>Import data from a CSV file, which is expected to contain an N*N 
  matrix of GlideScores, plus the titles on the header and on the first 
  column. Each column corresponds to a receptor and each row corresponds to
  a ligand. The set of ligand titles must be the same as the set of 
  receptor titles. Ligands that failed to dock can be represented int the 
  file either as a blank field or by the string &quot;NA&quot;.</p>
  <dl class="fields">
  </dl>
</td></tr></table>
</div>
<a name="read_exp_dg"></a>
<div>
<table class="details" border="1" cellpadding="3"
       cellspacing="0" width="100%" bgcolor="white">
<tr><td>
  <table width="100%" cellpadding="0" cellspacing="0" border="0">
  <tr valign="top"><td>
  <h3 class="epydoc"><span class="sig"><span class="sig-name">read_exp_dg</span>(<span class="sig-arg">self</span>,
        <span class="sig-arg">fname</span>)</span>
  </h3>
  </td><td align="right" valign="top"
    >&nbsp;
    </td>
  </tr></table>
  
  <pre class="literalblock">
Read a file with the experimental data. The text file has two
whitespace-separated columns:
    1) title
    2) DeltaG

</pre>
  <dl class="fields">
  </dl>
</td></tr></table>
</div>
<br />
<!-- ==================== NAVIGATION BAR ==================== -->
<table class="navbar" border="0" width="100%" cellpadding="0"
       bgcolor="#a0c0ff" cellspacing="0">
  <tr valign="middle">

  <!-- Tree link -->
      <th>&nbsp;&nbsp;&nbsp;<a
        href="module-tree.html">Trees</a>&nbsp;&nbsp;&nbsp;</th>

  <!-- Index link -->
      <th>&nbsp;&nbsp;&nbsp;<a
        href="identifier-index.html">Indices</a>&nbsp;&nbsp;&nbsp;</th>

  <!-- Help link -->
      <th>&nbsp;&nbsp;&nbsp;<a
        href="help.html">Help</a>&nbsp;&nbsp;&nbsp;</th>

  <!-- Project homepage -->
      <th class="navbar" align="right" width="100%">
        <table border="0" cellpadding="0" cellspacing="0">
          <tr><th class="navbar" align="center"
            >2015-2Schrodinger Python API</th>
          </tr></table></th>
  </tr>
</table>
<table border="0" cellpadding="0" cellspacing="0" width="100%%">
  <tr>
    <td align="left" class="footer">
    Generated by Epydoc 3.0.1 on Sat May  9 06:31:11 2015
    </td>
    <td align="right" class="footer">
      <a target="mainFrame" href="http://epydoc.sourceforge.net"
        >http://epydoc.sourceforge.net</a>
    </td>
  </tr>
</table>

<script type="text/javascript">
  <!--
  // Private objects are initially displayed (because if
  // javascript is turned off then we want them to be
  // visible); but by default, we want to hide them.  So hide
  // them unless we have a cookie that says to show them.
  checkCookie();
  // -->
</script>
</body>
</html>
