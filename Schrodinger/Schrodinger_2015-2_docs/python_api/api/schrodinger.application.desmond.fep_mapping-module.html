<?xml version="1.0" encoding="ascii"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
          "DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head>
  <title>schrodinger.application.desmond.fep_mapping</title>
  <link rel="stylesheet" href="epydoc.css" type="text/css" />
  <script type="text/javascript" src="epydoc.js"></script>
</head>

<body bgcolor="white" text="black" link="blue" vlink="#204080"
      alink="#204080">
<!-- ==================== NAVIGATION BAR ==================== -->
<table class="navbar" border="0" width="100%" cellpadding="0"
       bgcolor="#a0c0ff" cellspacing="0">
  <tr valign="middle">

  <!-- Tree link -->
      <th>&nbsp;&nbsp;&nbsp;<a
        href="module-tree.html">Trees</a>&nbsp;&nbsp;&nbsp;</th>

  <!-- Index link -->
      <th>&nbsp;&nbsp;&nbsp;<a
        href="identifier-index.html">Indices</a>&nbsp;&nbsp;&nbsp;</th>

  <!-- Help link -->
      <th>&nbsp;&nbsp;&nbsp;<a
        href="help.html">Help</a>&nbsp;&nbsp;&nbsp;</th>

  <!-- Project homepage -->
      <th class="navbar" align="right" width="100%">
        <table border="0" cellpadding="0" cellspacing="0">
          <tr><th class="navbar" align="center"
            >2015-2Schrodinger Python API</th>
          </tr></table></th>
  </tr>
</table>
<table width="100%" cellpadding="0" cellspacing="0">
  <tr valign="top">
    <td width="100%">
      <span class="breadcrumbs">
        <a href="schrodinger-module.html">Package&nbsp;schrodinger</a> ::
        <a href="schrodinger.application-module.html">Package&nbsp;application</a> ::
        <a href="schrodinger.application.desmond-module.html">Package&nbsp;desmond</a> ::
        Module&nbsp;fep_mapping
      </span>
    </td>
    <td>
      <table cellpadding="0" cellspacing="0">
        <!-- hide/show private -->
        <tr><td align="right"><span class="options">[<a href="javascript:void(0);" class="privatelink"
    onclick="toggle_private();">hide&nbsp;private</a>]</span></td></tr>
        <tr><td align="right"><span class="options"
            >[<a href="frames.html" target="_top">frames</a
            >]&nbsp;|&nbsp;<a href="schrodinger.application.desmond.fep_mapping-module.html"
            target="_top">no&nbsp;frames</a>]</span></td></tr>
      </table>
    </td>
  </tr>
</table>
<!-- ==================== MODULE DESCRIPTION ==================== -->
<h1 class="epydoc">Module fep_mapping</h1><p class="nomargin-top"></p>
<!-- ==================== CLASSES ==================== -->
<a name="section-Classes"></a>
<table class="summary" border="1" cellpadding="3"
       cellspacing="0" width="100%" bgcolor="white">
<tr bgcolor="#70b0f0" class="table-header">
  <td colspan="2" class="table-header">
    <table border="0" cellpadding="0" cellspacing="0" width="100%">
      <tr valign="top">
        <td align="left"><span class="table-header">Classes</span></td>
        <td align="right" valign="top"
         ><span class="options">[<a href="#section-Classes"
         class="privatelink" onclick="toggle_private();"
         >hide private</a>]</span></td>
      </tr>
    </table>
  </td>
</tr>
<tr>
    <td width="15%" align="right" valign="top" class="summary">
      <span class="summary-type">&nbsp;</span>
    </td><td class="summary">
        <a href="schrodinger.application.desmond.fep_mapping.AtomMappingData-class.html" class="summary-name">AtomMappingData</a><br />
      Class to store intermediary and final data structures for atom 
        mapping
    </td>
  </tr>
</table>
<!-- ==================== FUNCTIONS ==================== -->
<a name="section-Functions"></a>
<table class="summary" border="1" cellpadding="3"
       cellspacing="0" width="100%" bgcolor="white">
<tr bgcolor="#70b0f0" class="table-header">
  <td colspan="2" class="table-header">
    <table border="0" cellpadding="0" cellspacing="0" width="100%">
      <tr valign="top">
        <td align="left"><span class="table-header">Functions</span></td>
        <td align="right" valign="top"
         ><span class="options">[<a href="#section-Functions"
         class="privatelink" onclick="toggle_private();"
         >hide private</a>]</span></td>
      </tr>
    </table>
  </td>
</tr>
<tr>
    <td width="15%" align="right" valign="top" class="summary">
      <span class="summary-type">&nbsp;</span>
    </td><td class="summary">
      <table width="100%" cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td><span class="summary-sig"><a name="cleanup"></a><span class="summary-sig-name">cleanup</span>(<span class="summary-sig-arg">topdir</span>=<span class="summary-sig-default">None</span>)</span><br />
      Cleanup function to be run atexit</td>
          <td align="right" valign="top">
            
            
          </td>
        </tr>
      </table>
      
    </td>
  </tr>
<tr>
    <td width="15%" align="right" valign="top" class="summary">
      <span class="summary-type">&nbsp;</span>
    </td><td class="summary">
      <table width="100%" cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td><span class="summary-sig"><a href="schrodinger.application.desmond.fep_mapping-module.html#map_core_hydrogen" class="summary-sig-name">map_core_hydrogen</a>(<span class="summary-sig-arg">source_ct</span>,
        <span class="summary-sig-arg">dest_ct</span>,
        <span class="summary-sig-arg">core_map</span>,
        <span class="summary-sig-arg">s_remaining_indices</span>,
        <span class="summary-sig-arg">d_remaining_indices</span>)</span><br />
      Mapping hydrogen atoms connected to the core.</td>
          <td align="right" valign="top">
            
            
          </td>
        </tr>
      </table>
      
    </td>
  </tr>
<tr>
    <td width="15%" align="right" valign="top" class="summary">
      <span class="summary-type">&nbsp;</span>
    </td><td class="summary">
      <table width="100%" cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td><span class="summary-sig"><a name="find_fragment_by_cond"></a><span class="summary-sig-name">find_fragment_by_cond</span>(<span class="summary-sig-arg">bridge_atom</span>,
        <span class="summary-sig-arg">cond</span>)</span></td>
          <td align="right" valign="top">
            
            
          </td>
        </tr>
      </table>
      
    </td>
  </tr>
<tr>
    <td width="15%" align="right" valign="top" class="summary">
      <span class="summary-type">&nbsp;</span>
    </td><td class="summary">
      <table width="100%" cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td><span class="summary-sig"><a href="schrodinger.application.desmond.fep_mapping-module.html#find_noncore_fragment" class="summary-sig-name">find_noncore_fragment</a>(<span class="summary-sig-arg">bridge_atom</span>,
        <span class="summary-sig-arg">core_atom_indices</span>)</span><br />
      Finding non-core fragment from bridged</td>
          <td align="right" valign="top">
            
            
          </td>
        </tr>
      </table>
      
    </td>
  </tr>
<tr>
    <td width="15%" align="right" valign="top" class="summary">
      <span class="summary-type">&nbsp;</span>
    </td><td class="summary">
      <table width="100%" cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td><span class="summary-sig"><a href="schrodinger.application.desmond.fep_mapping-module.html#find_noncore_subfragment" class="summary-sig-name">find_noncore_subfragment</a>(<span class="summary-sig-arg">bridge_atom</span>,
        <span class="summary-sig-arg">core_atom_indices</span>,
        <span class="summary-sig-arg">frag_atom_indices</span>)</span><br />
      Finding non-core fragment from bridged</td>
          <td align="right" valign="top">
            
            
          </td>
        </tr>
      </table>
      
    </td>
  </tr>
<tr>
    <td width="15%" align="right" valign="top" class="summary">
      <span class="summary-type">&nbsp;</span>
    </td><td class="summary">
      <table width="100%" cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td><span class="summary-sig"><a name="find_all_fragment_pairs"></a><span class="summary-sig-name">find_all_fragment_pairs</span>(<span class="summary-sig-arg">source_ct</span>,
        <span class="summary-sig-arg">dest_ct</span>,
        <span class="summary-sig-arg">attachment_points</span>,
        <span class="summary-sig-arg">core_atom_indices</span>)</span></td>
          <td align="right" valign="top">
            
            
          </td>
        </tr>
      </table>
      
    </td>
  </tr>
<tr>
    <td width="15%" align="right" valign="top" class="summary">
      <span class="summary-type">&nbsp;</span>
    </td><td class="summary">
      <table width="100%" cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td><span class="summary-sig"><a href="schrodinger.application.desmond.fep_mapping-module.html#get_atom_mapping" class="summary-sig-name">get_atom_mapping</a>(<span class="summary-sig-arg">data</span>)</span><br />
      mapping atoms based on the result from RGA</td>
          <td align="right" valign="top">
            
            
          </td>
        </tr>
      </table>
      
    </td>
  </tr>
<tr>
    <td width="15%" align="right" valign="top" class="summary">
      <span class="summary-type">&nbsp;</span>
    </td><td class="summary">
      <table width="100%" cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td><span class="summary-sig"><a href="schrodinger.application.desmond.fep_mapping-module.html#get_fepio_atom_mapping" class="summary-sig-name">get_fepio_atom_mapping</a>(<span class="summary-sig-arg">atom_mapping</span>)</span><br />
      converting to atom mapping format required by mmfepio library.</td>
          <td align="right" valign="top">
            
            
          </td>
        </tr>
      </table>
      
    </td>
  </tr>
<tr>
    <td width="15%" align="right" valign="top" class="summary">
      <span class="summary-type">&nbsp;</span>
    </td><td class="summary">
      <table width="100%" cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td><span class="summary-sig"><a name="fragment_size_cond"></a><span class="summary-sig-name">fragment_size_cond</span>(<span class="summary-sig-arg">frag1</span>,
        <span class="summary-sig-arg">frag2</span>,
        <span class="summary-sig-arg">threshold</span>=<span class="summary-sig-default">10</span>)</span></td>
          <td align="right" valign="top">
            
            
          </td>
        </tr>
      </table>
      
    </td>
  </tr>
<tr>
    <td width="15%" align="right" valign="top" class="summary">
      <span class="summary-type">&nbsp;</span>
    </td><td class="summary">
      <table width="100%" cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td><span class="summary-sig"><a name="heavy_atom_num_cond"></a><span class="summary-sig-name">heavy_atom_num_cond</span>(<span class="summary-sig-arg">frag1</span>,
        <span class="summary-sig-arg">frag2</span>,
        <span class="summary-sig-arg">threshold</span>=<span class="summary-sig-default">7</span>)</span></td>
          <td align="right" valign="top">
            
            
          </td>
        </tr>
      </table>
      
    </td>
  </tr>
<tr>
    <td width="15%" align="right" valign="top" class="summary">
      <span class="summary-type">&nbsp;</span>
    </td><td class="summary">
      <table width="100%" cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td><span class="summary-sig"><a name="get_heavy_fragment"></a><span class="summary-sig-name">get_heavy_fragment</span>(<span class="summary-sig-arg">frag</span>)</span></td>
          <td align="right" valign="top">
            
            
          </td>
        </tr>
      </table>
      
    </td>
  </tr>
<tr>
    <td width="15%" align="right" valign="top" class="summary">
      <span class="summary-type">&nbsp;</span>
    </td><td class="summary">
      <table width="100%" cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td><span class="summary-sig"><a name="find_fragment_MCS"></a><span class="summary-sig-name">find_fragment_MCS</span>(<span class="summary-sig-arg">data</span>,
        <span class="summary-sig-arg">cond</span>=<span class="summary-sig-default">&lt;function heavy_atom_num_cond at 0x125d5578&gt;</span>,
        <span class="summary-sig-arg">atomtype</span>=<span class="summary-sig-default">11</span>)</span><br />
      Finding MCS in fragment if the fragment pair satisfied specified 
      conditions.</td>
          <td align="right" valign="top">
            
            
          </td>
        </tr>
      </table>
      
    </td>
  </tr>
<tr>
    <td width="15%" align="right" valign="top" class="summary">
      <span class="summary-type">&nbsp;</span>
    </td><td class="summary">
      <table width="100%" cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td><span class="summary-sig"><a href="schrodinger.application.desmond.fep_mapping-module.html#convert_rga_data" class="summary-sig-name">convert_rga_data</a>(<span class="summary-sig-arg">rga_data</span>,
        <span class="summary-sig-arg">input_file</span>)</span><br />
      Converting RGA internal data to AtomMappingData object</td>
          <td align="right" valign="top">
            
            
          </td>
        </tr>
      </table>
      
    </td>
  </tr>
<tr>
    <td width="15%" align="right" valign="top" class="summary">
      <span class="summary-type">&nbsp;</span>
    </td><td class="summary">
      <table width="100%" cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td><span class="summary-sig"><a name="convert_data"></a><span class="summary-sig-name">convert_data</span>(<span class="summary-sig-arg">source_ct</span>,
        <span class="summary-sig-arg">dest_ct</span>,
        <span class="summary-sig-arg">source_core_atoms</span>,
        <span class="summary-sig-arg">dest_core_atoms</span>,
        <span class="summary-sig-arg">source_attachments</span>,
        <span class="summary-sig-arg">dest_attachments</span>)</span><br />
      source_ct: dest_ct: source_core_atoms: list of source core atoms 
      dest_core_atoms: list of dest core atoms source_attachments: list of 
      source attachment points dest_attachments: list of dest attachment 
      points</td>
          <td align="right" valign="top">
            
            
          </td>
        </tr>
      </table>
      
    </td>
  </tr>
<tr>
    <td width="15%" align="right" valign="top" class="summary">
      <span class="summary-type">&nbsp;</span>
    </td><td class="summary">
      <table width="100%" cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td><span class="summary-sig"><a name="get_atom_mapping_data"></a><span class="summary-sig-name">get_atom_mapping_data</span>(<span class="summary-sig-arg">input_file</span>,
        <span class="summary-sig-arg">atomtype</span>=<span class="summary-sig-default">11</span>)</span></td>
          <td align="right" valign="top">
            
            
          </td>
        </tr>
      </table>
      
    </td>
  </tr>
<tr>
    <td width="15%" align="right" valign="top" class="summary">
      <span class="summary-type">&nbsp;</span>
    </td><td class="summary">
      <table width="100%" cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td><span class="summary-sig"><a name="run_rga"></a><span class="summary-sig-name">run_rga</span>(<span class="summary-sig-arg">input_file</span>,
        <span class="summary-sig-arg">atomtype</span>=<span class="summary-sig-default">11</span>)</span></td>
          <td align="right" valign="top">
            
            
          </td>
        </tr>
      </table>
      
    </td>
  </tr>
<tr>
    <td width="15%" align="right" valign="top" class="summary">
      <span class="summary-type">&nbsp;</span>
    </td><td class="summary">
      <table width="100%" cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td><span class="summary-sig"><a name="unique_list"></a><span class="summary-sig-name">unique_list</span>(<span class="summary-sig-arg">seq</span>,
        <span class="summary-sig-arg">idfun</span>=<span class="summary-sig-default">None</span>)</span><br />
      A fast function to remove duplicate element from sequence by 
      preserving the order at the same time.</td>
          <td align="right" valign="top">
            
            
          </td>
        </tr>
      </table>
      
    </td>
  </tr>
<tr>
    <td width="15%" align="right" valign="top" class="summary">
      <span class="summary-type">&nbsp;</span>
    </td><td class="summary">
      <table width="100%" cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td><span class="summary-sig"><a name="get_atom_marking"></a><span class="summary-sig-name">get_atom_marking</span>(<span class="summary-sig-arg">data</span>,
        <span class="summary-sig-arg">output_file</span>)</span></td>
          <td align="right" valign="top">
            
            
          </td>
        </tr>
      </table>
      
    </td>
  </tr>
<tr>
    <td width="15%" align="right" valign="top" class="summary">
      <span class="summary-type">&nbsp;</span>
    </td><td class="summary">
      <table width="100%" cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td><span class="summary-sig"><a name="get_bridge_atoms"></a><span class="summary-sig-name">get_bridge_atoms</span>(<span class="summary-sig-arg">data</span>)</span></td>
          <td align="right" valign="top">
            
            
          </td>
        </tr>
      </table>
      
    </td>
  </tr>
<tr>
    <td width="15%" align="right" valign="top" class="summary">
      <span class="summary-type">&nbsp;</span>
    </td><td class="summary">
      <table width="100%" cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td><span class="summary-sig"><a name="check_mapping"></a><span class="summary-sig-name">check_mapping</span>(<span class="summary-sig-arg">data</span>,
        <span class="summary-sig-arg">n1</span>,
        <span class="summary-sig-arg">n2</span>)</span></td>
          <td align="right" valign="top">
            
            
          </td>
        </tr>
      </table>
      
    </td>
  </tr>
<tr>
    <td width="15%" align="right" valign="top" class="summary">
      <span class="summary-type">&nbsp;</span>
    </td><td class="summary">
      <table width="100%" cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td><span class="summary-sig"><a href="schrodinger.application.desmond.fep_mapping-module.html#reorder_st" class="summary-sig-name">reorder_st</a>(<span class="summary-sig-arg">st</span>,
        <span class="summary-sig-arg">index_map</span>)</span></td>
          <td align="right" valign="top">
            
            
          </td>
        </tr>
      </table>
      
    </td>
  </tr>
<tr>
    <td width="15%" align="right" valign="top" class="summary">
      <span class="summary-type">&nbsp;</span>
    </td><td class="summary">
      <table width="100%" cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td><span class="summary-sig"><a name="is_ring_open_or_closed"></a><span class="summary-sig-name">is_ring_open_or_closed</span>(<span class="summary-sig-arg">s_frag_indices</span>,
        <span class="summary-sig-arg">d_frag_indices</span>,
        <span class="summary-sig-arg">s2d_bridge_atom</span>,
        <span class="summary-sig-arg">d2s_bridge_atom</span>)</span></td>
          <td align="right" valign="top">
            
            
          </td>
        </tr>
      </table>
      
    </td>
  </tr>
<tr>
    <td width="15%" align="right" valign="top" class="summary">
      <span class="summary-type">&nbsp;</span>
    </td><td class="summary">
      <table width="100%" cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td><span class="summary-sig"><a name="write_fepsubst_to_file"></a><span class="summary-sig-name">write_fepsubst_to_file</span>(<span class="summary-sig-arg">data</span>,
        <span class="summary-sig-arg">filename</span>,
        <span class="summary-sig-arg">overwrite</span>=<span class="summary-sig-default">True</span>)</span></td>
          <td align="right" valign="top">
            
            
          </td>
        </tr>
      </table>
      
    </td>
  </tr>
<tr>
    <td width="15%" align="right" valign="top" class="summary">
      <span class="summary-type">&nbsp;</span>
    </td><td class="summary">
      <table width="100%" cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td><span class="summary-sig"><a name="reorder_atoms"></a><span class="summary-sig-name">reorder_atoms</span>(<span class="summary-sig-arg">data</span>,
        <span class="summary-sig-arg">source_ct</span>,
        <span class="summary-sig-arg">dest_ct</span>)</span></td>
          <td align="right" valign="top">
            
            
          </td>
        </tr>
      </table>
      
    </td>
  </tr>
<tr>
    <td width="15%" align="right" valign="top" class="summary">
      <span class="summary-type">&nbsp;</span>
    </td><td class="summary">
      <table width="100%" cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td><span class="summary-sig"><a name="check1_subst_code"></a><span class="summary-sig-name">check1_subst_code</span>(<span class="summary-sig-arg">source_ct</span>,
        <span class="summary-sig-arg">dest_ct</span>)</span><br />
      take input cts and check single ring-atom/attachment subst_code, 
      return true if pass</td>
          <td align="right" valign="top">
            
            
          </td>
        </tr>
      </table>
      
    </td>
  </tr>
<tr>
    <td width="15%" align="right" valign="top" class="summary">
      <span class="summary-type">&nbsp;</span>
    </td><td class="summary">
      <table width="100%" cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td><span class="summary-sig"><a name="random_shuffle"></a><span class="summary-sig-name">random_shuffle</span>(<span class="summary-sig-arg">data</span>,
        <span class="summary-sig-arg">atomtype</span>)</span><br />
      generate atommap with random shuffled atom order, return atommaps in 
      original order</td>
          <td align="right" valign="top">
            
            
          </td>
        </tr>
      </table>
      
    </td>
  </tr>
<tr class="private">
    <td width="15%" align="right" valign="top" class="summary">
      <span class="summary-type">&nbsp;</span>
    </td><td class="summary">
      <table width="100%" cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td><span class="summary-sig"><a href="schrodinger.application.desmond.fep_mapping-module.html#__raw_fepsubst" class="summary-sig-name" onclick="show_private();">__raw_fepsubst</a>(<span class="summary-sig-arg">mol</span>,
        <span class="summary-sig-arg">noncore</span>,
        <span class="summary-sig-arg">cor</span>,
        <span class="summary-sig-arg">non</span>)</span><br />
      Assigns raw fep_subst code to the given molecule.</td>
          <td align="right" valign="top">
            
            
          </td>
        </tr>
      </table>
      
    </td>
  </tr>
<tr class="private">
    <td width="15%" align="right" valign="top" class="summary">
      <span class="summary-type">&nbsp;</span>
    </td><td class="summary">
      <table width="100%" cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td><span class="summary-sig"><a name="__is_dummy"></a><span class="summary-sig-name">__is_dummy</span>(<span class="summary-sig-arg">atom</span>)</span><br />
      Returns true if this atom can become a dummy atom in an alchemical 
      FEP mutation, or false if not.</td>
          <td align="right" valign="top">
            
            
          </td>
        </tr>
      </table>
      
    </td>
  </tr>
<tr class="private">
    <td width="15%" align="right" valign="top" class="summary">
      <span class="summary-type">&nbsp;</span>
    </td><td class="summary">
      <table width="100%" cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td><span class="summary-sig"><a href="schrodinger.application.desmond.fep_mapping-module.html#__fix_97atoms" class="summary-sig-name" onclick="show_private();">__fix_97atoms</a>(<span class="summary-sig-arg">mol</span>)</span><br />
      We loop through all &lt;97&gt; atoms and check if a &lt;97&gt; atom 
      is connected to more than 1 physical-physical hybrid atoms.</td>
          <td align="right" valign="top">
            
            
          </td>
        </tr>
      </table>
      
    </td>
  </tr>
<tr class="private">
    <td width="15%" align="right" valign="top" class="summary">
      <span class="summary-type">&nbsp;</span>
    </td><td class="summary">
      <table width="100%" cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td><span class="summary-sig"><a href="schrodinger.application.desmond.fep_mapping-module.html#__fix_99atoms" class="summary-sig-name" onclick="show_private();">__fix_99atoms</a>(<span class="summary-sig-arg">atom98</span>,
        <span class="summary-sig-arg">code98</span>,
        <span class="summary-sig-arg">atom99_set</span>)</span><br />
      This function reassigns the 'fep_subst' code for &lt;99&gt; atoms 
      that are bonded to the given &lt;98&gt; atom.</td>
          <td align="right" valign="top">
            
            
          </td>
        </tr>
      </table>
      
    </td>
  </tr>
<tr>
    <td width="15%" align="right" valign="top" class="summary">
      <span class="summary-type">&nbsp;</span>
    </td><td class="summary">
      <table width="100%" cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td><span class="summary-sig"><a name="get_subst_from_mapping"></a><span class="summary-sig-name">get_subst_from_mapping</span>(<span class="summary-sig-arg">mol0</span>,
        <span class="summary-sig-arg">mol1</span>)</span><br />
      Given two CTs: <code>ct0</code> and <code>ct1</code>, with 
      <code>i_fep_mapping</code> atom properties properly set for all atoms
      of <code>ct1</code>, sets the <code>i_fep_subst</code> atom 
      properties for both CTs.</td>
          <td align="right" valign="top">
            
            
          </td>
        </tr>
      </table>
      
    </td>
  </tr>
</table>
<!-- ==================== VARIABLES ==================== -->
<a name="section-Variables"></a>
<table class="summary" border="1" cellpadding="3"
       cellspacing="0" width="100%" bgcolor="white">
<tr bgcolor="#70b0f0" class="table-header">
  <td colspan="2" class="table-header">
    <table border="0" cellpadding="0" cellspacing="0" width="100%">
      <tr valign="top">
        <td align="left"><span class="table-header">Variables</span></td>
        <td align="right" valign="top"
         ><span class="options">[<a href="#section-Variables"
         class="privatelink" onclick="toggle_private();"
         >hide private</a>]</span></td>
      </tr>
    </table>
  </td>
</tr>
<tr>
    <td width="15%" align="right" valign="top" class="summary">
      <span class="summary-type">&nbsp;</span>
    </td><td class="summary">
        <a name="logger"></a><span class="summary-name">logger</span> = <code title="log.get_output_logger(name= &quot;fep_mapping&quot;)">log.get_output_logger(name= &quot;fep_mapping&quot;)</code>
    </td>
  </tr>
<tr>
    <td width="15%" align="right" valign="top" class="summary">
      <span class="summary-type">&nbsp;</span>
    </td><td class="summary">
        <a name="schrod_tmp"></a><span class="summary-name">schrod_tmp</span> = <code title="'/home/buildbot/.schrodinger/tmp'"><code class="variable-quote">'</code><code class="variable-string">/home/buildbot/.schrodinger/tmp</code><code class="variable-quote">'</code></code>
    </td>
  </tr>
<tr>
    <td width="15%" align="right" valign="top" class="summary">
      <span class="summary-type">&nbsp;</span>
    </td><td class="summary">
        <a href="schrodinger.application.desmond.fep_mapping-module.html#TEMP_DIR" class="summary-name">TEMP_DIR</a> = <code title="'/home/buildbot/.schrodinger/tmp/fep-mapping-tmpQTcBNM'"><code class="variable-quote">'</code><code class="variable-string">/home/buildbot/.schrodinger/tmp/fep-mapping-tmpQTc</code><code class="variable-ellipsis">...</code></code>
    </td>
  </tr>
<tr>
    <td width="15%" align="right" valign="top" class="summary">
      <span class="summary-type">&nbsp;</span>
    </td><td class="summary">
        <a name="FRAGMENT_SIZE_THRESHOLD"></a><span class="summary-name">FRAGMENT_SIZE_THRESHOLD</span> = <code title="10">10</code>
    </td>
  </tr>
<tr>
    <td width="15%" align="right" valign="top" class="summary">
      <span class="summary-type">&nbsp;</span>
    </td><td class="summary">
        <a name="HEAVY_ATOM_NUM_THERESHOLD"></a><span class="summary-name">HEAVY_ATOM_NUM_THERESHOLD</span> = <code title="7">7</code>
    </td>
  </tr>
<tr>
    <td width="15%" align="right" valign="top" class="summary">
      <span class="summary-type">&nbsp;</span>
    </td><td class="summary">
        <a name="FEP_MAPPING_ORIGINAL_INDEX"></a><span class="summary-name">FEP_MAPPING_ORIGINAL_INDEX</span> = <code title="'i_fep_mapping_origial_index'"><code class="variable-quote">'</code><code class="variable-string">i_fep_mapping_origial_index</code><code class="variable-quote">'</code></code>
    </td>
  </tr>
<tr>
    <td width="15%" align="right" valign="top" class="summary">
      <span class="summary-type">&nbsp;</span>
    </td><td class="summary">
        <a name="FEP_MAPPING_BRIDGE"></a><span class="summary-name">FEP_MAPPING_BRIDGE</span> = <code title="'i_fep_mapping_bridge'"><code class="variable-quote">'</code><code class="variable-string">i_fep_mapping_bridge</code><code class="variable-quote">'</code></code>
    </td>
  </tr>
<tr>
    <td width="15%" align="right" valign="top" class="summary">
      <span class="summary-type">&nbsp;</span>
    </td><td class="summary">
        <a name="DEFAULT_ATOM_TYPE"></a><span class="summary-name">DEFAULT_ATOM_TYPE</span> = <code title="11">11</code>
    </td>
  </tr>
<tr>
    <td width="15%" align="right" valign="top" class="summary">
      <span class="summary-type">&nbsp;</span>
    </td><td class="summary">
        <a name="__package__"></a><span class="summary-name">__package__</span> = <code title="'schrodinger.application.desmond'"><code class="variable-quote">'</code><code class="variable-string">schrodinger.application.desmond</code><code class="variable-quote">'</code></code>
    </td>
  </tr>
</table>
<!-- ==================== FUNCTION DETAILS ==================== -->
<a name="section-FunctionDetails"></a>
<table class="details" border="1" cellpadding="3"
       cellspacing="0" width="100%" bgcolor="white">
<tr bgcolor="#70b0f0" class="table-header">
  <td colspan="2" class="table-header">
    <table border="0" cellpadding="0" cellspacing="0" width="100%">
      <tr valign="top">
        <td align="left"><span class="table-header">Function Details</span></td>
        <td align="right" valign="top"
         ><span class="options">[<a href="#section-FunctionDetails"
         class="privatelink" onclick="toggle_private();"
         >hide private</a>]</span></td>
      </tr>
    </table>
  </td>
</tr>
</table>
<a name="map_core_hydrogen"></a>
<div>
<table class="details" border="1" cellpadding="3"
       cellspacing="0" width="100%" bgcolor="white">
<tr><td>
  <table width="100%" cellpadding="0" cellspacing="0" border="0">
  <tr valign="top"><td>
  <h3 class="epydoc"><span class="sig"><span class="sig-name">map_core_hydrogen</span>(<span class="sig-arg">source_ct</span>,
        <span class="sig-arg">dest_ct</span>,
        <span class="sig-arg">core_map</span>,
        <span class="sig-arg">s_remaining_indices</span>,
        <span class="sig-arg">d_remaining_indices</span>)</span>
  </h3>
  </td><td align="right" valign="top"
    >&nbsp;
    </td>
  </tr></table>
  
  <p>Mapping hydrogen atoms connected to the core. The number of hydrogen 
  atoms connected to the corresponding atoms should be equal except the 
  core atoms which have attachment.</p>
  <dl class="fields">
  </dl>
</td></tr></table>
</div>
<a name="find_noncore_fragment"></a>
<div>
<table class="details" border="1" cellpadding="3"
       cellspacing="0" width="100%" bgcolor="white">
<tr><td>
  <table width="100%" cellpadding="0" cellspacing="0" border="0">
  <tr valign="top"><td>
  <h3 class="epydoc"><span class="sig"><span class="sig-name">find_noncore_fragment</span>(<span class="sig-arg">bridge_atom</span>,
        <span class="sig-arg">core_atom_indices</span>)</span>
  </h3>
  </td><td align="right" valign="top"
    >&nbsp;
    </td>
  </tr></table>
  
  <p>Finding non-core fragment from bridged</p>
  <dl class="fields">
    <dt>Parameters:</dt>
    <dd><ul class="nomargin-top">
        <li><strong class="pname"><code>bridge_atom</code></strong> (_StructureAtom) - atom bonded to the attachment core atom.</li>
        <li><strong class="pname"><code>core_atoms</code></strong> (set of int) - a set of core atom indices. @return a list of atoms.</li>
    </ul></dd>
  </dl>
</td></tr></table>
</div>
<a name="find_noncore_subfragment"></a>
<div>
<table class="details" border="1" cellpadding="3"
       cellspacing="0" width="100%" bgcolor="white">
<tr><td>
  <table width="100%" cellpadding="0" cellspacing="0" border="0">
  <tr valign="top"><td>
  <h3 class="epydoc"><span class="sig"><span class="sig-name">find_noncore_subfragment</span>(<span class="sig-arg">bridge_atom</span>,
        <span class="sig-arg">core_atom_indices</span>,
        <span class="sig-arg">frag_atom_indices</span>)</span>
  </h3>
  </td><td align="right" valign="top"
    >&nbsp;
    </td>
  </tr></table>
  
  <p>Finding non-core fragment from bridged</p>
  <dl class="fields">
    <dt>Parameters:</dt>
    <dd><ul class="nomargin-top">
        <li><strong class="pname"><code>bridge_atom</code></strong> (_StructureAtom) - atom bonded to the attachment core atom.</li>
        <li><strong class="pname"><code>core_atom_indices</code></strong> (set of int) - a set of core atom indices. @return a list of atoms.</li>
    </ul></dd>
  </dl>
</td></tr></table>
</div>
<a name="get_atom_mapping"></a>
<div>
<table class="details" border="1" cellpadding="3"
       cellspacing="0" width="100%" bgcolor="white">
<tr><td>
  <table width="100%" cellpadding="0" cellspacing="0" border="0">
  <tr valign="top"><td>
  <h3 class="epydoc"><span class="sig"><span class="sig-name">get_atom_mapping</span>(<span class="sig-arg">data</span>)</span>
  </h3>
  </td><td align="right" valign="top"
    >&nbsp;
    </td>
  </tr></table>
  
  <p>mapping atoms based on the result from RGA</p>
  <dl class="fields">
    <dt>Parameters:</dt>
    <dd><ul class="nomargin-top">
        <li><strong class="pname"><code>data</code></strong> (AtomMappingData) - intermediary and finals data structures from RGA</li>
    </ul></dd>
  </dl>
</td></tr></table>
</div>
<a name="get_fepio_atom_mapping"></a>
<div>
<table class="details" border="1" cellpadding="3"
       cellspacing="0" width="100%" bgcolor="white">
<tr><td>
  <table width="100%" cellpadding="0" cellspacing="0" border="0">
  <tr valign="top"><td>
  <h3 class="epydoc"><span class="sig"><span class="sig-name">get_fepio_atom_mapping</span>(<span class="sig-arg">atom_mapping</span>)</span>
  </h3>
  </td><td align="right" valign="top"
    >&nbsp;
    </td>
  </tr></table>
  
  <p>converting to atom mapping format required by mmfepio library. Below 
  is an example: 1     1 2     2 3     -1 4     -1 5     3 -6    4 -7   
  5</p>
  <dl class="fields">
  </dl>
</td></tr></table>
</div>
<a name="convert_rga_data"></a>
<div>
<table class="details" border="1" cellpadding="3"
       cellspacing="0" width="100%" bgcolor="white">
<tr><td>
  <table width="100%" cellpadding="0" cellspacing="0" border="0">
  <tr valign="top"><td>
  <h3 class="epydoc"><span class="sig"><span class="sig-name">convert_rga_data</span>(<span class="sig-arg">rga_data</span>,
        <span class="sig-arg">input_file</span>)</span>
  </h3>
  </td><td align="right" valign="top"
    >&nbsp;
    </td>
  </tr></table>
  
  <p>Converting RGA internal data to AtomMappingData object</p>
  <dl class="fields">
    <dt>Parameters:</dt>
    <dd><ul class="nomargin-top">
        <li><strong class="pname"><code>rga_data</code></strong> (r_group_analysis.Data)</li>
        <li><strong class="pname"><code>input_file</code></strong> (string) - input file</li>
    </ul></dd>
  </dl>
</td></tr></table>
</div>
<a name="reorder_st"></a>
<div>
<table class="details" border="1" cellpadding="3"
       cellspacing="0" width="100%" bgcolor="white">
<tr><td>
  <table width="100%" cellpadding="0" cellspacing="0" border="0">
  <tr valign="top"><td>
  <h3 class="epydoc"><span class="sig"><span class="sig-name">reorder_st</span>(<span class="sig-arg">st</span>,
        <span class="sig-arg">index_map</span>)</span>
  </h3>
  </td><td align="right" valign="top"
    >&nbsp;
    </td>
  </tr></table>
  
  
  <dl class="fields">
    <dt>Parameters:</dt>
    <dd><ul class="nomargin-top">
        <li><strong class="pname"><code>ct</code></strong> (Structure) - Structure object</li>
        <li><strong class="pname"><code>index_map</code></strong> (list of tuple) - index mapping between old and new index [(new_index, old_index), 
          ...]</li>
    </ul></dd>
  </dl>
</td></tr></table>
</div>
<a name="__raw_fepsubst"></a>
<div class="private">
<table class="details" border="1" cellpadding="3"
       cellspacing="0" width="100%" bgcolor="white">
<tr><td>
  <table width="100%" cellpadding="0" cellspacing="0" border="0">
  <tr valign="top"><td>
  <h3 class="epydoc"><span class="sig"><span class="sig-name">__raw_fepsubst</span>(<span class="sig-arg">mol</span>,
        <span class="sig-arg">noncore</span>,
        <span class="sig-arg">cor</span>,
        <span class="sig-arg">non</span>)</span>
  </h3>
  </td><td align="right" valign="top"
    >&nbsp;
    </td>
  </tr></table>
  
  <p>Assigns raw fep_subst code to the given molecule. We assign only the 
  following values: 1, 2, 97, 98, and 99, and here we ignore the other 
  forms of values (i.e., 197, 297, 198, 298, 89, 79, etc.).</p>
  <dl class="fields">
    <dt>Parameters:</dt>
    <dd><ul class="nomargin-top">
        <li><strong class="pname"><code>mol</code></strong> (<code>structure.Structure</code>) - The molecule that we will set the &quot;i_fep_subst&quot; atom 
          property</li>
        <li><strong class="pname"><code>noncore</code></strong> (<code>set</code> of <code>int</code>) - All noncore atoms' indices</li>
        <li><strong class="pname"><code>cor</code></strong> (<code>list</code> of <code>int</code>) - All core atoms' indices</li>
        <li><strong class="pname"><code>non</code></strong> (<code>list</code> of <code>int</code>) - Noncore-but-matched atoms' indices</li>
    </ul></dd>
  </dl>
</td></tr></table>
</div>
<a name="__fix_97atoms"></a>
<div class="private">
<table class="details" border="1" cellpadding="3"
       cellspacing="0" width="100%" bgcolor="white">
<tr><td>
  <table width="100%" cellpadding="0" cellspacing="0" border="0">
  <tr valign="top"><td>
  <h3 class="epydoc"><span class="sig"><span class="sig-name">__fix_97atoms</span>(<span class="sig-arg">mol</span>)</span>
  </h3>
  </td><td align="right" valign="top"
    >&nbsp;
    </td>
  </tr></table>
  
  <p>We loop through all &lt;97&gt; atoms and check if a &lt;97&gt; atom is
  connected to more than 1 physical-physical hybrid atoms. If so, we leave 
  the atom's fep_subst code to be 97, otherwise we change it to 2 (so it 
  becomes a physical-dummy hybrid atom). We repeat this process until there
  is no change of the fep_subst code.</p>
  <dl class="fields">
  </dl>
</td></tr></table>
</div>
<a name="__fix_99atoms"></a>
<div class="private">
<table class="details" border="1" cellpadding="3"
       cellspacing="0" width="100%" bgcolor="white">
<tr><td>
  <table width="100%" cellpadding="0" cellspacing="0" border="0">
  <tr valign="top"><td>
  <h3 class="epydoc"><span class="sig"><span class="sig-name">__fix_99atoms</span>(<span class="sig-arg">atom98</span>,
        <span class="sig-arg">code98</span>,
        <span class="sig-arg">atom99_set</span>)</span>
  </h3>
  </td><td align="right" valign="top"
    >&nbsp;
    </td>
  </tr></table>
  
  <p>This function reassigns the 'fep_subst' code for &lt;99&gt; atoms that
  are bonded to the given &lt;98&gt; atom. Here I use the &lt;99&gt; 
  nomenclature to mean 99, 199, 299, and so on. -YW</p>
  <p>This reassignment is for two purposes:</p>
  <ol start="1">
    <li>
      Ensure the code consistency between the two molecules.
    </li>
    <li>
      Adjust some 99 codes to be 89 or 79 or 69.
    </li>
  </ol>
  <p>This reassignment has to be done after that we obtain an overall 
  knowledge of which atoms are &lt;98&gt;, &lt;99&gt;, and &lt;97&gt;.</p>
  <p>The assigned 'fep_subst' code is based the given &lt;98&gt; code: if 
  it's 98, &lt;99&gt; will be 99 (or 89, 79, etc.); if it's 198, &lt;99&gt;
  will be 199 (or 189, 179, etc.), and so on.</p>
  <dl class="fields">
    <dt>Parameters:</dt>
    <dd><ul class="nomargin-top">
        <li><strong class="pname"><code>atom98</code></strong> (<code>Structure.Atom</code>) - The &lt;98&gt; atom which we will reassign the &lt;99&gt; and 
          &lt;97&gt; atoms that are bonded to</li>
        <li><strong class="pname"><code>code98</code></strong> (<code>int</code>) - The &lt;98&gt; fep_subst code. The value will be one of 98, 198, 
          298, ... and so on.</li>
        <li><strong class="pname"><code>atom99_set</code></strong> (<code>set</code> of <code>Structure.Atom</code> objects) - A set that we use to keep track of the &lt;99&gt; atoms that have
          already been reassigned. For each atom, we reassign at most once.</li>
    </ul></dd>
  </dl>
</td></tr></table>
</div>
<br />
<!-- ==================== VARIABLES DETAILS ==================== -->
<a name="section-VariablesDetails"></a>
<table class="details" border="1" cellpadding="3"
       cellspacing="0" width="100%" bgcolor="white">
<tr bgcolor="#70b0f0" class="table-header">
  <td colspan="2" class="table-header">
    <table border="0" cellpadding="0" cellspacing="0" width="100%">
      <tr valign="top">
        <td align="left"><span class="table-header">Variables Details</span></td>
        <td align="right" valign="top"
         ><span class="options">[<a href="#section-VariablesDetails"
         class="privatelink" onclick="toggle_private();"
         >hide private</a>]</span></td>
      </tr>
    </table>
  </td>
</tr>
</table>
<a name="TEMP_DIR"></a>
<div>
<table class="details" border="1" cellpadding="3"
       cellspacing="0" width="100%" bgcolor="white">
<tr><td>
  <h3 class="epydoc">TEMP_DIR</h3>
  
  <dl class="fields">
  </dl>
  <dl class="fields">
    <dt>Value:</dt>
      <dd><table><tr><td><pre class="variable">
<code class="variable-quote">'</code><code class="variable-string">/home/buildbot/.schrodinger/tmp/fep-mapping-tmpQTcBNM</code><code class="variable-quote">'</code>
</pre></td></tr></table>
</dd>
  </dl>
</td></tr></table>
</div>
<br />
<!-- ==================== NAVIGATION BAR ==================== -->
<table class="navbar" border="0" width="100%" cellpadding="0"
       bgcolor="#a0c0ff" cellspacing="0">
  <tr valign="middle">

  <!-- Tree link -->
      <th>&nbsp;&nbsp;&nbsp;<a
        href="module-tree.html">Trees</a>&nbsp;&nbsp;&nbsp;</th>

  <!-- Index link -->
      <th>&nbsp;&nbsp;&nbsp;<a
        href="identifier-index.html">Indices</a>&nbsp;&nbsp;&nbsp;</th>

  <!-- Help link -->
      <th>&nbsp;&nbsp;&nbsp;<a
        href="help.html">Help</a>&nbsp;&nbsp;&nbsp;</th>

  <!-- Project homepage -->
      <th class="navbar" align="right" width="100%">
        <table border="0" cellpadding="0" cellspacing="0">
          <tr><th class="navbar" align="center"
            >2015-2Schrodinger Python API</th>
          </tr></table></th>
  </tr>
</table>
<table border="0" cellpadding="0" cellspacing="0" width="100%%">
  <tr>
    <td align="left" class="footer">
    Generated by Epydoc 3.0.1 on Sat May  9 06:30:41 2015
    </td>
    <td align="right" class="footer">
      <a target="mainFrame" href="http://epydoc.sourceforge.net"
        >http://epydoc.sourceforge.net</a>
    </td>
  </tr>
</table>

<script type="text/javascript">
  <!--
  // Private objects are initially displayed (because if
  // javascript is turned off then we want them to be
  // visible); but by default, we want to hide them.  So hide
  // them unless we have a cookie that says to show them.
  checkCookie();
  // -->
</script>
</body>
</html>
