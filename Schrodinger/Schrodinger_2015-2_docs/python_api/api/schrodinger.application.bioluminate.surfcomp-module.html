<?xml version="1.0" encoding="ascii"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
          "DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head>
  <title>schrodinger.application.bioluminate.surfcomp</title>
  <link rel="stylesheet" href="epydoc.css" type="text/css" />
  <script type="text/javascript" src="epydoc.js"></script>
</head>

<body bgcolor="white" text="black" link="blue" vlink="#204080"
      alink="#204080">
<!-- ==================== NAVIGATION BAR ==================== -->
<table class="navbar" border="0" width="100%" cellpadding="0"
       bgcolor="#a0c0ff" cellspacing="0">
  <tr valign="middle">

  <!-- Tree link -->
      <th>&nbsp;&nbsp;&nbsp;<a
        href="module-tree.html">Trees</a>&nbsp;&nbsp;&nbsp;</th>

  <!-- Index link -->
      <th>&nbsp;&nbsp;&nbsp;<a
        href="identifier-index.html">Indices</a>&nbsp;&nbsp;&nbsp;</th>

  <!-- Help link -->
      <th>&nbsp;&nbsp;&nbsp;<a
        href="help.html">Help</a>&nbsp;&nbsp;&nbsp;</th>

  <!-- Project homepage -->
      <th class="navbar" align="right" width="100%">
        <table border="0" cellpadding="0" cellspacing="0">
          <tr><th class="navbar" align="center"
            >2015-2Schrodinger Python API</th>
          </tr></table></th>
  </tr>
</table>
<table width="100%" cellpadding="0" cellspacing="0">
  <tr valign="top">
    <td width="100%">
      <span class="breadcrumbs">
        <a href="schrodinger-module.html">Package&nbsp;schrodinger</a> ::
        <a href="schrodinger.application-module.html">Package&nbsp;application</a> ::
        <a href="schrodinger.application.bioluminate-module.html">Package&nbsp;bioluminate</a> ::
        Module&nbsp;surfcomp
      </span>
    </td>
    <td>
      <table cellpadding="0" cellspacing="0">
        <!-- hide/show private -->
        <tr><td align="right"><span class="options">[<a href="javascript:void(0);" class="privatelink"
    onclick="toggle_private();">hide&nbsp;private</a>]</span></td></tr>
        <tr><td align="right"><span class="options"
            >[<a href="frames.html" target="_top">frames</a
            >]&nbsp;|&nbsp;<a href="schrodinger.application.bioluminate.surfcomp-module.html"
            target="_top">no&nbsp;frames</a>]</span></td></tr>
      </table>
    </td>
  </tr>
</table>
<!-- ==================== MODULE DESCRIPTION ==================== -->
<h1 class="epydoc">Module surfcomp</h1><p class="nomargin-top"></p>
<p>See PYTHON-2433 WARNING: Solvents are not accounted for in any 
  way.</p>

<!-- ==================== FUNCTIONS ==================== -->
<a name="section-Functions"></a>
<table class="summary" border="1" cellpadding="3"
       cellspacing="0" width="100%" bgcolor="white">
<tr bgcolor="#70b0f0" class="table-header">
  <td colspan="2" class="table-header">
    <table border="0" cellpadding="0" cellspacing="0" width="100%">
      <tr valign="top">
        <td align="left"><span class="table-header">Functions</span></td>
        <td align="right" valign="top"
         ><span class="options">[<a href="#section-Functions"
         class="privatelink" onclick="toggle_private();"
         >hide private</a>]</span></td>
      </tr>
    </table>
  </td>
</tr>
<tr>
    <td width="15%" align="right" valign="top" class="summary">
      <span class="summary-type">&nbsp;</span>
    </td><td class="summary">
      <table width="100%" cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td><span class="summary-sig"><a href="schrodinger.application.bioluminate.surfcomp-module.html#flatten_list" class="summary-sig-name">flatten_list</a>(<span class="summary-sig-arg">iterable</span>)</span><br />
      Given an iterable of lists, return a flattened list of all values.</td>
          <td align="right" valign="top">
            
            
          </td>
        </tr>
      </table>
      
    </td>
  </tr>
<tr>
    <td width="15%" align="right" valign="top" class="summary">
      <span class="summary-type">&nbsp;</span>
    </td><td class="summary">
      <table width="100%" cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td><span class="summary-sig"><a name="create_surface"></a><span class="summary-sig-name">create_surface</span>(<span class="summary-sig-arg">st</span>,
        <span class="summary-sig-arg">calc_normals</span>=<span class="summary-sig-default">True</span>,
        <span class="summary-sig-arg">grid_spacing</span>=<span class="summary-sig-default">0.5</span>)</span></td>
          <td align="right" valign="top">
            
            
          </td>
        </tr>
      </table>
      
    </td>
  </tr>
<tr>
    <td width="15%" align="right" valign="top" class="summary">
      <span class="summary-type">&nbsp;</span>
    </td><td class="summary">
      <table width="100%" cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td><span class="summary-sig"><a href="schrodinger.application.bioluminate.surfcomp-module.html#find_buddies_on_other_surf" class="summary-sig-name">find_buddies_on_other_surf</a>(<span class="summary-sig-arg">buried_a_coords</span>,
        <span class="summary-sig-arg">buried_b_coords</span>)</span><br />
      For each point in the first list, find the closest point from the 
      second list.</td>
          <td align="right" valign="top">
            
            
          </td>
        </tr>
      </table>
      
    </td>
  </tr>
<tr class="private">
    <td width="15%" align="right" valign="top" class="summary">
      <span class="summary-type">&nbsp;</span>
    </td><td class="summary">
      <table width="100%" cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td><span class="summary-sig"><a name="_calc_sc_per_atom"></a><span class="summary-sig-name">_calc_sc_per_atom</span>(<span class="summary-sig-arg">buried_a_coords</span>,
        <span class="summary-sig-arg">buried_b_coords</span>,
        <span class="summary-sig-arg">a_normals</span>,
        <span class="summary-sig-arg">b_normals</span>,
        <span class="summary-sig-arg">a_nearest</span>)</span><br />
      buried_a_coords - dict of buried surface coordinates of surface A
buried_b_coords - dict of buried surface coordinates of surface B
a_normals - array of surface normal vectors of surface A
b_normals - array of surface normal vectors of surface B
a_nearest - dict of an atom index of the closest atom in molecule
            A to the keyed surface point (index).</td>
          <td align="right" valign="top">
            
            
          </td>
        </tr>
      </table>
      
    </td>
  </tr>
<tr class="private">
    <td width="15%" align="right" valign="top" class="summary">
      <span class="summary-type">&nbsp;</span>
    </td><td class="summary">
      <table width="100%" cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td><span class="summary-sig"><a href="schrodinger.application.bioluminate.surfcomp-module.html#_calc_complementarity" class="summary-sig-name" onclick="show_private();">_calc_complementarity</a>(<span class="summary-sig-arg">st</span>,
        <span class="summary-sig-arg">atoms1</span>,
        <span class="summary-sig-arg">atoms2</span>,
        <span class="summary-sig-arg">grid_spacing</span>)</span><br />
      Given 2 atom lists, calculate surface complementarity for each atom 
      in each input set that is within 1.5A of the non-buried surface.</td>
          <td align="right" valign="top">
            
            
          </td>
        </tr>
      </table>
      
    </td>
  </tr>
<tr>
    <td width="15%" align="right" valign="top" class="summary">
      <span class="summary-type">&nbsp;</span>
    </td><td class="summary">
      <table width="100%" cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td><span class="summary-sig"><a href="schrodinger.application.bioluminate.surfcomp-module.html#calc_complementarity_by_atom" class="summary-sig-name">calc_complementarity_by_atom</a>(<span class="summary-sig-arg">st</span>,
        <span class="summary-sig-arg">atoms1</span>,
        <span class="summary-sig-arg">atoms2</span>=<span class="summary-sig-default">None</span>,
        <span class="summary-sig-arg">grid_spacing</span>=<span class="summary-sig-default">0.5</span>)</span><br />
      Return the values for surface complementarity between the specified surfaces,
grouped by atom from &lt;atoms1&gt;.</td>
          <td align="right" valign="top">
            
            
          </td>
        </tr>
      </table>
      
    </td>
  </tr>
<tr>
    <td width="15%" align="right" valign="top" class="summary">
      <span class="summary-type">&nbsp;</span>
    </td><td class="summary">
      <table width="100%" cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td><span class="summary-sig"><a href="schrodinger.application.bioluminate.surfcomp-module.html#calc_total_complementarity" class="summary-sig-name">calc_total_complementarity</a>(<span class="summary-sig-arg">st</span>,
        <span class="summary-sig-arg">atoms1</span>,
        <span class="summary-sig-arg">atoms2</span>=<span class="summary-sig-default">None</span>,
        <span class="summary-sig-arg">grid_spacing</span>=<span class="summary-sig-default">0.5</span>)</span><br />
      Return the total complementarity between the specified surfaces.</td>
          <td align="right" valign="top">
            
            
          </td>
        </tr>
      </table>
      
    </td>
  </tr>
<tr class="private">
    <td width="15%" align="right" valign="top" class="summary">
      <span class="summary-type">&nbsp;</span>
    </td><td class="summary">
      <table width="100%" cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td><span class="summary-sig"><a name="_run"></a><span class="summary-sig-name">_run</span>()</span><br />
      For testing this module from command-line.</td>
          <td align="right" valign="top">
            
            
          </td>
        </tr>
      </table>
      
    </td>
  </tr>
</table>
<!-- ==================== VARIABLES ==================== -->
<a name="section-Variables"></a>
<table class="summary" border="1" cellpadding="3"
       cellspacing="0" width="100%" bgcolor="white">
<tr bgcolor="#70b0f0" class="table-header">
  <td colspan="2" class="table-header">
    <table border="0" cellpadding="0" cellspacing="0" width="100%">
      <tr valign="top">
        <td align="left"><span class="table-header">Variables</span></td>
        <td align="right" valign="top"
         ><span class="options">[<a href="#section-Variables"
         class="privatelink" onclick="toggle_private();"
         >hide private</a>]</span></td>
      </tr>
    </table>
  </td>
</tr>
<tr>
    <td width="15%" align="right" valign="top" class="summary">
      <span class="summary-type">&nbsp;</span>
    </td><td class="summary">
        <a name="CONST_W"></a><span class="summary-name">CONST_W</span> = <code title="0.5">0.5</code>
    </td>
  </tr>
<tr>
    <td width="15%" align="right" valign="top" class="summary">
      <span class="summary-type">&nbsp;</span>
    </td><td class="summary">
        <a name="NON_BURIED_DIST"></a><span class="summary-name">NON_BURIED_DIST</span> = <code title="1.5">1.5</code>
    </td>
  </tr>
<tr>
    <td width="15%" align="right" valign="top" class="summary">
      <span class="summary-type">&nbsp;</span>
    </td><td class="summary">
        <a name="SURF_DIST_THRESHOLD"></a><span class="summary-name">SURF_DIST_THRESHOLD</span> = <code title="3.0">3.0</code>
    </td>
  </tr>
<tr>
    <td width="15%" align="right" valign="top" class="summary">
      <span class="summary-type">&nbsp;</span>
    </td><td class="summary">
        <a name="__package__"></a><span class="summary-name">__package__</span> = <code title="'schrodinger.application.bioluminate'"><code class="variable-quote">'</code><code class="variable-string">schrodinger.application.bioluminate</code><code class="variable-quote">'</code></code>
    </td>
  </tr>
</table>
<!-- ==================== FUNCTION DETAILS ==================== -->
<a name="section-FunctionDetails"></a>
<table class="details" border="1" cellpadding="3"
       cellspacing="0" width="100%" bgcolor="white">
<tr bgcolor="#70b0f0" class="table-header">
  <td colspan="2" class="table-header">
    <table border="0" cellpadding="0" cellspacing="0" width="100%">
      <tr valign="top">
        <td align="left"><span class="table-header">Function Details</span></td>
        <td align="right" valign="top"
         ><span class="options">[<a href="#section-FunctionDetails"
         class="privatelink" onclick="toggle_private();"
         >hide private</a>]</span></td>
      </tr>
    </table>
  </td>
</tr>
</table>
<a name="flatten_list"></a>
<div>
<table class="details" border="1" cellpadding="3"
       cellspacing="0" width="100%" bgcolor="white">
<tr><td>
  <table width="100%" cellpadding="0" cellspacing="0" border="0">
  <tr valign="top"><td>
  <h3 class="epydoc"><span class="sig"><span class="sig-name">flatten_list</span>(<span class="sig-arg">iterable</span>)</span>
  </h3>
  </td><td align="right" valign="top"
    >&nbsp;
    </td>
  </tr></table>
  
  <p>Given an iterable of lists, return a flattened list of all values. 
  This algorithm scales in linear time.</p>
  <dl class="fields">
  </dl>
</td></tr></table>
</div>
<a name="find_buddies_on_other_surf"></a>
<div>
<table class="details" border="1" cellpadding="3"
       cellspacing="0" width="100%" bgcolor="white">
<tr><td>
  <table width="100%" cellpadding="0" cellspacing="0" border="0">
  <tr valign="top"><td>
  <h3 class="epydoc"><span class="sig"><span class="sig-name">find_buddies_on_other_surf</span>(<span class="sig-arg">buried_a_coords</span>,
        <span class="sig-arg">buried_b_coords</span>)</span>
  </h3>
  </td><td align="right" valign="top"
    >&nbsp;
    </td>
  </tr></table>
  
  <p>For each point in the first list, find the closest point from the 
  second list. Returns a dict where keys are indices to the first list, and
  values are tuples of (index to second list, sq. distance).</p>
  <dl class="fields">
  </dl>
</td></tr></table>
</div>
<a name="_calc_complementarity"></a>
<div class="private">
<table class="details" border="1" cellpadding="3"
       cellspacing="0" width="100%" bgcolor="white">
<tr><td>
  <table width="100%" cellpadding="0" cellspacing="0" border="0">
  <tr valign="top"><td>
  <h3 class="epydoc"><span class="sig"><span class="sig-name">_calc_complementarity</span>(<span class="sig-arg">st</span>,
        <span class="sig-arg">atoms1</span>,
        <span class="sig-arg">atoms2</span>,
        <span class="sig-arg">grid_spacing</span>)</span>
  </h3>
  </td><td align="right" valign="top"
    >&nbsp;
    </td>
  </tr></table>
  
  <p>Given 2 atom lists, calculate surface complementarity for each atom in
  each input set that is within 1.5A of the non-buried surface. The results
  are returned as 2 dicts. The keys in the dict are atom indices in the 
  corresponding set, values are the Sc values for each surface point for 
  that atom, ranging from ~0 to 1.</p>
  <dl class="fields">
  </dl>
<div class="fields">      <p><strong>Note:</strong>
        Atoms are considered interacting if:
        <ul>
          <li>
            they are buried in the full ct surface
          </li>
          <li>
            they are on the surface of the interacting surfaces
          </li>
          <li>
            and they are within 3.0 A of the other interacting surface.
          </li>
        </ul>
        <p>Non-interacting atoms are not included in the returned 
        dictionary.</p>
      </p>
</div></td></tr></table>
</div>
<a name="calc_complementarity_by_atom"></a>
<div>
<table class="details" border="1" cellpadding="3"
       cellspacing="0" width="100%" bgcolor="white">
<tr><td>
  <table width="100%" cellpadding="0" cellspacing="0" border="0">
  <tr valign="top"><td>
  <h3 class="epydoc"><span class="sig"><span class="sig-name">calc_complementarity_by_atom</span>(<span class="sig-arg">st</span>,
        <span class="sig-arg">atoms1</span>,
        <span class="sig-arg">atoms2</span>=<span class="sig-default">None</span>,
        <span class="sig-arg">grid_spacing</span>=<span class="sig-default">0.5</span>)</span>
  </h3>
  </td><td align="right" valign="top"
    >&nbsp;
    </td>
  </tr></table>
  
  <pre class="literalblock">

Return the values for surface complementarity between the specified surfaces,
grouped by atom from &lt;atoms1&gt;.

@type st: structure._Structure object
@param st: Structure to which &lt;atoms1&gt; and &lt;atoms2&gt; are indices in.

@type atoms1: Iterable of atom indices
@param atoms1: Atom numbers from the surface for which to calculate the
    complementrairity.

@type atoms2: Iterable of atom indices
@param atoms2 = Atom numbers for the other surface. if not specified, use all
    other atoms from the CT.

@type grid_spacing: float
@param grid_spacing: Density (resolution) of the surfaces. Default is 0.5.
    Maestro defaults for this settings are: high=0.3, medium=0.6, low=0.8.

@rtype: dict of lists.
@return: Each value is a list of atom indices matching the SMARTS
    Will contain an entry for each atom in the given lists as the key,
    and dict value will be a list of surface complementarity (Sc) values
    for that atom. Each value corresponds to an interacting point on the
    surface of that atom. This list will be empty for buried atoms.
    Calculate the median of these values to determine the Sc for that atom.
    Calculate the median of all values for all residue's atoms to determine
    the Sc for that residue; etc.

</pre>
  <dl class="fields">
  </dl>
</td></tr></table>
</div>
<a name="calc_total_complementarity"></a>
<div>
<table class="details" border="1" cellpadding="3"
       cellspacing="0" width="100%" bgcolor="white">
<tr><td>
  <table width="100%" cellpadding="0" cellspacing="0" border="0">
  <tr valign="top"><td>
  <h3 class="epydoc"><span class="sig"><span class="sig-name">calc_total_complementarity</span>(<span class="sig-arg">st</span>,
        <span class="sig-arg">atoms1</span>,
        <span class="sig-arg">atoms2</span>=<span class="sig-default">None</span>,
        <span class="sig-arg">grid_spacing</span>=<span class="sig-default">0.5</span>)</span>
  </h3>
  </td><td align="right" valign="top"
    >&nbsp;
    </td>
  </tr></table>
  
  <pre class="literalblock">

Return the total complementarity between the specified surfaces.

@type st: structure._Structure object
@param st: Structure to which &lt;atoms1&gt; and &lt;atoms2&gt; are indices in.

@type atoms1: Iterable of atom indices
@param atoms1: Atom numbers from the surface for which to calculate the
    complementrairity.

@type atoms2: Iterable of atom indices
@param atoms2 = Atom numbers for the other surface. if not specified, use all
    other atoms from the CT.

@type grid_spacing: float
@param grid_spacing: Density (resolution) of the surfaces. Default is 0.5.
    Maestro defaults for this settings are: high=0.3, medium=0.6, low=0.8.

@rtype: float
@return the surface complementarity (Sc) between the 2 surfaces.

</pre>
  <dl class="fields">
  </dl>
</td></tr></table>
</div>
<br />
<!-- ==================== NAVIGATION BAR ==================== -->
<table class="navbar" border="0" width="100%" cellpadding="0"
       bgcolor="#a0c0ff" cellspacing="0">
  <tr valign="middle">

  <!-- Tree link -->
      <th>&nbsp;&nbsp;&nbsp;<a
        href="module-tree.html">Trees</a>&nbsp;&nbsp;&nbsp;</th>

  <!-- Index link -->
      <th>&nbsp;&nbsp;&nbsp;<a
        href="identifier-index.html">Indices</a>&nbsp;&nbsp;&nbsp;</th>

  <!-- Help link -->
      <th>&nbsp;&nbsp;&nbsp;<a
        href="help.html">Help</a>&nbsp;&nbsp;&nbsp;</th>

  <!-- Project homepage -->
      <th class="navbar" align="right" width="100%">
        <table border="0" cellpadding="0" cellspacing="0">
          <tr><th class="navbar" align="center"
            >2015-2Schrodinger Python API</th>
          </tr></table></th>
  </tr>
</table>
<table border="0" cellpadding="0" cellspacing="0" width="100%%">
  <tr>
    <td align="left" class="footer">
    Generated by Epydoc 3.0.1 on Sat May  9 06:30:40 2015
    </td>
    <td align="right" class="footer">
      <a target="mainFrame" href="http://epydoc.sourceforge.net"
        >http://epydoc.sourceforge.net</a>
    </td>
  </tr>
</table>

<script type="text/javascript">
  <!--
  // Private objects are initially displayed (because if
  // javascript is turned off then we want them to be
  // visible); but by default, we want to hide them.  So hide
  // them unless we have a cookie that says to show them.
  checkCookie();
  // -->
</script>
</body>
</html>
