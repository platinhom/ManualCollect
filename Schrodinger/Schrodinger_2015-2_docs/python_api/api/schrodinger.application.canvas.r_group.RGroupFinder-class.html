<?xml version="1.0" encoding="ascii"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
          "DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head>
  <title>schrodinger.application.canvas.r_group.RGroupFinder</title>
  <link rel="stylesheet" href="epydoc.css" type="text/css" />
  <script type="text/javascript" src="epydoc.js"></script>
</head>

<body bgcolor="white" text="black" link="blue" vlink="#204080"
      alink="#204080">
<!-- ==================== NAVIGATION BAR ==================== -->
<table class="navbar" border="0" width="100%" cellpadding="0"
       bgcolor="#a0c0ff" cellspacing="0">
  <tr valign="middle">

  <!-- Tree link -->
      <th>&nbsp;&nbsp;&nbsp;<a
        href="module-tree.html">Trees</a>&nbsp;&nbsp;&nbsp;</th>

  <!-- Index link -->
      <th>&nbsp;&nbsp;&nbsp;<a
        href="identifier-index.html">Indices</a>&nbsp;&nbsp;&nbsp;</th>

  <!-- Help link -->
      <th>&nbsp;&nbsp;&nbsp;<a
        href="help.html">Help</a>&nbsp;&nbsp;&nbsp;</th>

  <!-- Project homepage -->
      <th class="navbar" align="right" width="100%">
        <table border="0" cellpadding="0" cellspacing="0">
          <tr><th class="navbar" align="center"
            >2015-2Schrodinger Python API</th>
          </tr></table></th>
  </tr>
</table>
<table width="100%" cellpadding="0" cellspacing="0">
  <tr valign="top">
    <td width="100%">
      <span class="breadcrumbs">
        <a href="schrodinger-module.html">Package&nbsp;schrodinger</a> ::
        <a href="schrodinger.application-module.html">Package&nbsp;application</a> ::
        <a href="schrodinger.application.canvas-module.html">Package&nbsp;canvas</a> ::
        <a href="schrodinger.application.canvas.r_group-module.html">Module&nbsp;r_group</a> ::
        Class&nbsp;RGroupFinder
      </span>
    </td>
    <td>
      <table cellpadding="0" cellspacing="0">
        <!-- hide/show private -->
        <tr><td align="right"><span class="options">[<a href="javascript:void(0);" class="privatelink"
    onclick="toggle_private();">hide&nbsp;private</a>]</span></td></tr>
        <tr><td align="right"><span class="options"
            >[<a href="frames.html" target="_top">frames</a
            >]&nbsp;|&nbsp;<a href="schrodinger.application.canvas.r_group.RGroupFinder-class.html"
            target="_top">no&nbsp;frames</a>]</span></td></tr>
      </table>
    </td>
  </tr>
</table>
<!-- ==================== CLASS DESCRIPTION ==================== -->
<h1 class="epydoc">Class RGroupFinder</h1><p class="nomargin-top"></p>
<p>This class is used to find optimal core alignments and determines 
  r-groups for input structures. This is a base class that uses 'original' 
  algorithm that tries to minimize the number of r-groups.</p>

<!-- ==================== INSTANCE METHODS ==================== -->
<a name="section-InstanceMethods"></a>
<table class="summary" border="1" cellpadding="3"
       cellspacing="0" width="100%" bgcolor="white">
<tr bgcolor="#70b0f0" class="table-header">
  <td colspan="2" class="table-header">
    <table border="0" cellpadding="0" cellspacing="0" width="100%">
      <tr valign="top">
        <td align="left"><span class="table-header">Instance Methods</span></td>
        <td align="right" valign="top"
         ><span class="options">[<a href="#section-InstanceMethods"
         class="privatelink" onclick="toggle_private();"
         >hide private</a>]</span></td>
      </tr>
    </table>
  </td>
</tr>
<tr>
    <td width="15%" align="right" valign="top" class="summary">
      <span class="summary-type">&nbsp;</span>
    </td><td class="summary">
      <table width="100%" cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td><span class="summary-sig"><a href="schrodinger.application.canvas.r_group.RGroupFinder-class.html#__init__" class="summary-sig-name">__init__</a>(<span class="summary-sig-arg">self</span>,
        <span class="summary-sig-arg">input_file</span>,
        <span class="summary-sig-arg">smarts</span>,
        <span class="summary-sig-arg">temp_dir</span>=<span class="summary-sig-default">None</span>,
        <span class="summary-sig-arg">thread</span>=<span class="summary-sig-default">None</span>,
        <span class="summary-sig-arg">use_mm</span>=<span class="summary-sig-default">1</span>,
        <span class="summary-sig-arg">use_fp_sim</span>=<span class="summary-sig-default">False</span>,
        <span class="summary-sig-arg">sa_seed</span>=<span class="summary-sig-default">None</span>,
        <span class="summary-sig-arg">t_factor</span>=<span class="summary-sig-default">None</span>,
        <span class="summary-sig-arg">tmax_mult</span>=<span class="summary-sig-default">None</span>)</span><br />
      This function creates an instance of RGroupFinder object.</td>
          <td align="right" valign="top">
            
            
          </td>
        </tr>
      </table>
      
    </td>
  </tr>
<tr class="private">
    <td width="15%" align="right" valign="top" class="summary">
      <span class="summary-type">&nbsp;</span>
    </td><td class="summary">
      <table width="100%" cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td><span class="summary-sig"><a name="_resetData"></a><span class="summary-sig-name">_resetData</span>(<span class="summary-sig-arg">self</span>)</span><br />
      This function resets data objects used during calculation to their 
      initial values.</td>
          <td align="right" valign="top">
            
            
          </td>
        </tr>
      </table>
      
    </td>
  </tr>
<tr>
    <td width="15%" align="right" valign="top" class="summary">
      <span class="summary-type">&nbsp;</span>
    </td><td class="summary">
      <table width="100%" cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td><span class="summary-sig"><a href="schrodinger.application.canvas.r_group.RGroupFinder-class.html#calculate" class="summary-sig-name">calculate</a>(<span class="summary-sig-arg">self</span>)</span><br />
      This function is called to compute optimal molecule alignment and 
      determine attached r-groups.</td>
          <td align="right" valign="top">
            
            
          </td>
        </tr>
      </table>
      
    </td>
  </tr>
<tr class="private">
    <td width="15%" align="right" valign="top" class="summary">
      <span class="summary-type">&nbsp;</span>
    </td><td class="summary">
      <table width="100%" cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td><span class="summary-sig"><a name="_findCoreMatches"></a><span class="summary-sig-name">_findCoreMatches</span>(<span class="summary-sig-arg">self</span>)</span><br />
      In this function we loop over all molecule and find all possible core
      matches.</td>
          <td align="right" valign="top">
            
            
          </td>
        </tr>
      </table>
      
    </td>
  </tr>
<tr class="private">
    <td width="15%" align="right" valign="top" class="summary">
      <span class="summary-type">&nbsp;</span>
    </td><td class="summary">
      <table width="100%" cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td><span class="summary-sig"><a href="schrodinger.application.canvas.r_group.RGroupFinder-class.html#_checkAndTallyCoreMatches" class="summary-sig-name" onclick="show_private();">_checkAndTallyCoreMatches</a>(<span class="summary-sig-arg">self</span>,
        <span class="summary-sig-arg">i</span>,
        <span class="summary-sig-arg">ct</span>,
        <span class="summary-sig-arg">core_matches</span>,
        <span class="summary-sig-arg">bond_matches</span>)</span><br />
      Verify that a valid match was found by checking that core atoms contains
any heavy atoms, that current molecule is not a duplicate etc.</td>
          <td align="right" valign="top">
            
            
          </td>
        </tr>
      </table>
      
    </td>
  </tr>
<tr class="private">
    <td width="15%" align="right" valign="top" class="summary">
      <span class="summary-type">&nbsp;</span>
    </td><td class="summary">
      <table width="100%" cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td><span class="summary-sig"><a href="schrodinger.application.canvas.r_group.RGroupFinder-class.html#_checkCoreMatches" class="summary-sig-name" onclick="show_private();">_checkCoreMatches</a>(<span class="summary-sig-arg">self</span>,
        <span class="summary-sig-arg">ct</span>,
        <span class="summary-sig-arg">core_matches</span>,
        <span class="summary-sig-arg">bond_matches</span>)</span><br />
      Verifies that a valid match was found by checking that core atoms
contains any heavy atoms, that current molecule is not a duplicate etc.</td>
          <td align="right" valign="top">
            
            
          </td>
        </tr>
      </table>
      
    </td>
  </tr>
<tr class="private">
    <td width="15%" align="right" valign="top" class="summary">
      <span class="summary-type">&nbsp;</span>
    </td><td class="summary">
      <table width="100%" cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td><span class="summary-sig"><a href="schrodinger.application.canvas.r_group.RGroupFinder-class.html#_checkCoreHeavyAtoms" class="summary-sig-name" onclick="show_private();">_checkCoreHeavyAtoms</a>(<span class="summary-sig-arg">self</span>,
        <span class="summary-sig-arg">ct</span>,
        <span class="summary-sig-arg">core_matches</span>,
        <span class="summary-sig-arg">bond_matches</span>)</span><br />
      This function verifies that core match has heavy atoms.</td>
          <td align="right" valign="top">
            
            
          </td>
        </tr>
      </table>
      
    </td>
  </tr>
<tr class="private">
    <td width="15%" align="right" valign="top" class="summary">
      <span class="summary-type">&nbsp;</span>
    </td><td class="summary">
      <table width="100%" cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td><span class="summary-sig"><a href="schrodinger.application.canvas.r_group.RGroupFinder-class.html#_generateMessage" class="summary-sig-name" onclick="show_private();">_generateMessage</a>(<span class="summary-sig-arg">self</span>)</span><br />
      This function checks calculation results and generates appropriate 
      message.</td>
          <td align="right" valign="top">
            
            
          </td>
        </tr>
      </table>
      
    </td>
  </tr>
<tr class="private">
    <td width="15%" align="right" valign="top" class="summary">
      <span class="summary-type">list</span>
    </td><td class="summary">
      <table width="100%" cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td><span class="summary-sig"><a href="schrodinger.application.canvas.r_group.RGroupFinder-class.html#_findAttachments" class="summary-sig-name" onclick="show_private();">_findAttachments</a>(<span class="summary-sig-arg">self</span>,
        <span class="summary-sig-arg">ct</span>,
        <span class="summary-sig-arg">core</span>)</span><br />
      Find attachments for a given core.</td>
          <td align="right" valign="top">
            
            
          </td>
        </tr>
      </table>
      
    </td>
  </tr>
<tr class="private">
    <td width="15%" align="right" valign="top" class="summary">
      <span class="summary-type">&nbsp;</span>
    </td><td class="summary">
      <table width="100%" cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td><span class="summary-sig"><a href="schrodinger.application.canvas.r_group.RGroupFinder-class.html#_optimizeAlignment" class="summary-sig-name" onclick="show_private();">_optimizeAlignment</a>(<span class="summary-sig-arg">self</span>)</span><br />
      This function finds best core matches for molecules that have 
      multiple matches.</td>
          <td align="right" valign="top">
            
            
          </td>
        </tr>
      </table>
      
    </td>
  </tr>
<tr class="private">
    <td width="15%" align="right" valign="top" class="summary">
      <span class="summary-type">list, int</span>
    </td><td class="summary">
      <table width="100%" cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td><span class="summary-sig"><a href="schrodinger.application.canvas.r_group.RGroupFinder-class.html#_calculateStatesTally" class="summary-sig-name" onclick="show_private();">_calculateStatesTally</a>(<span class="summary-sig-arg">self</span>)</span><br />
      This function calculates number of 'states' (matches) for each 
      multiply matched molecule as well as the grand total of all states.</td>
          <td align="right" valign="top">
            
            
          </td>
        </tr>
      </table>
      
    </td>
  </tr>
<tr class="private">
    <td width="15%" align="right" valign="top" class="summary">
      <span class="summary-type">list</span>
    </td><td class="summary">
      <table width="100%" cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td><span class="summary-sig"><a href="schrodinger.application.canvas.r_group.RGroupFinder-class.html#_findBestMatches" class="summary-sig-name" onclick="show_private();">_findBestMatches</a>(<span class="summary-sig-arg">self</span>)</span><br />
      Find best matching core for each multiply matched molecule.</td>
          <td align="right" valign="top">
            
            
          </td>
        </tr>
      </table>
      
    </td>
  </tr>
<tr class="private">
    <td width="15%" align="right" valign="top" class="summary">
      <span class="summary-type"><a 
      href="schrodinger.application.canvas.r_group_dee.DEE_EnergyMatrix-class.html"
      class="link">DEE_EnergyMatrix</a></span>
    </td><td class="summary">
      <table width="100%" cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td><span class="summary-sig"><a href="schrodinger.application.canvas.r_group.RGroupFinder-class.html#_calculateEnergyMatrix" class="summary-sig-name" onclick="show_private();">_calculateEnergyMatrix</a>(<span class="summary-sig-arg">self</span>)</span><br />
      This function computes 'energy' matrix that is used in the 
      optimization procedure that finds best matching cores for each 
      molecule.</td>
          <td align="right" valign="top">
            
            
          </td>
        </tr>
      </table>
      
    </td>
  </tr>
<tr class="private">
    <td width="15%" align="right" valign="top" class="summary">
      <span class="summary-type">dict</span>
    </td><td class="summary">
      <table width="100%" cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td><span class="summary-sig"><a href="schrodinger.application.canvas.r_group.RGroupFinder-class.html#_calculateRGroupSimilarity" class="summary-sig-name" onclick="show_private();">_calculateRGroupSimilarity</a>(<span class="summary-sig-arg">self</span>)</span><br />
      This function calculates Tanimoto fingerprint similarities for every 
      attachment pair defined using SMILES.</td>
          <td align="right" valign="top">
            
            
          </td>
        </tr>
      </table>
      
    </td>
  </tr>
<tr class="private">
    <td width="15%" align="right" valign="top" class="summary">
      <span class="summary-type">dict</span>
    </td><td class="summary">
      <table width="100%" cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td><span class="summary-sig"><a href="schrodinger.application.canvas.r_group.RGroupFinder-class.html#_findUniqueRGroups" class="summary-sig-name" onclick="show_private();">_findUniqueRGroups</a>(<span class="summary-sig-arg">self</span>)</span><br />
      This function iterates over core 'states'.</td>
          <td align="right" valign="top">
            
            
          </td>
        </tr>
      </table>
      
    </td>
  </tr>
<tr class="private">
    <td width="15%" align="right" valign="top" class="summary">
      <span class="summary-type">dict</span>
    </td><td class="summary">
      <table width="100%" cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td><span class="summary-sig"><a href="schrodinger.application.canvas.r_group.RGroupFinder-class.html#_calculatePairSimilarity" class="summary-sig-name" onclick="show_private();">_calculatePairSimilarity</a>(<span class="summary-sig-arg">self</span>,
        <span class="summary-sig-arg">r_group_bitset</span>,
        <span class="summary-sig-arg">sim_func</span>)</span><br />
      This function calculates similarities for each pair of unique r-group
      attachments.</td>
          <td align="right" valign="top">
            
            
          </td>
        </tr>
      </table>
      
    </td>
  </tr>
<tr class="private">
    <td width="15%" align="right" valign="top" class="summary">
      <span class="summary-type">float</span>
    </td><td class="summary">
      <table width="100%" cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td><span class="summary-sig"><a href="schrodinger.application.canvas.r_group.RGroupFinder-class.html#_calculatePairSimilarityFP" class="summary-sig-name" onclick="show_private();">_calculatePairSimilarityFP</a>(<span class="summary-sig-arg">self</span>,
        <span class="summary-sig-arg">key1</span>,
        <span class="summary-sig-arg">key2</span>,
        <span class="summary-sig-arg">r_group_bitset</span>)</span><br />
      This function calculates Tanimoto FP similarities for a pair of 
      unique r-group attachments.</td>
          <td align="right" valign="top">
            
            
          </td>
        </tr>
      </table>
      
    </td>
  </tr>
<tr class="private">
    <td width="15%" align="right" valign="top" class="summary">
      <span class="summary-type">float</span>
    </td><td class="summary">
      <table width="100%" cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td><span class="summary-sig"><a href="schrodinger.application.canvas.r_group.RGroupFinder-class.html#_calculatePairSimilarityGeneric" class="summary-sig-name" onclick="show_private();">_calculatePairSimilarityGeneric</a>(<span class="summary-sig-arg">self</span>,
        <span class="summary-sig-arg">key1</span>,
        <span class="summary-sig-arg">key2</span>,
        <span class="summary-sig-arg">r_group_bitset</span>)</span><br />
      This function calculates similarities for a pair of unique r-group 
      attachments using simple sheme.</td>
          <td align="right" valign="top">
            
            
          </td>
        </tr>
      </table>
      
    </td>
  </tr>
<tr class="private">
    <td width="15%" align="right" valign="top" class="summary">
      <span class="summary-type">double</span>
    </td><td class="summary">
      <table width="100%" cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td><span class="summary-sig"><a href="schrodinger.application.canvas.r_group.RGroupFinder-class.html#_calculateStatePairScore" class="summary-sig-name" onclick="show_private();">_calculateStatePairScore</a>(<span class="summary-sig-arg">self</span>,
        <span class="summary-sig-arg">a1</span>,
        <span class="summary-sig-arg">a2</span>,
        <span class="summary-sig-arg">r_group_sim</span>)</span><br />
      This function calculates pairwise score for a pair of core states.</td>
          <td align="right" valign="top">
            
            
          </td>
        </tr>
      </table>
      
    </td>
  </tr>
<tr class="private">
    <td width="15%" align="right" valign="top" class="summary">
      <span class="summary-type">&nbsp;</span>
    </td><td class="summary">
      <table width="100%" cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td><span class="summary-sig"><a href="schrodinger.application.canvas.r_group.RGroupFinder-class.html#_calculateSimilarityMatrix" class="summary-sig-name" onclick="show_private();">_calculateSimilarityMatrix</a>(<span class="summary-sig-arg">self</span>,
        <span class="summary-sig-arg">ns</span>,
        <span class="summary-sig-arg">r_group_sim</span>)</span><br />
      This function computes similarity matrix, which contains pairwise 
      scores between core states of molecules that have multiple core 
      matches.</td>
          <td align="right" valign="top">
            
            
          </td>
        </tr>
      </table>
      
    </td>
  </tr>
<tr class="private">
    <td width="15%" align="right" valign="top" class="summary">
      <span class="summary-type">&nbsp;</span>
    </td><td class="summary">
      <table width="100%" cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td><span class="summary-sig"><a href="schrodinger.application.canvas.r_group.RGroupFinder-class.html#_finalizeCalculation" class="summary-sig-name" onclick="show_private();">_finalizeCalculation</a>(<span class="summary-sig-arg">self</span>)</span><br />
      This function is used to add r-group data into Data() object after 
      best matching core has been found.</td>
          <td align="right" valign="top">
            
            
          </td>
        </tr>
      </table>
      
    </td>
  </tr>
<tr class="private">
    <td width="15%" align="right" valign="top" class="summary">
      <span class="summary-type">&nbsp;</span>
    </td><td class="summary">
      <table width="100%" cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td><span class="summary-sig"><a name="_saveBestMatchData"></a><span class="summary-sig-name">_saveBestMatchData</span>(<span class="summary-sig-arg">self</span>)</span><br />
      This function iterates over input structures and stores core and bond
      data for 'best matches' in the Data() structure.</td>
          <td align="right" valign="top">
            
            
          </td>
        </tr>
      </table>
      
    </td>
  </tr>
<tr class="private">
    <td width="15%" align="right" valign="top" class="summary">
      <span class="summary-type">&nbsp;</span>
    </td><td class="summary">
      <table width="100%" cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td><span class="summary-sig"><a name="_savePropertyAndAttachmentData"></a><span class="summary-sig-name">_savePropertyAndAttachmentData</span>(<span class="summary-sig-arg">self</span>)</span><br />
      Iterate over input structures and save property and attachment groups
      data in the main Data() structure.</td>
          <td align="right" valign="top">
            
            
          </td>
        </tr>
      </table>
      
    </td>
  </tr>
</table>
<!-- ==================== METHOD DETAILS ==================== -->
<a name="section-MethodDetails"></a>
<table class="details" border="1" cellpadding="3"
       cellspacing="0" width="100%" bgcolor="white">
<tr bgcolor="#70b0f0" class="table-header">
  <td colspan="2" class="table-header">
    <table border="0" cellpadding="0" cellspacing="0" width="100%">
      <tr valign="top">
        <td align="left"><span class="table-header">Method Details</span></td>
        <td align="right" valign="top"
         ><span class="options">[<a href="#section-MethodDetails"
         class="privatelink" onclick="toggle_private();"
         >hide private</a>]</span></td>
      </tr>
    </table>
  </td>
</tr>
</table>
<a name="__init__"></a>
<div>
<table class="details" border="1" cellpadding="3"
       cellspacing="0" width="100%" bgcolor="white">
<tr><td>
  <table width="100%" cellpadding="0" cellspacing="0" border="0">
  <tr valign="top"><td>
  <h3 class="epydoc"><span class="sig"><span class="sig-name">__init__</span>(<span class="sig-arg">self</span>,
        <span class="sig-arg">input_file</span>,
        <span class="sig-arg">smarts</span>,
        <span class="sig-arg">temp_dir</span>=<span class="sig-default">None</span>,
        <span class="sig-arg">thread</span>=<span class="sig-default">None</span>,
        <span class="sig-arg">use_mm</span>=<span class="sig-default">1</span>,
        <span class="sig-arg">use_fp_sim</span>=<span class="sig-default">False</span>,
        <span class="sig-arg">sa_seed</span>=<span class="sig-default">None</span>,
        <span class="sig-arg">t_factor</span>=<span class="sig-default">None</span>,
        <span class="sig-arg">tmax_mult</span>=<span class="sig-default">None</span>)</span>
    <br /><em class="fname">(Constructor)</em>
  </h3>
  </td><td align="right" valign="top"
    >&nbsp;
    </td>
  </tr></table>
  
  <p>This function creates an instance of RGroupFinder object.</p>
  <dl class="fields">
    <dt>Parameters:</dt>
    <dd><ul class="nomargin-top">
        <li><strong class="pname"><code>input_file</code></strong> (str) - name of the input structure file</li>
        <li><strong class="pname"><code>smarts</code></strong> (list) - list of cores SMARTS patterns</li>
        <li><strong class="pname"><code>temp_dir</code></strong> (str) - name of temporary directory</li>
        <li><strong class="pname"><code>thread</code></strong> (calculation_thread) - calculation thread (optional)</li>
        <li><strong class="pname"><code>use_mm</code></strong> (int) - type of multiple matching algorithm (1-SA and 2-DEE)</li>
        <li><strong class="pname"><code>use_fp_sim</code></strong> (bool) - True to use fingerprint similarity between pairs of 'states'</li>
        <li><strong class="pname"><code>sa_seed</code></strong> (int) - SimualtedAnnealing random generator seed</li>
        <li><strong class="pname"><code>t_factor</code></strong> - SimulatedAnnealing temperature factor</li>
        <li><strong class="pname"><code>tmax_mult</code></strong> (float) - SimualtedAnnealing parameter to set starting temperature</li>
    </ul></dd>
  </dl>
</td></tr></table>
</div>
<a name="calculate"></a>
<div>
<table class="details" border="1" cellpadding="3"
       cellspacing="0" width="100%" bgcolor="white">
<tr><td>
  <table width="100%" cellpadding="0" cellspacing="0" border="0">
  <tr valign="top"><td>
  <h3 class="epydoc"><span class="sig"><span class="sig-name">calculate</span>(<span class="sig-arg">self</span>)</span>
  </h3>
  </td><td align="right" valign="top"
    >&nbsp;
    </td>
  </tr></table>
  
  <p>This function is called to compute optimal molecule alignment and 
  determine attached r-groups. It defines the order of calls that need to 
  be made as in 'Template Method' design pattern. When calculation is done 
  here self.data object can be retrieved to get results.</p>
  <dl class="fields">
  </dl>
</td></tr></table>
</div>
<a name="_checkAndTallyCoreMatches"></a>
<div class="private">
<table class="details" border="1" cellpadding="3"
       cellspacing="0" width="100%" bgcolor="white">
<tr><td>
  <table width="100%" cellpadding="0" cellspacing="0" border="0">
  <tr valign="top"><td>
  <h3 class="epydoc"><span class="sig"><span class="sig-name">_checkAndTallyCoreMatches</span>(<span class="sig-arg">self</span>,
        <span class="sig-arg">i</span>,
        <span class="sig-arg">ct</span>,
        <span class="sig-arg">core_matches</span>,
        <span class="sig-arg">bond_matches</span>)</span>
  </h3>
  </td><td align="right" valign="top"
    >&nbsp;
    </td>
  </tr></table>
  
  <pre class="literalblock">

Verify that a valid match was found by checking that core atoms contains
any heavy atoms, that current molecule is not a duplicate etc.  Also
update the class attributes to reflect the results of the verification.

@param i: index of current molecule
@type i: int

@param ct: current molecule ct
@type ct: L{schrodinger.structure.Structure}

@param core_matches: list of lists of core atom indices for each match
found
@type core_matches: list

@param bond_matches: list of lists of core bonds for each match found
@type bond_matches: list

@return: A tuple of:
- A bool indicating whether this is a 'good' match
- The updated core_matches list
- The updated bond_matches list
@rtype: tuple

</pre>
  <dl class="fields">
  </dl>
</td></tr></table>
</div>
<a name="_checkCoreMatches"></a>
<div class="private">
<table class="details" border="1" cellpadding="3"
       cellspacing="0" width="100%" bgcolor="white">
<tr><td>
  <table width="100%" cellpadding="0" cellspacing="0" border="0">
  <tr valign="top"><td>
  <h3 class="epydoc"><span class="sig"><span class="sig-name">_checkCoreMatches</span>(<span class="sig-arg">self</span>,
        <span class="sig-arg">ct</span>,
        <span class="sig-arg">core_matches</span>,
        <span class="sig-arg">bond_matches</span>)</span>
  </h3>
  </td><td align="right" valign="top"
    >&nbsp;
    </td>
  </tr></table>
  
  <pre class="literalblock">

Verifies that a valid match was found by checking that core atoms
contains any heavy atoms, that current molecule is not a duplicate etc.

@param ct: current molecule ct
@type ct: L{schrodinger.structure.Structure}

@param core_matches: list of lists of core atom indices for each match found
@type core_matches: list

@param bond_matches: list of lists of core bonds for each match found
@type bond_matches: list

@return: A tuple of:
- A match state constant that is one of GOOD_MATCH, NO_MATCHES,
  DUPLICATE_MATCH, or NO_HEAVY_ATOM_MATCH
- The updated core_matches list
- The updated bond_matches list
- The smiles string for the input molecule
@rtype: tuple

</pre>
  <dl class="fields">
  </dl>
</td></tr></table>
</div>
<a name="_checkCoreHeavyAtoms"></a>
<div class="private">
<table class="details" border="1" cellpadding="3"
       cellspacing="0" width="100%" bgcolor="white">
<tr><td>
  <table width="100%" cellpadding="0" cellspacing="0" border="0">
  <tr valign="top"><td>
  <h3 class="epydoc"><span class="sig"><span class="sig-name">_checkCoreHeavyAtoms</span>(<span class="sig-arg">self</span>,
        <span class="sig-arg">ct</span>,
        <span class="sig-arg">core_matches</span>,
        <span class="sig-arg">bond_matches</span>)</span>
  </h3>
  </td><td align="right" valign="top"
    >&nbsp;
    </td>
  </tr></table>
  
  <pre class="literalblock">

This function verifies that core match has heavy atoms.

@param ct: current molecule ct
@type ct: L{schrodinger.structure.Structure}

@param core_matches: list of lists of core atom indices for each match found
@type core_matches: list

@param bond_matches: list of lists of core bonds for each match found
@type bond_matches: list

@return: A tuple of:
- A match state constant that is one of GOOD_MATCH, NO_MATCHES,
  DUPLICATE_MATCH, or NO_HEAVY_ATOM_MATCH
- The updated core_matches list
- The updated bond_matches list
@rtype: tuple

</pre>
  <dl class="fields">
  </dl>
</td></tr></table>
</div>
<a name="_generateMessage"></a>
<div class="private">
<table class="details" border="1" cellpadding="3"
       cellspacing="0" width="100%" bgcolor="white">
<tr><td>
  <table width="100%" cellpadding="0" cellspacing="0" border="0">
  <tr valign="top"><td>
  <h3 class="epydoc"><span class="sig"><span class="sig-name">_generateMessage</span>(<span class="sig-arg">self</span>)</span>
  </h3>
  </td><td align="right" valign="top"
    >&nbsp;
    </td>
  </tr></table>
  
  <p>This function checks calculation results and generates appropriate 
  message.</p>
  <dl class="fields">
    <dt>Raises:</dt>
    <dd><ul class="nomargin-top">
        <li><code><strong class='fraise'><a href="schrodinger.application.canvas.r_group.RGroupException-class.html">RGroupException</a></strong></code> - raises this exception if only one structure matched the core 
        definition or no matches were found.</li>
    </ul></dd>
  </dl>
</td></tr></table>
</div>
<a name="_findAttachments"></a>
<div class="private">
<table class="details" border="1" cellpadding="3"
       cellspacing="0" width="100%" bgcolor="white">
<tr><td>
  <table width="100%" cellpadding="0" cellspacing="0" border="0">
  <tr valign="top"><td>
  <h3 class="epydoc"><span class="sig"><span class="sig-name">_findAttachments</span>(<span class="sig-arg">self</span>,
        <span class="sig-arg">ct</span>,
        <span class="sig-arg">core</span>)</span>
  </h3>
  </td><td align="right" valign="top"
    >&nbsp;
    </td>
  </tr></table>
  
  <p>Find attachments for a given core.</p>
  <dl class="fields">
    <dt>Parameters:</dt>
    <dd><ul class="nomargin-top">
        <li><strong class="pname"><code>ct</code></strong> (<a href="schrodinger.structure.Structure-class.html" 
          class="link">schrodinger.structure.Structure</a>) - current molecule ct</li>
        <li><strong class="pname"><code>core</code></strong> (list) - core atom indices</li>
    </ul></dd>
    <dt>Returns: list</dt>
        <dd>list of attached groups ('hydrogen', 'null' or SMILES)</dd>
  </dl>
</td></tr></table>
</div>
<a name="_optimizeAlignment"></a>
<div class="private">
<table class="details" border="1" cellpadding="3"
       cellspacing="0" width="100%" bgcolor="white">
<tr><td>
  <table width="100%" cellpadding="0" cellspacing="0" border="0">
  <tr valign="top"><td>
  <h3 class="epydoc"><span class="sig"><span class="sig-name">_optimizeAlignment</span>(<span class="sig-arg">self</span>)</span>
  </h3>
  </td><td align="right" valign="top"
    >&nbsp;
    </td>
  </tr></table>
  
  <p>This function finds best core matches for molecules that have multiple
  matches. Indices of best core matches are appended to self.core_states 
  data.</p>
  <dl class="fields">
  </dl>
</td></tr></table>
</div>
<a name="_calculateStatesTally"></a>
<div class="private">
<table class="details" border="1" cellpadding="3"
       cellspacing="0" width="100%" bgcolor="white">
<tr><td>
  <table width="100%" cellpadding="0" cellspacing="0" border="0">
  <tr valign="top"><td>
  <h3 class="epydoc"><span class="sig"><span class="sig-name">_calculateStatesTally</span>(<span class="sig-arg">self</span>)</span>
  </h3>
  </td><td align="right" valign="top"
    >&nbsp;
    </td>
  </tr></table>
  
  <p>This function calculates number of 'states' (matches) for each 
  multiply matched molecule as well as the grand total of all states.</p>
  <dl class="fields">
    <dt>Returns: list, int</dt>
        <dd>list consisting of number of states for each molecule and a total
          number of states</dd>
  </dl>
</td></tr></table>
</div>
<a name="_findBestMatches"></a>
<div class="private">
<table class="details" border="1" cellpadding="3"
       cellspacing="0" width="100%" bgcolor="white">
<tr><td>
  <table width="100%" cellpadding="0" cellspacing="0" border="0">
  <tr valign="top"><td>
  <h3 class="epydoc"><span class="sig"><span class="sig-name">_findBestMatches</span>(<span class="sig-arg">self</span>)</span>
  </h3>
  </td><td align="right" valign="top"
    >&nbsp;
    </td>
  </tr></table>
  
  <p>Find best matching core for each multiply matched molecule.</p>
  <dl class="fields">
    <dt>Returns: list</dt>
        <dd>list that contains indices of 'best matching' cores for each 
          molecule</dd>
  </dl>
</td></tr></table>
</div>
<a name="_calculateEnergyMatrix"></a>
<div class="private">
<table class="details" border="1" cellpadding="3"
       cellspacing="0" width="100%" bgcolor="white">
<tr><td>
  <table width="100%" cellpadding="0" cellspacing="0" border="0">
  <tr valign="top"><td>
  <h3 class="epydoc"><span class="sig"><span class="sig-name">_calculateEnergyMatrix</span>(<span class="sig-arg">self</span>)</span>
  </h3>
  </td><td align="right" valign="top"
    >&nbsp;
    </td>
  </tr></table>
  
  <p>This function computes 'energy' matrix that is used in the 
  optimization procedure that finds best matching cores for each 
  molecule.</p>
  <dl class="fields">
    <dt>Returns: <a 
      href="schrodinger.application.canvas.r_group_dee.DEE_EnergyMatrix-class.html"
      class="link">DEE_EnergyMatrix</a></dt>
        <dd>energy matrix</dd>
  </dl>
</td></tr></table>
</div>
<a name="_calculateRGroupSimilarity"></a>
<div class="private">
<table class="details" border="1" cellpadding="3"
       cellspacing="0" width="100%" bgcolor="white">
<tr><td>
  <table width="100%" cellpadding="0" cellspacing="0" border="0">
  <tr valign="top"><td>
  <h3 class="epydoc"><span class="sig"><span class="sig-name">_calculateRGroupSimilarity</span>(<span class="sig-arg">self</span>)</span>
  </h3>
  </td><td align="right" valign="top"
    >&nbsp;
    </td>
  </tr></table>
  
  <p>This function calculates Tanimoto fingerprint similarities for every 
  attachment pair defined using SMILES.</p>
  <dl class="fields">
    <dt>Returns: dict</dt>
        <dd>dictionary of similarity scores keyd on the pair of SMILES string</dd>
  </dl>
</td></tr></table>
</div>
<a name="_findUniqueRGroups"></a>
<div class="private">
<table class="details" border="1" cellpadding="3"
       cellspacing="0" width="100%" bgcolor="white">
<tr><td>
  <table width="100%" cellpadding="0" cellspacing="0" border="0">
  <tr valign="top"><td>
  <h3 class="epydoc"><span class="sig"><span class="sig-name">_findUniqueRGroups</span>(<span class="sig-arg">self</span>)</span>
  </h3>
  </td><td align="right" valign="top"
    >&nbsp;
    </td>
  </tr></table>
  
  <p>This function iterates over core 'states'. For each attached group, 
  which is defined by a SMILES string, it calculates its fingerprint. 
  SMILES string is used as a key, so that we only store FPs for unique 
  attachments.</p>
  <dl class="fields">
    <dt>Returns: dict</dt>
        <dd>dictionary, where SMILES is key and FP is value</dd>
  </dl>
</td></tr></table>
</div>
<a name="_calculatePairSimilarity"></a>
<div class="private">
<table class="details" border="1" cellpadding="3"
       cellspacing="0" width="100%" bgcolor="white">
<tr><td>
  <table width="100%" cellpadding="0" cellspacing="0" border="0">
  <tr valign="top"><td>
  <h3 class="epydoc"><span class="sig"><span class="sig-name">_calculatePairSimilarity</span>(<span class="sig-arg">self</span>,
        <span class="sig-arg">r_group_bitset</span>,
        <span class="sig-arg">sim_func</span>)</span>
  </h3>
  </td><td align="right" valign="top"
    >&nbsp;
    </td>
  </tr></table>
  
  <p>This function calculates similarities for each pair of unique r-group 
  attachments.</p>
  <dl class="fields">
    <dt>Parameters:</dt>
    <dd><ul class="nomargin-top">
        <li><strong class="pname"><code>r_group_bitset</code></strong> (dict) - dictionary of FPs for r-groups keyed on SMILES</li>
        <li><strong class="pname"><code>sim_func</code></strong> (function) - function used to compute similarity between pair of attachments. 
          This function can be either _calculatePairSimilarityFP or 
          _calculatePairSimilarityGeneric.</li>
    </ul></dd>
    <dt>Returns: dict</dt>
        <dd>dictionary of pair similarities keyed on a pair of SMILES</dd>
  </dl>
</td></tr></table>
</div>
<a name="_calculatePairSimilarityFP"></a>
<div class="private">
<table class="details" border="1" cellpadding="3"
       cellspacing="0" width="100%" bgcolor="white">
<tr><td>
  <table width="100%" cellpadding="0" cellspacing="0" border="0">
  <tr valign="top"><td>
  <h3 class="epydoc"><span class="sig"><span class="sig-name">_calculatePairSimilarityFP</span>(<span class="sig-arg">self</span>,
        <span class="sig-arg">key1</span>,
        <span class="sig-arg">key2</span>,
        <span class="sig-arg">r_group_bitset</span>)</span>
  </h3>
  </td><td align="right" valign="top"
    >&nbsp;
    </td>
  </tr></table>
  
  <p>This function calculates Tanimoto FP similarities for a pair of unique
  r-group attachments.</p>
  <dl class="fields">
    <dt>Parameters:</dt>
    <dd><ul class="nomargin-top">
        <li><strong class="pname"><code>key1</code></strong> (str) - first r-group key, which can be SMILES or 'hydrogen'</li>
        <li><strong class="pname"><code>key2</code></strong> (str) - second r-group key, which can be SMILES or 'hydrogen'</li>
        <li><strong class="pname"><code>r_group_bitset</code></strong> (dict) - dict of FPs for r-groups.</li>
    </ul></dd>
    <dt>Returns: float</dt>
        <dd>similarity between two groups</dd>
  </dl>
</td></tr></table>
</div>
<a name="_calculatePairSimilarityGeneric"></a>
<div class="private">
<table class="details" border="1" cellpadding="3"
       cellspacing="0" width="100%" bgcolor="white">
<tr><td>
  <table width="100%" cellpadding="0" cellspacing="0" border="0">
  <tr valign="top"><td>
  <h3 class="epydoc"><span class="sig"><span class="sig-name">_calculatePairSimilarityGeneric</span>(<span class="sig-arg">self</span>,
        <span class="sig-arg">key1</span>,
        <span class="sig-arg">key2</span>,
        <span class="sig-arg">r_group_bitset</span>)</span>
  </h3>
  </td><td align="right" valign="top"
    >&nbsp;
    </td>
  </tr></table>
  
  <p>This function calculates similarities for a pair of unique r-group 
  attachments using simple sheme.</p>
  <dl class="fields">
    <dt>Parameters:</dt>
    <dd><ul class="nomargin-top">
        <li><strong class="pname"><code>key1</code></strong> (str) - first r-group key, which can be SMILES or 'hydrogen'</li>
        <li><strong class="pname"><code>key2</code></strong> (str) - second r-group key, which can be SMILES or 'hydrogen'</li>
        <li><strong class="pname"><code>r_group_bitset</code></strong> (dict) - dict of FPs for r-groups. This variable is not used by this 
          function, but we need it for compatibility.</li>
    </ul></dd>
    <dt>Returns: float</dt>
        <dd>similarity between two groups</dd>
  </dl>
</td></tr></table>
</div>
<a name="_calculateStatePairScore"></a>
<div class="private">
<table class="details" border="1" cellpadding="3"
       cellspacing="0" width="100%" bgcolor="white">
<tr><td>
  <table width="100%" cellpadding="0" cellspacing="0" border="0">
  <tr valign="top"><td>
  <h3 class="epydoc"><span class="sig"><span class="sig-name">_calculateStatePairScore</span>(<span class="sig-arg">self</span>,
        <span class="sig-arg">a1</span>,
        <span class="sig-arg">a2</span>,
        <span class="sig-arg">r_group_sim</span>)</span>
  </h3>
  </td><td align="right" valign="top"
    >&nbsp;
    </td>
  </tr></table>
  
  <p>This function calculates pairwise score for a pair of core states. For
  each state we have lists of groups at each attachment point. These groups
  can be 'null', 'hydrogen' or be identified by a SMILES string. It is 
  possible to have multiple groups attached to the same point.</p>
  <dl class="fields">
    <dt>Parameters:</dt>
    <dd><ul class="nomargin-top">
        <li><strong class="pname"><code>a1</code></strong> (list) - list of attachment groups for 1st state</li>
        <li><strong class="pname"><code>a2</code></strong> (list) - list of attachment groups for 2nd state</li>
        <li><strong class="pname"><code>r_group_sim</code></strong> (dict) - dictionary of Tanimoto similarities</li>
    </ul></dd>
    <dt>Returns: double</dt>
        <dd>pairwise score</dd>
  </dl>
</td></tr></table>
</div>
<a name="_calculateSimilarityMatrix"></a>
<div class="private">
<table class="details" border="1" cellpadding="3"
       cellspacing="0" width="100%" bgcolor="white">
<tr><td>
  <table width="100%" cellpadding="0" cellspacing="0" border="0">
  <tr valign="top"><td>
  <h3 class="epydoc"><span class="sig"><span class="sig-name">_calculateSimilarityMatrix</span>(<span class="sig-arg">self</span>,
        <span class="sig-arg">ns</span>,
        <span class="sig-arg">r_group_sim</span>)</span>
  </h3>
  </td><td align="right" valign="top"
    >&nbsp;
    </td>
  </tr></table>
  
  <p>This function computes similarity matrix, which contains pairwise 
  scores between core states of molecules that have multiple core 
  matches.</p>
  <dl class="fields">
    <dt>Parameters:</dt>
    <dd><ul class="nomargin-top">
        <li><strong class="pname"><code>ns</code></strong> (int) - total number of core states (matrix dimensions)</li>
        <li><strong class="pname"><code>r_group_sim</code></strong> (dict) - pairwise Tanimoto similarity between pairs of attachments</li>
    </ul></dd>
    <dt>Returns:</dt>
        <dd>ns * ns similarity matrix</dd>
  </dl>
</td></tr></table>
</div>
<a name="_finalizeCalculation"></a>
<div class="private">
<table class="details" border="1" cellpadding="3"
       cellspacing="0" width="100%" bgcolor="white">
<tr><td>
  <table width="100%" cellpadding="0" cellspacing="0" border="0">
  <tr valign="top"><td>
  <h3 class="epydoc"><span class="sig"><span class="sig-name">_finalizeCalculation</span>(<span class="sig-arg">self</span>)</span>
  </h3>
  </td><td align="right" valign="top"
    >&nbsp;
    </td>
  </tr></table>
  
  <p>This function is used to add r-group data into Data() object after 
  best matching core has been found. This includes adding core bonds, 
  adding properties and adding information about attched groups.</p>
  <dl class="fields">
  </dl>
</td></tr></table>
</div>
<br />
<!-- ==================== NAVIGATION BAR ==================== -->
<table class="navbar" border="0" width="100%" cellpadding="0"
       bgcolor="#a0c0ff" cellspacing="0">
  <tr valign="middle">

  <!-- Tree link -->
      <th>&nbsp;&nbsp;&nbsp;<a
        href="module-tree.html">Trees</a>&nbsp;&nbsp;&nbsp;</th>

  <!-- Index link -->
      <th>&nbsp;&nbsp;&nbsp;<a
        href="identifier-index.html">Indices</a>&nbsp;&nbsp;&nbsp;</th>

  <!-- Help link -->
      <th>&nbsp;&nbsp;&nbsp;<a
        href="help.html">Help</a>&nbsp;&nbsp;&nbsp;</th>

  <!-- Project homepage -->
      <th class="navbar" align="right" width="100%">
        <table border="0" cellpadding="0" cellspacing="0">
          <tr><th class="navbar" align="center"
            >2015-2Schrodinger Python API</th>
          </tr></table></th>
  </tr>
</table>
<table border="0" cellpadding="0" cellspacing="0" width="100%%">
  <tr>
    <td align="left" class="footer">
    Generated by Epydoc 3.0.1 on Sat May  9 06:31:03 2015
    </td>
    <td align="right" class="footer">
      <a target="mainFrame" href="http://epydoc.sourceforge.net"
        >http://epydoc.sourceforge.net</a>
    </td>
  </tr>
</table>

<script type="text/javascript">
  <!--
  // Private objects are initially displayed (because if
  // javascript is turned off then we want them to be
  // visible); but by default, we want to hide them.  So hide
  // them unless we have a cookie that says to show them.
  checkCookie();
  // -->
</script>
</body>
</html>
