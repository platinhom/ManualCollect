<!DOCTYPE html>
<html xmlns:MadCap="http://www.madcapsoftware.com/Schemas/MadCap.xsd" lang="en-US" xml:lang="en-US" data-mc-search-type="Stem" data-mc-help-system-file-name="Documentation.xml" data-mc-path-to-help-system="../" data-mc-target-type="WebHelp2" data-mc-runtime-file-type="Topic" data-mc-preload-images="false" data-mc-in-preview-mode="false" data-mc-toc-path="User Manuals|Jaguar User Manual|Setting Jaguar Options in Maestro|SCF Settings">
    <head>
        <meta name="viewport" content="width=device-width, initial-scale=1.0" />
        <meta charset="utf-8" />
        <meta http-equiv="X-UA-Compatible" content="IE=edge" />
        <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
        <link href="../Skins/Default/Stylesheets/Slideshow.css" rel="stylesheet" type="text/css" data-mc-generated="True" />
        <link href="../Skins/Default/Stylesheets/TextEffects.css" rel="stylesheet" type="text/css" data-mc-generated="True" />
        <link href="../Skins/Default/Stylesheets/Topic.css" rel="stylesheet" type="text/css" data-mc-generated="True" />
        <link href="../Skins/Default/Stylesheets/Components/Styles.css" rel="stylesheet" type="text/css" data-mc-generated="True" /><title>SCF Convergence Methods</title>
        <link href="../Resources/Stylesheets/docs.css" rel="stylesheet" />
        <script src="../Resources/Scripts/custom.modernizr.js" type="text/javascript">
        </script>
        <script src="../Resources/Scripts/jquery.min.js" type="text/javascript">
        </script>
        <script src="../Resources/Scripts/require.min.js" type="text/javascript">
        </script>
        <script src="../Resources/Scripts/require.config.js" type="text/javascript">
        </script>
        <script src="../Resources/Scripts/foundation.min.js" type="text/javascript">
        </script>
        <script src="../Resources/Scripts/plugins.min.js" type="text/javascript">
        </script>
        <script src="../Resources/Scripts/MadCapAll.js" type="text/javascript">
        </script>
    </head>
    <body><a name="aanchor8496"></a>
        <MadCap:concept term="User Manuals" /><a name="aanchor8497"></a>
        <MadCap:concept term="Jaguar" /><a name="jaguar_options_2333515368_171298"></a>
        <table class="NavLink" data-mc-conditions="Default.ScreenOnly">
            <tr class="NavLink">
                <td class="NavLeft"><span class="NavText">◀ <a class="NavLink MCXref xref xrefNavLink" href="jaguar_options_scf_convergence.htm">SCF Convergence Criteria</a></span>
                </td>
                <td class="NavCenter"><span class="NavText"><a class="NavLink MCXref xref xrefNavLink" href="jaguar_user_manualTOC.htm">Jaguar User Manual</a></span>
                </td>
                <td class="NavRight"><span class="NavText"><a class="NavLink MCXref xref xrefNavLink" href="jaguar_options_scf_orbital.htm">Orbital Handling and Localization Settings</a> ▶</span>
                </td>
            </tr>
        </table>
        <h1 class="Title">SCF Convergence Methods</h1>
        <p>Jaguar provides a range of options for controlling the convergence of SCF calculations. These options are available in the <span class="GUI">Convergence methods</span> section. </p>
        <p>Level shifting adds a constant to the diagonal of the Fock matrix for the virtual orbitals before diagonalization. This reduces the mixing of the occupied and virtual orbitals, and damps the changes in the orbitals. As a result, the convergence is slower, but this method often helps otherwise intractable cases to converge. Level shifting is normally varied during the course of an SCF calculation without having to explicitly set a value. Useful SCF level shift values are generally in the range 0.3–1.0. You can set the constant in the <span class="GUI">SCF Level shift</span> text box.<a href="javascript:void(0);" class="MCTextPopup popup popupHead" style="font-size: 0.9em; vertical-align: super">1<span class="MCTextPopupBody MCTextPopupBody_Closed needs-pie popupBody"><span class="MCTextPopupArrow"></span>Keyword vshift in the gen section.</span></a></p>
        <p>Thermal smearing populates the virtual orbitals using a Fermi-Dirac distribution with a given temperature, allowing orbitals other than the default orbitals to be populated. The temperature is progressively reduced so that the true occupied orbitals are the only ones populated at the end of the calculation. This procedure makes it easier for orbitals to switch if they are not in the default initial guess but are in the converged wave function. To use thermal smearing, choose a method from the <span class="GUI">Thermal smearing</span> option menu<a href="javascript:void(0);" class="MCTextPopup popup popupHead" style="font-size: 0.9em; vertical-align: super">2<span class="MCTextPopupBody MCTextPopupBody_Closed needs-pie popupBody"><span class="MCTextPopupArrow"></span>Keyword ifdtherm in the gen section.</span></a> and enter a value in the <span class="GUI">Initial temperature</span> text box.<a href="javascript:void(0);" class="MCTextPopup popup popupHead" style="font-size: 0.9em; vertical-align: super">3<span class="MCTextPopupBody MCTextPopupBody_Closed needs-pie popupBody"><span class="MCTextPopupArrow"></span>Keyword fdtemp in the gen section.</span></a> More information on this method can be found in <a class="TopicLink MCXref xref xrefTopicLink" href="../jaguar_command_reference/jaguar_input_gen_scf.htm#jaguar_input_1430212170_68859">Keywords for SCF Methods in the Jaguar Input File</a>. </p>
        <p>Finally, you can attempt to force convergence by selecting the <span class="GUI">Force convergence</span> option.<a href="javascript:void(0);" class="MCTextPopup popup popupHead" style="font-size: 0.9em; vertical-align: super">4<span class="MCTextPopupBody MCTextPopupBody_Closed needs-pie popupBody"><span class="MCTextPopupArrow"></span>Keyword iacscf=1 in the gen section.</span></a> This option starts with a large level shift and adjusts the value during the calculation, and runs at ultrafine accuracy level. Use this option with caution. </p>
        <p>To speed up convergence, Jaguar offers some convergence acceleration schemes, which are available from the <span class="GUI">Convergence scheme</span> option menu. We recommend using the default Direct Inversion in the Iterative Subspace (DIIS)<a href="javascript:void(0);" class="MCTextPopup popup popupHead" style="font-size: 0.9em; vertical-align: super">5<span class="MCTextPopupBody MCTextPopupBody_Closed needs-pie popupBody"><span class="MCTextPopupArrow"></span>Keyword iconv = 1 in the gen section.</span></a> or GVB-DIIS<a href="javascript:void(0);" class="MCTextPopup popup popupHead" style="font-size: 0.9em; vertical-align: super">6<span class="MCTextPopupBody MCTextPopupBody_Closed needs-pie popupBody"><span class="MCTextPopupArrow"></span>Keyword iconv = 4 in the gen section.</span></a> SCF convergence schemes [<a class="Ref_Number_Only MCXref xref xrefRef_Number_Only" href="jaguar_references.htm#jaguar_references_1926199490_22931">11</a>, <a class="Ref_Number_Only MCXref xref xrefRef_Number_Only" href="jaguar_references.htm#jaguar_references_1926199490_227804">177</a>] whenever possible. The DIIS method generally performs better, but for jobs with SCF convergence problems, GVB-DIIS may give improved convergence. The DIIS method can be used with any wave function, including those with multiple open shells. You can also use the OCBSE convergence scheme<a href="javascript:void(0);" class="MCTextPopup popup popupHead" style="font-size: 0.9em; vertical-align: super">7<span class="MCTextPopupBody MCTextPopupBody_Closed needs-pie popupBody"><span class="MCTextPopupArrow"></span>Keyword iconv = 3 in the gen section.</span></a> <a class="Reference_Number MCXref xref xrefReference_Number" href="jaguar_references.htm#jaguar_references_1926199490_20567">[<span style="color: #0e6895;" class="mcFormatColor">22</span>]</a>, although it is generally much slower than DIIS.</p>
        <table class="NavLink" data-mc-conditions="Default.ScreenOnly">
            <tr class="NavLink">
                <td class="NavLeft"><span class="NavText">◀ <a class="NavLink MCXref xref xrefNavLink" href="jaguar_options_scf_convergence.htm">SCF Convergence Criteria</a></span>
                </td>
                <td class="NavCenter"><span class="NavText"><a class="NavLink MCXref xref xrefNavLink" href="jaguar_user_manualTOC.htm">Jaguar User Manual</a></span>
                </td>
                <td class="NavRight"><span class="NavText"><a class="NavLink MCXref xref xrefNavLink" href="jaguar_options_scf_orbital.htm">Orbital Handling and Localization Settings</a> ▶</span>
                </td>
            </tr>
        </table>
    </body>
</html>