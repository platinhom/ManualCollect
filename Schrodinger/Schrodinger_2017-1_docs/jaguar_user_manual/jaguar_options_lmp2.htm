<!DOCTYPE html>
<html xmlns:MadCap="http://www.madcapsoftware.com/Schemas/MadCap.xsd" lang="en-US" xml:lang="en-US" data-mc-search-type="Stem" data-mc-help-system-file-name="Documentation.xml" data-mc-path-to-help-system="../" data-mc-target-type="WebHelp2" data-mc-runtime-file-type="Topic" data-mc-preload-images="false" data-mc-in-preview-mode="false" data-mc-toc-path="User Manuals|Jaguar User Manual|Setting Jaguar Options in Maestro">
    <head>
        <meta name="viewport" content="width=device-width, initial-scale=1.0" />
        <meta charset="utf-8" />
        <meta http-equiv="X-UA-Compatible" content="IE=edge" />
        <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
        <link href="../Skins/Default/Stylesheets/Slideshow.css" rel="stylesheet" type="text/css" data-mc-generated="True" />
        <link href="../Skins/Default/Stylesheets/TextEffects.css" rel="stylesheet" type="text/css" data-mc-generated="True" />
        <link href="../Skins/Default/Stylesheets/Topic.css" rel="stylesheet" type="text/css" data-mc-generated="True" />
        <link href="../Skins/Default/Stylesheets/Components/Styles.css" rel="stylesheet" type="text/css" data-mc-generated="True" /><title>Local MP2 Settings</title>
        <link href="../Resources/Stylesheets/docs.css" rel="stylesheet" />
        <script src="../Resources/Scripts/custom.modernizr.js" type="text/javascript">
        </script>
        <script src="../Resources/Scripts/jquery.min.js" type="text/javascript">
        </script>
        <script src="../Resources/Scripts/require.min.js" type="text/javascript">
        </script>
        <script src="../Resources/Scripts/require.config.js" type="text/javascript">
        </script>
        <script src="../Resources/Scripts/foundation.min.js" type="text/javascript">
        </script>
        <script src="../Resources/Scripts/plugins.min.js" type="text/javascript">
        </script>
        <script src="../Resources/Scripts/MadCapAll.js" type="text/javascript">
        </script>
    </head>
    <body><a name="aanchor4231"></a>
        <MadCap:concept term="User Manuals" /><a name="aanchor4232"></a>
        <MadCap:concept term="Jaguar" /><a name="jaguar_options_2333515368_170770"></a><a name="jaguar_options_2333515368_78200"></a>
        <table class="NavLink" data-mc-conditions="Default.ScreenOnly">
            <tr class="NavLink">
                <td class="NavLeft"><span class="NavText">◀ <a class="NavLink MCXref xref xrefNavLink" href="jaguar_options_hartreefock.htm">Hartree-Fock and TDHF Settings</a></span>
                </td>
                <td class="NavCenter"><span class="NavText"><a class="NavLink MCXref xref xrefNavLink" href="jaguar_user_manualTOC.htm">Jaguar User Manual</a></span>
                </td>
                <td class="NavRight"><span class="NavText"><a class="NavLink MCXref xref xrefNavLink" href="jaguar_options_hamiltonian.htm">Hamiltonian Settings</a> ▶</span>
                </td>
            </tr>
        </table>
        <h1 class="Title">Local MP2 Settings</h1>
        <p>The <span class="GUI">LMP2 (Local MP2)</span> option<a href="javascript:void(0);" class="MCTextPopup popup popupHead" style="font-size: 0.9em; vertical-align: super">1<span class="MCTextPopupBody MCTextPopupBody_Closed needs-pie popupBody"><span class="MCTextPopupArrow"></span>Keyword mp2 = 3 in the gen section.</span></a> of the <span class="GUI">Level of theory</span> option menu allows you to set up a local Møller-Plesset second-order perturbation theory [<a class="Ref_Number_Only MCXref xref xrefRef_Number_Only" href="jaguar_references.htm#jaguar_references_1926199490_227686">92</a>–<a class="Ref_Number_Only MCXref xref xrefRef_Number_Only" href="jaguar_references.htm#jaguar_references_1926199490_227692">95</a>] calculation. The local MP2 (LMP2) method greatly reduces the basis set superposition errors that can arise from the canonical MP2 method <a class="Reference_Number MCXref xref xrefReference_Number" href="jaguar_references.htm#jaguar_references_1926199490_227692">[<span style="color: #0e6895;" class="mcFormatColor">95</span>]</a>. The LMP2 method is much faster than canonical MP2, and typically recovers 98% of the canonical MP2 energy correction. The pseudospectral implementation of LMP2 is described in <a class="TopicLink MCXref xref xrefTopicLink" href="jaguar_theory_lmp2.htm#jaguar_theory_2952449424_112356">Pseudospectral Local MP2 Techniques</a>.</p>
        <p class="image">
            <img src="theory_tab_lmp2.png" style="margin: 2px;" />
        </p>
        <p>For closed-shell systems, you can perform LMP2 geometry optimizations, charge fitting, solvation calculations, and many other options available with HF wave functions. For open-shell systems, you can perform gas-phase energy and geometry optimizations but not property calculations. All local MP2 geometry optimizations employ analytic gradients. </p>
        <p>For calculations of LMP2 dipole moments, Jaguar computes a coupled perturbed Hartree-Fock (CPHF) wave function, which can be computationally expensive. However, since CPHF methods lead to a better description of the charge density, we recommend computing LMP2 dipole moments as well for any calculation for which you need to compute accurate LMP2 electrostatic potential (ESP) fitted charges. For details, see <a class="TopicLink MCXref xref xrefTopicLink" href="jaguar_options_properties_espcharge.htm#jaguar_options_2333515368_128036">Charges from Jaguar Electrostatic Potential Fitting</a> and <a class="TopicLink MCXref xref xrefTopicLink" href="jaguar_options_properties_moments.htm#jaguar_options_2333515368_157630">Multipole Moments from Jaguar Calculations</a>.</p>
        <p>Jaguar’s implementation of the local MP2 method requires basis sets that allow the pseudospectral method to be used. This basis set information can be found in <a class="TopicLink MCXref xref xrefTopicLink" href="jaguar_options_basis_set.htm#jaguar_options_2333515368_199025">Basis Sets</a>. A warning is displayed if you choose a non-pseudospectral calculation.</p>
        <p>The reference wave function is produced through a localization of the usual Hartree-Fock reference wave function, using a unitary transformation of the occupied canonical Hartree-Fock orbitals. (This localization procedure does<i> not</i> change the reference energy.) The default localization procedure is Pipek-Mezey <a class="Reference_Number MCXref xref xrefReference_Number" href="jaguar_references.htm#jaguar_references_1926199490_230208">[<span style="color: #0e6895;" class="mcFormatColor">97</span>]</a> localization,<a href="javascript:void(0);" class="MCTextPopup popup popupHead" style="font-size: 0.9em; vertical-align: super">2<span class="MCTextPopupBody MCTextPopupBody_Closed needs-pie popupBody"><span class="MCTextPopupArrow"></span>Keyword loclmp2v = 2 in the gen section.</span></a> but you can choose Boys <a class="Reference_Number MCXref xref xrefReference_Number" href="jaguar_references.htm#jaguar_references_1926199490_227694">[<span style="color: #0e6895;" class="mcFormatColor">96</span>]</a> localization<a href="javascript:void(0);" class="MCTextPopup popup popupHead" style="font-size: 0.9em; vertical-align: super">3<span class="MCTextPopupBody MCTextPopupBody_Closed needs-pie popupBody"><span class="MCTextPopupArrow"></span>Keyword loclmp2v = 1 in the gen section.</span></a> or an alternate Pipek-Mezey localization<a href="javascript:void(0);" class="MCTextPopup popup popupHead" style="font-size: 0.9em; vertical-align: super">4<span class="MCTextPopupBody MCTextPopupBody_Closed needs-pie popupBody"><span class="MCTextPopupArrow"></span>Keyword loclmp2v = 3 in the gen section.</span></a> (see <a class="TopicLink MCXref xref xrefTopicLink" href="../jaguar_command_reference/jaguar_input_gen_lmp2.htm#jaguar_input_1430212170_80346">LMP2 Keywords In The Jaguar Input File</a>). These schemes are available from the <span class="GUI">Valence localization method</span> option menu. </p>
        <p>In LMP2, unlike in canonical MP2, the correlating virtual space for each occupied orbital is limited to those orbitals that are localized on the atoms of the local occupied Hartree-Fock orbital. The localization of the occupied orbitals makes this limitation of the virtual space a good approximation, and leads to a reduction in the basis set superposition error. In the limit that all local virtual orbitals are assigned to every occupied orbital, the local MP2 method and the canonical MP2 method are exactly equivalent.</p>
        <p>All calculation types available for LMP2 wave functions are also available with the “local local” MP2 method, which allows you to treat only some atoms at the LMP2 level, while the remaining atoms are treated at the HF level. Local local MP2 calculations use orbitals that are localized on the specified atom pairs. After the localization of the canonical Hartree-Fock orbitals, the atomic orbital coefficients for each localized orbital are summed for each atom, and the orbital is considered localized on the two atoms whose coefficient sums are largest. If the largest coefficient sum on one atom is more than ten times as large as the coefficient sum on any other atom, the localized orbital is considered to be localized on that single atom, and that localized orbital will be included in any LMP2 calculation for which that atom is specified in any requested LMP2 atom pairs.</p>
        <p>Jaguar includes a setting for a local LMP2 calculation that treats all atoms bonded to atoms of other elements—“heteroatom pairs”—at the LMP2 level. These heteroatom pairs do not include C atoms bonded only to C and H atoms, so hydrocarbon fragments are not correlated. We recommend this setting for solvation calculations using LMP2. To request such a calculation, select <span class="GUI">Hetero atom pairs</span><a href="javascript:void(0);" class="MCTextPopup popup popupHead" style="font-size: 0.9em; vertical-align: super">5<span class="MCTextPopupBody MCTextPopupBody_Closed needs-pie popupBody"><span class="MCTextPopupArrow"></span>Keywords iheter = 1 in the gen section.</span></a> in the <span class="GUI">LMP2 pairs </span>section. For other kinds of local LMP2 calculations, you must set up the pairs in an <span class="Keyword">lmp2</span> section by editing the input file. See <a class="TopicLink MCXref xref xrefTopicLink selected" href="#jaguar_options_2333515368_170770">Local MP2 Settings</a> for more information. If you add an <span class="Keyword">lmp2</span> section, the <span class="GUI">Level of theory</span> is set to <span class="GUI">Other</span>.</p>
        <p>Correlation of orbitals on atom pairs in a virtual space that is restricted to those atoms is not the optimal choice when the orbitals are delocalized, as they are in aromatic systems such as benzene. Such delocalized orbitals are represented in valence bond theory by resonance structures. To handle aromatic systems, you can delocalize the LMP2 pairs over neighboring atoms in the ring (partial delocalization),<a href="javascript:void(0);" class="MCTextPopup popup popupHead" style="font-size: 0.9em; vertical-align: super">6<span class="MCTextPopupBody MCTextPopupBody_Closed needs-pie popupBody"><span class="MCTextPopupArrow"></span>Keyword ireson = 1 in the gen section.</span></a> or over the whole ring (full delocalization).<a href="javascript:void(0);" class="MCTextPopup popup popupHead" style="font-size: 0.9em; vertical-align: super">7<span class="MCTextPopupBody MCTextPopupBody_Closed needs-pie popupBody"><span class="MCTextPopupArrow"></span>Keyword ireson = 2 in the gen section.</span></a> These options are available from the <span class="GUI">Resonance</span> menu. </p>
        <table class="NavLink" data-mc-conditions="Default.ScreenOnly">
            <tr class="NavLink">
                <td class="NavLeft"><span class="NavText">◀ <a class="NavLink MCXref xref xrefNavLink" href="jaguar_options_hartreefock.htm">Hartree-Fock and TDHF Settings</a></span>
                </td>
                <td class="NavCenter"><span class="NavText"><a class="NavLink MCXref xref xrefNavLink" href="jaguar_user_manualTOC.htm">Jaguar User Manual</a></span>
                </td>
                <td class="NavRight"><span class="NavText"><a class="NavLink MCXref xref xrefNavLink" href="jaguar_options_hamiltonian.htm">Hamiltonian Settings</a> ▶</span>
                </td>
            </tr>
        </table>
    </body>
</html>