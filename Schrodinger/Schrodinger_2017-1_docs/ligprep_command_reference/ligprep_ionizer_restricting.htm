<!DOCTYPE html>
<html xmlns:MadCap="http://www.madcapsoftware.com/Schemas/MadCap.xsd" lang="en-US" xml:lang="en-US" data-mc-search-type="Stem" data-mc-help-system-file-name="Documentation.xml" data-mc-path-to-help-system="../" data-mc-target-type="WebHelp2" data-mc-runtime-file-type="Topic" data-mc-preload-images="false" data-mc-in-preview-mode="false" data-mc-toc-path="Command References|LigPrep Command Reference|The ionizer Utility">
    <head>
        <meta name="viewport" content="width=device-width, initial-scale=1.0" />
        <meta charset="utf-8" />
        <meta http-equiv="X-UA-Compatible" content="IE=edge" />
        <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
        <link href="../Skins/Default/Stylesheets/Slideshow.css" rel="stylesheet" type="text/css" data-mc-generated="True" />
        <link href="../Skins/Default/Stylesheets/TextEffects.css" rel="stylesheet" type="text/css" data-mc-generated="True" />
        <link href="../Skins/Default/Stylesheets/Topic.css" rel="stylesheet" type="text/css" data-mc-generated="True" />
        <link href="../Skins/Default/Stylesheets/Components/Styles.css" rel="stylesheet" type="text/css" data-mc-generated="True" /><title>Restricting Ionization State Generation</title>
        <link href="../Resources/Stylesheets/docs.css" rel="stylesheet" />
        <script src="../Resources/Scripts/custom.modernizr.js" type="text/javascript">
        </script>
        <script src="../Resources/Scripts/jquery.min.js" type="text/javascript">
        </script>
        <script src="../Resources/Scripts/require.min.js" type="text/javascript">
        </script>
        <script src="../Resources/Scripts/require.config.js" type="text/javascript">
        </script>
        <script src="../Resources/Scripts/foundation.min.js" type="text/javascript">
        </script>
        <script src="../Resources/Scripts/plugins.min.js" type="text/javascript">
        </script>
        <script src="../Resources/Scripts/MadCapAll.js" type="text/javascript">
        </script>
    </head>
    <body><a name="aanchor2383"></a>
        <MadCap:concept term="Command Reference" /><a name="aanchor2384"></a>
        <MadCap:concept term="LigPrep" /><a name="ionizer_174229727_747060"></a>
        <table class="NavLink" data-mc-conditions="Default.ScreenOnly">
            <tr class="NavLink">
                <td class="NavLeft"><span class="NavText">◀ <a class="NavLink MCXref xref xrefNavLink" href="ligprep_ionizer_input.htm" xrefformat="{paratext}">Input Structure Requirements for the ionizer</a></span>
                </td>
                <td class="NavCenter"><span class="NavText"><a class="NavLink MCXref xref xrefNavLink" href="ligprep_command_referenceTOC.htm" xrefformat="{paratext}">LigPrep Command Reference Manual</a></span>
                </td>
                <td class="NavRight"><span class="NavText"><a class="NavLink MCXref xref xrefNavLink" href="ionizer_output.htm" xrefformat="{paratext}">Structural Output from the ionizer</a> ▶</span>
                </td>
            </tr>
        </table>
        <h1 class="Title">Restricting Ionization State Generation</h1>
        <p>The Ionizer has two methods for restricting the generation of ion states to ensure that each state has a significant population under the chosen conditions. The default method is to screen values according to a pH range. This is done by specifying a target pH value with the <code>-ph</code> option and a threshold value with the <code>-pht</code> option. The default pH is 7, and the default threshold is 2. For any ionizable group whose p<i>K</i><sub>a</sub> lies within the threshold value around the target pH value (| p<i>K</i><sub>a</sub> − pH | <span class="Symbol">£</span> threshold), both protonated and deprotonated forms are generated. If the p<i>K</i><sub>a</sub> is smaller than the target pH value by more than the threshold value, only the deprotonated form is generated, and if the p<i>K</i><sub>a</sub> is larger than the target pH value by more than the threshold value, only the protonated form is generated. To generate all possible ionization states, you can set the threshold to a large value. </p>
        <p>The alternative method is to use the <code>-pkt</code> option to specify a relative threshold for the p<i>K</i><sub>a</sub> values to screen out improbable states. In this method, a structure generated by the <code>ionizer</code> is rejected if the maximum p<i>K</i><sub>a</sub> value of any deprotonated group is greater than the minimum p<i>K</i><sub>a</sub> value of any protonated group by the specified threshold. </p>
        <p>For example, if the threshold is 3.0 and the structure has two ionizable groups with p<i>K</i><sub>a</sub> values of 6.0 and 10.0, the structure with the first group protonated and the second group deprotonated is rejected. Likewise, if the threshold is 2.0 and the structure has 4 ionizable groups, with p<i>K</i><sub>a</sub> values of 4.0, 5.5, 7.0, and 8.5, the structure with the first and fourth groups deprotonated and the second and third groups protonated is rejected. In this case the maximum p<i>K</i><sub>a</sub> of the deprotonated groups is 8.5 and the minimum p<i>K</i><sub>a</sub> of the protonated groups is 5.5. The difference is greater than the threshold value of 2.0. </p>
        <p>This method treats each structure independently and ensures that the totally protonated form and the totally deprotonated form are always included in the output. There is no default value for the threshold, and as for the pH-based method, it is possible to specify a p<i>K</i><sub>a</sub> threshold large enough so that no ion state is rejected.</p>
        <p>If you specify the p<i>K</i><sub>a</sub> threshold, you can also specify a maximum number of groups ionized and a maximum total charge, to limit the number of structures generated. Setting the <code>-mi</code> option limits the maximum number of ionized groups to the value specified. The default is 4. If a possible ion state has more individual groups ionized than this value, the state is rejected. This limit applies only to the ionizable groups detected by the Ionizer. Setting the <code>-mq</code> option limits the absolute value of the total charge to a value less than or equal to the value specified. The default is 2. If the structure already has a formal charge, this charge is taken into account when the restriction is applied. </p>
        <table class="NavLink" data-mc-conditions="Default.ScreenOnly">
            <tr class="NavLink">
                <td class="NavLeft"><span class="NavText">◀ <a class="NavLink MCXref xref xrefNavLink" href="ligprep_ionizer_input.htm" xrefformat="{paratext}">Input Structure Requirements for the ionizer</a></span>
                </td>
                <td class="NavCenter"><span class="NavText"><a class="NavLink MCXref xref xrefNavLink" href="ligprep_command_referenceTOC.htm" xrefformat="{paratext}">LigPrep Command Reference Manual</a></span>
                </td>
                <td class="NavRight"><span class="NavText"><a class="NavLink MCXref xref xrefNavLink" href="ionizer_output.htm" xrefformat="{paratext}">Structural Output from the ionizer</a> ▶</span>
                </td>
            </tr>
        </table>
    </body>
</html>