<!DOCTYPE html>
<html xmlns:MadCap="http://www.madcapsoftware.com/Schemas/MadCap.xsd" lang="en-US" xml:lang="en-US" data-mc-search-type="Stem" data-mc-help-system-file-name="Documentation.xml" data-mc-path-to-help-system="../" data-mc-target-type="WebHelp2" data-mc-runtime-file-type="Topic" data-mc-preload-images="false" data-mc-in-preview-mode="false" data-mc-toc-path="Help|Prime Help">
    <head>
        <meta name="viewport" content="width=device-width, initial-scale=1.0" />
        <meta charset="utf-8" />
        <meta http-equiv="X-UA-Compatible" content="IE=edge" />
        <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
        <link href="../Skins/Default/Stylesheets/Slideshow.css" rel="stylesheet" type="text/css" data-mc-generated="True" />
        <link href="../Skins/Default/Stylesheets/TextEffects.css" rel="stylesheet" type="text/css" data-mc-generated="True" />
        <link href="../Skins/Default/Stylesheets/Topic.css" rel="stylesheet" type="text/css" data-mc-generated="True" />
        <link href="../Skins/Default/Stylesheets/Components/Styles.css" rel="stylesheet" type="text/css" data-mc-generated="True" />
        <link href="../Resources/Stylesheets/docs.css" rel="stylesheet" type="text/css" /><title>Prime Structure Prediction — Find Homologs Step</title>
        <script src="../Resources/Scripts/custom.modernizr.js" type="text/javascript">
        </script>
        <script src="../Resources/Scripts/jquery.min.js" type="text/javascript">
        </script>
        <script src="../Resources/Scripts/require.min.js" type="text/javascript">
        </script>
        <script src="../Resources/Scripts/require.config.js" type="text/javascript">
        </script>
        <script src="../Resources/Scripts/foundation.min.js" type="text/javascript">
        </script>
        <script src="../Resources/Scripts/plugins.min.js" type="text/javascript">
        </script>
        <script src="../Resources/Scripts/MadCapAll.js" type="text/javascript">
        </script>
    </head>
    <body><a name="aanchor1742"></a>
        <MadCap:concept term="Help Topics" /><a name="aanchor1743"></a>
        <MadCap:concept term="Prime" />
        <table class="navlink">
            <tr>
                <td class="navlink"><a class="navbutton" href="#using">Using</a>
                </td>
                <td class="navlink"><a class="navbutton" href="#features">Features</a>
                </td>
                <td class="navlink"><a class="navbutton" href="#links">Links</a>
                </td>
            </tr>
        </table>
        <h1 class="title">Prime Structure Prediction — Find Homologs Step</h1><a name="summary"></a>
        <p>This step is used to search for homologs of the query sequence. These homologs can then be used as templates to build a model structure.</p>
        <p>For details about the Find Homologs step, see the topic <a href="../prime_user_manual/structure_prediction_homologs.htm">Find Homologs Step</a>.</p>
        <p>For general information on the panel, see the topic <a href="structure_prediction.html">Structure Prediction Panel</a>.</p>
        <h2><a name="using"></a>Using the Find Homologs Step</h2>
        <ul>
            <li value="1"><a href="#PspFH2">Searching for Homologs</a>
            </li>
            <li value="2"><a href="#PspFH3">Find Homologs Search Options</a>
            </li>
            <li value="3"><a href="#PspFH4">Importing Homologs</a>
            </li>
            <li value="4"><a href="#PspFH4a">Selecting Templates</a>
            </li>
            <li value="5"><a href="#PspFH5">Aligning Structures (Multiple Templates)</a>
            </li>
            <li value="6"><a href="#PspFH5a">Extracting Single Chains</a>
            </li>
            <li value="7"><a href="#PspFHN">Proceeding to the Next Step</a>
            </li>
            <li value="8"><a href="#PspFH7">Saving Runs With Different Templates</a>
            </li>
            <li value="9"><a href="#PspFHE">Error Messages</a>
            </li>
        </ul>
        <h4><a name="PspFH2"></a>Searching for Homologs</h4>
        <p>To search for homologs, click the <span class="GUI">Search</span> button near the middle of the Prime panel. Depending on what is selected in the <span class="GUI">Options</span> dialog box, BLAST or PSI-BLAST will be used to search for templates.</p>
        <p>Optionally, run HMMER on the Pfam database by clicking the <span class="GUI">Identify Globally Conserved Residues</span> button, to search for globally conserved residues from a multiple sequence alignment of homologous proteins. The conserved residues are shown in the sequence viewer, colored according to the template color if both the template and the query have the conserved residue. This allows you to easily identify conserved residues that are not in the both the template and the query.</p>
        <p>When the homolog search is complete, select the template that you would like to use to build a model by clicking the sequence in the <span class="GUI">Homologs</span> table. The template structure is retrieved from the PDB (either a local copy or the web site) and is displayed in the Workspace for inspection. Clicking on another template in the table deselects the first template and displays the new template structure.</p>
        <h4><a name="PspFH3"></a>Find Homologs Search Options</h4>
        <p>Click <span class="GUI">Options</span> to open the <span class="GUI">Find Homologs - Options</span> dialog box. Here you can choose the kind of search you want to run—BLAST or PSI-BLAST—or change the settings for either type of search. You can also choose whether to run the search on the BLAST web site or using a local copy of the BLAST database. By default a local copy is used.</p>
        <p>For example, the default database for searching is <span class="GUI">NCBI PDB (non-redundant)</span>. Other options include:</p>
        <ul>
            <li value="1"><span class="GUI">NCBI PDB (all)</span>, which shows all PDB hits, including PDB files with identical sequences, and</li>
            <li value="2"><span class="GUI">NCBI NR</span>, (recommended for PSI-BLAST runs.) If <span class="GUI">NCBI NR</span> is selected, only nonredundant PDB hits are displayed in the <span class="GUI">Homologs</span> table.</li>
        </ul>
        <p>For more information on BLAST and its options, go to <a href="http://www.ncbi.nlm.nih.gov/books/NBK21097/">http://www.ncbi.nlm.nih.gov/books/NBK21097/</a>.</p>
        <h4><a name="PspFH4"></a>Importing Homologs</h4>
        <p>If the homologs you want to use are not in the NCBI sequence database, or if you have homologs that you want to use, you can import them using the <span class="GUI">Import</span> buttons. Homologs are aligned quickly using ClustalW on import.</p>
        <p>To import homologs from a file, click <span class="GUI">From File</span>. You can import homologs in PDB and Maestro format.</p>
        <p>To import homologs from Maestro, select them in the Project Table and click <span class="GUI">From Project Table</span>. This allows you to import homologs in any format recognized by Maestro.</p>
        <h4><a name="PspFH4a"></a>Selecting Templates</h4>
        <p>If you want to build a homology model for a single chain, and have found a satisfactory single template, you can simply select the desired template in the table.</p>
        <p>If you want to use more than one template as a composite (chimera) model, in which each template is used for a different region of the query, you can select multiple templates in the table with shift-click or control-click. The template structures must then be aligned before you use them.</p>
        <p>Likewise, if you want to build a consensus model, you can select multiple templates in the table, but they do not need to be aligned.</p>
        <p>If you want to build a homology model for a homomultimer, you should select a single chain of a template that is also a homomultimer with the same number of chains. The remaining chains are retrieved and used when the model is built.</p>
        <p>For heteromultimers, each chain should be built in a separate run before they are combined to build the final multimer. You can use any of the above models to build each chain, including a homomultimer model if the heteromultimer contains a homomultimer.</p>
        <h4><a name="PspFH5"></a>Aligning Structures</h4>
        <p>Spatial alignment of multiple templates is only required if you want to build a composite (or chimera) model. Otherwise, any alignment is done as necessary; in particular, alignment should <i>not</i> be done if you want to build a multimer model, because the templates must be in the correct spatial relation to each other for building.</p>
        <p>If you have already created a file with structurally aligned multiple templates, you can use the <span class="GUI">Import</span> button to import it. Otherwise, when you have selected your templates, click <span class="GUI">Align Structures</span> to structurally align the templates.</p>
        <p>Only templates with some degree of structural similarity can produce a meaningful structural alignment. If <span class="GUI">Align Structures</span> fails, a warning message appears:</p>
        <p><span class="GUI">WARNING The structural alignment did not produce a suitable superimposition. The selected templates should not be used together for structure building.</span>
        </p>
        <p>Templates with multiple chains may sometimes require special handling. In some cases, <span class="GUI">Align Structures</span> fails to align multiple templates with multiple chains. Furthermore, a chain from a given template file cannot be structurally aligned to another chain from the same template file. It can also happen that <span class="GUI">Align Structures</span> aligns a template to chain B of another template, but you need an alignment with chain A. In these cases, it is necessary to generate single-chain templates, as described in the next section, <a href="#PspFH5a">Extracting Single Chains</a>.</p>
        <h4><a name="PspFH5a"></a>Extracting Single Chains</h4>
        <p>If Align Structures fails to align templates with multiple chains correctly, use the <a href="../maestro_projects_help/get_pdb_file_db.html"><span class="GUI">Get PDB File</span> panel</a> to extract single chain templates from the PDB database, either from a local installation or from the web. To open this panel, choose <span class="GUI">File → Get PDB File</span></p>
        <p>To extract a particular chain:</p>
        <ol>
            <li value="1">Enter the PDB ID in the <span class="GUI">PDB ID</span> text box.</li>
            <li value="2">Enter the single-letter chain name in the <span class="GUI">Chain name</span> text box.</li>
            <li value="3">(Optional) Choose the source for the structure.</li>
            <li value="4">Click <span class="GUI">Download</span>.</li>
        </ol>
        <p>The chain is downloaded into the working directory and imported into the Maestro project. Once you have imported all the desired chains, you can select them in the Project Table, then in the <span class="GUI">Find Homologs</span> step, click <span class="GUI">From Project Table</span>.</p>
        <p>For example, if Align Structures were to have difficulty aligning several multiple-chain template structures, you would follow these steps to correct the problem:</p>
        <ol>
            <li value="1">
                <p>Extract the single chains from the chosen multiple-chain templates using the instructions above.</p>
            </li>
            <li value="2">
                <p>Select the chains in the <span class="GUI">Project Table</span> panel.</p>
            </li>
            <li value="3">
                <p>In the <span class="GUI">Find Homologs</span> step, click <span class="GUI">From Project Table</span>. The new homologs appear in the <span class="GUI">Homologs</span> table.</p>
            </li>
            <li value="4">
                <p>Select the single-chain version of each multiple-chain template, and click <span class="GUI">Align Structures</span> again.</p>
            </li>
        </ol>
        <p>You can also use the <code>getpdb</code> utility from the command line to extract chains from the PDB database. To use <code>getpdb</code>, you must either have access to the web to download the chain, or have a local installation of the PDB, to which one of the following environment variables is set:</p>
        <ul>
            <li value="1"><tt>SCHRODINGER_PDB</tt>
            </li>
            <li value="2"><tt>SCHRODINGER_THIRDPARTY</tt>
            </li>
            <li value="3"><tt>SCHRODINGER</tt>
            </li>
        </ul>
        <p>If it is only the SCHRODINGER variable that has been set, <code>getpdb</code> uses the default location of the database, <code>$SCHRODINGER/thirdparty</code>.</p>
        <p>To extract an entire protein from the PDB database, type:</p>
        <p><tt>$SCHRODINGER/utilities/getpdb</tt><i>4-letter_PDB_code</i>
        </p>
        <p>For example,</p><pre xml:space="preserve">
$SCHRODINGER/utilities/getpdb 1aaa
</pre>
        <p>retrieves the PDB file for the structure with PDB code 1AAA.</p>
        <p>To extract a particular chain, type:</p>
        <p><tt>$SCHRODINGER/utilities/getpdb</tt><i>4-letter_PDB_code</i><tt>:</tt><i>Chain_ID</i>
        </p>
        <p>For example, if the first multiple-chain template is the protein 1ems, and the chain needed is chain A, use the command:</p><pre xml:space="preserve">
$SCHRODINGER/utilities/getpdb 1ems:A 
</pre>
        <p>This command extracts all residues, including HETATMs, in chain A (as well as any HETATMs with no chain name.)</p>
        <p>Note: The <i>Chain_ID</i> variable is case sensitive, though the <i>PDB_code</i> is not. In this example, <tt>1EmS:A</tt> would also work, but <tt>1ems:a</tt> would produce errors.</p>
        <p>After the <span class="GUI">getpdb</span> utility has extracted <tt>1ems:A</tt>, it returns the following message:</p>
        <p><tt>saved data to file: 1ems_A.pdb</tt>
        </p>
        <p>You can then click <span class="GUI">From File</span> in the <span class="GUI">Find Homologs</span> and import the single-chain file, <code>1ems_A.pdb</code>. The new homolog appears in the <span class="GUI">Homologs</span> table.</p>
        <h4><a name="PspFHN"></a>Proceeding to the next step</h4>
        <p>When you are satisfied with the template or templates you have selected, follow the <span class="GUI">Comparative Modeling</span> Path by proceeding to the Edit Alignment step.</p>
        <p>If no satisfactory templates can be identified by BLAST/PSI-BLAST and you have not imported a template, you may wish to proceed to the Fold Recognition step.</p>
        <h4><a name="PspFH7"></a>Saving Runs With Different Templates</h4>
        <p>If, after proceeding to further steps, you decide that you would like to try a different template, you can avoid overwriting your existing workflow by starting a new one before you navigate back to Find Homologs to choose a different homolog. Select <span class="GUI">Save As</span> from the <span class="GUI">File</span> menu. This will create a copy of the current run, allowing you to select a new template and build on it. You will then be able to compare results from each run. See the <a href="info_runs.html">Using Prime Runs</a> help topic for more information.</p>
        <h4><a name="PspFHE"></a>Error Messages</h4>
        <p>If you select multiple templates and proceed to Edit Alignment, you will be reminded of the requirements for use of multiple templates.</p>
        <p>If one of these messages appears when you click <span class="GUI">Next</span> to go to the Edit Alignment step, you will not be able to proceed along the <span class="GUI">Comparative Modeling Path</span> until the problem is resolved:</p>
        <dl>
            <dt><span class="GUI">No Homologs Found</span>
            </dt>
            <dd>
                <p>You may change your search options and continue searching, or else proceed to Fold Recognition.</p>
            </dd>
            <dt><span class="GUI">Invalid File</span>:</dt>
            <dd>
                <p>Check to be sure the homolog file exists (in either <code>$SCHRODINGER/thirdparty/database/pdb/data/structures/divided/pdb/*/</code> or <code>$SCHRODINGER_THIRDPARTY/database/pdb/data/structures/divided/pdb/*/</code>) and is in the right format (gzip compressed) <span class="GUI">pdb</span>*<span class="GUI">.ent.gz</span>).</p>
            </dd>
        </dl>
        <h2><a name="features"></a>Find Homologs Step Features</h2>
        <ul>
            <li value="1"><a href="#feature1"><span class="GUI">BLAST Homology Search</span> button</a>
            </li>
            <li value="2"><a href="#feature2"><span class="GUI">Options</span> button</a>
            </li>
            <li value="3"><a href="#feature3"><span class="GUI">Import</span> buttons</a> <ul> <li value="1"><a href="#feature3.1"><span class="GUI">From File</span> button</a></li><li value="2"><a href="#feature3.2"><span class="GUI">From Project Table</span> button</a></li></ul></li>
            <li value="4"><a href="#feature4"><span class="GUI">Identify Globally Conserved Residues</span> button</a>
            </li>
            <li value="5"><a href="#feature5"><span class="GUI">Family name</span> text box</a>
            </li>
            <li value="6"><a href="#feature6"><span class="GUI">Homologs</span> table</a>
            </li>
            <li value="7"><a href="#feature7"><span class="GUI">Align Structures</span> button</a>
            </li>
        </ul>
        <dl>
            <dt><a name="feature1"></a><span class="GUI">BLAST Homology Search</span> button</dt>
            <dd>
                <p>Click this button to perform a search for homologs using BLAST. The search is performed with the standard choice of database, similarity matrix, gap costs, and so on, but you can change these options by clicking <span class="GUI">Options</span>. The results of the search are returned in the <span class="GUI">Homologs</span> table.</p>
            </dd>
            <dt><a name="feature2"></a><span class="GUI">Options</span> button</dt>
            <dd>
                <p>Set BLAST options for the search, including whether to do a BLAST search or a PSI-BLAST search. Opens the <span class="GUI">Find Homologs - Options</span> dialog box.</p>
            </dd>
            <dt><a name="feature3"></a><span class="GUI">Import</span> buttons</dt>
            <dd>
                <p>Import homologs into the <span class="GUI">Homologs</span> table. You can import them from one of two sources:</p>
                <dl>
                    <dt><a name="feature3.1"></a><span class="GUI">From File</span> button</dt>
                    <dd>
                        <p>Import the homologs from a PDB file or a Maestro file. Opens a file selector, in which you can navigate to and load a single homolog.</p>
                    </dd>
                    <dt><a name="feature3.2"></a><span class="GUI">From Project Table</span> button</dt>
                    <dd>
                        <p>Import the selected entries in the Project Table into the <span class="GUI">Homologs</span> table. The entries must be selected before you click this button.</p>
                    </dd>
                </dl>
            </dd>
            <dt><a name="feature4"></a><span class="GUI">Identify Globally Conserved Residues</span> button</dt>
            <dd>
                <p>Run a search with HMMER on the Pfam database, to identify the query family and provide information about which residues are conserved in the consensus sequence. The sequence viewer shows the match bewteen the query and the consensus sequence of the family.</p>
            </dd>
            <dt><a name="feature5"></a><span class="GUI">Family name</span> text box</dt>
            <dd>
                <p>Shows the query family name, with an E-value in parentheses. If the E-value of the family is too large, it is not meaningful to consider the family.</p>
            </dd>
            <dt><a name="feature6"></a><span class="GUI">Homologs</span> table</dt>
            <dd>
                <p>Displays the homologs that were found in the search or imported. For more information on the table, see <a href="../prime_user_manual/structure_prediction_homologs_results.htm" class="MCXref xref" xrefformat="{paratext}">PSP Homolog Search Results</a>.</p>
            </dd>
            <dt><a name="feature7"></a><span class="GUI">Align Structures</span> button</dt>
            <dd>
                <p>Perform a structural alignment on the selected templates.</p>
            </dd>
        </dl>
        <h2><a name="links"></a>Related Topics</h2>
        <ul>
            <li value="1"><a href="../maestro_tools_help/protein_structure_alignment.html" class="MCXref xref" xrefformat="{paratext}">Protein Structure Alignment Panel</a>
            </li>
            <li value="2"><a href="edit_alignment_step.html" class="MCXref xref" xrefformat="{paratext}">Prime Structure Prediction — Edit Alignment Step</a>
            </li>
            <li value="3"><a href="input_sequence_step.html" class="MCXref xref" xrefformat="{paratext}">Prime Structure Prediction — Input Sequence Step</a>
            </li>
            <li value="4"><a href="info_runs.html" class="MCXref xref" xrefformat="{paratext}">Using Prime Runs</a>
            </li>
            <li value="5"><a href="structure_prediction.html" class="MCXref xref" xrefformat="{paratext}">Structure Prediction Panel</a>
            </li>
            <li value="6"><a href="job_options.html" class="MCXref xref" xrefformat="{paratext}">Structure Prediction - Job Options Dialog Box</a>
            </li>
            <li value="7"><a href="toolbar.html" class="MCXref xref" xrefformat="{paratext}">Prime Structure Prediction Toolbar</a>
            </li>
            <li value="8"><a href="info_third.html" class="MCXref xref" xrefformat="{paratext}">Prime Third-Party Programs</a>
            </li>
        </ul>
    </body>
</html>