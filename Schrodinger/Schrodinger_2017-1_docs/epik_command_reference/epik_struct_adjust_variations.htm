<!DOCTYPE html>
<html xmlns:MadCap="http://www.madcapsoftware.com/Schemas/MadCap.xsd" lang="en-US" xml:lang="en-US" data-mc-search-type="Stem" data-mc-help-system-file-name="Documentation.xml" data-mc-path-to-help-system="../" data-mc-target-type="WebHelp2" data-mc-runtime-file-type="Topic" data-mc-preload-images="false" data-mc-in-preview-mode="false" data-mc-toc-path="Command References|Epik Command Reference|Structural Adjustment in Epik">
    <head>
        <meta name="viewport" content="width=device-width, initial-scale=1.0" />
        <meta charset="utf-8" />
        <meta http-equiv="X-UA-Compatible" content="IE=edge" />
        <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
        <link href="../Skins/Default/Stylesheets/Slideshow.css" rel="stylesheet" type="text/css" data-mc-generated="True" />
        <link href="../Skins/Default/Stylesheets/TextEffects.css" rel="stylesheet" type="text/css" data-mc-generated="True" />
        <link href="../Skins/Default/Stylesheets/Topic.css" rel="stylesheet" type="text/css" data-mc-generated="True" />
        <link href="../Skins/Default/Stylesheets/Components/Styles.css" rel="stylesheet" type="text/css" data-mc-generated="True" /><title>Creating Structural Variations and Estimating Populations</title>
        <link href="../Resources/Stylesheets/docs.css" rel="stylesheet" />
        <script src="../Resources/Scripts/custom.modernizr.js" type="text/javascript">
        </script>
        <script src="../Resources/Scripts/jquery.min.js" type="text/javascript">
        </script>
        <script src="../Resources/Scripts/require.min.js" type="text/javascript">
        </script>
        <script src="../Resources/Scripts/require.config.js" type="text/javascript">
        </script>
        <script src="../Resources/Scripts/foundation.min.js" type="text/javascript">
        </script>
        <script src="../Resources/Scripts/plugins.min.js" type="text/javascript">
        </script>
        <script src="../Resources/Scripts/MadCapAll.js" type="text/javascript">
        </script>
    </head>
    <body><a name="aanchor8037"></a>
        <MadCap:concept term="Command Reference" /><a name="aanchor8038"></a>
        <MadCap:concept term="Epik" /><a name="epik_struct_adjust_2944728150_742300"></a>
        <table class="NavLink" data-mc-conditions="Default.ScreenOnly">
            <tr class="NavLink">
                <td class="NavLeft"><span class="NavText">◀ <a class="NavLink MCXref xref xrefNavLink" href="epik_struct_adjust_penalties.htm" xrefformat="{paratext}">Penalties and Populations for Ionization State and Tautomeric Forms</a></span>
                </td>
                <td class="NavCenter"><span class="NavText"><a class="NavLink MCXref xref xrefNavLink" href="epik_command_referenceTOC.htm" xrefformat="{paratext}">Epik Command Reference</a></span>
                </td>
                <td class="NavRight"><span class="NavText"><a class="NavLink MCXref xref xrefNavLink" href="epik_struct_adjust_metals.htm" xrefformat="{paratext}">Structural Adjustment for Metal Binding</a> ▶</span>
                </td>
            </tr>
        </table>
        <h1 class="Title">Creating Structural Variations and Estimating Populations</h1>
        <p>The process for generating collections of tautomeric and ionic structural variations on the input structure is iterative, with each iteration involving a tautomeric stage and an ionization stage. In describing the procedure for adjusting the structures generated from a single input structure, it is helpful to use the following phrases:</p>
        <ul>
            <li value="1">
                <p class="ListPara">“current collection of structures” describes the structures generated in the previous stage of the process</p>
            </li>
            <li value="2">
                <p class="ListPara">“new collection of structures” describes the set of structures being generated in the current stage of the process.</p>
            </li>
        </ul>
        <p>At the start of the first iteration, the current collection of structures is the input structure which is initially assigned a population of 1.0.</p>
        <p>During the tautomerization stage of each iteration, each structure, <i>j</i>, in the current collection is tautomerized separately. The resulting tautomers are assigned weights, Wt<sub class="SubItal">j,t</sub>, given by the following equation:</p>
        <table class="AutoNumber_p_Equation_" style="width: 100%;" cellspacing="0" cellpadding="0">
            <col style="width: auto;" />
            <col style="width: 100px;" />
            <col style="width: auto;" />
            <tr>
                <td class="AutoNumber_p_Equation_" valign="top" data-mc-autonum="(1)">
                    <img src="../GeneratedImages/Equations/Equation158.svg" alt="" class="_MCEquation_0 mcReset" />
                </td>
                <td class="AutoNumber_p_Equation_" valign="top"><span>(1)</span>
                </td>
                <td valign="top" />
            </tr>
        </table>
        <p>where:</p>
        <ul class="ListCompact">
            <li value="1">Pc<sub class="SubItal">j</sub> is the population of the structure <i>j</i> in the current collection
    </li>
            <li value="2">p<sub class="SubItal">t</sub> is the population of the tautomer divided by the population of the original tautomer
    </li>
        </ul>
        <p>When the tautomers have been generated for all the current structures, the Wt<sub class="SubItal">j,t</sub> are normalized to give populations, pt<sub class="SubItal">j,t</sub> as shown in the following equation:</p>
        <table class="AutoNumber_p_Equation_" style="width: 100%;" cellspacing="0" cellpadding="0">
            <col style="width: auto;" />
            <col style="width: 100px;" />
            <col style="width: auto;" />
            <tr>
                <td class="AutoNumber_p_Equation_" valign="top" data-mc-autonum="(2)">
                    <img src="../GeneratedImages/Equations/Equation159.svg" alt="" class="_MCEquation_0 mcReset" />
                </td>
                <td class="AutoNumber_p_Equation_" valign="top"><span>(2)</span>
                </td>
                <td valign="top" />
            </tr>
        </table>
        <p>All tautomeric forms with population weights lower than <i>minpop</i> are eliminated and the resulting structures are now considered the current collection of structures. If more than <i>ms</i> structures are present and <i>ms </i><span class="Symbol">³</span> 3, then only the <i>ms</i> most probable structures are kept. If <i>ms</i> &lt; 3, three structures are kept.</p>
        <p>All structures in the current collection of structures are now subjected to ionization. The pH range, <i>del_pH</i>, is given by:</p>
        <table class="AutoNumber_p_Equation_" style="width: 100%;" cellspacing="0" cellpadding="0">
            <col style="width: auto;" />
            <col style="width: 100px;" />
            <col style="width: auto;" />
            <tr>
                <td class="AutoNumber_p_Equation_" valign="top" data-mc-autonum="(3)">
                    <img src="../GeneratedImages/Equations/Equation160.svg" alt="" class="_MCEquation_0 mcReset" />
                </td>
                <td class="AutoNumber_p_Equation_" valign="top"><span>(3)</span>
                </td>
                <td valign="top" />
            </tr>
        </table>
        <p>The following steps are carried out separately for each of the current structures, <i>j</i>:</p>
        <table class="AutoNumber_p_Numbered1" style="width: 100%; margin-left: 0;" cellspacing="0" cellpadding="0">
            <col style="width: 0px;" />
            <col style="width: 32px;" />
            <col style="width: auto;" />
            <tr>
                <td valign="top" />
                <td class="AutoNumber_p_Numbered1" valign="top"><span>1.</span>
                </td>
                <td class="AutoNumber_p_Numbered1" valign="top" data-mc-autonum="1.">Estimate the p<i>K</i><sub>a</sub> values for all ionizable groups</td>
            </tr>
        </table>
        <table class="AutoNumber_p_Numbered1_" style="width: 100%; margin-left: 0;" cellspacing="0" cellpadding="0">
            <col style="width: 0px;" />
            <col style="width: 32px;" />
            <col style="width: auto;" />
            <tr>
                <td valign="top" />
                <td class="AutoNumber_p_Numbered1" valign="top"><span>2.</span>
                </td>
                <td class="AutoNumber_p_Numbered1" valign="top" data-mc-autonum="2.">Accumulate structures into the new collection by examining each ionizable group in turn:</td>
            </tr>
        </table>
        <p class="Roman2">If it is in a basic form and p<i>K</i><sub>a</sub> &lt; pH + <i>del_pH</i>, the basic form is added to the new collection of structures.</p>
        <p class="Roman2_">If it is in a basic form and p<i>K</i><sub>a</sub> &gt; pH − <i>del_pH</i>, a proton is added to generate a new structure which is added to the new collection.</p>
        <p class="Roman2_">If it is an acidic form and p<i>K</i><sub>a</sub> &gt; pH − <i>del_pH</i>, the acid form is added to the new collection of structures</p>
        <p class="Roman2_">If it is in an acidic form and p<i>K</i><sub>a</sub> &lt; pH + <i>del_pH</i>, the proton is removed to generate a new structure which is added to the new collection.</p>
        <p>If a new structure is the same as one already present in the new collection, it is not added a second time.</p>
        <p>When all of the structures in the current collection of structures have been ionized, the weights for the new states are estimated:</p>
        <table class="AutoNumber_p_Equation_" style="width: 100%;" cellspacing="0" cellpadding="0">
            <col style="width: auto;" />
            <col style="width: 100px;" />
            <col style="width: auto;" />
            <tr>
                <td class="AutoNumber_p_Equation_" valign="top" data-mc-autonum="(4)">
                    <img src="../GeneratedImages/Equations/Equation161.svg" alt="" class="_MCEquation_0 mcReset" />
                </td>
                <td class="AutoNumber_p_Equation_" valign="top"><span>(4)</span>
                </td>
                <td valign="top" />
            </tr>
        </table>
        <p>which are normalized to give estimates for the populations:</p>
        <table class="AutoNumber_p_Equation_" style="width: 100%;" cellspacing="0" cellpadding="0">
            <col style="width: auto;" />
            <col style="width: 100px;" />
            <col style="width: auto;" />
            <tr>
                <td class="AutoNumber_p_Equation_" valign="top" data-mc-autonum="(5)">
                    <img src="../GeneratedImages/Equations/Equation162.svg" alt="" class="_MCEquation_0 mcReset" />
                </td>
                <td class="AutoNumber_p_Equation_" valign="top"><span>(5)</span>
                </td>
                <td valign="top" />
            </tr>
        </table>
        <p>Those with a population lower than the <i>minpop</i> threshold are eliminated. If there are more than <i>ms</i> structures, only the <i>ms</i> structures with the highest population are retained, with a minimum of 3 structures. The resulting set of structures is now considered the current collection of structures. The populations of individual structures in this collection, <i>j</i>, are now referred to as Pc<sub class="SubItal">j</sub>.</p>
        <p>For each iteration, the process of tautomerizing and ionizing is repeated until either the collection of structures does not change from one iteration to the next, or the maximum number of iterations (6) is reached. At the end of this process, using the population for each structure, Pc<sub class="SubItal">j</sub>, the overall state penalty for each structure is calculated using:</p>
        <table class="AutoNumber_p_Equation_" style="width: 100%;" cellspacing="0" cellpadding="0">
            <col style="width: auto;" />
            <col style="width: 100px;" />
            <col style="width: auto;" />
            <tr>
                <td class="AutoNumber_p_Equation_" valign="top" data-mc-autonum="(6)">
                    <img src="../GeneratedImages/Equations/Equation163.svg" alt="" class="_MCEquation_0 mcReset" />
                </td>
                <td class="AutoNumber_p_Equation_" valign="top"><span>(6)</span>
                </td>
                <td valign="top" />
            </tr>
        </table>
        <p>The process used to determine <code>r_epik_State_Penalty</code> involves a number of significant approximations and thus, this quantity should only be used as a rough guide for gauging the importance of the output structures.</p>
        <table class="NavLink" data-mc-conditions="Default.ScreenOnly">
            <tr class="NavLink">
                <td class="NavLeft"><span class="NavText">◀ <a class="NavLink MCXref xref xrefNavLink" href="epik_struct_adjust_penalties.htm" xrefformat="{paratext}">Penalties and Populations for Ionization State and Tautomeric Forms</a></span>
                </td>
                <td class="NavCenter"><span class="NavText"><a class="NavLink MCXref xref xrefNavLink" href="epik_command_referenceTOC.htm" xrefformat="{paratext}">Epik Command Reference</a></span>
                </td>
                <td class="NavRight"><span class="NavText"><a class="NavLink MCXref xref xrefNavLink" href="epik_struct_adjust_metals.htm" xrefformat="{paratext}">Structural Adjustment for Metal Binding</a> ▶</span>
                </td>
            </tr>
        </table>
    </body>
</html>