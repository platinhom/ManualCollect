<!DOCTYPE html>
<html xmlns:MadCap="http://www.madcapsoftware.com/Schemas/MadCap.xsd" lang="en-US" xml:lang="en-US" data-mc-search-type="Stem" data-mc-help-system-file-name="Documentation.xml" data-mc-path-to-help-system="../" data-mc-target-type="WebHelp2" data-mc-runtime-file-type="Topic" data-mc-preload-images="false" data-mc-in-preview-mode="false" data-mc-toc-path="User Manuals|MacroModel User Manual|MacroModel Minimizations|Setting MacroModel Minimization Parameters">
    <head>
        <meta name="viewport" content="width=device-width, initial-scale=1.0" />
        <meta charset="utf-8" />
        <meta http-equiv="X-UA-Compatible" content="IE=edge" />
        <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
        <link href="../Skins/Default/Stylesheets/Slideshow.css" rel="stylesheet" type="text/css" data-mc-generated="True" />
        <link href="../Skins/Default/Stylesheets/TextEffects.css" rel="stylesheet" type="text/css" data-mc-generated="True" />
        <link href="../Skins/Default/Stylesheets/Topic.css" rel="stylesheet" type="text/css" data-mc-generated="True" />
        <link href="../Skins/Default/Stylesheets/Components/Styles.css" rel="stylesheet" type="text/css" data-mc-generated="True" /><title>MacroModel Minimization Methods</title>
        <link href="../Resources/Stylesheets/docs.css" rel="stylesheet" />
        <script src="../Resources/Scripts/custom.modernizr.js" type="text/javascript">
        </script>
        <script src="../Resources/Scripts/jquery.min.js" type="text/javascript">
        </script>
        <script src="../Resources/Scripts/require.min.js" type="text/javascript">
        </script>
        <script src="../Resources/Scripts/require.config.js" type="text/javascript">
        </script>
        <script src="../Resources/Scripts/foundation.min.js" type="text/javascript">
        </script>
        <script src="../Resources/Scripts/plugins.min.js" type="text/javascript">
        </script>
        <script src="../Resources/Scripts/MadCapAll.js" type="text/javascript">
        </script>
    </head>
    <body><a name="aanchor6282"></a>
        <MadCap:concept term="User Manuals" /><a name="aanchor6283"></a>
        <MadCap:concept term="MacroModel" /><a name="mm_minimization_378678775_740365"></a>
        <table class="NavLink" data-mc-conditions="Default.ScreenOnly">
            <tr class="NavLink">
                <td class="NavLeft"><span class="NavText">◀ <a href="mm_minimization_parameters.htm" class="NavLink MCXref xref xrefNavLink" xrefformat="{paratext}">Setting MacroModel Minimization Parameters</a></span>
                </td>
                <td class="NavCenter"><span class="NavText"><a class="NavLink MCXref xref xrefNavLink" href="macromodel_user_manualTOC.htm" xrefformat="{paratext}">MacroModel User Manual</a></span>
                </td>
                <td class="NavRight"><span class="NavText"><a href="mm_minimization_parameters_convergence.htm" class="NavLink MCXref xref xrefNavLink" xrefformat="{paratext}">Convergence Parameters for MacroModel Minimizations</a> ▶</span>
                </td>
            </tr>
        </table>
        <h1 class="Title">MacroModel Minimization Methods</h1>
        <p>From the <span class="GUI">Method</span> option menu, select a minimization method for your calculation. Choose from the following supported methods:</p>
        <ul>
            <li value="1">
                <p class="ListPara"><span class="GUI">PRCG</span> (Polak-Ribiere Conjugate Gradient) </p>
                <p class="ListPara">This is a conjugate gradient minimization scheme that uses the Polak-Ribiere first derivative method with restarts every 3N iterations <a class="Reference_Number MCXref xref xrefReference_Number" href="../macromodel_command_reference/mmod_references.htm#mmod_references_3670527510_742020" xrefformat="[{color #0E6895}{paranumonly}{/color}]">[<span style="color: #0e6895;" class="mcFormatColor">25</span>]</a>. This is the best general method for energy minimization, but it should not be used to find transition states.</p>
            </li>
            <li value="2">
                <p class="ListPara"><span class="GUI">TNCG</span> (Truncated Newton Conjugate Gradient)</p>
                <p class="ListPara">TNCG uses second derivatives and line searching and is highly efficient for producing very low gradient structures. It generally converges in one tenth the number of iterations necessary for a PRCG, but each iteration takes more time. Often FMNR re-minimization of TNCG structures gives the lowest final gradients <a class="Reference_Number MCXref xref xrefReference_Number" href="../macromodel_command_reference/mmod_references.htm#mmod_references_3670527510_741406" xrefformat="[{color #0E6895}{paranumonly}{/color}]">[<span style="color: #0e6895;" class="mcFormatColor">27</span>]</a>.</p>
            </li>
            <li value="3">
                <p class="ListPara"><span class="GUI">OSVM</span> (Oren-Spedicato Variable Metric)</p>
                <p class="ListPara">This is a variable metric minimization that uses the Oren-Spedicato modification <a class="Reference_Number MCXref xref xrefReference_Number" href="../macromodel_command_reference/mmod_references.htm#mmod_references_3670527510_741398" xrefformat="[{color #0E6895}{paranumonly}{/color}]">[<span style="color: #0e6895;" class="mcFormatColor">26</span>]</a> of the Fletcher-Powell quasi-Newton method. Convergence to saddle points is possible. Typical convergence occurs in 3N – 6N iterations, but note that iteration speed is relatively slow. OSVM is not recommended for structures with poor starting geometries.</p>
            </li>
            <li value="4">
                <p class="ListPara"><span class="GUI">SD</span> (Steepest Descent)</p>
                <p class="ListPara">This is a steepest descent minimization method. The “SD” should not be used to find saddle points, and convergence is poor towards the end of minimization. This is a good method for starting geometries that are far from the minimum, but switching to another method is recommended when derivatives fall below 10 kJ/mol-Å or so. It is generally not optimal to use SD minimization. PRCG is usually a better choice.</p>
            </li>
            <li value="5">
                <p class="ListPara"><span class="GUI">FMNR</span> (Full Matrix Newton Raphson)</p>
                <p class="ListPara">With this method, convergence to saddle points is not uncommon. Use FMNR with preminimized structures having RMS gradients of less than 0.1 kJ/mol-Å. Use line searching (select after prompt) for problematic cases, or if the RMS First Derivative is greater than 0.1. The preminimization requirement derives from the Newton Raphson assumption of a quadratic potential surface. The method works only if the assumption is valid. FMNR is the most effective method for fully converging structures, but the computational resources required are significant for large structures.</p>
                <p class="ListPara">To find saddle point structures, you will need to start very close to the saddle point, and you will have to disable line searching.</p>
                <p class="ListPara">FMNR has excellent convergence properties, and typically converges in two to ten iterations.</p>
            </li>
            <li value="6">
                <p class="ListPara"><span class="GUI">LBFGS</span> (Low-memory Broyden-Fletcher-Goldfarb-Shanno)</p>
                <p class="ListPara">A method that performs well with large structures.</p>
            </li>
            <li value="7">
                <p class="ListPara"><span class="GUI">Optimal</span>
                </p>
                <p class="ListPara">This choice uses the <span class="GUI">TNCG</span> method if the number of unfixed atoms is less than 1000 and solvation is employed, otherwise it uses the <span class="GUI">PRCG</span> method. (Sets <span class="CodeLink"><a href="../macromodel_command_reference/opcodes_minimization.htm#opcodes_509685220_mini">MINI</a></span> arg1 to 20). </p>
            </li>
        </ul>
        <table class="NavLink" data-mc-conditions="Default.ScreenOnly">
            <tr class="NavLink">
                <td class="NavLeft"><span class="NavText">◀ <a href="mm_minimization_parameters.htm" class="NavLink MCXref xref xrefNavLink" xrefformat="{paratext}">Setting MacroModel Minimization Parameters</a></span>
                </td>
                <td class="NavCenter"><span class="NavText"><a class="NavLink MCXref xref xrefNavLink" href="macromodel_user_manualTOC.htm" xrefformat="{paratext}">MacroModel User Manual</a></span>
                </td>
                <td class="NavRight"><span class="NavText"><a href="mm_minimization_parameters_convergence.htm" class="NavLink MCXref xref xrefNavLink" xrefformat="{paratext}">Convergence Parameters for MacroModel Minimizations</a> ▶</span>
                </td>
            </tr>
        </table>
    </body>
</html>