<!DOCTYPE html>
<html xmlns:MadCap="http://www.madcapsoftware.com/Schemas/MadCap.xsd" lang="en-US" xml:lang="en-US" data-mc-search-type="Stem" data-mc-help-system-file-name="Documentation.xml" data-mc-path-to-help-system="../" data-mc-target-type="WebHelp2" data-mc-runtime-file-type="Topic" data-mc-preload-images="false" data-mc-in-preview-mode="false" data-mc-toc-path="Help|Maestro Tools Help">
    <MadCap:conditionalText data-mc-conditions="Default.FFBUILDER">
        <html>
            <head>
                <meta name="viewport" content="width=device-width, initial-scale=1.0" />
                <meta charset="utf-8" />
                <meta http-equiv="X-UA-Compatible" content="IE=edge" />
                <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
                <link href="../Skins/Default/Stylesheets/Slideshow.css" rel="stylesheet" type="text/css" data-mc-generated="True" />
                <link href="../Skins/Default/Stylesheets/TextEffects.css" rel="stylesheet" type="text/css" data-mc-generated="True" />
                <link href="../Skins/Default/Stylesheets/Topic.css" rel="stylesheet" type="text/css" data-mc-generated="True" />
                <link href="../Skins/Default/Stylesheets/Components/Styles.css" rel="stylesheet" type="text/css" data-mc-generated="True" />
                <link href="../Resources/Stylesheets/docs.css" rel="stylesheet" type="text/css" /><title>Force Field Builder Panel</title>
                <script src="../Resources/Scripts/custom.modernizr.js" type="text/javascript">
                </script>
                <script src="../Resources/Scripts/jquery.min.js" type="text/javascript">
                </script>
                <script src="../Resources/Scripts/require.min.js" type="text/javascript">
                </script>
                <script src="../Resources/Scripts/require.config.js" type="text/javascript">
                </script>
                <script src="../Resources/Scripts/foundation.min.js" type="text/javascript">
                </script>
                <script src="../Resources/Scripts/plugins.min.js" type="text/javascript">
                </script>
                <script src="../Resources/Scripts/MadCapAll.js" type="text/javascript">
                </script>
            </head>
            <body><a name="aanchor625"></a>
                <MadCap:concept term="Help Topics" /><a name="aanchor626"></a>
                <MadCap:concept term="Maestro" />
                <table class="navlink">
                    <tr>
                        <td class="navlink"><a class="navbutton" href="#using">Using</a>
                        </td>
                        <td class="navlink"><a class="navbutton" href="#features">Features</a>
                        </td>
                        <td class="navlink"><a class="navbutton" href="#links">Links</a>
                        </td>
                    </tr>
                </table>
                <h1 class="title">Force Field Builder Panel</h1><a name="summary"></a>
                <p>Customize torsions that are not explicitly included in the OPLS3 force field by fitting to quantum-mechanical calculations for a set of molecules.</p>
                <h2><a name="using"></a>Using the Force Field Builder Panel</h2>
                <p>This panel is designed to provide force-field parameters for torsions that are not explicitly represented in the force field. The set of molecules that is provided is analyzed to locate such torsions, and you can then run quantum-mechanical calculations on these molecules, which are fitted to obtain parameters for the torsions. By default, all torsions that are found are fitted simultaneously, but you can exclude selected torsions from the fit and refit the data.</p>
                <p>The torsional energies are calculated by performing coordinate scans with Jaguar, then fitting the resulting energy curves to produce new force-field parameters. These calculations can take a long time. They can be run on multiple processors to decrease the turnaround time.</p>
                <p><b>To generate custom force-field parameters:</b>
                </p>
                <ol>
                    <li value="1">
                        <p>Specify a directory for the intermediate data in the <span class="GUI">Directory</span> text box.</p>
                    </li>
                    <li value="2">
                        <p>Add molecules for analysis and generation of parameters.</p>
                    </li>
                    <li value="3">
                        <p>(Optional) Examine the torsions that have been selected for fitting.</p>
                    </li>
                    <li value="4">
                        <p>Click <span class="GUI">Calculate and Fit</span> to run the fitting job.</p>
                    </li>
                    <li value="5">
                        <p>Examine the resulting torsional energy curves, and decide whether to exclude any torsional curves and refit.</p>
                    </li>
                    <li value="6">
                        <p>Save the parameters.</p>
                    </li>
                </ol>
                <p>The custom force field parameters can be used by selecting <span class="GUI">Use customized version</span> in any application panel that supports OPLS3. You can also set <a href="../maestro_help/preferences.html#jobs_forcefield">preferences</a> for the use of OPLS3 and the customized version, so that they are selected by default in the application panels.</p>
                <h2><a name="features"></a>Force Field Builder Panel Features</h2>
                <ul>
                    <li value="1"><a href="#feature1"><span class="GUI">Directory</span> text box and buttons</a>
                    </li>
                    <li value="2"><a href="#feature2"><span class="GUI">Add molecules from</span> buttons</a>
                    </li>
                    <li value="3"><a href="#feature3"><span class="GUI">Molecules</span> table and display area</a>
                    </li>
                    <li value="4"><a href="#feature4"><span class="GUI">Fragments with missing torsions</span> table</a>
                    </li>
                    <li value="5"><a href="#advanced"><span class="GUI">Advanced</span> button</a>
                    </li>
                    <li value="6"><a href="#feature5"><span class="GUI">Calculate and Fit</span> button</a>
                    </li>
                    <li value="7"><a href="#feature6"><span class="GUI">Refit</span> button</a>
                    </li>
                    <li value="8"><a href="#feature7"><span class="GUI">Save Parameters</span> button</a>
                    </li>
                    <li value="9"><a href="#feature8">Status area</a>
                    </li>
                    <li value="10"><a href="#feature9"><span class="GUI">Reset Panel</span> button</a>
                    </li>
                </ul>
                <dl>
                    <dt><a name="feature1"></a><span class="GUI">Directory</span> text box and buttons</dt>
                    <dd>
                        <p>Specify the directory for storage of intermediate data, or for loading existing data. You can type the directory name into the text box, click <span class="GUI">Open</span> to locate a directory that contains existing data, or click <span class="GUI">New</span> to specify a directory into which new intermediate data will be written. Both buttons open file selectors, and the directory name is displayed in the text box when you close the file selector. When you click <span class="GUI">New</span>, you must navigate to a location, and then specify a name for the new directory in the <span class="GUI">File name</span> text box. The directory is created with this name when you click <span class="GUI">Save</span>.</p>
                    </dd>
                    <dt><a name="feature2"></a><span class="GUI">Add molecules from</span> buttons</dt>
                    <dd>
                        <p>Add the molecules for which you want to obtain custom force-field parameters. You can add them from the <span class="GUI">Workspace</span> (included entries), the <span class="GUI">Project Table</span> (selected entries) or a file. Clicking <span class="GUI">File</span> opens a file selector.</p>
                        <p>Once you have chosen a source for the molecules, they are analyzed in a job that is run locally. When the job finishes, the tables below are filled in, and the first molecule is selected in the <span class="GUI">Molecules</span> table. If molecules cannot be analyzed, they are not added to the table, and a dialog box opens with a report of the molecules that could not be analyzed.</p>
                        <p>You can use these buttons multiple times to add molecules, which are analyzed and added to the tables.</p>
                        <p />
                    </dd>
                    <dt><a name="feature3"></a><span class="GUI">Molecules</span> table and display area</dt>
                    <dd>
                        <p>This table lists the input structures, with their titles and the number of torsions for which parameters are missing. You can select a single row in the table. When the row is selected, a 2D structure is displayed in the display area to the right, and the bonds for which torsions are not defined are marked with a number in a colored circle. The number is the row index in the <span class="GUI">Fragments with missing torsions</span> table. When you select a fragment in the <span class="GUI">Fragments with missing torsions</span> table, the circle is highlighted with a yellow border.</p>
                        <p>To delete a molecule from the table, select it, then right-click and choose <span class="GUI">Delete Selected</span>. To clear the table, right-click and choose <span class="GUI">Delete All</span>.</p>
                    </dd>
                    <dt><a name="feature4"></a><span class="GUI">Fragments with missing torsions</span> table</dt>
                    <dd>
                        <p>This table displays the 2D structures for the fragments from the current molecule that have missing torsions. When you select a fragment in this table, it is highlighted in the display area for the molecule.</p>
                        <p>After parameters have been generated for a molecule, two columns are added to the table: <span class="GUI">Fit RMSE</span>, which displays the RMSE between the QM energy and the force-field energy from the fitting procedure at the points on the torsional grid, and <span class="GUI">Refit</span>, which is a column of check boxes that you can use to include or exclude a fragment from refitting.</p>
                        <p>The torsional energy of the selected fragment is displayed in a graph in the display area to the right. Three curves are displayed: the energy from the origianl force-field parameters, the QM energy, and the energy from the newly fitted parameters. You can click on a point in this plot to display the QM structure for this point in the Workspace.</p>
                    </dd>
                    <dt><a name="advanced"></a><span class="GUI">Advanced</span> button</dt>
                    <dd>
                        <p>Open the <span class="GUI">FFBuilder Fragment Options</span> dialog box, in which you can set the following options for fragmenting the molecules:</p>
                        <dl>
                            <dt><span class="GUI">Fragmentize</span> option</dt>
                            <dd>
                                <p>This option controls whether ligands are trimmed down into fragments for fitting, or left as they are. If the ligands you supply are the actual molecules you want to use for fitting, deselect this option. Otherwise, the molecules will be trimmed (the default).</p>
                            </dd>
                            <dt><span class="GUI">Keep atoms bonded to torsional atoms</span> option</dt>
                            <dd>
                                <p>When trimming down a ligand, keep all atoms that are bonded to any atoms involved in the torsion that is being fitted. The torsional atoms are the two central atoms of the torsion ("central torsional atoms"), and all atoms that are bonded to these atoms ("end torsional atoms"), from which a torsion around the central bond could be constructed. Selecting this option means that any atoms that are two bonds away from the central two atoms of the torsion are kept.</p>
                            </dd>
                            <dt><span class="GUI">Keep proximate rings if</span> options</dt>
                            <dd>
                                <p>Keep non-aromatic rings that have an atom in the torsional atom set. You can choose one of two options for how close the ring is to the central bond:</p>
                                <ul>
                                    <li value="1"><span class="GUI">a central torsional atom is part of the ring</span>
                                    </li>
                                    <li value="2"><span class="GUI">an end torsional atom is part of the ring</span>
                                    </li>
                                </ul>
                                <p>Aromatic rings that have atoms in the torsional set are always kept.</p>
                            </dd>
                            <dt><span class="GUI">Max ring size</span> text box</dt>
                            <dd>
                                <p>Set a limit on the size of non-aromatic rings that are kept if they have atoms in the torsional atom set. This box is provided so that you can exclude macrocycles from being kept, as it may be useful to trim macrocycles but not smaller rings.</p>
                            </dd>
                        </dl>
                    </dd>
                    <dt><a name="feature5"></a><span class="GUI">Calculate and Fit</span> button</dt>
                    <dd>
                        <p>Start the QM calculations to generate QM torsional scans and fit the torsions. The calculations are done on all fragments for all molecules. The QM torsional energies are then fitted to obtain new force-field parameters.</p>
                    </dd>
                    <dt><a name="feature6"></a><span class="GUI">Refit</span> button</dt>
                    <dd>
                        <p>Refit the QM energies to obtain a new set of force-field parameters. This allows you to exclude torsions from the fit and then refit the data.</p>
                    </dd>
                    <dt><a name="feature7"></a><span class="GUI">Save Parameters</span> button</dt>
                    <dd>
                        <p>Save the parameters as a custom force field. The custom force field is written by default to the <code>opls_dir</code> folder in your <a href="../job_control/job_control_glossary.htm#user_resources_directory">Schr√∂dinger user resources directory</a>. You can change the location in the <span class="GUI">Preferences</span> panel, under  <a href="../maestro_help/preferences.html#jobs_forcefield">Jobs - Force field</a></p>
                    </dd>
                    <dt><a name="feature8"></a>Status area</dt>
                    <dd>
                        <p>This area reports the status of the current operation or the requirement for the next operation.</p>
                    </dd>
                    <dt><a name="feature9"></a><span class="GUI">Reset Panel</span> button</dt>
                    <dd>
                        <p>Clear all data from the panel and reset any values to their defaults.</p>
                    </dd>
                </dl>
                <h2><a name="links"></a>Related Topics</h2>
                <ul>
                    <li value="1"><a href="../maestro_help/preferences.html" class="MCXref xref" xrefformat="{paratext}">Preferences Panel</a>
                    </li>
                    <li value="2"><a href="../maestro_help/opls3.html" class="MCXref xref" xrefformat="{paratext}">OPLS3 Force Field</a>
                    </li>
                </ul>
            </body>
        </html>
    </MadCap:conditionalText>
</html>