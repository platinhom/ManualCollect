<!DOCTYPE html>
<html xmlns:MadCap="http://www.madcapsoftware.com/Schemas/MadCap.xsd" lang="en-US" xml:lang="en-US" data-mc-search-type="Stem" data-mc-help-system-file-name="Documentation.xml" data-mc-path-to-help-system="../" data-mc-target-type="WebHelp2" data-mc-runtime-file-type="Topic" data-mc-preload-images="false" data-mc-in-preview-mode="false" data-mc-toc-path="Command References|Jaguar Command Reference|The Jaguar Input File|The gen Section Of The Jaguar Input File">
    <head>
        <meta name="viewport" content="width=device-width, initial-scale=1.0" />
        <meta charset="utf-8" />
        <meta http-equiv="X-UA-Compatible" content="IE=edge" />
        <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
        <link href="../Skins/Default/Stylesheets/Slideshow.css" rel="stylesheet" type="text/css" data-mc-generated="True" />
        <link href="../Skins/Default/Stylesheets/TextEffects.css" rel="stylesheet" type="text/css" data-mc-generated="True" />
        <link href="../Skins/Default/Stylesheets/Topic.css" rel="stylesheet" type="text/css" data-mc-generated="True" />
        <link href="../Skins/Default/Stylesheets/Components/Styles.css" rel="stylesheet" type="text/css" data-mc-generated="True" /><title>TDHF and TDDFT Keywords In The Jaguar Input File</title>
        <link href="../Resources/TableStyles/StandardRules.css" rel="stylesheet" data-mc-stylesheet-type="table" />
        <link href="../Resources/Stylesheets/docs.css" rel="stylesheet" />
        <script src="../Resources/Scripts/custom.modernizr.js" type="text/javascript">
        </script>
        <script src="../Resources/Scripts/jquery.min.js" type="text/javascript">
        </script>
        <script src="../Resources/Scripts/require.min.js" type="text/javascript">
        </script>
        <script src="../Resources/Scripts/require.config.js" type="text/javascript">
        </script>
        <script src="../Resources/Scripts/foundation.min.js" type="text/javascript">
        </script>
        <script src="../Resources/Scripts/plugins.min.js" type="text/javascript">
        </script>
        <script src="../Resources/Scripts/MadCapAll.js" type="text/javascript">
        </script>
    </head>
    <body><a name="aanchor8552"></a>
        <MadCap:concept term="Command Reference" /><a name="aanchor8553"></a>
        <MadCap:concept term="Jaguar" /><a name="jaguar_input_1430212170_725514"></a><a name="jaguar_input_1430212170_43334"></a>
        <table class="NavLink" data-mc-conditions="Default.ScreenOnly">
            <tr class="NavLink">
                <td class="NavLeft"><span class="NavText">◀ <a class="NavLink MCXref xref xrefNavLink" href="jaguar_input_gen_dft.htm">DFT Keywords In The Jaguar Input File</a></span>
                </td>
                <td class="NavCenter"><span class="NavText"><a class="NavLink MCXref xref xrefNavLink" href="jaguar_command_referenceTOC.htm">Jaguar Command Reference Manual</a></span>
                </td>
                <td class="NavRight"><span class="NavText"><a class="NavLink MCXref xref xrefNavLink" href="jaguar_input_gen_geopt.htm">Geometry Optimization and Transition-State Keywords in the Jaguar Input File</a> ▶</span>
                </td>
            </tr>
        </table>
        <h1 class="Title">TDHF and TDDFT Keywords In The Jaguar Input File</h1>
        <p>The time-dependent Hartree-Fock (TDHF) and time-dependent density-functional theory (TDDFT) methods can be used after an SCF calculation to generate information on excited states. The output includes energies, oscillator strengths and transition dipole moments for excitations from the ground state. If a spin-orbit TDDFT calculation is run, phosphorescence rates are also calculated.</p>
        <p>The keywords for the TDHF or TDDFT calculation are listed in <a class="Table_Number MCXref xref xrefTable_Number selected" href="#jaguar_input_1430212170_793056">Table 1</a>. A TDDFT calculation is performed if a density functional has been specified, otherwise a TDHF calculation is performed. The rest of the calculation should be set up as an SCF calculation. </p>
        <p>For a closed-shell system, you can choose to generate singlet excited states or triplet excited states, or both. The states are spin-adapted. If you are using the spin-orbit ZORA Hamiltonian (<span class="Keyword"><a href="jaguar_input_gen_relham.htm#jaguar_input_1430212170_relham">relham</a></span>=zora-2c), Kramers-restricted excited states are generated, and you must have <span class="Keyword"><a href="jaguar_input_gen_scf.htm#jaguar_input_1430212170_iuhf">iuhf</a></span>=0 as unrestricted TDDFT with spin-orbit coupling is not permitted. TDDFT with the spin-orbit ZORA Hamiltonian is called SO-TDDFT. </p>
        <p>You can run TDHF or TDDFT calculations on open-shell systems with a UHF or UDFT reference function (but not SO-TDDFT or SO-TDHF, i.e. with <span class="Keyword"><a href="jaguar_input_gen_relham.htm#jaguar_input_1430212170_relham">relham</a></span>=zora-2c). These calculations generate all singly-excited states, including states of higher or lower spin arising from a single spin flip, but there is no spin adaption. </p>
        <p>In conjunction with <span class="Keyword">igeopt</span>=1, you can run a geometry optimization on the lowest excited state generated by TDDFT (but not SO-TDDFT). If the ground state is a closed shell, you can choose to optimize the lowest singlet or the lowest triplet state with <span class="Keyword">rsinglet</span> or <span class="Keyword">rtriplet</span> set. </p>
        <p>You should not normally need to set <span class="Keyword">nrestart</span>, because the program determines how many iterations it can do with the amount of memory available. </p>
        <p>You should use the <span class="Keyword">ittdft</span> keyword, as it selects a much faster and more accurate algorithm. The old <span class="Keyword">icis</span> keyword is deprecated and may be removed in a future release.</p>
        <table class="TableStyle-StandardRules" style="caption-side: top;mc-table-style: url('../Resources/TableStyles/StandardRules.css');" cellspacing="0">
            <caption valign="top" style="padding-bottom: 7pt;">
                <p class="Table_Caption" data-mc-autonum="Table 1. "><span class="autonumber"><span>Table 1. </span></span><a name="jaguar_input_1430212170_793056"></a>Keywords for TDDFT and TDHF calculations</p>
            </caption>
            <thead>
                <tr class="TableStyle-StandardRules-Head-Header1">
                    <td class="TableStyle-StandardRules-HeadE-Column1-Header1">
                        <p class="Cell_Heading">Keyword</p>
                    </td>
                    <td class="TableStyle-StandardRules-HeadE-Column1-Header1">
                        <p class="Cell_Heading">Value</p>
                    </td>
                    <td class="TableStyle-StandardRules-HeadD-Column1-Header1">
                        <p class="Cell_Heading">Description</p>
                    </td>
                </tr>
            </thead>
            <tbody>
                <tr class="TableStyle-StandardRules-Body-Body1">
                    <td class="TableStyle-StandardRules-BodyH-Column1-Body1">
                        <p class="Cell_Body"><a name="jaguar_input_1430212170_itddft"></a><span class="Keyword">itddft</span>
                        </p>
                    </td>
                    <td class="TableStyle-StandardRules-BodyH-Column1-Body1">
                        <p class="Cell_Body"><i class="BoldItalic">0</i>
                        </p>
                    </td>
                    <td class="TableStyle-StandardRules-BodyG-Column1-Body1">
                        <p class="Cell_Body">Do not do a TDDFT or TDHF calculation.</p>
                    </td>
                </tr>
                <tr class="TableStyle-StandardRules-Body-Body1">
                    <td class="TableStyle-StandardRules-BodyE-Column1-Body1">
                        <p class="Cell_Body">&#160;</p>
                    </td>
                    <td class="TableStyle-StandardRules-BodyE-Column1-Body1">
                        <p class="Cell_Body">1</p>
                    </td>
                    <td class="TableStyle-StandardRules-BodyD-Column1-Body1">
                        <p class="Cell_Body">Do a TDDFT or TDHF calculation.</p>
                    </td>
                </tr>
                <tr class="TableStyle-StandardRules-Body-Body2">
                    <td class="TableStyle-StandardRules-BodyH-Column1-Body2">
                        <p class="Cell_Body"><a name="jaguar_input_1430212170_itda"></a><span class="Keyword">itda</span>
                        </p>
                    </td>
                    <td class="TableStyle-StandardRules-BodyH-Column1-Body2">
                        <p class="Cell_Body"><i class="BoldItalic">0</i>
                        </p>
                    </td>
                    <td class="TableStyle-StandardRules-BodyG-Column1-Body2">
                        <p class="Cell_Body">Use the full linear response in TDDFT calculations</p>
                    </td>
                </tr>
                <tr class="TableStyle-StandardRules-Body-Body2">
                    <td class="TableStyle-StandardRules-BodyE-Column1-Body2">
                        <p class="Cell_Body">&#160;</p>
                    </td>
                    <td class="TableStyle-StandardRules-BodyE-Column1-Body2">
                        <p class="Cell_Body">1</p>
                    </td>
                    <td class="TableStyle-StandardRules-BodyD-Column1-Body2">
                        <p class="Cell_Body">Use the Tamm-Dancoff approximation (TDA) in TDDFT calculations, do a CIS calculation for HF wave functions.</p>
                    </td>
                </tr>
                <tr class="TableStyle-StandardRules-Body-Body1">
                    <td class="TableStyle-StandardRules-BodyH-Column1-Body1">
                        <p class="Cell_Body"><a name="jaguar_input_1430212170_icis"></a><span class="Keyword">icis</span>
                        </p>
                    </td>
                    <td class="TableStyle-StandardRules-BodyH-Column1-Body1">
                        <p class="Cell_Body"><i class="BoldItalic">0</i>
                        </p>
                    </td>
                    <td class="TableStyle-StandardRules-BodyG-Column1-Body1">
                        <p class="Cell_Body">Do not do a CIS or TDDFT calculation with the old implementation. </p>
                    </td>
                </tr>
                <tr class="TableStyle-StandardRules-Body-Body1">
                    <td class="TableStyle-StandardRules-BodyE-Column1-Body1">
                        <p class="Cell_Body">&#160;</p>
                    </td>
                    <td class="TableStyle-StandardRules-BodyE-Column1-Body1">
                        <p class="Cell_Body">1</p>
                    </td>
                    <td class="TableStyle-StandardRules-BodyD-Column1-Body1">
                        <p class="Cell_Body">Do a CIS or TDDFT calculation with the old implementation. Deprecated. Use <span class="Keyword">itddft</span> instead.</p>
                    </td>
                </tr>
                <tr class="TableStyle-StandardRules-Body-Body2">
                    <td class="TableStyle-StandardRules-BodyH-Column1-Body2">
                        <p class="Cell_Body"><a name="jaguar_input_1430212170_rsinglet"></a><span class="Keyword">rsinglet</span>
                        </p>
                    </td>
                    <td class="TableStyle-StandardRules-BodyH-Column1-Body2">
                        <p class="Cell_Body"><i class="BoldItalic">0</i>
                        </p>
                    </td>
                    <td class="TableStyle-StandardRules-BodyG-Column1-Body2">
                        <p class="Cell_Body">Do not calculate restricted singlet excited states. </p>
                    </td>
                </tr>
                <tr class="TableStyle-StandardRules-Body-Body2">
                    <td class="TableStyle-StandardRules-BodyE-Column1-Body2">
                        <p class="Cell_Body">&#160;</p>
                    </td>
                    <td class="TableStyle-StandardRules-BodyE-Column1-Body2">
                        <p class="Cell_Body">1</p>
                    </td>
                    <td class="TableStyle-StandardRules-BodyD-Column1-Body2">
                        <p class="Cell_Body">Calculate restricted singlet excited states. Only applies if <span class="Keyword">iuhf</span>=0, and only valid for a closed-shell reference. <span class="Keyword">rsinglet</span>=1 is the default if neither <span class="Keyword">rsinglet</span> or <span class="Keyword">rtriplet</span> is specified. Ignored with <span class="Keyword"><a href="jaguar_input_gen_relham.htm#jaguar_input_1430212170_relham">relham</a></span>=zora-2c. </p>
                    </td>
                </tr>
                <tr class="TableStyle-StandardRules-Body-Body1">
                    <td class="TableStyle-StandardRules-BodyH-Column1-Body1">
                        <p class="Cell_Body"><a name="jaguar_input_1430212170_rtriplet"></a><span class="Keyword">rtriplet</span>
                        </p>
                    </td>
                    <td class="TableStyle-StandardRules-BodyH-Column1-Body1">
                        <p class="Cell_Body"><i class="BoldItalic">0</i>
                        </p>
                    </td>
                    <td class="TableStyle-StandardRules-BodyG-Column1-Body1">
                        <p class="Cell_Body">Do not calculate restricted triplet excited states. </p>
                    </td>
                </tr>
                <tr class="TableStyle-StandardRules-Body-Body1">
                    <td class="TableStyle-StandardRules-BodyE-Column1-Body1">
                        <p class="Cell_Body">&#160;</p>
                    </td>
                    <td class="TableStyle-StandardRules-BodyE-Column1-Body1">
                        <p class="Cell_Body">1</p>
                    </td>
                    <td class="TableStyle-StandardRules-BodyD-Column1-Body1">
                        <p class="Cell_Body">Calculate restricted triplet excited states. Only applies if <span class="Keyword">iuhf</span>=0, and only valid for a closed-shell reference. Ignored with <span class="Keyword"><a href="jaguar_input_gen_relham.htm#jaguar_input_1430212170_relham">relham</a></span>=zora-2c.</p>
                    </td>
                </tr>
                <tr class="TableStyle-StandardRules-Body-Body2">
                    <td class="TableStyle-StandardRules-BodyH-Column1-Body2">
                        <p class="Cell_Body"><a name="jaguar_input_1430212170_rgeneric"></a><span class="Keyword">rgeneric</span>
                        </p>
                    </td>
                    <td class="TableStyle-StandardRules-BodyH-Column1-Body2">
                        <p class="Cell_Body"><i class="BoldItalic">0</i>
                        </p>
                    </td>
                    <td class="TableStyle-StandardRules-BodyG-Column1-Body2">
                        <p class="Cell_Body">Do not calculate Kramers-restricted excited states (i.e. including spin-orbit coupling).</p>
                    </td>
                </tr>
                <tr class="TableStyle-StandardRules-Body-Body2">
                    <td class="TableStyle-StandardRules-BodyE-Column1-Body2">
                        <p class="Cell_Body">&#160;</p>
                    </td>
                    <td class="TableStyle-StandardRules-BodyE-Column1-Body2">
                        <p class="Cell_Body">1</p>
                    </td>
                    <td class="TableStyle-StandardRules-BodyD-Column1-Body2">
                        <p class="Cell_Body">Calculate Kramers-restricted excited states. Only applies if <span class="Keyword">iuhf</span>=0, and only relevant for a closed-shell reference with spin-orbit coupling (<span class="Keyword"><a href="jaguar_input_gen_relham.htm#jaguar_input_1430212170_relham">relham</a></span>=zora-2c); ignored otherwise.</p>
                    </td>
                </tr>
                <tr class="TableStyle-StandardRules-Body-Body1">
                    <td class="TableStyle-StandardRules-BodyH-Column1-Body1">
                        <p class="Cell_Body"><a name="jaguar_input_1430212170_nroot"></a><span class="Keyword">nroot</span>
                        </p>
                    </td>
                    <td class="TableStyle-StandardRules-BodyH-Column1-Body1">
                        <p class="Cell_Body">&gt;0 </p>
                    </td>
                    <td class="TableStyle-StandardRules-BodyG-Column1-Body1">
                        <p class="Cell_Body">Number of roots to find. Default value is 1.</p>
                    </td>
                </tr>
                <tr class="TableStyle-StandardRules-Body-Body1">
                    <td class="TableStyle-StandardRules-BodyE-Column1-Body1">
                        <p class="Cell_Body"><a name="jaguar_input_1430212170_dconvci"></a><span class="Keyword">dconvci</span>
                        </p>
                    </td>
                    <td class="TableStyle-StandardRules-BodyE-Column1-Body1">
                        <p class="Cell_Body"><i class="BoldItalic">1.0e-2</i>
                        </p>
                    </td>
                    <td class="TableStyle-StandardRules-BodyD-Column1-Body1">
                        <p class="Cell_Body">Convergence criterion for the norm of the residual vector (default is 1e-5 for a non-pseudospectral calculation)</p>
                    </td>
                </tr>
                <tr class="TableStyle-StandardRules-Body-Body2">
                    <td class="TableStyle-StandardRules-BodyH-Column1-Body2">
                        <p class="Cell_Body"><a name="jaguar_input_1430212170_econvci"></a><span class="Keyword">econvci</span>
                        </p>
                    </td>
                    <td class="TableStyle-StandardRules-BodyH-Column1-Body2">
                        <p class="Cell_Body"><i class="BoldItalic">1.0e-5</i>
                        </p>
                    </td>
                    <td class="TableStyle-StandardRules-BodyG-Column1-Body2">
                        <p class="Cell_Body">Convergence criterion for the change in energy (default is 1e-8 for a non-pseudospectral calculation)</p>
                    </td>
                </tr>
                <tr class="TableStyle-StandardRules-Body-Body2">
                    <td class="TableStyle-StandardRules-BodyE-Column1-Body2">
                        <p class="Cell_Body"><a name="jaguar_input_1430212170_nrestart"></a><span class="Keyword">nrestart</span>
                        </p>
                    </td>
                    <td class="TableStyle-StandardRules-BodyE-Column1-Body2">
                        <p class="Cell_Body">&gt;0</p>
                    </td>
                    <td class="TableStyle-StandardRules-BodyD-Column1-Body2">
                        <p class="Cell_Body">Number of iterations before restarting</p>
                    </td>
                </tr>
                <tr class="TableStyle-StandardRules-Body-Body1">
                    <td class="TableStyle-StandardRules-BodyH-Column1-Body1">
                        <p class="Cell_Body">&#160;</p>
                    </td>
                    <td class="TableStyle-StandardRules-BodyH-Column1-Body1">
                        <p class="Cell_Body"><i class="BoldItalic">0</i>
                        </p>
                    </td>
                    <td class="TableStyle-StandardRules-BodyG-Column1-Body1">
                        <p class="Cell_Body">Determine number of iterations before restarting automatically</p>
                    </td>
                </tr>
                <tr class="TableStyle-StandardRules-Body-Body1">
                    <td class="TableStyle-StandardRules-BodyE-Column1-Body1">
                        <p class="Cell_Body"><a name="jaguar_input_1430212170_maxciit"></a><span class="Keyword">maxciit</span>
                        </p>
                    </td>
                    <td class="TableStyle-StandardRules-BodyE-Column1-Body1">
                        <p class="Cell_Body"><i class="BoldItalic">32</i>
                        </p>
                    </td>
                    <td class="TableStyle-StandardRules-BodyD-Column1-Body1">
                        <p class="Cell_Body">Maximum number of iterations used</p>
                    </td>
                </tr>
                <tr class="TableStyle-StandardRules-Body-Body2">
                    <td class="TableStyle-StandardRules-BodyH-Column1-Body2">
                        <p class="Cell_Body"><a name="jaguar_input_1430212170_tddft_hso"></a><span class="Keyword">tddft_hso</span>
                        </p>
                    </td>
                    <td class="TableStyle-StandardRules-BodyH-Column1-Body2">
                        <p class="Cell_Body"><i class="BoldItalic">0</i>
                        </p>
                    </td>
                    <td class="TableStyle-StandardRules-BodyG-Column1-Body2">
                        <p class="Cell_Body">Do not calculate spin-orbit matrix elements between singlet and triplet states. </p>
                    </td>
                </tr>
                <tr class="TableStyle-StandardRules-Body-Body2">
                    <td class="TableStyle-StandardRules-BodyE-Column1-Body2">
                        <p class="Cell_Body">&#160;</p>
                    </td>
                    <td class="TableStyle-StandardRules-BodyE-Column1-Body2">
                        <p class="Cell_Body">1</p>
                    </td>
                    <td class="TableStyle-StandardRules-BodyD-Column1-Body2">
                        <p class="Cell_Body">Calculate spin-orbit matrix elements between the lowest triplet state and the ground and lowest excited singlet state. The calculation must be run on a closed-shell molecule with the scalar ZORA Hamiltonian (<span class="Keyword"><a href="jaguar_input_gen_relham.htm#jaguar_input_1430212170_relham">relham</a></span><code>=zora-1c</code> or <code>zora-scalar</code>), and <code>rsinglet=1</code> and <code>rtriplet=1</code>. Matrix elements are reported for all three magnetic sublevels (M<sub>S</sub> values) of the lowest triplet state, as these are in general different; the matrix elements are complex.</p>
                    </td>
                </tr>
                <tr class="TableStyle-StandardRules-Body-Body1">
                    <td class="TableStyle-StandardRules-BodyH-Column1-Body1">
                        <p class="Cell_Body"><a name="jaguar_input_1430212170_phosphotmp"></a><span class="Keyword">phosphotmp</span>
                        </p>
                    </td>
                    <td class="TableStyle-StandardRules-BodyH-Column1-Body1">
                        <p class="Cell_Body"><i class="BoldItalic">298.0</i>
                        </p>
                    </td>
                    <td class="TableStyle-StandardRules-BodyG-Column1-Body1">
                        <p class="Cell_Body">Temperature for calculation of average phosphorescence rates. Phosphorescence rates require the spin-orbit ZORA Hamiltonian  (<span class="Keyword"><a href="jaguar_input_gen_relham.htm#jaguar_input_1430212170_relham">relham</a></span><code>=zora-2c</code> or <code>zora-so</code>).</p>
                    </td>
                </tr>
                <tr class="TableStyle-StandardRules-Body-Body1">
                    <td class="TableStyle-StandardRules-BodyB-Column1-Body1">
                        <p class="Cell_Body"><a name="jaguar_input_1430212170_solv_refr"></a><span class="Keyword">solv_refr</span>
                        </p>
                    </td>
                    <td class="TableStyle-StandardRules-BodyB-Column1-Body1">
                        <p class="Cell_Body"><i class="BoldItalic">1.4241</i>
                        </p>
                    </td>
                    <td class="TableStyle-StandardRules-BodyA-Column1-Body1">
                        <p class="Cell_Body">Refractive index of the solvent for calculation of solvent-corrected average phosphorescence rates. The default value is for CH<sub>2</sub>Cl<sub>2</sub>. Phosphorescence rates require the spin-orbit ZORA Hamiltonian  (<span class="Keyword"><a href="jaguar_input_gen_relham.htm#jaguar_input_1430212170_relham">relham</a></span><code>=zora-2c</code> or <code>zora-so</code>).</p>
                    </td>
                </tr>
            </tbody>
        </table>
        <table class="NavLink" data-mc-conditions="Default.ScreenOnly">
            <tr class="NavLink">
                <td class="NavLeft"><span class="NavText">◀ <a class="NavLink MCXref xref xrefNavLink" href="jaguar_input_gen_dft.htm">DFT Keywords In The Jaguar Input File</a></span>
                </td>
                <td class="NavCenter"><span class="NavText"><a class="NavLink MCXref xref xrefNavLink" href="jaguar_command_referenceTOC.htm">Jaguar Command Reference Manual</a></span>
                </td>
                <td class="NavRight"><span class="NavText"><a class="NavLink MCXref xref xrefNavLink" href="jaguar_input_gen_geopt.htm">Geometry Optimization and Transition-State Keywords in the Jaguar Input File</a> ▶</span>
                </td>
            </tr>
        </table>
    </body>
</html>