<!DOCTYPE html>
<html xmlns:MadCap="http://www.madcapsoftware.com/Schemas/MadCap.xsd" lang="en-US" xml:lang="en-US" data-mc-search-type="Stem" data-mc-help-system-file-name="Documentation.xml" data-mc-path-to-help-system="../" data-mc-target-type="WebHelp2" data-mc-runtime-file-type="Topic" data-mc-preload-images="false" data-mc-in-preview-mode="false" data-mc-toc-path="Command References|Jaguar Command Reference|The Jaguar Input File|The gen Section Of The Jaguar Input File">
    <head>
        <meta name="viewport" content="width=device-width, initial-scale=1.0" />
        <meta charset="utf-8" />
        <meta http-equiv="X-UA-Compatible" content="IE=edge" />
        <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
        <link href="../Skins/Default/Stylesheets/Slideshow.css" rel="stylesheet" type="text/css" data-mc-generated="True" />
        <link href="../Skins/Default/Stylesheets/TextEffects.css" rel="stylesheet" type="text/css" data-mc-generated="True" />
        <link href="../Skins/Default/Stylesheets/Topic.css" rel="stylesheet" type="text/css" data-mc-generated="True" />
        <link href="../Skins/Default/Stylesheets/Components/Styles.css" rel="stylesheet" type="text/css" data-mc-generated="True" /><title>LMP2 Keywords In The Jaguar Input File</title>
        <link href="../Resources/TableStyles/StandardRules.css" rel="stylesheet" data-mc-stylesheet-type="table" />
        <link href="../Resources/Stylesheets/docs.css" rel="stylesheet" />
        <script src="../Resources/Scripts/custom.modernizr.js" type="text/javascript">
        </script>
        <script src="../Resources/Scripts/jquery.min.js" type="text/javascript">
        </script>
        <script src="../Resources/Scripts/require.min.js" type="text/javascript">
        </script>
        <script src="../Resources/Scripts/require.config.js" type="text/javascript">
        </script>
        <script src="../Resources/Scripts/foundation.min.js" type="text/javascript">
        </script>
        <script src="../Resources/Scripts/plugins.min.js" type="text/javascript">
        </script>
        <script src="../Resources/Scripts/MadCapAll.js" type="text/javascript">
        </script>
    </head>
    <body><a name="aanchor1732"></a>
        <MadCap:concept term="Command Reference" /><a name="aanchor1733"></a>
        <MadCap:concept term="Jaguar" /><a name="jaguar_input_1430212170_765708"></a><a name="jaguar_input_1430212170_80346"></a>
        <table class="NavLink" data-mc-conditions="Default.ScreenOnly">
            <tr class="NavLink">
                <td class="NavLeft"><span class="NavText">◀ <a class="NavLink MCXref xref xrefNavLink" href="jaguar_input_gen_symmetry.htm">Symmetry-Related Keywords In The Jaguar Input File</a></span>
                </td>
                <td class="NavCenter"><span class="NavText"><a class="NavLink MCXref xref xrefNavLink" href="jaguar_command_referenceTOC.htm">Jaguar Command Reference Manual</a></span>
                </td>
                <td class="NavRight"><span class="NavText"><a class="NavLink MCXref xref xrefNavLink" href="jaguar_input_gen_relham.htm">Relativistic Hamiltonian Keyword In The Jaguar Input File</a> ▶</span>
                </td>
            </tr>
        </table>
        <h1 class="Title">LMP2 Keywords In The Jaguar Input File</h1>
        <p>The <span class="Keyword">mp2</span> keyword allows you to request a local Møller-Plesset perturbation theory (LMP2) calculation. By default, LMP2 is off. For more information on the local MP2 method, see <a class="TopicLink MCXref xref xrefTopicLink" href="../jaguar_user_manual/jaguar_options_lmp2.htm#jaguar_options_2333515368_78200">Local MP2 Settings</a> and <a class="TopicLink MCXref xref xrefTopicLink" href="../jaguar_user_manual/jaguar_theory_lmp2.htm#jaguar_theory_2952449424_63004">Pseudospectral Local MP2 Techniques</a>. LMP2 keywords are given in <a class="Table_Number MCXref xref xrefTable_Number selected" href="#jaguar_input_1430212170_789868">Table 1</a>. </p>
        <table class="TableStyle-StandardRules" style="caption-side: top;mc-table-style: url('../Resources/TableStyles/StandardRules.css');" cellspacing="0">
            <caption valign="top" style="padding-bottom: 7pt;">
                <p class="Table_Caption" data-mc-autonum="Table 1. "><span class="autonumber"><span>Table 1. </span></span><a name="jaguar_input_1430212170_789868"></a>Keyword settings for local MP2 calculations</p>
            </caption>
            <thead>
                <tr class="TableStyle-StandardRules-Head-Header1">
                    <td class="TableStyle-StandardRules-HeadE-Column1-Header1">
                        <p class="Cell_Heading">Keyword</p>
                    </td>
                    <td class="TableStyle-StandardRules-HeadE-Column1-Header1">
                        <p class="Cell_Heading">Value</p>
                    </td>
                    <td class="TableStyle-StandardRules-HeadD-Column1-Header1">
                        <p class="Cell_Heading">Description</p>
                    </td>
                </tr>
            </thead>
            <tbody>
                <tr class="TableStyle-StandardRules-Body-Body1">
                    <td class="TableStyle-StandardRules-BodyH-Column1-Body1">
                        <p class="Cell_Body"><a name="jaguar_input_1430212170_mp2"></a><span class="Keyword">mp2</span>
                        </p>
                    </td>
                    <td class="TableStyle-StandardRules-BodyH-Column1-Body1">
                        <p class="Cell_Body"><span class="BoldItalic">0</span><b> </b>
                        </p>
                    </td>
                    <td class="TableStyle-StandardRules-BodyG-Column1-Body1">
                        <p class="Cell_Body">Do not run LMP2 calculation</p>
                    </td>
                </tr>
                <tr class="TableStyle-StandardRules-Body-Body1">
                    <td class="TableStyle-StandardRules-BodyE-Column1-Body1">
                        <p class="Cell_Body">&#160;</p>
                    </td>
                    <td class="TableStyle-StandardRules-BodyE-Column1-Body1">
                        <p class="Cell_Body">1</p>
                    </td>
                    <td class="TableStyle-StandardRules-BodyD-Column1-Body1">
                        <p class="Cell_Body">Correlate core and valence electrons (not recommended: see text)</p>
                    </td>
                </tr>
                <tr class="TableStyle-StandardRules-Body-Body2">
                    <td class="TableStyle-StandardRules-BodyH-Column1-Body2">
                        <p class="Cell_Body">&#160;</p>
                    </td>
                    <td class="TableStyle-StandardRules-BodyH-Column1-Body2">
                        <p class="Cell_Body">3</p>
                    </td>
                    <td class="TableStyle-StandardRules-BodyG-Column1-Body2">
                        <p class="Cell_Body">Run LMP2 calculation (for valence electrons only)</p>
                    </td>
                </tr>
                <tr class="TableStyle-StandardRules-Body-Body2">
                    <td class="TableStyle-StandardRules-BodyE-Column1-Body2">
                        <p class="Cell_Body"><a name="jaguar_input_1430212170_idelocv"></a><span class="Keyword">idelocv</span>
                        </p>
                    </td>
                    <td class="TableStyle-StandardRules-BodyE-Column1-Body2">
                        <p class="Cell_Body"><span class="BoldItalic">0</span><b> </b>
                        </p>
                    </td>
                    <td class="TableStyle-StandardRules-BodyD-Column1-Body2">
                        <p class="Cell_Body">Do not delocalize any pairs listed in <span class="Keyword">lmp2</span> section (default for all calculations except those with <span class="Keyword"><a href="jaguar_input_gen_geopt.htm#jaguar_input_1430212170_iqst">iqst</a></span>&gt;0 and/or <span class="Keyword"><a href="#jaguar_input_1430212170_ireson" class="selected">ireson</a></span>&gt;0)</p>
                    </td>
                </tr>
                <tr class="TableStyle-StandardRules-Body-Body1">
                    <td class="TableStyle-StandardRules-BodyH-Column1-Body1">
                        <p class="Cell_Body">&#160;</p>
                    </td>
                    <td class="TableStyle-StandardRules-BodyH-Column1-Body1">
                        <p class="Cell_Body">1</p>
                    </td>
                    <td class="TableStyle-StandardRules-BodyG-Column1-Body1">
                        <p class="Cell_Body">Treat all LMP2 pairs, but delocalize any pairs in <span class="Keyword">lmp2</span> section as indicated there, or (default for QST-guided transition-state searches) delocalize any pairs on atoms with breaking or forming bonds</p>
                    </td>
                </tr>
                <tr class="TableStyle-StandardRules-Body-Body1">
                    <td class="TableStyle-StandardRules-BodyE-Column1-Body1">
                        <p class="Cell_Body">&#160;</p>
                    </td>
                    <td class="TableStyle-StandardRules-BodyE-Column1-Body1">
                        <p class="Cell_Body">2</p>
                    </td>
                    <td class="TableStyle-StandardRules-BodyD-Column1-Body1">
                        <p class="Cell_Body">Perform a local local MP2 calculation, treating only pairs listed in the <span class="Keyword">lmp2</span> section at the LMP2 level, and also delocalize any pairs in <span class="Keyword">lmp2</span> section as indicated there</p>
                    </td>
                </tr>
                <tr class="TableStyle-StandardRules-Body-Body2">
                    <td class="TableStyle-StandardRules-BodyH-Column1-Body2">
                        <p class="Cell_Body"><span class="Keyword"><a name="jaguar_input_1430212170_ireson">ireson</a></span>
                        </p>
                    </td>
                    <td class="TableStyle-StandardRules-BodyH-Column1-Body2">
                        <p class="Cell_Body"><span class="BoldItalic">0</span><b> </b>
                        </p>
                    </td>
                    <td class="TableStyle-StandardRules-BodyG-Column1-Body2">
                        <p class="Cell_Body">Do not delocalize LMP2 pairs over other atoms</p>
                    </td>
                </tr>
                <tr class="TableStyle-StandardRules-Body-Body2">
                    <td class="TableStyle-StandardRules-BodyE-Column1-Body2">
                        <p class="Cell_Body">&#160;</p>
                    </td>
                    <td class="TableStyle-StandardRules-BodyE-Column1-Body2">
                        <p class="Cell_Body">1</p>
                    </td>
                    <td class="TableStyle-StandardRules-BodyD-Column1-Body2">
                        <p class="Cell_Body">Delocalize each bond pair in an aromatic ring over the neighboring atoms in the ring</p>
                    </td>
                </tr>
                <tr class="TableStyle-StandardRules-Body-Body1">
                    <td class="TableStyle-StandardRules-BodyH-Column1-Body1">
                        <p class="Cell_Body">&#160;</p>
                    </td>
                    <td class="TableStyle-StandardRules-BodyH-Column1-Body1">
                        <p class="Cell_Body">2</p>
                    </td>
                    <td class="TableStyle-StandardRules-BodyG-Column1-Body1">
                        <p class="Cell_Body">Delocalize bond pairs in an aromatic ring over all atoms in the ring</p>
                    </td>
                </tr>
                <tr class="TableStyle-StandardRules-Body-Body1">
                    <td class="TableStyle-StandardRules-BodyE-Column1-Body1">
                        <p class="Cell_Body"><span class="Keyword"><a name="jaguar_input_1430212170_iheter">iheter</a></span>
                        </p>
                    </td>
                    <td class="TableStyle-StandardRules-BodyE-Column1-Body1">
                        <p class="Cell_Body"><span class="BoldItalic">0</span><b> </b>
                        </p>
                    </td>
                    <td class="TableStyle-StandardRules-BodyD-Column1-Body1">
                        <p class="Cell_Body">Treat all atoms with LMP2 if LMP2 is on unless <span class="Keyword">lmp2</span> section exists; if LMP2 is on and <span class="Keyword">lmp2</span> section exists, set atom pairs in <span class="Keyword">lmp2</span> section</p>
                    </td>
                </tr>
                <tr class="TableStyle-StandardRules-Body-Body2">
                    <td class="TableStyle-StandardRules-BodyH-Column1-Body2">
                        <p class="Cell_Body">&#160;</p>
                    </td>
                    <td class="TableStyle-StandardRules-BodyH-Column1-Body2">
                        <p class="Cell_Body">1</p>
                    </td>
                    <td class="TableStyle-StandardRules-BodyG-Column1-Body2">
                        <p class="Cell_Body">Treat only heteroatom pairs (atoms in bonds with atoms of other elements, except C atoms bonded only to C and/or H) and any pairs set in <span class="Keyword">lmp2</span> section at LMP2 level, other atoms at HF level</p>
                    </td>
                </tr>
                <tr class="TableStyle-StandardRules-Body-Body2">
                    <td class="TableStyle-StandardRules-BodyE-Column1-Body2">
                        <p class="Cell_Body"><a name="jaguar_input_1430212170_loclmp2c"></a><span class="Keyword">loclmp2c</span>
                        </p>
                    </td>
                    <td class="TableStyle-StandardRules-BodyE-Column1-Body2">
                        <p class="Cell_Body"><span class="BoldItalic">0</span>
                        </p>
                    </td>
                    <td class="TableStyle-StandardRules-BodyD-Column1-Body2">
                        <p class="Cell_Body">Do not localize core orbitals for LMP2 calculation</p>
                    </td>
                </tr>
                <tr class="TableStyle-StandardRules-Body-Body1">
                    <td class="TableStyle-StandardRules-BodyH-Column1-Body1">
                        <p class="Cell_Body">&#160;</p>
                    </td>
                    <td class="TableStyle-StandardRules-BodyH-Column1-Body1">
                        <p class="Cell_Body">1</p>
                    </td>
                    <td class="TableStyle-StandardRules-BodyG-Column1-Body1">
                        <p class="Cell_Body">Perform Boys localization on core orbitals for LMP2 calculation</p>
                    </td>
                </tr>
                <tr class="TableStyle-StandardRules-Body-Body1">
                    <td class="TableStyle-StandardRules-BodyE-Column1-Body1">
                        <p class="Cell_Body">&#160;</p>
                    </td>
                    <td class="TableStyle-StandardRules-BodyE-Column1-Body1">
                        <p class="Cell_Body">2</p>
                    </td>
                    <td class="TableStyle-StandardRules-BodyD-Column1-Body1">
                        <p class="Cell_Body">Perform Pipek-Mezey localization on core orbitals for LMP2 calculation, maximizing Mulliken atomic populations</p>
                    </td>
                </tr>
                <tr class="TableStyle-StandardRules-Body-Body2">
                    <td class="TableStyle-StandardRules-BodyH-Column1-Body2">
                        <p class="Cell_Body">&#160;</p>
                    </td>
                    <td class="TableStyle-StandardRules-BodyH-Column1-Body2">
                        <p class="Cell_Body">3</p>
                    </td>
                    <td class="TableStyle-StandardRules-BodyG-Column1-Body2">
                        <p class="Cell_Body">Perform Pipek-Mezey localization on core orbitals for LMP2 calculation, maximizing Mulliken basis function populations</p>
                    </td>
                </tr>
                <tr class="TableStyle-StandardRules-Body-Body2">
                    <td class="TableStyle-StandardRules-BodyE-Column1-Body2">
                        <p class="Cell_Body"><a name="jaguar_input_1430212170_loclmp2v"></a><span class="Keyword">loclmp2v</span>
                        </p>
                    </td>
                    <td class="TableStyle-StandardRules-BodyE-Column1-Body2">
                        <p class="Cell_Body">1</p>
                    </td>
                    <td class="TableStyle-StandardRules-BodyD-Column1-Body2">
                        <p class="Cell_Body">Perform Boys localization on valence orbitals for LMP2 calculation</p>
                    </td>
                </tr>
                <tr class="TableStyle-StandardRules-Body-Body1">
                    <td class="TableStyle-StandardRules-BodyH-Column1-Body1">
                        <p class="Cell_Body">&#160;</p>
                    </td>
                    <td class="TableStyle-StandardRules-BodyH-Column1-Body1">
                        <p class="Cell_Body"><span class="BoldItalic">2</span>
                        </p>
                    </td>
                    <td class="TableStyle-StandardRules-BodyG-Column1-Body1">
                        <p class="Cell_Body">Perform Pipek-Mezey localization on valence orbitals for LMP2 calculation, maximizing Mulliken atomic populations</p>
                    </td>
                </tr>
                <tr class="TableStyle-StandardRules-Body-Body1">
                    <td class="TableStyle-StandardRules-BodyB-Column1-Body1">
                        <p class="Cell_Body">&#160;</p>
                    </td>
                    <td class="TableStyle-StandardRules-BodyB-Column1-Body1">
                        <p class="Cell_Body">3 </p>
                    </td>
                    <td class="TableStyle-StandardRules-BodyA-Column1-Body1">
                        <p class="Cell_Body">Perform Pipek-Mezey localization on valence orbitals for LMP2 calculation, maximizing Mulliken basis function populations. This scheme produces results that are significantly different from the other two schemes.</p>
                    </td>
                </tr>
            </tbody>
        </table>
        <p>LMP2 calculations require a basis set that is set up for the pseudospectral method—see <a class="TopicLink MCXref xref xrefTopicLink" href="../jaguar_user_manual/jaguar_options_basis_set.htm#jaguar_options_2333515368_84552">Basis Sets</a> for basis set information. Because the available basis sets are not designed for core correlation, you should not use the <span class="Keyword">mp2</span>=1 setting. Calculations performed with this setting are likely to be misleading. This is because core correlation requires basis functions that have a similar mean radius to the core functions that are correlated, including higher angular momentum functions. For example, to correlate the 1s in a double-zeta basis, an s function and a p function with a similar mean radius to the 1s orbital are needed. The pseudospectral basis sets do not have such functions. </p>
        <p>Local MP2 calculations use the LMP2 method for all atoms unless the <span class="Keyword">lmp2</span> section (described in <a class="TopicLink MCXref xref xrefTopicLink" href="jaguar_input_lmp2.htm#jaguar_input_1430212170_806672">The lmp2 Section Of The Jaguar Input File</a>) is used to set local LMP2 pairs or unless the keyword <span class="Keyword"><a href="#jaguar_input_1430212170_iheter" class="selected">iheter</a></span> is set to 1. The <span class="Keyword">iheter</span> and <span class="Keyword">mp2</span> keyword settings are described in <a class="Table_Number MCXref xref xrefTable_Number selected" href="#jaguar_input_1430212170_789868">Table 1</a>.</p>
        <p>For LMP2 calculations, Jaguar needs to obtain localized orbitals. By default, Jaguar uses the Pipek-Mezey method to perform the localization. If Pipek-Mezey localization does not converge for a particular case, you might want to try Boys localization by changing the settings for the keywords <span class="Keyword">loclmp2c</span> and <span class="Keyword">loclmp2v</span>, as indicated in <a class="Table_Number MCXref xref xrefTable_Number selected" href="#jaguar_input_1430212170_789868">Table 1</a>. If you are performing a set of calculations to compare against each other, you should use the same localization method for all of the calculations. In particular, the <span class="Keyword">loclmp2v</span>=3 scheme is known to affect the LMP2 energy significantly compared to the other two localization schemes.</p>
        <table class="NavLink" data-mc-conditions="Default.ScreenOnly">
            <tr class="NavLink">
                <td class="NavLeft"><span class="NavText">◀ <a class="NavLink MCXref xref xrefNavLink" href="jaguar_input_gen_symmetry.htm">Symmetry-Related Keywords In The Jaguar Input File</a></span>
                </td>
                <td class="NavCenter"><span class="NavText"><a class="NavLink MCXref xref xrefNavLink" href="jaguar_command_referenceTOC.htm">Jaguar Command Reference Manual</a></span>
                </td>
                <td class="NavRight"><span class="NavText"><a class="NavLink MCXref xref xrefNavLink" href="jaguar_input_gen_relham.htm">Relativistic Hamiltonian Keyword In The Jaguar Input File</a> ▶</span>
                </td>
            </tr>
        </table>
    </body>
</html>