<!DOCTYPE html>
<html xmlns:MadCap="http://www.madcapsoftware.com/Schemas/MadCap.xsd" lang="en-US" xml:lang="en-US" data-mc-search-type="Stem" data-mc-help-system-file-name="Documentation.xml" data-mc-path-to-help-system="../" data-mc-target-type="WebHelp2" data-mc-runtime-file-type="Topic" data-mc-preload-images="false" data-mc-in-preview-mode="false" data-mc-toc-path="Command References|MacroModel Command Reference|MacroModel Capabilities|MacroModel Energetic Calculation Features">
    <head>
        <meta name="viewport" content="width=device-width, initial-scale=1.0" />
        <meta charset="utf-8" />
        <meta http-equiv="X-UA-Compatible" content="IE=edge" />
        <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
        <link href="../Skins/Default/Stylesheets/Slideshow.css" rel="stylesheet" type="text/css" data-mc-generated="True" />
        <link href="../Skins/Default/Stylesheets/TextEffects.css" rel="stylesheet" type="text/css" data-mc-generated="True" />
        <link href="../Skins/Default/Stylesheets/Topic.css" rel="stylesheet" type="text/css" data-mc-generated="True" />
        <link href="../Skins/Default/Stylesheets/Components/Styles.css" rel="stylesheet" type="text/css" data-mc-generated="True" /><title>Force Fields and Energy Equations in MacroModel</title>
        <link href="../Resources/Stylesheets/docs.css" rel="stylesheet" />
        <script src="../Resources/Scripts/custom.modernizr.js" type="text/javascript">
        </script>
        <script src="../Resources/Scripts/jquery.min.js" type="text/javascript">
        </script>
        <script src="../Resources/Scripts/require.min.js" type="text/javascript">
        </script>
        <script src="../Resources/Scripts/require.config.js" type="text/javascript">
        </script>
        <script src="../Resources/Scripts/foundation.min.js" type="text/javascript">
        </script>
        <script src="../Resources/Scripts/plugins.min.js" type="text/javascript">
        </script>
        <script src="../Resources/Scripts/MadCapAll.js" type="text/javascript">
        </script>
    </head>
    <body><a name="aanchor393"></a>
        <MadCap:concept term="Command Reference" /><a name="aanchor394"></a>
        <MadCap:concept term="MacroModel" /><a name="macromodel_capabilities_1857967633_738219"></a>
        <table class="NavLink" data-mc-conditions="Default.ScreenOnly">
            <tr class="NavLink">
                <td class="NavLeft"><span class="NavText">◀ <a class="NavLink MCXref xref xrefNavLink" href="macromodel_capabilities_energetic.htm" xrefformat="{paratext}">MacroModel Energetic Calculation Features</a></span>
                </td>
                <td class="NavCenter"><span class="NavText"><a class="NavLink MCXref xref xrefNavLink" href="macromodel_command_referenceTOC.htm" xrefformat="{paratext}">MacroModel Command Reference Manual</a></span>
                </td>
                <td class="NavRight"><span class="NavText"><a class="NavLink MCXref xref xrefNavLink" href="macromodel_capabilities_energetic_minimization.htm" xrefformat="{paratext}">MacroModel Energy Minimization Methods</a> ▶</span>
                </td>
            </tr>
        </table>
        <h1 class="Title">Force Fields and Energy Equations in MacroModel</h1>
        <ul>
            <li value="1">
                <p class="ListPara">MM2*, MM3*, AMBER*, and OPLS* force fields (enhanced and/or modified versions of the corresponding native force-fields; see <a class="TopicLink MCXref xref xrefTopicLink" href="mmod_force_field_files.htm#mmod_force_field_files_3963860785_738153" xrefformat="{paratext}">Force-Field File Format</a> for implementation differences).</p>
            </li>
            <li value="2">
                <p class="ListPara">Native OPLS_2005 (also referred to collectively under the name OPLS-AA).</p>
            </li>
            <li value="3">
                <p class="ListPara">Native OPLS3 (also referred to collectively under the name OPLS-AA). </p>
            </li>
            <li value="4">
                <p class="ListPara">Native MMFF94 and MMFF94s.</p>
            </li>
            <li value="5">
                <p class="ListPara">Native Amber 4.1 (AMBER94).</p>
            </li>
            <li value="6">
                <p class="ListPara">Automatic checking and adjustment of formal charges and bond orders in calculations involving MMFF, MMFFs, and OPLS-AA force fields. This feature is disabled by <span class="CodeLink"><a href="opcodes_misc_debug.htm#opcodes_509685220_debg">DEBG</a></span><code>  <![CDATA[ ]]></code>191.</p>
            </li>
            <li value="7">
                <p class="ListPara">BMFF (BatchMin Force-Field inter-process-communication library) allows an external process to generate force-field parameters and pass them to MacroModel. See <a class="TopicLink MCXref xref xrefTopicLink" href="bmff_protocol.htm#bmff_protocol_3957064207_738153" xrefformat="{paratext}">The BMFF Protocol</a> for details. This mechanism was used to implement MMFF, using a co-process supplied by Dr. Thomas A. Halgren; however, the mechanism is general and should greatly simplify the porting of additional force fields to MacroModel.</p>
            </li>
            <li value="8">
                <p class="ListPara">Analytical continuum treatment of solvation (water, chloroform, and octanol setup files supplied). For precise parameter matching, it is possible to specify atomic connectivity out to the beta-atom level in <code>.slv</code> files.</p>
            </li>
            <li value="9">
                <p class="ListPara">Ability to specify multiple parameter blocks in the solvation files for use with different force fields. This is done by placing a force-field number on an <code>SMODEL</code> line of the file. If an <code>SMODEL</code> block is found containing both the force field and the solvation model specified in the <code>.com</code> file, that block is used. If no block is found specifying the current force field, then, if a block is found for the current model specifying 0 for the force field, this block is used as the default. If neither is found, the first <code>SMODEL</code> block for the solvation model specified in the <code>.com</code> file is used. The program can also be instructed to use the general set of parameters for a particular solvent using arg2 of <span class="CodeLink"><a href="opcodes_ffld.htm#opcodes_509685220_solv">SOLV</a></span>. Parametrizations for specific force fields are provided for OPLS-AA and MMFF for water and octanol. </p>
            </li>
            <li value="10">
                <p class="ListPara">GB/SA with fixed/frozen atoms. We have continued to improve the use of both the GB and the SA parts of GB/SA when fixed and/or frozen atoms are in use. The intent is to provide speed optimization with minimal loss of accuracy. For energetic calculations, frozen atoms need not “see” each other; thus, for example, frozen nonbonded pairs are deleted from the nonbonded pairlist. However, the motion of the moving atoms causes the GB radii of the frozen atoms to change, and the GB energy contributions of frozen atom pairs will then change accordingly. To accommodate this without losing all the advantage of frozen-atom optimization, starting with MacroModel 7.0 we define a cutoff, <code>CUTFMM</code>, which defines a radius around the moving atoms within which any frozen atoms are treated as moving for the purpose of GB only. This is specified in arg8 of the <span class="CodeLink"><a href="opcodes_ffld.htm#opcodes_509685220_exnb">EXNB</a></span> command. Similar concerns arise for SA, where a <code>CUTSFM</code> is defined in arg5 of <span class="CodeLink"><a href="opcodes_ffld.htm#opcodes_509685220_exn2">EXN2</a></span>, an extension of the <span class="CodeLink"><a href="opcodes_ffld.htm#opcodes_509685220_exnb">EXNB</a></span> command.</p>
            </li>
            <li value="11">
                <p class="ListPara">Correction for Born radii when not all nonbonded pairs are included in a calculation. For calculations on large systems such as proteins, typically not all nonbonded interactions are included in energetic and derivative calculations, to make simulations tractable. This leads to systematic errors in the values of Born radii used to calculate the GB energy in the GB/SA solvation model. A correction is done to account for this error and improve energetic and derivative calculations. See <a class="TopicLink MCXref xref xrefTopicLink" href="../macromodel_user_manual/basic_mol_mechanics_solvation.htm#basic_mol_mechanics_2947424456_99917" xrefformat="{paratext}">MacroModel Solvation Treatment</a> for further details.</p>
            </li>
            <li value="12">
                <p class="ListPara">Vacuum, constant dielectric and distance-dependent-dielectric solvation treatments.</p>
            </li>
            <li value="13">
                <p class="ListPara">Novel method for accurate electrostatic and GB energies despite truncation of nonbonded interactions. Implementation of the “Bond Dipole Cutoff” (<span class="CodeLink"><a href="opcodes_ffld.htm#opcodes_509685220_bdco">BDCO</a></span>) algorithm allows for exclusion of distant pairs from the nonbonded pairlist without compromising the absolute accuracy of the electrostatic and GB energies of a system. Much better agreement is achieved with the values of these energetic terms as calculated without cutoffs when <span class="CodeLink"><a href="opcodes_ffld.htm#opcodes_509685220_bdco"><a href="opcodes_ffld.htm#opcodes_509685220_bdco">BDCO</a></a></span> is used as opposed to traditional residue-based cutoffs. Additionally, <span class="CodeLink"><a href="opcodes_ffld.htm#opcodes_509685220_bdco"><a href="opcodes_ffld.htm#opcodes_509685220_bdco">BDCO</a></a></span> offers much better energetic accuracy than residue-based cutoffs using default cutoff values despite the fact that the <span class="CodeLink"><a href="opcodes_ffld.htm#opcodes_509685220_bdco">BDCO</a></span> calculation uses significantly <i>fewer</i> nonbonded pairs. Performance is maintained while accuracy is significantly improved. See the <span class="CodeLink"><a href="opcodes_ffld.htm#opcodes_509685220_bdco">BDCO</a></span> opcode description in this manual and <a class="TopicLink MCXref xref xrefTopicLink" href="../macromodel_user_manual/basic_mol_mechanics_truncation.htm#basic_mol_mechanics_2947424456_30038" xrefformat="{paratext}">Truncation of Electrostatic Interactions in MacroModel</a> for details.</p>
            </li>
            <li value="14">
                <p class="ListPara">Dihedral driving for production of Ramachandran-style energy surfaces. The non-driven degrees of freedom for each point on the surface may be taken either from the most recently minimized structure or else from the starting structure.</p>
            </li>
            <li value="15">
                <p class="ListPara">In force-field substructures, parameters may be given a geometric dependence on values of torsions, angles or ring size. This geometric dependence is retested at key points in a simulation, such as the start of a new step of conformational search.</p>
            </li>
            <li value="16">
                <p class="ListPara">Ability to turn off interactions between sets of atoms. The sets are defined with the <span class="CodeLink"><a href="opcodes_energy.htm#opcodes_509685220_aset">ASET</a></span> command, and interactions are turned off with the <span class="CodeLink"><a href="opcodes_energy.htm#opcodes_509685220_asnt">ASNT</a></span> command.</p>
            </li>
            <li value="17">
                <p class="ListPara"><span class="CodeLink"><a href="opcodes_energy.htm#opcodes_509685220_vdwb">VDWB</a></span> command replaces bend interactions with van der Waals interactions, for modeling transition-metal complexes using the “points-on-a-sphere” model.</p>
            </li>
            <li value="18">
                <p class="ListPara">In addition to harmonic constraints on atomic positions (<span class="CodeLink"><a href="opcodes_constrained_mini.htm#opcodes_509685220_fxat">FXAT</a></span>), distances (<span class="CodeLink"><a href="opcodes_constrained_mini.htm#opcodes_509685220_fxdi">FXDI</a></span>), angles (<span class="CodeLink"><a href="opcodes_constrained_mini.htm#opcodes_509685220_fxba">FXBA</a></span>), and dihedral angles (<span class="CodeLink"><a href="opcodes_constrained_mini.htm#opcodes_509685220_fxta">FXTA</a></span>), we provide support for fully “frozen” atoms: atoms that do not move at all, but whose effect is felt by the atoms that can move. This is encoded by specifying a negative force-constant in a <span class="CodeLink"><a href="opcodes_constrained_mini.htm#opcodes_509685220_fxat">FXAT</a></span> command.</p>
            </li>
            <li value="19">
                <p class="ListPara">The OPLS* force field includes short-range purely repulsive potentials on the polar hydrogen atoms. These potentials do not significantly affect the energies of normal structures but prevent catastrophic close approaches by negatively changed atoms in highly strained conformations such as those generated in aggressive conformational search methods such as <span class="CodeLink"><a href="opcodes_csearch.htm#opcodes_509685220_mcmm">MCMM</a></span>, <span class="CodeLink"><a href="opcodes_csearch.htm#opcodes_509685220_lmcs">LMCS</a></span>, and <span class="CodeLink"><a href="opcodes_csearch.htm#opcodes_509685220_lmc2">LMC2</a></span>. This modification is not needed for the OPLS_2005 and OPLS3 force field, which uses Lennard-Jones 12-6 potentials for interactions involving such atoms.</p>
            </li>
            <li value="20">
                <p class="ListPara">Torsional potentials for highly strained conformations in which three of the atoms at one end of the torsion become collinear can cause problems during minimizations. The torsional potential is damped as either triplet of atoms at the end of the torsion becomes linear. The strength of the damping can be controlled via arg8 of <span class="CodeLink"><a href="opcodes_ffld.htm#opcodes_509685220_ffld">FFLD</a></span>.</p>
            </li>
        </ul>
        <table class="NavLink" data-mc-conditions="Default.ScreenOnly">
            <tr class="NavLink">
                <td class="NavLeft"><span class="NavText">◀ <a class="NavLink MCXref xref xrefNavLink" href="macromodel_capabilities_energetic.htm" xrefformat="{paratext}">MacroModel Energetic Calculation Features</a></span>
                </td>
                <td class="NavCenter"><span class="NavText"><a class="NavLink MCXref xref xrefNavLink" href="macromodel_command_referenceTOC.htm" xrefformat="{paratext}">MacroModel Command Reference Manual</a></span>
                </td>
                <td class="NavRight"><span class="NavText"><a class="NavLink MCXref xref xrefNavLink" href="macromodel_capabilities_energetic_minimization.htm" xrefformat="{paratext}">MacroModel Energy Minimization Methods</a> ▶</span>
                </td>
            </tr>
        </table>
    </body>
</html>