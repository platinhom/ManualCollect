<!DOCTYPE html>
<html xmlns:MadCap="http://www.madcapsoftware.com/Schemas/MadCap.xsd" lang="en-US" xml:lang="en-US" data-mc-search-type="Stem" data-mc-help-system-file-name="Documentation.xml" data-mc-path-to-help-system="../" data-mc-target-type="WebHelp2" data-mc-runtime-file-type="Topic" data-mc-preload-images="false" data-mc-in-preview-mode="false" data-mc-toc-path="Command References|MacroModel Command Reference|Force-Field File Format|Substructure Section of the Force-Field File">
    <head>
        <meta name="viewport" content="width=device-width, initial-scale=1.0" />
        <meta charset="utf-8" />
        <meta http-equiv="X-UA-Compatible" content="IE=edge" />
        <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
        <link href="../Skins/Default/Stylesheets/Slideshow.css" rel="stylesheet" type="text/css" data-mc-generated="True" />
        <link href="../Skins/Default/Stylesheets/TextEffects.css" rel="stylesheet" type="text/css" data-mc-generated="True" />
        <link href="../Skins/Default/Stylesheets/Topic.css" rel="stylesheet" type="text/css" data-mc-generated="True" />
        <link href="../Skins/Default/Stylesheets/Components/Styles.css" rel="stylesheet" type="text/css" data-mc-generated="True" /><title>Substructure Linear Notation in the Force-Field File</title>
        <link href="../Resources/Stylesheets/docs.css" rel="stylesheet" />
        <script src="../Resources/Scripts/custom.modernizr.js" type="text/javascript">
        </script>
        <script src="../Resources/Scripts/jquery.min.js" type="text/javascript">
        </script>
        <script src="../Resources/Scripts/require.min.js" type="text/javascript">
        </script>
        <script src="../Resources/Scripts/require.config.js" type="text/javascript">
        </script>
        <script src="../Resources/Scripts/foundation.min.js" type="text/javascript">
        </script>
        <script src="../Resources/Scripts/plugins.min.js" type="text/javascript">
        </script>
        <script src="../Resources/Scripts/MadCapAll.js" type="text/javascript">
        </script>
    </head>
    <body><a name="aanchor1873"></a>
        <MadCap:concept term="Command Reference" /><a name="aanchor1874"></a>
        <MadCap:concept term="MacroModel" /><a name="mmod_force_field_files_3963860785_738569"></a>
        <table class="NavLink" data-mc-conditions="Default.ScreenOnly">
            <tr class="NavLink">
                <td class="NavLeft"><span class="NavText">◀ <a class="NavLink MCXref xref xrefNavLink" href="mmod_force_field_files_subs_use.htm" xrefformat="{paratext}">Use of Substructures in the Force-Field File</a></span>
                </td>
                <td class="NavCenter"><span class="NavText"><a class="NavLink MCXref xref xrefNavLink" href="macromodel_command_referenceTOC.htm" xrefformat="{paratext}">MacroModel Command Reference Manual</a></span>
                </td>
                <td class="NavRight"><span class="NavText"><a class="NavLink MCXref xref xrefNavLink" href="mmod_force_field_files_subs_charge.htm" xrefformat="{paratext}">Force-Field Substructure Charge Processing</a> ▶</span>
                </td>
            </tr>
        </table>
        <h1 class="Title">Substructure Linear Notation in the Force-Field File</h1>
        <p>In addition to the normal one- to four-atom descriptors of stretch, bend, and torsional substructures used in molecular mechanics, MacroModel provides for description of more complex substructures. These are the “special substructures” given at the end of a MacroModel force field files. The description of the atomic connectivity is given by a simple linear notation which resembles SMILES/SMARTS notation. Atoms and bonds are described as in normal interactions but up to 50 atoms (130 characters maximum) may comprise a substructure, and complicated connectivity, including wild-card and optional atoms, may be specified. </p>
        <p>Structures are described as a list of connected atoms and bonds; all atoms and bonds in the structure must be explicitly included. Ethyl vinyl ether would be:</p>
        <p class="Indented1"><code>C2=C2–O3–C3–C3</code>
        </p>
        <p>The atom types are normal MacroModel atom types: <code>C2</code> is sp<sup>2</sup> carbon, <code>C3</code> is sp<sup>3</sup> carbon, and <code>O3</code> is non-carbonyl oxygen. </p>
        <p>Simple generalized atom descriptors may also be used; then the formula above would be:</p>
        <p class="Indented1"><code>C=C–O–C–C</code>
        </p>
        <p>You may also use the equivalenced atom types to represent many different types of atoms. Generalized bond descriptors may also be used; for example, an asterisk (<code>*</code>) stands for a bond of any order:</p>
        <p class="Indented1"><code>C*C-O-C-C</code>
        </p>
        <p>This could represent diethyl ether, ethyl vinyl ether or ethoxy acetylene.</p>
        <h3 class="Heading3Nonum">Ring Closure</h3>
        <p>Ring-forming bonds are added as a bond type followed by a number which specifies which atoms are bound together. Cyclopentane is:</p>
        <p class="Indented1"><code>C-C-C-C-C-1</code>
        </p>
        <p>Thus the last (fifth) atom is bound to the first (<code>-1</code>); this signifies a single bond to the first atom in the substructure. Ring closure bonds can go only to atoms earlier in the substructure. Norbornane would be represented:</p>
        <p class="Indented1"><code>C-C-C-C(-C-1)-C-C-1</code>
        </p>
        <p>Note the use of parentheses to identify atoms off the linear backbone as represented. Quinoline could be:</p>
        <p class="Indented1"><code>N=C-C=C-C=C(-1)-C=C-C=C-5</code>
        </p>
        <p>For the quinoline above to match, it would have to have the connectivity and bonding exactly as drawn above. Thus the user would always have to draw the correct resonance structure for the parameters to be found. As an alternative, we generally specify the atom type more exactly to designate the atomic hybridization and use wild card bonds for all the connectivity. Thus any resonance form of quinoline would match the following:</p>
        <p class="Indented1"><code>N2*C2*C2*C2*C2*C2(*1)*C2*C2*C2*C2*5</code>
        </p>
        <h3 class="Heading3Nonum">Chain Branching</h3>
        <p>As a further example of the use of parentheses, methylcyclobutane could have any of the following linear notations:</p>
        <p class="Indented1"><code>C(-C)-C-C-C-1</code>
        </p>
        <p class="Indented1"><code>C-C-C-C(-C)-1</code>
        </p>
        <p class="Indented1"><code>C-C-C-C(-1)-C</code>
        </p>
        <p class="Indented1"><code>C-C(-C)-C-C-1</code>
        </p>
        <p>Parentheses may be nested. Isopropylbenzene could be:</p>
        <p class="Indented1"><code>C=C(-C(-C)-C)-C=C-C=C-1</code>
        </p>
        <p>Threonine could be:</p>
        <p class="Indented1"><code>N-C(-C(-C)-O-H)-C=O</code>
        </p>
        <h3 class="Heading3Nonum">Optional Atoms</h3>
        <p>Optional atoms may also be specified within the linear notation so that the substructure will match whether or not the optional atom is found. Optional atoms with associated bonds are put in square brackets ([ ]). In the substructure below, serine would be identified whether or not the optional hydrogens were present in the structure:</p>
        <p class="Indented1"><code>N[(-H)]-C(-C-O[-H])-C=O</code>
        </p>
        <p>Parameters are assigned for optional atoms if the atoms are explicitly present in the molecule. If the optional atoms are absent, the constants involving those atoms will not be used in reassigning the interaction constants previously assigned by the first part of the force field (1-4 atom interactions). Another way to accomplish the same end is to omit the optional atoms but to include the parameters involving the hydrogens as off-substructure interactions (see below).</p>
        <p>The atoms in the substructure are referred to by number when parameters are assigned. An atom is simply referred to by its position in the linear notation; for example, the serine nitrogen would be number one and the carbonyl oxygen would be number 8.</p>
        <table class="NavLink" data-mc-conditions="Default.ScreenOnly">
            <tr class="NavLink">
                <td class="NavLeft"><span class="NavText">◀ <a class="NavLink MCXref xref xrefNavLink" href="mmod_force_field_files_subs_use.htm" xrefformat="{paratext}">Use of Substructures in the Force-Field File</a></span>
                </td>
                <td class="NavCenter"><span class="NavText"><a class="NavLink MCXref xref xrefNavLink" href="macromodel_command_referenceTOC.htm" xrefformat="{paratext}">MacroModel Command Reference Manual</a></span>
                </td>
                <td class="NavRight"><span class="NavText"><a class="NavLink MCXref xref xrefNavLink" href="mmod_force_field_files_subs_charge.htm" xrefformat="{paratext}">Force-Field Substructure Charge Processing</a> ▶</span>
                </td>
            </tr>
        </table>
    </body>
</html>