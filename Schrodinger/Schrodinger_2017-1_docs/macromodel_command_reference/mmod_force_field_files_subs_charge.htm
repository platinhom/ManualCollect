<!DOCTYPE html>
<html xmlns:MadCap="http://www.madcapsoftware.com/Schemas/MadCap.xsd" lang="en-US" xml:lang="en-US" data-mc-search-type="Stem" data-mc-help-system-file-name="Documentation.xml" data-mc-path-to-help-system="../" data-mc-target-type="WebHelp2" data-mc-runtime-file-type="Topic" data-mc-preload-images="false" data-mc-in-preview-mode="false" data-mc-toc-path="Command References|MacroModel Command Reference|Force-Field File Format|Substructure Section of the Force-Field File">
    <head>
        <meta name="viewport" content="width=device-width, initial-scale=1.0" />
        <meta charset="utf-8" />
        <meta http-equiv="X-UA-Compatible" content="IE=edge" />
        <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
        <link href="../Skins/Default/Stylesheets/Slideshow.css" rel="stylesheet" type="text/css" data-mc-generated="True" />
        <link href="../Skins/Default/Stylesheets/TextEffects.css" rel="stylesheet" type="text/css" data-mc-generated="True" />
        <link href="../Skins/Default/Stylesheets/Topic.css" rel="stylesheet" type="text/css" data-mc-generated="True" />
        <link href="../Skins/Default/Stylesheets/Components/Styles.css" rel="stylesheet" type="text/css" data-mc-generated="True" /><title>Force-Field Substructure Charge Processing</title>
        <link href="../Resources/Stylesheets/docs.css" rel="stylesheet" />
        <script src="../Resources/Scripts/custom.modernizr.js" type="text/javascript">
        </script>
        <script src="../Resources/Scripts/jquery.min.js" type="text/javascript">
        </script>
        <script src="../Resources/Scripts/require.min.js" type="text/javascript">
        </script>
        <script src="../Resources/Scripts/require.config.js" type="text/javascript">
        </script>
        <script src="../Resources/Scripts/foundation.min.js" type="text/javascript">
        </script>
        <script src="../Resources/Scripts/plugins.min.js" type="text/javascript">
        </script>
        <script src="../Resources/Scripts/MadCapAll.js" type="text/javascript">
        </script>
    </head>
    <body><a name="aanchor6803"></a>
        <MadCap:concept term="Command Reference" /><a name="aanchor6804"></a>
        <MadCap:concept term="MacroModel" /><a name="mmod_force_field_files_3963860785_738602"></a>
        <table class="NavLink" data-mc-conditions="Default.ScreenOnly">
            <tr class="NavLink">
                <td class="NavLeft"><span class="NavText">◀ <a class="NavLink MCXref xref xrefNavLink" href="mmod_force_field_files_subs_notation.htm" xrefformat="{paratext}">Substructure Linear Notation in the Force-Field File</a></span>
                </td>
                <td class="NavCenter"><span class="NavText"><a class="NavLink MCXref xref xrefNavLink" href="macromodel_command_referenceTOC.htm" xrefformat="{paratext}">MacroModel Command Reference Manual</a></span>
                </td>
                <td class="NavRight"><span class="NavText"><a class="NavLink MCXref xref xrefNavLink" href="mmod_force_field_files_subs_examples.htm" xrefformat="{paratext}">Force-Field File Substructure Examples</a> ▶</span>
                </td>
            </tr>
        </table>
        <h1 class="Title">Force-Field Substructure Charge Processing</h1>
        <p>You can continue to specify explicit partial charges in force field substructures by specifying <code>8</code> in the first two columns of a line containing such partial charges as in previous versions of MacroModel. However, internal processing of these charges was changed in version 8.0. Whereas MacroModel used to directly “paste” such partial charges onto the system being simulated, it now proceeds as follows: </p>
        <table class="AutoNumber_p_Numbered1" style="width: 100%; margin-left: 0;" cellspacing="0" cellpadding="0">
            <col style="width: 0px;" />
            <col style="width: 32px;" />
            <col style="width: auto;" />
            <tr>
                <td valign="top" />
                <td class="AutoNumber_p_Numbered1" valign="top"><span>1.</span>
                </td>
                <td class="AutoNumber_p_Numbered1" valign="top" data-mc-autonum="1.">Formal charges from <code>atom.typ</code> are assigned to the atoms in the force field substructure (<span class="OpcodeLink"><a href="opcodes_misc_debug.htm#opcodes_509685220_debg">DEBG</a></span><code> 11</code> causes formal charges to be assigned from the <code>.fld</code> file).</td>
            </tr>
        </table>
        <table class="AutoNumber_p_Numbered1_" style="width: 100%; margin-left: 0;" cellspacing="0" cellpadding="0">
            <col style="width: 0px;" />
            <col style="width: 32px;" />
            <col style="width: auto;" />
            <tr>
                <td valign="top" />
                <td class="AutoNumber_p_Numbered1" valign="top"><span>2.</span>
                </td>
                <td class="AutoNumber_p_Numbered1" valign="top" data-mc-autonum="2.">Such formal charges are delocalized over other atoms in that force field substructure if appropriate.</td>
            </tr>
        </table>
        <table class="AutoNumber_p_Numbered1_" style="width: 100%; margin-left: 0;" cellspacing="0" cellpadding="0">
            <col style="width: 0px;" />
            <col style="width: 32px;" />
            <col style="width: auto;" />
            <tr>
                <td valign="top" />
                <td class="AutoNumber_p_Numbered1" valign="top"><span>3.</span>
                </td>
                <td class="AutoNumber_p_Numbered1" valign="top" data-mc-autonum="3.">The delocalized formal charges are subtracted from the user specified partial charges.</td>
            </tr>
        </table>
        <table class="AutoNumber_p_Numbered1_" style="width: 100%; margin-left: 0;" cellspacing="0" cellpadding="0">
            <col style="width: 0px;" />
            <col style="width: 32px;" />
            <col style="width: auto;" />
            <tr>
                <td valign="top" />
                <td class="AutoNumber_p_Numbered1" valign="top"><span>4.</span>
                </td>
                <td class="AutoNumber_p_Numbered1" valign="top" data-mc-autonum="4.">These modified partial charges are decomposed into bond charge increments. </td>
            </tr>
        </table>
        <p>Internally, all charge processing to determine partial charges on the system being simulated is done using bond charge increments and delocalized formal charges. For detailed output to the <code>.log</code> file of this process, specify <span class="OpcodeLink"><a href="opcodes_misc_debug.htm#opcodes_509685220_debg">DEBG</a></span><code> 128</code> at the top of your <code>.com</code> file. Note that if wildcard atom types (e.g., N0, O0, 00) or generalized atom types (e.g., C, O) are used in the substructure linear notation, such atoms will be assigned formal charges of 0.0, and formal charge delocalization will not be allowed over those atoms in the delocalized formal charge calculation for that force field substructure. Additionally, formal charge delocalization will not be done over wildcard bond types, denoted by “*” in the substructure linear notation. If equivalenced atom types are used in the force field substructure, the formal charge properties will be taken to be those for the first MacroModel atom type in the list of atom types for that particular equivalenced atom type. For example, given the line<br /><code>1  CS  CA CB CC<br /></code>the formal charge properties for an atom of type CS in a force field substructure will be those which are specified for the actual MacroModel atom type CA.</p>
        <table class="NavLink" data-mc-conditions="Default.ScreenOnly">
            <tr class="NavLink">
                <td class="NavLeft"><span class="NavText">◀ <a class="NavLink MCXref xref xrefNavLink" href="mmod_force_field_files_subs_notation.htm" xrefformat="{paratext}">Substructure Linear Notation in the Force-Field File</a></span>
                </td>
                <td class="NavCenter"><span class="NavText"><a class="NavLink MCXref xref xrefNavLink" href="macromodel_command_referenceTOC.htm" xrefformat="{paratext}">MacroModel Command Reference Manual</a></span>
                </td>
                <td class="NavRight"><span class="NavText"><a class="NavLink MCXref xref xrefNavLink" href="mmod_force_field_files_subs_examples.htm" xrefformat="{paratext}">Force-Field File Substructure Examples</a> ▶</span>
                </td>
            </tr>
        </table>
    </body>
</html>